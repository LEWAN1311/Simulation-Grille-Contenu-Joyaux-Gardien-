/*! For license information please see wacodcowlhostwebpack.js.LICENSE.txt */
!function(e){function t(t){for(var a,i,r=t[0],o=t[1],s=t[2],c=0,d=[];c<r.length;c++)i=r[c],Object.prototype.hasOwnProperty.call(u,i)&&u[i]&&d.push(u[i][0]),u[i]=0;for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a]);for(v&&v(t);d.length;)d.shift()();return f.push.apply(f,s||[]),n()}function n(){for(var e,t=0;t<f.length;t++){for(var n=f[t],a=!0,i=1;i<n.length;i++){var r=n[i];0!==u[r]&&(a=!1)}a&&(f.splice(t--,1),e=p(p.s=n[0]))}return e}var a=window,i=a.require;function r(e){var t=e&&e.indexOf("/",e.indexOf("://")+3)+1;return t?e.slice(0,t):e}var o=document.currentScript,s=r(o&&o.src||i&&i.toUrl("")),c=r(a.__backupBaseUrl),d=i&&i.s.contexts._,l={},u={wacodcowlhostwebpack:0},f=[];function p(t){if(l[t])return l[t].exports;var n=l[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,p),n.l=!0,n.exports}var m=[[],[32],[42,"ondemand.resx-ondemand"],[28],[34]];p.ee=function(e,t,n){return Promise.all((Array.isArray(e)?e:m[e]).map(function(e){return p.e(e)})).then(n?p.t.bind(0,t,n):p.bind(0,t))},p.e=function(e){var t=e.toString(),n=d&&d.config.paths[t]&&d.nameToUrl(t)||function(e){return p.p+""+e+".js"}(e);function i(e){var t=[],i=u[e];if(0!==i)if(i)t.push(i[2]);else{var r=new Promise(function(t,n){i=u[e]=[t,n]});t.push(i[2]=r);var o,s=document.createElement("script");s.charset="utf-8",s.timeout=120,p.nc&&s.setAttribute("nonce",p.nc),s.src=n,0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous");var c=new Error;o=function(t){s.onerror=s.onload=null,clearTimeout(d);var n=u[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+a+": "+i+")",c.name="ChunkLoadError",c.type=a,c.request=i,n[1](c)}u[e]=void 0}};var d=setTimeout(function(){o({type:"timeout",target:s})},12e4);s.onerror=s.onload=o;var l=a.__odspSriHashes;if(l){var f=l[a.__odsp_culture+"/"+e]||l[e];f&&(s.integrity=f)}document.head.appendChild(s)}return Promise.all(t)}return i(e).catch(function(t){var r=a.__integrityViolationCallBack;r&&r(t.request);var o=c&&n.replace(s,c);return o&&o!==n?(n=o,i(e)):Promise.reject(t)})},p.m=e,p.c=l,p.d=function(e,t,n){p.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},p.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},p.t=function(e,t){if(1&t&&(e=p(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(p.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)p.d(n,a,function(t){return e[t]}.bind(null,a));return n},p.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return p.d(t,"a",t),t},p.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},p.p="/",p.oe=function(e){throw console.error(e),e};var _=p.p;Object.defineProperty(p,"p",{get:function(){if(window.require&&window.require.toUrl){var e=window.require.toUrl("");_=("/"!==e.slice(-1)?e+"/":e)+"wacodcowlhostwebpack.manifest/"}return _}});var h=window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[],b=h.push.bind(h);h.push=t,h=h.slice();for(var g=0;g<h.length;g++)t(h[g]);var v=b;f.push([314,"plt.resx-plt","plt.react","plt.office-ui-fabric-react","plt.odsp-common","plt.items-view"]),n()}([function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"r",function(){return o}),n.d(t,"n",function(){return s}),n.d(t,"t",function(){return c}),n.d(t,"i",function(){return d}),n.d(t,"o",function(){return l});var a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var r=function(){return r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};function o(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}function s(e,t,n,a){var i,r=arguments.length,o=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r<3?i(o):r>3?i(t,n,o):i(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o}function c(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})}function d(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}function l(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))}Object.create,Object.create},function(e,t,n){"use strict";n.d(t,"S",function(){return D}),n.d(t,"D",function(){return I}),n.d(t,"h",function(){return x}),n.d(t,"m",function(){return C}),n.d(t,"c",function(){return O}),n.d(t,"g",function(){return w}),n.d(t,"p",function(){return E}),n.d(t,"I",function(){return A}),n.d(t,"O",function(){return L}),n.d(t,"T",function(){return k}),n.d(t,"U",function(){return M}),n.d(t,"P",function(){return P}),n.d(t,"u",function(){return T}),n.d(t,"d",function(){return U}),n.d(t,"f",function(){return F}),n.d(t,"v",function(){return H}),n.d(t,"b",function(){return R}),n.d(t,"l",function(){return N}),n.d(t,"R",function(){return j}),n.d(t,"e",function(){return V}),n.d(t,"t",function(){return z}),n.d(t,"n",function(){return G}),n.d(t,"a",function(){return K}),n.d(t,"F",function(){return W}),n.d(t,"E",function(){return Y}),n.d(t,"x",function(){return J}),n.d(t,"r",function(){return X}),n.d(t,"w",function(){return Z}),n.d(t,"i",function(){return $}),n.d(t,"o",function(){return ee}),n.d(t,"M",function(){return te}),n.d(t,"s",function(){return ne}),n.d(t,"_",function(){return ae}),n.d(t,"y",function(){return ie}),n.d(t,"H",function(){return re}),n.d(t,"L",function(){return oe}),n.d(t,"k",function(){return se}),n.d(t,"A",function(){return ce}),n.d(t,"C",function(){return de});var a=n(6),i=n(87),r=n(2),o=a.a,s=a.t.freeze,c=(a.t.seal,a.t.keys),d=String[a.l],l=d.trim,u=d.endsWith,f=d.startsWith,p=Date[a.l].toISOString,m=Array.isArray,_=a.r.toString,h=a.i.toString,b=h.call(a.t),g=/-([a-z])/g,v=/([^\w\d_$])/g,y=/^(\d+[\w\d_$])/,S=Object.getPrototypeOf;function D(e,t){return typeof e===t}function I(e){return void 0===e||typeof e===a.u}function x(e){return null===e||I(e)}function C(e){return!x(e)}function O(e,t){return!(!e||!a.i.call(e,t))}function w(e){return!(!e||typeof e!==a.d)}function E(e){return!(!e||typeof e!==a.s)}function A(e){var t=e;return t&&H(t)&&(t=(t=(t=t.replace(g,function(e,t){return t.toUpperCase()})).replace(v,"_")).replace(y,function(e,t){return"_"+t})),t}function L(e,t){if(e)for(var n in e)a.i.call(e,n)&&t.call(e,n,e[n])}function k(e,t){var n=!1;return e&&t&&!(n=e===t)&&(n=u?e.endsWith(t):function(e,t){var n=!1,a=t?t.length:0,i=e?e.length:0;if(a&&i&&i>=a&&!(n=e===t)){for(var r=i-1,o=a-1;o>=0;o--){if(e[r]!=t[o])return!1;r--}n=!0}return n}(e,t)),n}function M(e,t){var n=!1;return e&&t&&!(n=e===t)&&(n=f?e.startsWith(t):function(e,t){var n=!1,a=t?t.length:0;if(e&&a&&e.length>=a&&!(n=e===t)){for(var i=0;i<a;i++)if(e[i]!==t[i])return!1;n=!0}return n}(e,t)),n}function P(e,t){return!(!e||!t)&&-1!==e.indexOf(t)}function T(e){return!(!e||"[object Date]"!==_.call(e))}var U=m||function(e){return!(!e||"[object Array]"!==_.call(e))};function F(e){return!(!e||"[object Error]"!==_.call(e))}function H(e){return"string"==typeof e}function R(e){return"number"==typeof e}function N(e){return"boolean"==typeof e}function B(e){var t=!1;if(e&&"object"==typeof e){var n=S?S(e):function(e){if(e){if(S)return S(e);var t=e.__proto__||e[a.l]||e.constructor;if(t)return t}return null}(e);n?(n.constructor&&a.i.call(n,"constructor")&&(n=n.constructor),t=typeof n===a.s&&h.call(n)===b):t=!0}return t}function j(e){if(e)return p?e.toISOString():function(e){if(e&&e.getUTCFullYear){var t=function(e){var t=String(e);return 1===t.length&&(t="0"+t),t};return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}(e)}function V(e,t,n){var a=e.length;try{for(var i=0;i<a&&(!(i in e)||-1!==t.call(n||e,e[i],i,e));i++);}catch(e){}}function z(e,t,n){if(e){if(e.indexOf)return e.indexOf(t,n);var a=e.length,i=n||0;try{for(var r=Math.max(i>=0?i:a-Math.abs(i),0);r<a;r++)if(r in e&&e[r]===t)return r}catch(e){}}return-1}function G(e,t,n){var a;if(e){if(e.map)return e.map(t,n);var i=e.length,r=n||e;a=new Array(i);try{for(var o=0;o<i;o++)o in e&&(a[o]=t.call(r,e[o],e))}catch(e){}}return a}function K(e,t,n){var a;if(e){if(e.reduce)return e.reduce(t,n);var i=e.length,r=0;if(arguments.length>=3)a=arguments[2];else{for(;r<i&&!(r in e);)r++;a=e[r++]}for(;r<i;)r in e&&(a=t(a,e[r],r,e)),r++}return a}function W(e){return e&&(e=l&&e.trim?e.trim():e.replace?e.replace(/^\s+|\s+$/g,""):e),e}var q=!{toString:null}.propertyIsEnumerable("toString"),Q=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];function Y(e){var t=typeof e;if(t===a.s||t===a.d&&null!==e||Object(i.n)("objKeys called on non-object"),!q&&c)return c(e);var n=[];for(var r in e)e&&a.i.call(e,r)&&n.push(r);if(q)for(var o=Q.length,s=0;s<o;s++)e&&a.i.call(e,Q[s])&&n.push(Q[s]);return n}function J(e,t,n,a){if(o)try{var i={enumerable:!0,configurable:!0};return n&&(i.get=n),a&&(i.set=a),o(e,t,i),!0}catch(e){}return!1}function X(e){return s&&L(e,function(e,t){(U(t)||w(t))&&s(t)}),Z(e)}var Z=s||function(e){return e};function $(){var e=Date;return e.now?e.now():(new e).getTime()}function ee(e){return F(e)?e.name:r.i}function te(e,t,n,a,i){var r=n;return e&&((r=e[t])===n||i&&!i(r)||a&&!a(n)||(r=n,e[t]=r)),r}function ne(e,t,n){var a;return e?!(a=e[t])&&x(a)&&(a=I(n)?{}:n,e[t]=a):a=I(n)?{}:n,a}function ae(e){return!e}function ie(e){return!!e}function re(e){throw new Error(e)}function oe(e,t,n,a,i){e&&t&&n&&(!1!==i||I(e[t]))&&(e[t]=function(e,t){var n=null,a=null;return E(e)?n=e:a=e,function(){var e=arguments;if(n&&(a=n()),a)return a[t].apply(a,e)}}(n,a))}function se(e,t,n,a){return e&&t&&w(e)&&U(n)&&V(n,function(n){H(n)&&oe(e,n,t,n,a)}),e}function ce(e){return e&&a.e&&(e=Object(a.t)(Object(a.e)({},e))),e}function de(e,t,n,i,r,o){var s=arguments,c=s[0]||{},d=s.length,l=!1,u=1;for(d>0&&N(c)&&(l=c,c=s[u]||{},u++),w(c)||(c={});u<d;u++){var f=s[u],p=U(f),m=w(f);for(var _ in f){var h=p&&_ in f||m&&a.i.call(f,_);if(h){var b=f[_],g=void 0;if(l&&b&&((g=U(b))||B(b))){var v=c[_];g?U(v)||(v=[]):B(v)||(v={}),b=de(l,v,b)}void 0!==b&&(c[_]=b)}}}return c}},function(e,t,n){"use strict";n.d(t,"i",function(){return a}),n.d(t,"p",function(){return i}),n.d(t,"u",function(){return r}),n.d(t,"h",function(){return o}),n.d(t,"c",function(){return s}),n.d(t,"b",function(){return c}),n.d(t,"t",function(){return d}),n.d(t,"g",function(){return l}),n.d(t,"n",function(){return u}),n.d(t,"a",function(){return f}),n.d(t,"f",function(){return p}),n.d(t,"_",function(){return m}),n.d(t,"d",function(){return _}),n.d(t,"e",function(){return h}),n.d(t,"m",function(){return b}),n.d(t,"s",function(){return g}),n.d(t,"r",function(){return v}),n.d(t,"o",function(){return y}),n.d(t,"l",function(){return S});var a="",i="processTelemetry",r="priority",o="setNextPlugin",s="isInitialized",c="teardown",d="core",l="update",u="disabled",f="_doTeardown",p="processNext",m="resume",_="pause",h="addNotificationListener",b="removeNotificationListener",g="eventsSent",v="eventsDiscarded",y="eventsSendRequest",S="perfEvent"},function(e,t,n){"use strict";var a=n(7);t.e=a.e},,,function(e,t,n){"use strict";n.d(t,"s",function(){return a}),n.d(t,"d",function(){return i}),n.d(t,"u",function(){return r}),n.d(t,"l",function(){return o}),n.d(t,"c",function(){return s}),n.d(t,"o",function(){return c}),n.d(t,"t",function(){return d}),n.d(t,"r",function(){return l}),n.d(t,"e",function(){return u}),n.d(t,"n",function(){return f}),n.d(t,"a",function(){return p}),n.d(t,"i",function(){return m});var a="function",i="object",r="undefined",o="prototype",s="hasOwnProperty",c="default",d=Object,l=d[o],u=d.assign,f=d.create,p=d.defineProperty,m=l[s]},,function(e,t,n){"use strict";n.d(t,"L",function(){return r.n}),n.d(t,"o",function(){return r.t}),n.d(t,"A",function(){return d}),n.d(t,"e",function(){return l}),n.d(t,"s",function(){return u}),n.d(t,"n",function(){return p}),n.d(t,"f",function(){return m}),n.d(t,"m",function(){return _}),n.d(t,"_",function(){return h}),n.d(t,"u",function(){return b}),n.d(t,"h",function(){return g}),n.d(t,"b",function(){return v}),n.d(t,"g",function(){return y}),n.d(t,"v",function(){return S}),n.d(t,"p",function(){return D}),n.d(t,"y",function(){return I}),n.d(t,"D",function(){return x}),n.d(t,"O",function(){return C}),n.d(t,"C",function(){return O}),n.d(t,"x",function(){return w}),n.d(t,"d",function(){return E}),n.d(t,"l",function(){return A}),n.d(t,"t",function(){return L}),n.d(t,"i",function(){return k}),n.d(t,"I",function(){return T}),n.d(t,"S",function(){return U}),n.d(t,"a",function(){return F}),n.d(t,"r",function(){return H}),n.d(t,"c",function(){return R}),n.d(t,"w",function(){return N}),n.d(t,"E",function(){return j});var a=n(279),i=n(3),r=(window._spModuleLink&&["ODBLightSpeedWebPack","ODBOneDrive"].indexOf(window._spModuleLink.manifestName),n(27)),o=window._spModuleLink&&"MetaOSODBFileBrowserV2"===window._spModuleLink.manifestName,s=window._spModuleLink&&"ODBLightSpeedWebPack"===window._spModuleLink.manifestName,c=window._spModuleLink&&"ModernFrame"===window._spModuleLink.manifestName,d=(i.e.isActivated("385ac127-7335-45ab-9515-8ac541286052","08/25/2023","Use service config for SWA routing enabled value"),window.Flight&&"odclightspeedwebpack"===window.Flight.manifest||window._spModuleLink&&"odclightspeedinspowebpack"===window._spModuleLink.manifestName),l={ODC:"AddTelemetryHeaders"},u=(i.e.isActivated("BF7BE655-7F9F-40C8-920B-C4088F784512","05/05/2022","Prefer cookie API calls using proxy in File Picker"),r.n,i.e.isActivated("95195f4e-8936-409f-bc5e-d98fad1cef73","08/18/2021","KillSwitch for consuming exposed Default click control handler in OneDriveItemsScopeApp"),!s&&r.i,i.e.isActivated("7B7FA902-74E1-41A3-B7FA-5E99A7C60744","10/25/2021","Enables the CallerId and CallerScenarioId query provided on inbound links to be logged in extra data of Page.View engagement event."),r.a,r.a,!r.a&&i.e.isActivated("3EFEFBD7-0AA5-4041-AAC2-EE0308AC532D","07/27/2023","shows the Recent pivot for migrated users"),!!r.a&&i.e.isActivated("70C000B4-CC40-4BC4-99BF-77B1C9D91115","08/01/2022","Disable photos pivot in winApp"),i.e.isActivated("728AC795-2069-44D4-B387-4B82D9E1D930","06/29/2022","Use layer projection for Sites in ODB"),i.e.isActivated("C7DDA4BE-D28B-4151-A22F-0BD7727B012D","1/26/2022","Use cross-site File Browser for Sites in ODB"),i.e.isActivated("8EC3A32A-7C43-4A5F-9AE1-74CBF2762A13","05/22/2023","Enable ODB LightSpeed in File Browser"),i.e.isActivated("AE80FFF3-D767-43B8-94F7-0C1D745C293F"),i.e.isActivated("B29F9DC8-0A52-4F31-A513-088869FB0BB9"),i.e.isActivated("5B71E25C-79EB-46E2-A9EE-C2B81FAC35A0"),i.e.isActivated("7A9FE75A-505E-49E7-A1B9-559C38018477","10/22/2023","Routes certain CTAs for Brazil and India users to the Plans page rather than DIME"),i.e.isActivated("480B5399-553E-44D1-890F-217A65B602DD","06/06/2023","Add scenario header in push channel , FRE and prefetch API calls"),i.e.isActivated("CB8ABF5A-9C79-4B25-A42A-2D3161BC722E"),r.n,r.a,r.a,{ODB:-990,ODC:"ForceEnableAria"}),f=(r.n,!r.a&&i.e.isActivated("5F12686F-52A2-4E49-A1D8-A2AE7969622E","10/29/2021","Use multiPart getItem api(ODC vroom) to avoid CORS if KS is not activated."),i.e.isActivated("DC975CAD-8F3C-4979-97E2-DA9970A68919","03/25/2022","Prefer isMySiteOwner check for ODB"),i.e.isActivated("ADD22FCF-682C-4C09-975D-664352383E72"),r.a,void 0===n.p),p=(r.n&&!s&&!r.a&&!o||!r.n&&f&&i.e.isActivated("608E1D31-70F0-4B48-9EC3-CDCC41EA17E2","8/30/2021","Refresh the page in a SPList when closing previewer when the user is using AMD."),i.e.isActivated("9ACCAC8B-D74D-43A2-98AA-457EADAF074D","11/5/2021","Initialze logging with OAuth support"),i.e.isActivated("F7A1F6FE-3272-4B0E-AD26-70E8322C5D8F","09/15/2022","Ensure components use getDriveQuotaKey method to get the key"),i.e.isActivated("72B58EAF-775A-4B01-BFF4-A083818DDF86","05/05/2022","Use on-demand implementation for DefaultClickAction"),r.a,i.e.isActivated("00ece790-28cb-4228-b947-70c6cf959b9e","6/5/2023","Simplified Sharing Dialog v2"),i.e.isActivated("4496A248-01D8-4CBC-988F-C8D3DF98E12F","09/26/2023","Use self-issued token for authentication"),i.e.isActivated("5EF28CEA-01F7-4DA8-995F-00EC16D852B1","09/26/2023","Use self-issued token to authenticate zip download"),{ODC:!i.e.isActivated("0DEAC9E8-4230-49B1-869A-55EE7D4256FC","10/22/2021","Disable silent auth frame in ODC itemsscope for anonymous users")}),m={ODC:"UseItemsScopeInAllPhotosEnableIE"},_={ODC:"UseItemsScopeInAllPhotosEnableMobile"},h={ODC:"UseItemsScopeInAllPhotosEnableSafari"},b={ODC:"UseItemsScopeInAllPhotos"},g={ODC:"UseItemsScopeInAllTags"},v={ODC:!r.a||"EnableLightspeedInOneDriveWinApp",ODB:!r.a||1413},y={ODC:"UseItemsScopeInSingleAlbum"},S={ODC:"UseItemsScopeInSingleTag"},D={ODC:"UseItemsScopeInAllPhotosEnableInFilePicker"},I={ODB:!r.a},x={ODC:"UseNewShareDialogForWinApp"},C={ODB:!0,ODC:"WACHostMoveToFolder"},O={ODB:!0,ODC:"WACHostCommonFilePicker"},w=(r.a,r.n,{ODC:"UseVroomInItemsScopeAllPhotos"}),E={ODC:"UpdateOdcPhotoApiForConvergence"},A=(i.e.isActivated("6BDFBA6F-5D99-45BE-82FA-9F1AA26B3270","11/21/2023","use default all photos settings for migrated user as SkyApi doesnot support migrated scenarios"),{ODC:"UpdateOdcVaultApiForConvergence",ODB:61310}),L={ODC:"ApplyItemsScopeToRecycleBin"},k=(r.n,i.e.isActivated("a22e84e5-8586-40bd-8095-9c90ab3fad2b","12/08/2020","Use the new tile design in the more shared libraries page"),{ODC:"EnableSearchInFilePickerHosts",ODB:1128}),M=(i.e.isActivated("a393b488-dba6-431f-b6f9-383f65f2340b","4/10/2023","Protection for sensitivity label changes that are not blocked by doclib flight."),i.e.isActivated("a66557cf-0022-43dd-b951-e1b1fa3fcad4","04/07/2023","allow OneUpLightSpeed to override selection")),P=window.location.href.toString().indexOf("detailsPane")>-1,T={ODB:s?60491:!M&&c&&P,ODC:!1};i.e.isActivated("74355188-3458-42A4-9DB6-5666BA79B5EB","03/02/2022","Moves transition resources to the KnockoutResourceScope as a preparation for OnDemand Knockout"),i.e.isActivated("641e3add-dd2f-41f8-b6f7-fc34cf2c3e43","10/06/2023","Disable Clipchamp in New Button and Edit New Button Section in SP Sites"),r.n,i.e.isActivated("f8821413-7078-41bf-b2f4-f23a04fb160a","05/11/2021","Log error in PrefetchListData method");var U={ODC:"UseNewShareDialog"},F={ODC:"EnableMsaOauthErrorRedirect"},H={ODC:"FamilySharing"},R={ODC:!0},N=(i.e.isActivated("FF1B4420-96EA-4BE2-9DD2-250D0CAFB79E","04/10/2023","Use base OneDrive nav in File Browser"),i.e.isActivated("CC7D2937-5E6E-4604-AAC5-E5A8DD34BFFB","11/08/2022","Flush telemetry before notifying Picker host"),i.e.isActivated("2A89B57A-0069-4F50-AAD5-3B931C8EF512","03/08/2023","Enable open on drag-hover"),i.e.isActivated("00783027-B2E9-4B88-82FB-C2921BF253B2","03/18/2023","Enable Drag/Drop copy"),i.e.isActivated("63B21C89-2740-44A9-980B-DDA8E2689DAA","07/21/2021","Do not invalidate source location when performing a copy"),i.e.isActivated("63B21C89-2740-44A9-980B-DDA8E2689DAA","07/21/2021","Do not invalidate source location when performing a copy"),i.e.isActivated("60FAB98B-2A5D-4153-B69A-46A9C7C4B6D7","11/17/2021","Use SelectionHelper to get the current item"),i.e.isActivated("CCA9C934-1E36-4308-B93D-0025EAAECC37","11/17/2021","Use SelectionHelper to get the current item in AddToAlbumExecutor"),i.e.isActivated("EB5778E9-2AB1-4A93-AED8-64615D06F8D6","03/01/2022","Show notification banner in Lightspeed"),i.e.isActivated("74216f8a-f424-4b58-9d69-5fcbd587c0d2","05/30/2023","Enable telemetry for enhanced image tagging library toggle actions"),function(e){if(r.o&&r.o.farmSettings)return r.o.farmSettings[e]}),B=function(e){return e.serviceSetting?function(e){if(i.e.isActivated("ff60da5f-a9ea-432e-9d7b-d58b8f7519ba","2/19/2021","ServiceConfigSettingKillSwitch"))return 1===Number(N(e));if(i.e.isActivated("23a54fe5-4472-4139-b74f-4b9e45901702","8/25/2023","Normalize service config boolean settings casing"))return 1===Number(N(e))||"true"===N(e);var t=N(e);return!!t&&(1===Number(t)||"true"===t.toLowerCase())}(e.serviceSetting):a.n.isFeatureEnabled(e)},j=r.a?function(e){return!!Object(r.r)()&&B(e===x?e={ODC:"UseNewShareDialogForWinApp"}:e)}:B;i.e.isActivated("0c7daee7-fce1-4cf2-bb94-988d168bb456","09/01/2023","Enable fix for image tagger toggle text rendering")},function(e,t,n){"use strict";var a;!function(e){e[e.Loading=0]="Loading",e[e.Files=1]="Files",e[e.FilePicker=2]="FilePicker",e[e.FolderPicker=3]="FolderPicker",e[e.Photos=4]="Photos",e[e.TextFileEditor=5]="TextFileEditor",e[e.AccountChooser=6]="AccountChooser",e[e.StorageInfo=7]="StorageInfo",e[e.StorageOptions=8]="StorageOptions",e[e.AppData=9]="AppData",e[e.Error=10]="Error",e[e.SyncOnboarding=11]="SyncOnboarding",e[e.Share=12]="Share",e[e.OneUp=14]="OneUp",e[e.PhotoPreferences=15]="PhotoPreferences",e[e.Embed=16]="Embed",e[e.SyncPlaceholders=17]="SyncPlaceholders",e[e.Restore=18]="Restore",e[e.ValidatePermission=20]="ValidatePermission",e[e.RansomwareDetection=21]="RansomwareDetection",e[e.Settings=22]="Settings",e[e.Unlock=23]="Unlock",e[e.MobileAppUpsell=24]="MobileAppUpsell",e[e.FileRequest=26]="FileRequest",e[e.CreateList=27]="CreateList",e[e.ManageVault=28]="ManageVault",e[e.RequestAccess=29]="RequestAccess",e[e.TraceMe=30]="TraceMe",e[e.FileBrowser=31]="FileBrowser",e[e.TagPreferences=32]="TagPreferences",e[e.PhotoStream=33]="PhotoStream",e[e.Convergence=34]="Convergence",e[e.DocumentOptions=35]="DocumentOptions",e[e.DeviceBackups=37]="DeviceBackups",e[e.Search=38]="Search",e[e.NotificationOptions=39]="NotificationOptions",e[e.ContentAssembly=40]="ContentAssembly",e[e.MetaOSAuthPopup=41]="MetaOSAuthPopup",e[e.SharingSettings=301]="SharingSettings",e[e.SyncSettings=302]="SyncSettings",e[e.StorageSettings=303]="StorageSettings",e[e.AccessPolicySettings=304]="AccessPolicySettings",e[e.ComplianceSettings=305]="ComplianceSettings",e[e.NotificationSettings=306]="NotificationSettings",e[e.GeoLocations=307]="GeoLocations"}(a||(a={}));var i=a;t.e=i},function(e,t,n){"use strict";n.d(t,"e",function(){return x}),n.d(t,"A",function(){return E.y}),n.d(t,"p",function(){return M}),n.d(t,"b",function(){return P}),n.d(t,"g",function(){return T}),n.d(t,"S",function(){return U}),n.d(t,"n",function(){return F}),n.d(t,"x",function(){return H}),n.d(t,"t",function(){return R}),n.d(t,"I",function(){return N}),n.d(t,"C",function(){return B}),n.d(t,"c",function(){return j}),n.d(t,"i",function(){return V}),n.d(t,"r",function(){return z}),n.d(t,"u",function(){return G}),n.d(t,"o",function(){return K}),n.d(t,"v",function(){return W}),n.d(t,"w",function(){return q}),n.d(t,"d",function(){return Q}),n.d(t,"m",function(){return Y}),n.d(t,"h",function(){return J}),n.d(t,"s",function(){return X}),n.d(t,"a",function(){return Z}),n.d(t,"O",function(){return $}),n.d(t,"f",function(){return ee}),n.d(t,"_",function(){return te}),n.d(t,"D",function(){return ne}),n.d(t,"y",function(){return ae}),n.d(t,"l",function(){return ie}),n.d(t,"E",function(){return oe});var a,i=n(0),r=n(26),o=n(86),s=n(58),c=n(7),d=n(81),l=n(127),u=n(118),f=(n(106),n(84)),p=n(12),m=n(171),_=(n(128),n(75)),h=n(43),b=(n(266),n(279)),g=n(9);!function(e){e[e.AllMyPhotos=0]="AllMyPhotos",e[e.Albums=1]="Albums",e[e.allTags=2]="allTags",e[e.allPlaces=3]="allPlaces",e[e.allPeople=4]="allPeople",e[e.singleAlbum=5]="singleAlbum",e[e.singleTag=6]="singleTag",e[e.singlePlace=7]="singlePlace",e[e.singlePerson=8]="singlePerson",e[e.onThisDay=9]="onThisDay",e[e.onThisMonth=10]="onThisMonth",e[e.lastWeekPreviousYears=11]="lastWeekPreviousYears"}(a||(a={}));var v,y=a,S=n(18),D=n(153),I=n(37);!function(e){e[e.Feed=0]="Feed",e[e.Story=1]="Story"}(v||(v={}));var x,C=n(22),O=n(77),w=n(24),E=n(16),A=!c.e.isActivated("A1B9808D-D7B3-41D5-9954-CC3BF1A89881","10/09/2023","Adds ReturnURL as a prop instead of just wreply for signins (for SPO)"),L=!c.e.isActivated("9CBCD9E8-6429-4AA7-8C30-2471C57496E5","10/24/2023");!function(e){e[e.all=31]="all",e[e.folders=2]="folders",e[e.photos=8]="photos",e[e.documents=16]="documents",e[e.music=32]="music"}(x||(x={}));var k={ch:"https://www.microsoft.com/de-ch/microsoft-schweiz/unternehmen/impressum.aspx",at:"https://www.microsoft.com/de-at/unternehmen/rechtliches/impressum-corp.aspx",de:"https://www.microsoft.com/germany/siteservices/impressum/default.mspx"};function M(e){return p.e(e)}function P(e,t){var n;switch(e.v){case"1":case"FolderPickerView":case"2":case"FilePickerView":case"pickerconsent":n=g.e.FilePicker;break;case"3":n=g.e.Files;break;case"photos":n=g.e.Photos;break;case"managestorage":n=g.e.StorageInfo;break;case"photopreferences":n=g.e.PhotoPreferences;break;case"tagpreferences":n=g.e.TagPreferences;break;case"error":n=g.e.Error;break;case"RansomwareDetection":n=g.e.RansomwareDetection;break;case"syncplaceholders":n=g.e.SyncPlaceholders;break;case"upgrade":n=g.e.StorageOptions;break;case"restore":n=g.e.Restore;break;case"TextFileEditor":n=g.e.TextFileEditor;break;case"syncpremiumupsell":n=g.e.SyncOnboarding;break;case"validatepermission":n=g.e.ValidatePermission;break;case"requestaccess":n=g.e.RequestAccess;break;case"unlock":n=g.e.Unlock;break;case"ManageVault":n=g.e.ManageVault;break;case"traceme":n=g.e.TraceMe;break;case"convergence":n=g.e.Convergence;break;case"documentoptions":n=g.e.DocumentOptions;break;case"devicebackups":n=g.e.DeviceBackups;break;case"search":n=g.e.Search;break;case"NotificationOptions":n=g.e.NotificationOptions;break;default:if(Object(E.s)())n=g.e.AccountChooser;else{if(j(e)&&t)return g.e.OneUp;n=g.e.Files}}return n}function T(e){return"photos"===e.v&&Object(D.e)(Object(f.e)(e))?y.AllMyPhotos:Object(E.u)(e)?y.allTags:Object(E.v)(e)?y.singleTag:Object(E.l)(e)?y.allPlaces:Object(E.g)(e)?y.singlePlace:Object(E.m)(e)?y.onThisDay:Object(E._)(e)?y.onThisMonth:Object(E.p)(e)?y.lastWeekPreviousYears:Object(E.d)(e)?y.AllMyPhotos:Object(E.c)(e)?y.Albums:Object(E.b)(e)?y.singleAlbum:"photos"===e.v?y.AllMyPhotos:null}function U(e){var t,n;void 0===e&&(e=S.e.Files);var a=((t={})[S.e.Files]="",t[S.e.Recent]="mru",t[S.e.SharedWithMe]="sharedby",t[S.e.SharedByMe]="sharedbyme",t[S.e.RecycleBin]="recyclebin",t[S.e.AllMyPhotos]="allmyphotos",t[S.e.PhotoStream]="photostream",t[S.e.Selection]="selection",t[S.e.People]="people",t[S.e.LargestFiles]="largestfiles",t);return Object(h.e)(((n={}).qt=a[e],n))}function F(e){return e.authkey}function H(e){return!(e.mid||e.mcid||"sharedby"!==e.qt&&R(e)||N(e))}function R(e){var t=e.cid;return!(!t&&E.f)&&function(e){var t=E.y;return!e||Object(l.e)(e,t)}(t)}function N(e){return Object(E.d)(e)||Object(E.c)(e)||Object(E.b)(e)||Object(E.u)(e)||Object(E.l)(e)||Object(E.m)(e)||Object(E._)(e)||Object(E.p)(e)}function B(e){return!(!e.mid||!e.mcid)}function j(e){var t=null;return(e.parId||e.parQt||e.parCid)&&((t={}).id=e.id,t.qt=e.qt,t.cid=e.cid,t.internalPath=e.internalPath,Object(w.E)(w.y)&&(t.driveId=e.driveId),delete t.u),t&&Object(h.e)(t)||null}function V(e){var t=e.action||"";return C.e[t.toLowerCase()]||C.t.none}function z(){return window.location.protocol+"//"+window.location.host}function G(e){var t=e.itemKey,n=e.itemInfo,a=e.page,r=e.action,o=e.preserveAction,s=void 0!==o&&o,c=e.viewParams,d=n||{},l=d.itemIsPlaceholder,u=d.itemVirtualItemType,p=d.itemExtension,_=d.itemType,h=M(t),b=Object(i.e)({},h),v=W(c);void 0!==a&&(v.v=function(e,t){var n,a=t.v;switch(e){case g.e.FilePicker:n=re(a)?a:"FilePickerView";break;case g.e.TextFileEditor:n="TextFileEditor";break;case g.e.Photos:n="photos";break;case g.e.RansomwareDetection:n="RansomwareDetection";default:case g.e.Files:}return n}(a,c));var y=!1,I=!!p&&Object(m.e)(p,_);if(l)switch(b.id){case"tags":case"places":case"albums":v.v="photos",y=!0}else switch("TextFileEditor"===v.v&&(I||(v.v="")),u){case O.e.Album:case O.e.AlbumRoot:case O.e.Tag:case O.e.TagsRoot:v.v="photos",y=!0}"allmyphotos"===h.qt&&(b.v="photos",y=!0,"true"!==h.onThisDay&&"true"!==h.onThisMonth&&"true"!==h.lastWeekPreviousYears||(c&&c.startDate&&(b.startDate=c.startDate),c&&c.cid&&(b.cid=c.cid))),"photostream"===h.qt&&(b.v="photoStream",b.psShareId=c.psShareId);var w=Object(f.e)(h);I||!n||y||w===S.e.Search||w===S.e.AllMyPhotos||w===S.e.PhotoStream||(b.v=""),!I&&Object(D.e)(w)&&("photos"!==v.v&&"photoStream"!==v.v||Object(E.n)(h)!==x.photos.toString())&&(b.v=""),re(v.v)&&(b.v=v.v),delete v.scope,delete b.u;var A=V(c);return r?b.action=r&&C.t[r]&&C.t[r].toLowerCase()||"":s&&A&&(A===C.t.showProperties&&b.o||(b.action=C.t[A].toLowerCase())),Object(i.e)(v,b),v}function K(e,t){var n=[];switch(n.push(z()),e){case 0:n.push("/");break;case 1:n.push(I.i);break;default:n.push(X())}return n.push("?"),n.push(t),n.join("")}function W(e){var t,n,a=Object(i.e)(((t={}).iam=e.iam,t.ticket=e.ticket,t.authkey=e.authkey,t.redeem=e.redeem,t.v=e.v,t.invref=e.invref,t.invsrc=e.invsrc,t.client_id=e.client_id,t.scope=e.scope,t.domain=e.domain,t.referrer=e.referrer,t.crid=e.crid,t.auth=e.auth,t.picker=e.picker,t.filePicker=e.filePicker,t.fileBrowser=e.fileBrowser,t.app=e.app,t.scenario=e.scenario,t.expectsBusiness=e.expectsBusiness,t.sc=e.sc,t.simulateunauth=e.simulateunauth,t),L?((n={})[b.t]=e[b.t],n[b.e]=e[b.e],n):{});for(var r in e)0===r.indexOf("EXPExperimentTest_e")&&(a[r]=e[r]);var o=e["WT.mc_id"],s=e.ocid;for(var c in o&&(a["WT.mc_id"]=o,a.ocid=s||o),e)c.startsWith("wd")&&(a[c]=e[c]);return a}function q(e,t){return void 0===t&&(t=!1),t||r.e.si?Z($(e)):e}function Q(){var e=o.e.getMarket(),t=e&&e.split("-")[1];return t&&k[t.toLowerCase()]}function Y(){return"https://go.microsoft.com/fwlink/?linkid=2100224"}function J(e){var t,n=e.wtcParam,a=e.viewParams,i=e.hideLeftNav,r=((t={}).ocid=a.ocid||a["WT.mc_id"]||n,t.v="upgrade",t.hideLeftNav=i,t),o="/"===window.location.pathname;return q("".concat(o?"#":"/?").concat(p.t(r,null,!0)))}function X(){return window.location.pathname}function Z(e){var t=r.e.signInUrl;return window.location.href.indexOf("iam=")>-1?(t+="&redirect_uri={0}",e=z()+"/business"):t+="&ru={0}&wreply={0}",A&&(t+="&returnUrl={0}"),u.n(t,d.e.encodeURIComponent(e||window.location.href))}function $(e){return 0===e.indexOf("#")&&(e=K(2,e.substring(1))),e}function ee(e){var t=e.additionalViewParams,n=G(Object(i.e)({},e));return t&&Object(s.e)(n,t),t&&t.sc||delete n.sc,"#"+p.t(n,null,!0)}function te(){return z()+"/marketblockerror.aspx"}function ne(e){var t={};return t.id=e.id,t.challengeToken=e.authkey,t.v="validatepermission",z()+"?"+p.t(t,null,!0)}function ae(e){var t={};return t.id=e.id,t.challengeToken=e.authkey,t.v="requestaccess",z()+"?"+p.t(t,null,!0)}function ie(e){void 0===e&&(e={});var t=Object(i.e)({},e),n=e.ithint;switch(n&&("album"===n.split(",")[0]&&(t.v="photos"),delete t.ithint),S.e.AllMyPhotos===Object(f.e)(e)&&(t.v="photos"),e.v){case"pickerconsent":t.v="pickerconsent";break;case"FolderPickerView":case"1":t.v="FolderPickerView";break;case"FilePickerView":case"2":t.v="FilePickerView";break;case"RansomwareDetection":t.v="RansomwareDetection";break;case"3":delete t.v}return t}function re(e){var t;switch(e){case"FilePickerView":case"2":case"FolderPickerView":case"1":case"pickerconsent":t=!0;break;default:t=!1}return t}function oe(e){void 0===e&&(e={filters:[]});for(var t=[],n=[],a=0,i=0,r=e.filters;i<r.length;i++)"string"==typeof(c=r[i])?t.push(c):n.push(c);if(!t.length)for(var o=0,s=n;o<s.length;o++){var c;switch(c=s[o]){case _.e.folder:a|=7;break;case _.e.audio:a|=32;break;case _.e.media:a|=8;break;case _.e.document:a|=16;break;case _.e.any:a|=x.all}}var d=t.join(";"),l="".concat(a||""),u={};return d&&(u.ext=d),l&&(u.ft=l),u}},,,function(e,t,n){"use strict";function a(e,t,n){return c(e,1,t,n)}function i(e,t,n){return c(e,2,t,n)}function r(e,t,n){return c(e,3,t,n)}function o(e,t,n){return c(e,0,t,n)}function s(e,t,n){return c(e,4,t,n)}function c(e,t,n,a){return{name:e,dataType:t,value:n,classification:a||4}}n.d(t,"e",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"i",function(){return o}),n.d(t,"n",function(){return s})},function(e,t,n){var a,i,r;!function(o){var s=this||(0,eval)("this"),c=s.document,d=s.navigator,l=s.jQuery,u=s.JSON;!function(o){i=[t,n],void 0===(r="function"==typeof(a=o)?a.apply(t,i):a)||(e.exports=r)}(function(e,t){function n(e,t){return(null===e||typeof e in D)&&e===t}function a(e,t){var n;return function(){n||(n=S.a.setTimeout(function(){n=o,e()},t))}}function i(e,t){var n;return function(){clearTimeout(n),n=S.a.setTimeout(e,t)}}function r(e,t){t&&t!==I?"beforeChange"===t?this.Lb(e):this.Ha(e,t):this.Mb(e)}function f(e,t){null!==t&&t.k&&t.k()}function p(e,t){var n=this.Ic,a=n[E];a.S||(this.lb&&this.Na[t]?(n.Qb(t,e,this.Na[t]),this.Na[t]=null,--this.lb):a.r[t]||n.Qb(t,e,a.s?{ia:e}:n.wc(e)))}function m(e,t,n,a){S.d[e]={init:function(e,i,r,o,s){var c,d;return S.m(function(){var r=i(),o=S.a.c(r),l=(o=!n!=!o,!d);(l||t||o!==c)&&(l&&S.va.Aa()&&(d=S.a.ua(S.e.childNodes(e),!0)),o?(l||S.e.da(e,S.a.ua(d)),S.Ka(a?a(s,r):s,e)):S.e.xa(e),c=o)},null,{i:e}),{controlsDescendantBindings:!0}}},S.h.ta[e]=!1,S.e.V[e]=!0}var _,h,b,g,v,y,S=void 0!==e?e:{};S.b=function(e,t){for(var n=e.split("."),a=S,i=0;i<n.length-1;i++)a=a[n[i]];a[n[n.length-1]]=t},S.G=function(e,t,n){e[t]=n},S.version="3.5.0-pre",S.b("version",S.version),S.options={deferUpdates:!1,useOnlyNativeEvents:!1},S.a=function(){function e(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}function t(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function n(e,t){return e.__proto__=t,e}function a(e,t,n,a){var i=e[t].match(h)||[];S.a.q(n.match(h),function(e){S.a.pa(i,e,a)}),e[t]=i.join(" ")}var i={__proto__:[]}instanceof Array,r="function"==typeof Symbol,f={},p={};f[d&&/Firefox\/2/i.test(d.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"],f.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" "),e(f,function(e,t){if(t.length)for(var n=0,a=t.length;n<a;n++)p[t[n]]=e});var m={propertychange:!0},_=c&&function(){for(var e=3,t=c.createElement("div"),n=t.getElementsByTagName("i");t.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e",n[0];);return 4<e?e:o}(),h=/\S+/g;return{ec:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],q:function(e,t){for(var n=0,a=e.length;n<a;n++)t(e[n],n)},o:function(e,t){if("function"==typeof Array.prototype.indexOf)return Array.prototype.indexOf.call(e,t);for(var n=0,a=e.length;n<a;n++)if(e[n]===t)return n;return-1},Tb:function(e,t,n){for(var a=0,i=e.length;a<i;a++)if(t.call(n,e[a],a))return e[a];return null},Ma:function(e,t){var n=S.a.o(e,t);0<n?e.splice(n,1):0===n&&e.shift()},Ub:function(e){for(var t=[],n=0,a=(e=e||[]).length;n<a;n++)0>S.a.o(t,e[n])&&t.push(e[n]);return t},fb:function(e,t){for(var n=[],a=0,i=(e=e||[]).length;a<i;a++)n.push(t(e[a],a));return n},La:function(e,t){for(var n=[],a=0,i=(e=e||[]).length;a<i;a++)t(e[a],a)&&n.push(e[a]);return n},ra:function(e,t){if(t instanceof Array)e.push.apply(e,t);else for(var n=0,a=t.length;n<a;n++)e.push(t[n]);return e},pa:function(e,t,n){var a=S.a.o(S.a.zb(e),t);0>a?n&&e.push(t):n||e.splice(a,1)},ka:i,extend:t,Ya:n,Za:i?n:t,D:e,Ca:function(e,t){if(!e)return e;var n,a={};for(n in e)e.hasOwnProperty(n)&&(a[n]=t(e[n],n,e));return a},ob:function(e){for(;e.firstChild;)S.removeNode(e.firstChild)},lc:function(e){for(var t=((e=S.a.W(e))[0]&&e[0].ownerDocument||c).createElement("div"),n=0,a=e.length;n<a;n++)t.appendChild(S.$(e[n]));return t},ua:function(e,t){for(var n=0,a=e.length,i=[];n<a;n++){var r=e[n].cloneNode(!0);i.push(t?S.$(r):r)}return i},da:function(e,t){if(S.a.ob(e),t)for(var n=0,a=t.length;n<a;n++)e.appendChild(t[n])},sc:function(e,t){var n=e.nodeType?[e]:e;if(0<n.length){for(var a=n[0],i=a.parentNode,r=0,o=t.length;r<o;r++)i.insertBefore(t[r],a);for(r=0,o=n.length;r<o;r++)S.removeNode(n[r])}},za:function(e,t){if(e.length){for(t=8===t.nodeType&&t.parentNode||t;e.length&&e[0].parentNode!==t;)e.splice(0,1);for(;1<e.length&&e[e.length-1].parentNode!==t;)e.length--;if(1<e.length){var n=e[0],a=e[e.length-1];for(e.length=0;n!==a;)e.push(n),n=n.nextSibling;e.push(a)}}return e},uc:function(e,t){7>_?e.setAttribute("selected",t):e.selected=t},ab:function(e){return null===e||e===o?"":e.trim?e.trim():e.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},od:function(e,t){return e=e||"",!(t.length>e.length)&&e.substring(0,t.length)===t},Nc:function(e,t){if(e===t)return!0;if(11===e.nodeType)return!1;if(t.contains)return t.contains(3===e.nodeType?e.parentNode:e);if(t.compareDocumentPosition)return 16==(16&t.compareDocumentPosition(e));for(;e&&e!=t;)e=e.parentNode;return!!e},nb:function(e){return S.a.Nc(e,e.ownerDocument.documentElement)},Rb:function(e){return!!S.a.Tb(e,S.a.nb)},A:function(e){return e&&e.tagName&&e.tagName.toLowerCase()},Xb:function(e){return S.onError?function(){try{return e.apply(this,arguments)}catch(e){throw S.onError&&S.onError(e),e}}:e},setTimeout:function(e,t){return setTimeout(S.a.Xb(e),t)},bc:function(e){setTimeout(function(){throw S.onError&&S.onError(e),e},0)},p:function(e,t,n){var a=S.a.Xb(n);if(n=_&&m[t],S.options.useOnlyNativeEvents||n||!l)if(n||"function"!=typeof e.addEventListener){if(void 0===e.attachEvent)throw Error("Browser doesn't support addEventListener or attachEvent");var i=function(t){a.call(e,t)},r="on"+t;e.attachEvent(r,i),S.a.F.oa(e,function(){e.detachEvent(r,i)})}else e.addEventListener(t,a,!1);else l(e).bind(t,a)},Da:function(e,t){if(!e||!e.nodeType)throw Error("element must be a DOM node when calling triggerEvent");var n;if(n=!("input"!==S.a.A(e)||!e.type||"click"!=t.toLowerCase()||"checkbox"!=(n=e.type)&&"radio"!=n),S.options.useOnlyNativeEvents||!l||n)if("function"==typeof c.createEvent){if("function"!=typeof e.dispatchEvent)throw Error("The supplied element doesn't support dispatchEvent");(n=c.createEvent(p[t]||"HTMLEvents")).initEvent(t,!0,!0,s,0,0,0,0,0,!1,!1,!1,!1,0,e),e.dispatchEvent(n)}else if(n&&e.click)e.click();else{if(void 0===e.fireEvent)throw Error("Browser doesn't support triggering events");e.fireEvent("on"+t)}else l(e).trigger(t)},c:function(e){return S.H(e)?e():e},zb:function(e){return S.H(e)?e.t():e},cb:function(e,t,n){var i;t&&("object"==typeof e.classList?(i=e.classList[n?"add":"remove"],S.a.q(t.match(h),function(t){i.call(e.classList,t)})):"string"==typeof e.className.baseVal?a(e.className,"baseVal",t,n):a(e,"className",t,n))},$a:function(e,t){var n=S.a.c(t);null!==n&&n!==o||(n="");var a=S.e.firstChild(e);!a||3!=a.nodeType||S.e.nextSibling(a)?S.e.da(e,[e.ownerDocument.createTextNode(n)]):a.data=n,S.a.Sc(e)},tc:function(e,t){if(e.name=t,7>=_)try{e.mergeAttributes(c.createElement("<input name='"+e.name+"'/>"),!1)}catch(e){}},Sc:function(e){9<=_&&(e=1==e.nodeType?e:e.parentNode).style&&(e.style.zoom=e.style.zoom)},Oc:function(e){if(_){var t=e.style.width;e.style.width=0,e.style.width=t}},jd:function(e,t){e=S.a.c(e),t=S.a.c(t);for(var n=[],a=e;a<=t;a++)n.push(a);return n},W:function(e){for(var t=[],n=0,a=e.length;n<a;n++)t.push(e[n]);return t},$b:function(e){return r?Symbol(e):e},sd:6===_,ud:7===_,C:_,gc:function(e,t){for(var n=S.a.W(e.getElementsByTagName("input")).concat(S.a.W(e.getElementsByTagName("textarea"))),a="string"==typeof t?function(e){return e.name===t}:function(e){return t.test(e.name)},i=[],r=n.length-1;0<=r;r--)a(n[r])&&i.push(n[r]);return i},fd:function(e){return"string"==typeof e&&(e=S.a.ab(e))?u&&u.parse?u.parse(e):new Function("return "+e)():null},Eb:function(e,t,n){if(!u||!u.stringify)throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return u.stringify(S.a.c(e),t,n)},gd:function(t,n,a){var i=(a=a||{}).params||{},r=a.includeFields||this.ec,o=t;if("object"==typeof t&&"form"===S.a.A(t)){o=t.action;for(var s=r.length-1;0<=s;s--)for(var d=S.a.gc(t,r[s]),l=d.length-1;0<=l;l--)i[d[l].name]=d[l].value}n=S.a.c(n);var u=c.createElement("form");for(var f in u.style.display="none",u.action=o,u.method="post",n)(t=c.createElement("input")).type="hidden",t.name=f,t.value=S.a.Eb(S.a.c(n[f])),u.appendChild(t);e(i,function(e,t){var n=c.createElement("input");n.type="hidden",n.name=e,n.value=t,u.appendChild(n)}),c.body.appendChild(u),a.submitter?a.submitter(u):u.submit(),setTimeout(function(){u.parentNode.removeChild(u)},0)}}}(),S.b("utils",S.a),S.b("utils.arrayForEach",S.a.q),S.b("utils.arrayFirst",S.a.Tb),S.b("utils.arrayFilter",S.a.La),S.b("utils.arrayGetDistinctValues",S.a.Ub),S.b("utils.arrayIndexOf",S.a.o),S.b("utils.arrayMap",S.a.fb),S.b("utils.arrayPushAll",S.a.ra),S.b("utils.arrayRemoveItem",S.a.Ma),S.b("utils.extend",S.a.extend),S.b("utils.fieldsIncludedWithJsonPost",S.a.ec),S.b("utils.getFormFields",S.a.gc),S.b("utils.peekObservable",S.a.zb),S.b("utils.postJson",S.a.gd),S.b("utils.parseJson",S.a.fd),S.b("utils.registerEventHandler",S.a.p),S.b("utils.stringifyJson",S.a.Eb),S.b("utils.range",S.a.jd),S.b("utils.toggleDomNodeCssClass",S.a.cb),S.b("utils.triggerEvent",S.a.Da),S.b("utils.unwrapObservable",S.a.c),S.b("utils.objectForEach",S.a.D),S.b("utils.addOrRemoveItem",S.a.pa),S.b("utils.setTextContent",S.a.$a),S.b("unwrap",S.a.c),Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if(1===arguments.length)return function(){return t.apply(e,arguments)};var n=Array.prototype.slice.call(arguments,1);return function(){var a=n.slice(0);return a.push.apply(a,arguments),t.apply(e,a)}}),S.a.f=new function(){function e(e,i){var r=e[n];if(!r||"null"===r||!a[r]){if(!i)return o;r=e[n]="ko"+t++,a[r]={}}return a[r]}var t=0,n="__ko__"+(new Date).getTime(),a={};return{get:function(t,n){var a=e(t,!1);return a===o?o:a[n]},set:function(t,n,a){a===o&&e(t,!1)===o||(e(t,!0)[n]=a)},clear:function(e){var t=e[n];return!!t&&(delete a[t],e[n]=null,!0)},I:function(){return t+++n}}},S.b("utils.domData",S.a.f),S.b("utils.domData.clear",S.a.f.clear),S.a.F=new function(){function e(e,t){var a=S.a.f.get(e,n);return a===o&&t&&(a=[],S.a.f.set(e,n,a)),a}function t(n){if(a=e(n,!1))for(var a=a.slice(0),r=0;r<a.length;r++)a[r](n);if(S.a.f.clear(n),S.a.F.cleanExternalData(n),i[n.nodeType])for(a=n.firstChild;n=a;)a=n.nextSibling,8===n.nodeType&&t(n)}var n=S.a.f.I(),a={1:!0,8:!0,9:!0},i={1:!0,9:!0};return{oa:function(t,n){if("function"!=typeof n)throw Error("Callback must be a function");e(t,!0).push(n)},rc:function(t,a){var i=e(t,!1);i&&(S.a.Ma(i,a),0==i.length&&S.a.f.set(t,n,o))},$:function(e){if(a[e.nodeType]&&(t(e),i[e.nodeType])){var n=[];S.a.ra(n,e.getElementsByTagName("*"));for(var r=0,o=n.length;r<o;r++)t(n[r])}return e},removeNode:function(e){S.$(e),e.parentNode&&e.parentNode.removeChild(e)},cleanExternalData:function(e){l&&"function"==typeof l.cleanData&&l.cleanData([e])}}},S.$=S.a.F.$,S.removeNode=S.a.F.removeNode,S.b("cleanNode",S.$),S.b("removeNode",S.removeNode),S.b("utils.domNodeDisposal",S.a.F),S.b("utils.domNodeDisposal.addDisposeCallback",S.a.F.oa),S.b("utils.domNodeDisposal.removeDisposeCallback",S.a.F.rc),_=[0,"",""],v={thead:h=[1,"<table>","</table>"],tbody:h,tfoot:h,tr:[2,"<table><tbody>","</tbody></table>"],td:b=[3,"<table><tbody><tr>","</tr></tbody></table>"],th:b,option:g=[1,"<select multiple='multiple'>","</select>"],optgroup:g},y=8>=S.a.C,S.a.ma=function(e,t){var n;if(l){if(l.parseHTML)n=l.parseHTML(e,t)||[];else if((n=l.clean([e],t))&&n[0]){for(var a=n[0];a.parentNode&&11!==a.parentNode.nodeType;)a=a.parentNode;a.parentNode&&a.parentNode.removeChild(a)}}else{(n=t)||(n=c),a=n.parentWindow||n.defaultView||s;var i,r=S.a.ab(e).toLowerCase(),o=n.createElement("div");for(i=(r=r.match(/^<([a-z]+)[ >]/))&&v[r[1]]||_,r=i[0],i="ignored<div>"+i[1]+e+i[2]+"</div>","function"==typeof a.innerShiv?o.appendChild(a.innerShiv(i)):(y&&n.appendChild(o),o.innerHTML=i,y&&o.parentNode.removeChild(o));r--;)o=o.lastChild;n=S.a.W(o.lastChild.childNodes)}return n},S.a.Cb=function(e,t){if(S.a.ob(e),null!==(t=S.a.c(t))&&t!==o)if("string"!=typeof t&&(t=t.toString()),l)l(e).html(t);else for(var n=S.a.ma(t,e.ownerDocument),a=0;a<n.length;a++)e.appendChild(n[a])},S.b("utils.parseHtmlFragment",S.a.ma),S.b("utils.setHtml",S.a.Cb),S.M=function(){function e(t,n){if(t)if(8==t.nodeType)null!=(a=S.M.nc(t.nodeValue))&&n.push({Mc:t,dd:a});else if(1==t.nodeType)for(var a=0,i=t.childNodes,r=i.length;a<r;a++)e(i[a],n)}var t={};return{wb:function(e){if("function"!=typeof e)throw Error("You can only pass a function to ko.memoization.memoize()");var n=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1);return t[n]=e,"\x3c!--[ko_memo:"+n+"]--\x3e"},zc:function(e,n){var a=t[e];if(a===o)throw Error("Couldn't find any memo with ID "+e+". Perhaps it's already been unmemoized.");try{return a.apply(null,n||[]),!0}finally{delete t[e]}},Ac:function(t,n){var a=[];e(t,a);for(var i=0,r=a.length;i<r;i++){var o=a[i].Mc,s=[o];n&&S.a.ra(s,n),S.M.zc(a[i].dd,s),o.nodeValue="",o.parentNode&&o.parentNode.removeChild(o)}},nc:function(e){return(e=e.match(/^\[ko_memo\:(.*?)\]$/))?e[1]:null}}}(),S.b("memoization",S.M),S.b("memoization.memoize",S.M.wb),S.b("memoization.unmemoize",S.M.zc),S.b("memoization.parseMemoText",S.M.nc),S.b("memoization.unmemoizeDomNodeAndDescendants",S.M.Ac),S.Z=function(){function e(){if(a)for(var e,t=a,i=0;r<a;)if(e=n[r++]){if(r>t){if(5e3<=++i){r=a,S.a.bc(Error("'Too much recursion' after processing "+i+" task groups."));break}t=a}try{e()}catch(e){S.a.bc(e)}}}function t(){e(),r=a=n.length=0}var n=[],a=0,i=1,r=0;return{scheduler:s.MutationObserver?function(e){var t=c.createElement("div");return new MutationObserver(e).observe(t,{attributes:!0}),function(){t.classList.toggle("foo")}}(t):c&&"onreadystatechange"in c.createElement("script")?function(e){var t=c.createElement("script");t.onreadystatechange=function(){t.onreadystatechange=null,c.documentElement.removeChild(t),t=null,e()},c.documentElement.appendChild(t)}:function(e){setTimeout(e,0)},Xa:function(e){return a||S.Z.scheduler(t),n[a++]=e,i++},cancel:function(e){(e-=i-a)>=r&&e<a&&(n[e]=null)},resetForTesting:function(){var e=a-r;return r=a=n.length=0,e},nd:e}}(),S.b("tasks",S.Z),S.b("tasks.schedule",S.Z.Xa),S.b("tasks.runEarly",S.Z.nd),S.ya={throttle:function(e,t){e.throttleEvaluation=t;var n=null;return S.B({read:e,write:function(a){clearTimeout(n),n=S.a.setTimeout(function(){e(a)},t)}})},rateLimit:function(e,t){var n,r,o;"number"==typeof t?n=t:(n=t.timeout,r=t.method),e.eb=!1,o="notifyWhenChangesStop"==r?i:a,e.Ua(function(e){return o(e,n)})},deferred:function(e,t){if(!0!==t)throw Error("The 'deferred' extender only accepts the value 'true', because it is not supported to turn deferral off once enabled.");e.eb||(e.eb=!0,e.Ua(function(t){var n;return function(){S.Z.cancel(n),n=S.Z.Xa(t),e.notifySubscribers(o,"dirty")}}))},notify:function(e,t){e.equalityComparer="always"==t?null:n}};var D={undefined:1,boolean:1,number:1,string:1};S.b("extenders",S.ya),S.xc=function(e,t,n){this.ia=e,this.gb=t,this.Lc=n,this.S=!1,S.G(this,"dispose",this.k)},S.xc.prototype.k=function(){this.S=!0,this.Lc()},S.J=function(){S.a.Za(this,x),x.rb(this)};var I="change",x={rb:function(e){e.K={},e.Ob=1},Y:function(e,t,n){var a=this;n=n||I;var i=new S.xc(a,t?e.bind(t):e,function(){S.a.Ma(a.K[n],i),a.Ia&&a.Ia(n)});return a.sa&&a.sa(n),a.K[n]||(a.K[n]=[]),a.K[n].push(i),i},notifySubscribers:function(e,t){if((t=t||I)===I&&this.Ib(),this.Qa(t))try{S.l.Vb();for(var n,a=this.K[t].slice(0),i=0;n=a[i];++i)n.S||n.gb(e)}finally{S.l.end()}},Oa:function(){return this.Ob},Vc:function(e){return this.Oa()!==e},Ib:function(){++this.Ob},Ua:function(e){var t,n,a,i=this,o=S.H(i);i.Ha||(i.Ha=i.notifySubscribers,i.notifySubscribers=r);var s=e(function(){i.Nb=!1,o&&a===i&&(a=i()),t=!1,i.tb(n,a)&&i.Ha(n=a)});i.Mb=function(e){i.Nb=t=!0,a=e,s()},i.Lb=function(e){t||(n=e,i.Ha(e,"beforeChange"))}},Qa:function(e){return this.K[e]&&this.K[e].length},Tc:function(e){if(e)return this.K[e]&&this.K[e].length||0;var t=0;return S.a.D(this.K,function(e,n){"dirty"!==e&&(t+=n.length)}),t},tb:function(e,t){return!this.equalityComparer||!this.equalityComparer(e,t)},extend:function(e){var t=this;return e&&S.a.D(e,function(e,n){var a=S.ya[e];"function"==typeof a&&(t=a(t,n)||t)}),t}};S.G(x,"subscribe",x.Y),S.G(x,"extend",x.extend),S.G(x,"getSubscriptionsCount",x.Tc),S.a.ka&&S.a.Ya(x,Function.prototype),S.J.fn=x,S.jc=function(e){return null!=e&&"function"==typeof e.Y&&"function"==typeof e.notifySubscribers},S.b("subscribable",S.J),S.b("isSubscribable",S.jc),S.va=S.l=function(){function e(e){a.push(n),n=e}function t(){n=a.pop()}var n,a=[],i=0;return{Vb:e,end:t,qc:function(e){if(n){if(!S.jc(e))throw Error("Only subscribable things can act as dependencies");n.gb.call(n.Hc,e,e.Dc||(e.Dc=++i))}},w:function(n,a,i){try{return e(),n.apply(a,i||[])}finally{t()}},Aa:function(){if(n)return n.m.Aa()},Ta:function(){if(n)return n.Ta}}}(),S.b("computedContext",S.va),S.b("computedContext.getDependenciesCount",S.va.Aa),S.b("computedContext.isInitial",S.va.Ta),S.b("ignoreDependencies",S.rd=S.l.w);var C=S.a.$b("_latestValue");S.N=function(e){function t(){return 0<arguments.length?(t.tb(t[C],arguments[0])&&(t.ga(),t[C]=arguments[0],t.fa()),this):(S.l.qc(t),t[C])}return t[C]=e,S.a.ka||S.a.extend(t,S.J.fn),S.J.fn.rb(t),S.a.Za(t,O),S.options.deferUpdates&&S.ya.deferred(t,!0),t};var O={equalityComparer:n,t:function(){return this[C]},fa:function(){this.notifySubscribers(this[C])},ga:function(){this.notifySubscribers(this[C],"beforeChange")}};S.a.ka&&S.a.Ya(O,S.J.fn);var w=S.N.hd="__ko_proto__";O[w]=S.N,S.Pa=function(e,t){return null!==e&&e!==o&&e[w]!==o&&(e[w]===t||S.Pa(e[w],t))},S.H=function(e){return S.Pa(e,S.N)},S.Ba=function(e){return!!("function"==typeof e&&e[w]===S.N||"function"==typeof e&&e[w]===S.B&&e.Wc)},S.b("observable",S.N),S.b("isObservable",S.H),S.b("isWriteableObservable",S.Ba),S.b("isWritableObservable",S.Ba),S.b("observable.fn",O),S.G(O,"peek",O.t),S.G(O,"valueHasMutated",O.fa),S.G(O,"valueWillMutate",O.ga),S.la=function(e){if("object"!=typeof(e=e||[])||!("length"in e))throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");return e=S.N(e),S.a.Za(e,S.la.fn),e.extend({trackArrayChanges:!0})},S.la.fn={remove:function(e){for(var t=this.t(),n=[],a="function"!=typeof e||S.H(e)?function(t){return t===e}:e,i=0;i<t.length;i++){var r=t[i];a(r)&&(0===n.length&&this.ga(),n.push(r),t.splice(i,1),i--)}return n.length&&this.fa(),n},removeAll:function(e){if(e===o){var t=this.t(),n=t.slice(0);return this.ga(),t.splice(0,t.length),this.fa(),n}return e?this.remove(function(t){return 0<=S.a.o(e,t)}):[]},destroy:function(e){var t=this.t(),n="function"!=typeof e||S.H(e)?function(t){return t===e}:e;this.ga();for(var a=t.length-1;0<=a;a--)n(t[a])&&(t[a]._destroy=!0);this.fa()},destroyAll:function(e){return e===o?this.destroy(function(){return!0}):e?this.destroy(function(t){return 0<=S.a.o(e,t)}):[]},indexOf:function(e){var t=this();return S.a.o(t,e)},replace:function(e,t){var n=this.indexOf(e);0<=n&&(this.ga(),this.t()[n]=t,this.fa())}},S.a.ka&&S.a.Ya(S.la.fn,S.N.fn),S.a.q("pop push reverse shift sort splice unshift".split(" "),function(e){S.la.fn[e]=function(){var t=this.t();this.ga(),this.Wb(t,e,arguments);var n=t[e].apply(t,arguments);return this.fa(),n===t?this:n}}),S.a.q(["slice"],function(e){S.la.fn[e]=function(){var t=this();return t[e].apply(t,arguments)}}),S.b("observableArray",S.la),S.ya.trackArrayChanges=function(e,t){function n(){if(!r){r=!0,i=e.notifySubscribers,e.notifySubscribers=function(e,t){return t&&t!==I||++c,i.apply(this,arguments)};var t=[].concat(e.t()||[]);s=null,a=e.Y(function(n){var a;n=[].concat(n||[]),e.Qa("arrayChange")&&((!s||1<c)&&(s=S.a.ib(t,n,e.hb)),a=s),t=n,s=null,c=0,a&&a.length&&e.notifySubscribers(a,"arrayChange")})}}if(e.hb={},t&&"object"==typeof t&&S.a.extend(e.hb,t),e.hb.sparse=!0,!e.Wb){var a,i,r=!1,s=null,c=0,d=e.sa,l=e.Ia;e.sa=function(t){d&&d.call(e,t),"arrayChange"===t&&n()},e.Ia=function(t){l&&l.call(e,t),"arrayChange"!==t||e.Qa("arrayChange")||(i&&(e.notifySubscribers=i,i=o),a.k(),r=!1)},e.Wb=function(e,t,n){function a(e,t,n){return i[i.length]={status:e,value:t,index:n}}if(r&&!c){var i=[],o=e.length,d=n.length,l=0;switch(t){case"push":l=o;case"unshift":for(t=0;t<d;t++)a("added",n[t],l+t);break;case"pop":l=o-1;case"shift":o&&a("deleted",e[l],l);break;case"splice":t=Math.min(Math.max(0,0>n[0]?o+n[0]:n[0]),o),o=1===d?o:Math.min(t+(n[1]||0),o),d=t+d-2,l=Math.max(o,d);for(var u=[],f=[],p=2;t<l;++t,++p)t<o&&f.push(a("deleted",e[t],t)),t<d&&u.push(a("added",n[p],t));S.a.fc(f,u);break;default:return}s=i}}}};var E=S.a.$b("_state");S.m=S.B=function(e,t,n){function a(){if(0<arguments.length){if("function"!=typeof i)throw Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return i.apply(r.pb,arguments),this}return S.l.qc(a),(r.T||r.s&&a.Ra())&&a.aa(),r.U}if("object"==typeof e?n=e:(n=n||{},e&&(n.read=e)),"function"!=typeof n.read)throw Error("Pass a function that returns the value of the ko.computed");var i=n.write,r={U:o,T:!0,Sa:!1,Fb:!1,S:!1,Wa:!1,s:!1,kd:n.read,pb:t||n.owner,i:n.disposeWhenNodeIsRemoved||n.i||null,wa:n.disposeWhen||n.wa,mb:null,r:{},L:0,dc:null};return a[E]=r,a.Wc="function"==typeof i,S.a.ka||S.a.extend(a,S.J.fn),S.J.fn.rb(a),S.a.Za(a,A),n.pure?(r.Wa=!0,r.s=!0,S.a.extend(a,L)):n.deferEvaluation&&S.a.extend(a,k),S.options.deferUpdates&&S.ya.deferred(a,!0),r.i&&(r.Fb=!0,r.i.nodeType||(r.i=null)),r.s||n.deferEvaluation||a.aa(),r.i&&a.ba()&&S.a.F.oa(r.i,r.mb=function(){a.k()}),a};var A={equalityComparer:n,Aa:function(){return this[E].L},Qb:function(e,t,n){if(this[E].Wa&&t===this)throw Error("A 'pure' computed must not be called recursively");this[E].r[e]=n,n.Ga=this[E].L++,n.na=t.Oa()},Ra:function(){var e,t,n=this[E].r;for(e in n)if(n.hasOwnProperty(e)&&(t=n[e]).ia.Vc(t.na))return!0},cd:function(){this.Fa&&!this[E].Sa&&this.Fa()},ba:function(){return this[E].T||0<this[E].L},md:function(){this.Nb||this.cc()},wc:function(e){if(e.eb&&!this[E].i){var t=e.Y(this.cd,this,"dirty"),n=e.Y(this.md,this);return{ia:e,k:function(){t.k(),n.k()}}}return e.Y(this.cc,this)},cc:function(){var e=this,t=e.throttleEvaluation;t&&0<=t?(clearTimeout(this[E].dc),this[E].dc=S.a.setTimeout(function(){e.aa(!0)},t)):e.Fa?e.Fa():e.aa(!0)},aa:function(e){var t=this[E],n=t.wa;if(!t.Sa&&!t.S){if(t.i&&!S.a.nb(t.i)||n&&n()){if(!t.Fb)return void this.k()}else t.Fb=!1;t.Sa=!0;try{this.Rc(e)}finally{t.Sa=!1}t.L||this.k()}},Rc:function(e){var t=this[E],n=t.Wa?o:!t.L,a={Ic:this,Na:t.r,lb:t.L};S.l.Vb({Hc:a,gb:p,m:this,Ta:n}),t.r={},t.L=0,a=this.Qc(t,a),this.tb(t.U,a)&&(t.s||this.notifySubscribers(t.U,"beforeChange"),t.U=a,t.s?this.Ib():e&&this.notifySubscribers(t.U)),n&&this.notifySubscribers(t.U,"awake")},Qc:function(e,t){try{var n=e.kd;return e.pb?n.call(e.pb):n()}finally{S.l.end(),t.lb&&!e.s&&S.a.D(t.Na,f),e.T=!1}},t:function(){var e=this[E];return(e.T&&!e.L||e.s&&this.Ra())&&this.aa(),e.U},Ua:function(e){S.J.fn.Ua.call(this,e),this.Fa=function(){this.Lb(this[E].U),this[E].T=!0,this.Mb(this)}},k:function(){var e=this[E];!e.s&&e.r&&S.a.D(e.r,function(e,t){t.k&&t.k()}),e.i&&e.mb&&S.a.F.rc(e.i,e.mb),e.r=null,e.L=0,e.S=!0,e.T=!1,e.s=!1,e.i=null}},L={sa:function(e){var t=this,n=t[E];if(!n.S&&n.s&&"change"==e){if(n.s=!1,n.T||t.Ra())n.r=null,n.L=0,n.T=!0,t.aa(),t.Ib();else{var a=[];S.a.D(n.r,function(e,t){a[t.Ga]=e}),S.a.q(a,function(e,a){var i=n.r[e],r=t.wc(i.ia);r.Ga=a,r.na=i.na,n.r[e]=r})}n.S||t.notifySubscribers(n.U,"awake")}},Ia:function(e){var t=this[E];t.S||"change"!=e||this.Qa("change")||(S.a.D(t.r,function(e,n){n.k&&(t.r[e]={ia:n.ia,Ga:n.Ga,na:n.na},n.k())}),t.s=!0,this.notifySubscribers(o,"asleep"))},Oa:function(){var e=this[E];return e.s&&(e.T||this.Ra())&&this.aa(),S.J.fn.Oa.call(this)}},k={sa:function(e){"change"!=e&&"beforeChange"!=e||this.t()}};S.a.ka&&S.a.Ya(A,S.J.fn);var M=S.N.hd;S.m[M]=S.N,A[M]=S.m,S.Yc=function(e){return S.Pa(e,S.m)},S.Zc=function(e){return S.Pa(e,S.m)&&e[E]&&e[E].Wa},S.b("computed",S.m),S.b("dependentObservable",S.m),S.b("isComputed",S.Yc),S.b("isPureComputed",S.Zc),S.b("computed.fn",A),S.G(A,"peek",A.t),S.G(A,"dispose",A.k),S.G(A,"isActive",A.ba),S.G(A,"getDependenciesCount",A.Aa),S.pc=function(e,t){return"function"==typeof e?S.m(e,t,{pure:!0}):((e=S.a.extend({},e)).pure=!0,S.m(e,t))},S.b("pureComputed",S.pc),function(){function e(n,a,i){if(i=i||new t,"object"!=typeof(n=a(n))||null===n||n===o||n instanceof RegExp||n instanceof Date||n instanceof String||n instanceof Number||n instanceof Boolean)return n;var r=n instanceof Array?[]:{};return i.save(n,r),function(e,t){if(e instanceof Array){for(var n=0;n<e.length;n++)t(n);"function"==typeof e.toJSON&&t("toJSON")}else for(n in e)t(n)}(n,function(t){var s=a(n[t]);switch(typeof s){case"boolean":case"number":case"string":case"function":r[t]=s;break;case"object":case"undefined":var c=i.get(s);r[t]=c!==o?c:e(s,a,i)}}),r}function t(){this.keys=[],this.Jb=[]}S.yc=function(t){if(0==arguments.length)throw Error("When calling ko.toJS, pass the object you want to convert.");return e(t,function(e){for(var t=0;S.H(e)&&10>t;t++)e=e();return e})},S.toJSON=function(e,t,n){return e=S.yc(e),S.a.Eb(e,t,n)},t.prototype={save:function(e,t){var n=S.a.o(this.keys,e);0<=n?this.Jb[n]=t:(this.keys.push(e),this.Jb.push(t))},get:function(e){return 0<=(e=S.a.o(this.keys,e))?this.Jb[e]:o}}}(),S.b("toJS",S.yc),S.b("toJSON",S.toJSON),S.j={u:function(e){switch(S.a.A(e)){case"option":return!0===e.__ko__hasDomDataOptionValue__?S.a.f.get(e,S.d.options.xb):7>=S.a.C?e.getAttributeNode("value")&&e.getAttributeNode("value").specified?e.value:e.text:e.value;case"select":return 0<=e.selectedIndex?S.j.u(e.options[e.selectedIndex]):o;default:return e.value}},ha:function(e,t,n){switch(S.a.A(e)){case"option":"string"==typeof t?(S.a.f.set(e,S.d.options.xb,o),"__ko__hasDomDataOptionValue__"in e&&delete e.__ko__hasDomDataOptionValue__,e.value=t):(S.a.f.set(e,S.d.options.xb,t),e.__ko__hasDomDataOptionValue__=!0,e.value="number"==typeof t?t:"");break;case"select":""!==t&&null!==t||(t=o);for(var a,i=-1,r=0,s=e.options.length;r<s;++r)if((a=S.j.u(e.options[r]))==t||""==a&&t===o){i=r;break}(n||0<=i||t===o&&1<e.size)&&(e.selectedIndex=i);break;default:null!==t&&t!==o||(t=""),e.value=t}}},S.b("selectExtensions",S.j),S.b("selectExtensions.readValue",S.j.u),S.b("selectExtensions.writeValue",S.j.ha),S.h=function(){function e(e){123===(e=S.a.ab(e)).charCodeAt(0)&&(e=e.slice(1,-1));var t,n=[],o=e.match(a),s=[],c=0;if(o){o.push(",");for(var d,l=0;d=o[l];++l){var u=d.charCodeAt(0);if(44===u){if(0>=c){n.push(t&&s.length?{key:t,value:s.join("")}:{unknown:t||s.join("")}),t=c=0,s=[];continue}}else if(58===u){if(!c&&!t&&1===s.length){t=s.pop();continue}}else 47===u&&l&&1<d.length?(u=o[l-1].match(i))&&!r[u[0]]&&((o=(e=e.substr(e.indexOf(d)+1)).match(a)).push(","),l=-1,d="/"):40===u||123===u||91===u?++c:41===u||125===u||93===u?--c:t||s.length||34!==u&&39!==u||(d=d.slice(1,-1));s.push(d)}}return n}var t=["true","false","null","undefined"],n=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,a=RegExp("\"(?:[^\"\\\\]|\\\\.)*\"|'(?:[^'\\\\]|\\\\.)*'|/(?:[^/\\\\]|\\\\.)*/w*|[^\\s:,/][^,\"'{}()/:[\\]]*[^\\s,\"'{}()/:[\\]]|[^\\s]","g"),i=/[\])"'A-Za-z0-9_$]+$/,r={in:1,return:1,typeof:1},o={};return{ta:[],ea:o,yb:e,Va:function(a,i){function r(e,a){var i;if(!l){var u=S.getBindingHandler(e);if(u&&u.preprocess&&!(a=u.preprocess(a,e,r)))return;(u=o[e])&&(i=a,0<=S.a.o(t,i)?i=!1:(u=i.match(n),i=null!==u&&(u[1]?"Object("+u[1]+")"+u[2]:i)),u=i),u&&c.push("'"+e+"':function(_z){"+i+"=_z}")}d&&(a="function(){return "+a+" }"),s.push("'"+e+"':"+a)}var s=[],c=[],d=(i=i||{}).valueAccessors,l=i.bindingParams,u="string"==typeof a?e(a):a;return S.a.q(u,function(e){r(e.key||e.unknown,e.value)}),c.length&&r("_ko_property_writers","{"+c.join(",")+" }"),s.join(",")},bd:function(e,t){for(var n=0;n<e.length;n++)if(e[n].key==t)return!0;return!1},Ea:function(e,t,n,a,i){e&&S.H(e)?!S.Ba(e)||i&&e.t()===a||e(a):(e=t.get("_ko_property_writers"))&&e[n]&&e[n](a)}}}(),S.b("expressionRewriting",S.h),S.b("expressionRewriting.bindingRewriteValidators",S.h.ta),S.b("expressionRewriting.parseObjectLiteral",S.h.yb),S.b("expressionRewriting.preProcessBindings",S.h.Va),S.b("expressionRewriting._twoWayBindings",S.h.ea),S.b("jsonExpressionRewriting",S.h),S.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",S.h.Va),function(){function e(e){return 8==e.nodeType&&r.test(i?e.text:e.nodeValue)}function t(e){return 8==e.nodeType&&o.test(i?e.text:e.nodeValue)}function n(n,a){for(var i=n,r=1,o=[];i=i.nextSibling;){if(t(i)&&0==--r)return o;o.push(i),e(i)&&r++}if(!a)throw Error("Cannot find closing comment tag to match: "+n.nodeValue);return null}function a(e,t){var a=n(e,t);return a?0<a.length?a[a.length-1].nextSibling:e.nextSibling:null}var i=c&&"\x3c!--test--\x3e"===c.createComment("test").text,r=i?/^\x3c!--\s*ko(?:\s+([\s\S]+))?\s*--\x3e$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,o=i?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,s={ul:!0,ol:!0};S.e={V:{},childNodes:function(t){return e(t)?n(t):t.childNodes},xa:function(t){if(e(t))for(var n=0,a=(t=S.e.childNodes(t)).length;n<a;n++)S.removeNode(t[n]);else S.a.ob(t)},da:function(t,n){if(e(t)){S.e.xa(t);for(var a=t.nextSibling,i=0,r=n.length;i<r;i++)a.parentNode.insertBefore(n[i],a)}else S.a.da(t,n)},oc:function(t,n){e(t)?t.parentNode.insertBefore(n,t.nextSibling):t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n)},ic:function(t,n,a){a?e(t)?t.parentNode.insertBefore(n,a.nextSibling):a.nextSibling?t.insertBefore(n,a.nextSibling):t.appendChild(n):S.e.oc(t,n)},firstChild:function(n){return e(n)?!n.nextSibling||t(n.nextSibling)?null:n.nextSibling:n.firstChild},nextSibling:function(n){return e(n)&&(n=a(n)),n.nextSibling&&t(n.nextSibling)?null:n.nextSibling},Uc:e,qd:function(e){return(e=(i?e.text:e.nodeValue).match(r))?e[1]:null},mc:function(n){if(s[S.a.A(n)]){var i=n.firstChild;if(i)do{if(1===i.nodeType){var r,o=null;if(r=i.firstChild)do{if(o)o.push(r);else if(e(r)){var c=a(r,!0);c?r=c:o=[r]}else t(r)&&(o=[r])}while(r=r.nextSibling);if(r=o)for(o=i.nextSibling,c=0;c<r.length;c++)o?n.insertBefore(r[c],o):n.appendChild(r[c])}}while(i=i.nextSibling)}}}}(),S.b("virtualElements",S.e),S.b("virtualElements.allowedBindings",S.e.V),S.b("virtualElements.emptyNode",S.e.xa),S.b("virtualElements.insertAfter",S.e.ic),S.b("virtualElements.prepend",S.e.oc),S.b("virtualElements.setDomNodeChildren",S.e.da),S.R=function(){this.Gc={}},S.a.extend(S.R.prototype,{nodeHasBindings:function(e){switch(e.nodeType){case 1:return null!=e.getAttribute("data-bind")||S.g.getComponentNameForNode(e);case 8:return S.e.Uc(e);default:return!1}},getBindings:function(e,t){var n=(n=this.getBindingsString(e,t))?this.parseBindingsString(n,t,e):null;return S.g.Pb(n,e,t,!1)},getBindingAccessors:function(e,t){var n=(n=this.getBindingsString(e,t))?this.parseBindingsString(n,t,e,{valueAccessors:!0}):null;return S.g.Pb(n,e,t,!0)},getBindingsString:function(e){switch(e.nodeType){case 1:return e.getAttribute("data-bind");case 8:return S.e.qd(e);default:return null}},parseBindingsString:function(e,t,n,a){try{var i,r=this.Gc,o=e+(a&&a.valueAccessors||"");if(!(i=r[o])){var s,c="with($context){with($data||{}){return{"+S.h.Va(e,a)+"}}}";s=new Function("$context","$element",c),i=r[o]=s}return i(t,n)}catch(t){throw t.message="Unable to parse bindings.\nBindings value: "+e+"\nMessage: "+t.message,t}}}),S.R.instance=new S.R,S.b("bindingProvider",S.R),function(){function e(e){return function(){return e}}function t(e){return e()}function n(e){return S.a.Ca(S.l.w(e),function(t,n){return function(){return e()[n]}})}function a(t,a,i){return"function"==typeof t?n(t.bind(null,a,i)):S.a.Ca(t,e)}function i(e,t){return n(this.getBindings.bind(this,e,t))}function r(e,t,n){var a,i=S.e.firstChild(t),r=S.R.instance,o=r.preprocessNode;if(o){for(;a=i;)i=S.e.nextSibling(a),o.call(r,a);i=S.e.firstChild(t)}for(;a=i;)i=S.e.nextSibling(a),c(e,a,n)}function c(e,t,n){var a=!0,i=1===t.nodeType;i&&S.e.mc(t),(i&&n||S.R.instance.nodeHasBindings(t))&&(a=d(t,null,e,n).shouldBindDescendants),a&&!f[S.a.A(t)]&&r(e,t,!i)}function d(e,n,a,r){var s,c,d=S.a.f.get(e,p);if(!n){if(d)throw Error("You cannot apply bindings multiple times to the same element.");S.a.f.set(e,p,!0)}if(!d&&r&&S.vc(e,a),n&&"function"!=typeof n)s=n;else{var l=S.R.instance,u=l.getBindingAccessors||i,f=S.B(function(){return(s=n?n(a,e):u.call(l,e,a))&&a.P&&a.P(),s},null,{i:e});s&&f.ba()||(f=null)}if(s){var m=f?function(e){return function(){return t(f()[e])}}:function(e){return s[e]},_=function(){return S.a.Ca(f?f():s,t)};_.get=function(e){return s[e]&&t(m(e))},_.has=function(e){return e in s},r=function(e){var t=[],n={},a=[];return S.a.D(e,function i(r){if(!n[r]){var o=S.getBindingHandler(r);o&&(o.after&&(a.push(r),S.a.q(o.after,function(t){if(e[t]){if(-1!==S.a.o(a,t))throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+a.join(", "));i(t)}}),a.length--),t.push({key:r,hc:o})),n[r]=!0}}),t}(s),S.a.q(r,function(t){var n=t.hc.init,i=t.hc.update,r=t.key;if(8===e.nodeType&&!S.e.V[r])throw Error("The binding '"+r+"' cannot be used with virtual elements");try{"function"==typeof n&&S.l.w(function(){var t=n(e,m(r),_,a.$data,a);if(t&&t.controlsDescendantBindings){if(c!==o)throw Error("Multiple bindings ("+c+" and "+r+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");c=r}}),"function"==typeof i&&S.B(function(){i(e,m(r),_,a.$data,a)},null,{i:e})}catch(e){throw e.message='Unable to process binding "'+r+": "+s[r]+'"\nMessage: '+e.message,e}})}return{shouldBindDescendants:c===o}}function u(e){return e&&e instanceof S.Q?e:new S.Q(e)}S.d={};var f={script:!0,textarea:!0,template:!0};S.getBindingHandler=function(e){return S.d[e]},S.Q=function(e,t,n,a,i){function r(){var i=l?e():e,r=S.a.c(i);return t?(t.P&&t.P(),S.a.extend(d,t),d.P=c):(d.$parents=[],d.$root=r,d.ko=S),d.$rawData=i,d.$data=r,n&&(d[n]=r),a&&a(d,t,r),d.$data}var s,c,d=this,l="function"==typeof e&&!S.H(e);i&&i.exportDependencies?r():(c=S.B(r,null,{wa:function(){return s&&!S.a.Rb(s)},i:!0})).ba()&&(d.P=c,c.equalityComparer=null,s=[],c.Bc=function(e){s.push(e),S.a.F.oa(e,function(e){S.a.Ma(s,e),s.length||(c.k(),d.P=c=o)})})},S.Q.prototype.createChildContext=function(e,t,n,a){return new S.Q(e,this,t,function(e,t){e.$parentContext=t,e.$parent=t.$data,e.$parents=(t.$parents||[]).slice(0),e.$parents.unshift(e.$parent),n&&n(e)},a)},S.Q.prototype.extend=function(e){return new S.Q(this.P||this.$data,this,null,function(t,n){t.$rawData=n.$rawData,S.a.extend(t,"function"==typeof e?e():e)})},S.Q.prototype.Zb=function(e,t){return this.createChildContext(e,t,null,{exportDependencies:!0})};var p=S.a.f.I(),m=S.a.f.I();S.vc=function(e,t){if(2!=arguments.length)return S.a.f.get(e,m);S.a.f.set(e,m,t),t.P&&t.P.Bc(e)},S.Ja=function(e,t,n){return 1===e.nodeType&&S.e.mc(e),d(e,t,u(n),!0)},S.Ec=function(e,t,n){return n=u(n),S.Ja(e,a(t,n,e),n)},S.Ka=function(e,t){1!==t.nodeType&&8!==t.nodeType||r(u(e),t,!0)},S.Sb=function(e,t){if(!l&&s.jQuery&&(l=s.jQuery),t&&1!==t.nodeType&&8!==t.nodeType)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");t=t||s.document.body,c(u(e),t,!0)},S.kb=function(e){switch(e.nodeType){case 1:case 8:var t=S.vc(e);if(t)return t;if(e.parentNode)return S.kb(e.parentNode)}return o},S.Kc=function(e){return(e=S.kb(e))?e.$data:o},S.b("bindingHandlers",S.d),S.b("applyBindings",S.Sb),S.b("applyBindingsToDescendants",S.Ka),S.b("applyBindingAccessorsToNode",S.Ja),S.b("applyBindingsToNode",S.Ec),S.b("contextFor",S.kb),S.b("dataFor",S.Kc)}(),function(e){function t(t,a){var o,s=i.hasOwnProperty(t)?i[t]:e;s?s.Y(a):((s=i[t]=new S.J).Y(a),n(t,function(e,n){var a=!(!n||!n.synchronous);r[t]={definition:e,$c:a},delete i[t],o||a?s.notifySubscribers(e):S.Z.Xa(function(){s.notifySubscribers(e)})}),o=!0)}function n(e,t){a("getConfig",[e],function(n){n?a("loadComponent",[e,n],function(e){t(e,n)}):t(null,null)})}function a(t,n,i,r){r||(r=S.g.loaders.slice(0));var o=r.shift();if(o){var s=o[t];if(s){var c=!1;if(s.apply(o,n.concat(function(e){c?i(null):null!==e?i(e):a(t,n,i,r)}))!==e&&(c=!0,!o.suppressLoaderExceptions))throw Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.")}else a(t,n,i,r)}else i(null)}var i={},r={};S.g={get:function(n,a){var i=r.hasOwnProperty(n)?r[n]:e;i?i.$c?S.l.w(function(){a(i.definition)}):S.Z.Xa(function(){a(i.definition)}):t(n,a)},Yb:function(e){delete r[e]},Kb:a},S.g.loaders=[],S.b("components",S.g),S.b("components.get",S.g.get),S.b("components.clearCachedDefinition",S.g.Yb)}(),function(){function e(e,t,n,a){function i(){0==--s&&a(o)}var o={},s=2,c=n.template;n=n.viewModel,c?r(t,c,function(t){S.g.Kb("loadTemplate",[e,t],function(e){o.template=e,i()})}):i(),n?r(t,n,function(t){S.g.Kb("loadViewModel",[e,t],function(e){o[l]=e,i()})}):i()}function n(e,t,a){if("function"==typeof t)a(function(e){return new t(e)});else if("function"==typeof t[l])a(t[l]);else if("instance"in t){var i=t.instance;a(function(){return i})}else"viewModel"in t?n(e,t.viewModel,a):e("Unknown viewModel value: "+t)}function a(e){switch(S.a.A(e)){case"script":return S.a.ma(e.text);case"textarea":return S.a.ma(e.value);case"template":if(i(e.content))return S.a.ua(e.content.childNodes)}return S.a.ua(e.childNodes)}function i(e){return s.DocumentFragment?e instanceof DocumentFragment:e&&11===e.nodeType}function r(e,n,a){"string"==typeof n.require?t||s.require?(t||s.require)([n.require],a):e("Uses require, but no AMD loader is present"):a(n)}function o(e){return function(t){throw Error("Component '"+e+"': "+t)}}var d={};S.g.register=function(e,t){if(!t)throw Error("Invalid configuration for "+e);if(S.g.ub(e))throw Error("Component "+e+" is already registered");d[e]=t},S.g.ub=function(e){return d.hasOwnProperty(e)},S.g.pd=function(e){delete d[e],S.g.Yb(e)},S.g.ac={getConfig:function(e,t){t(d.hasOwnProperty(e)?d[e]:null)},loadComponent:function(t,n,a){var i=o(t);r(i,n,function(n){e(t,i,n,a)})},loadTemplate:function(e,t,n){if(e=o(e),"string"==typeof t)n(S.a.ma(t));else if(t instanceof Array)n(t);else if(i(t))n(S.a.W(t.childNodes));else if(t.element)if(t=t.element,s.HTMLElement?t instanceof HTMLElement:t&&t.tagName&&1===t.nodeType)n(a(t));else if("string"==typeof t){var r=c.getElementById(t);r?n(a(r)):e("Cannot find element with ID "+t)}else e("Unknown element type: "+t);else e("Unknown template value: "+t)},loadViewModel:function(e,t,a){n(o(e),t,a)}};var l="createViewModel";S.b("components.register",S.g.register),S.b("components.isRegistered",S.g.ub),S.b("components.unregister",S.g.pd),S.b("components.defaultLoader",S.g.ac),S.g.loaders.push(S.g.ac),S.g.Cc=d}(),function(){function e(e,n){if(a=e.getAttribute("params")){var a=t.parseBindingsString(a,n,e,{valueAccessors:!0,bindingParams:!0}),i=(a=S.a.Ca(a,function(t){return S.m(t,null,{i:e})}),S.a.Ca(a,function(t){var n=t.t();return t.ba()?S.m({read:function(){return S.a.c(t())},write:S.Ba(n)&&function(e){t()(e)},i:e}):n}));return i.hasOwnProperty("$raw")||(i.$raw=a),i}return{$raw:{}}}S.g.getComponentNameForNode=function(e){var t=S.a.A(e);if(S.g.ub(t)&&(-1!=t.indexOf("-")||"[object HTMLUnknownElement]"==""+e||8>=S.a.C&&e.tagName===t))return t},S.g.Pb=function(t,n,a,i){if(1===n.nodeType){var r=S.g.getComponentNameForNode(n);if(r){if((t=t||{}).component)throw Error('Cannot use the "component" binding on a custom element matching a component');var o={name:r,params:e(n,a)};t.component=i?function(){return o}:o}}return t};var t=new S.R;9>S.a.C&&(S.g.register=function(e){return function(t){return c.createElement(t),e.apply(this,arguments)}}(S.g.register),c.createDocumentFragment=function(e){return function(){var t,n=e(),a=S.g.Cc;for(t in a)a.hasOwnProperty(t)&&n.createElement(t);return n}}(c.createDocumentFragment))}(),function(e){var t=0;S.d.component={init:function(e,n,a,i,r){function o(){var e=s&&s.dispose;"function"==typeof e&&e.call(s),c=s=null}var s,c,d=S.a.W(S.e.childNodes(e));return S.a.F.oa(e,o),S.m(function(){var a,i,l=S.a.c(n());if("string"==typeof l?a=l:(a=S.a.c(l.name),i=S.a.c(l.params)),!a)throw Error("No component name specified");var u=c=++t;S.g.get(a,function(t){if(c===u){if(o(),!t)throw Error("Unknown component '"+a+"'");!function(e,t,n){if(!(t=t.template))throw Error("Component '"+e+"' has no template");e=S.a.ua(t),S.e.da(n,e)}(a,t,e);var n=function(e,t,n,a){var i=e.createViewModel;return i?i.call(e,a,{element:t,templateNodes:n}):a}(t,e,d,i);t=r.createChildContext(n,void 0,function(e){e.$component=n,e.$componentTemplateNodes=d}),s=n,S.Ka(t,e)}})},null,{i:e}),{controlsDescendantBindings:!0}}},S.e.V.component=!0}();var P={class:"className",for:"htmlFor"};S.d.attr={update:function(e,t){var n=S.a.c(t())||{};S.a.D(n,function(t,n){var a=!1===(n=S.a.c(n))||null===n||n===o;a&&e.removeAttribute(t),8>=S.a.C&&t in P?(t=P[t],a?e.removeAttribute(t):e[t]=n):a||e.setAttribute(t,n.toString()),"name"===t&&S.a.tc(e,a?"":n.toString())})}},S.d.checked={after:["value","attr"],init:function(e,t,n){function a(){var a=e.checked,r=f?i():a;if(!S.va.Ta()&&(!s||a)){var o=S.l.w(t);if(d){var c=l?o.t():o;u!==r?(a&&(S.a.pa(c,r,!0),S.a.pa(c,u,!1)),u=r):S.a.pa(c,r,a),l&&S.Ba(o)&&o(c)}else S.h.Ea(o,n,"checked",r,!0)}}var i=S.pc(function(){return n.has("checkedValue")?S.a.c(n.get("checkedValue")):n.has("value")?S.a.c(n.get("value")):e.value}),r="checkbox"==e.type,s="radio"==e.type;if(r||s){var c=t(),d=r&&S.a.c(c)instanceof Array,l=!(d&&c.push&&c.splice),u=d?i():o,f=s||d;s&&!e.name&&S.d.uniqueName.init(e,function(){return!0}),S.m(a,null,{i:e}),S.a.p(e,"click",a),S.m(function(){var n=S.a.c(t());e.checked=d?0<=S.a.o(n,i()):r?n:i()===n},null,{i:e}),c=o}}},S.h.ea.checked=!0,S.d.checkedValue={update:function(e,t){e.value=S.a.c(t())}},S.d.class={update:function(e,t){var n=S.a.ab(S.a.c(t()));S.a.cb(e,e.__ko__cssValue,!1),e.__ko__cssValue=n,S.a.cb(e,n,!0)}},S.d.css={update:function(e,t){var n=S.a.c(t());null!==n&&"object"==typeof n?S.a.D(n,function(t,n){n=S.a.c(n),S.a.cb(e,t,n)}):S.d.class.update(e,t)}},S.d.enable={update:function(e,t){var n=S.a.c(t());n&&e.disabled?e.removeAttribute("disabled"):n||e.disabled||(e.disabled=!0)}},S.d.disable={update:function(e,t){S.d.enable.update(e,function(){return!S.a.c(t())})}},S.d.event={init:function(e,t,n,a,i){var r=t()||{};S.a.D(r,function(r){"string"==typeof r&&S.a.p(e,r,function(e){var o,s=t()[r];if(s){try{var c=S.a.W(arguments);a=i.$data,c.unshift(a),o=s.apply(a,c)}finally{!0!==o&&(e.preventDefault?e.preventDefault():e.returnValue=!1)}!1===n.get(r+"Bubble")&&(e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation())}})})}},S.d.foreach={kc:function(e){return function(){var t=e(),n=S.a.zb(t);return n&&"number"!=typeof n.length?(S.a.c(t),{foreach:n.data,as:n.as,includeDestroyed:n.includeDestroyed,afterAdd:n.afterAdd,beforeRemove:n.beforeRemove,afterRender:n.afterRender,beforeMove:n.beforeMove,afterMove:n.afterMove,templateEngine:S.X.sb}):{foreach:t,templateEngine:S.X.sb}}},init:function(e,t){return S.d.template.init(e,S.d.foreach.kc(t))},update:function(e,t,n,a,i){return S.d.template.update(e,S.d.foreach.kc(t),n,a,i)}},S.h.ta.foreach=!1,S.e.V.foreach=!0,S.d.hasfocus={init:function(e,t,n){function a(a){e.__ko_hasfocusUpdating=!0;var i=e.ownerDocument;if("activeElement"in i){var r;try{r=i.activeElement}catch(e){r=i.body}a=r===e}i=t(),S.h.Ea(i,n,"hasfocus",a,!0),e.__ko_hasfocusLastValue=a,e.__ko_hasfocusUpdating=!1}var i=a.bind(null,!0),r=a.bind(null,!1);S.a.p(e,"focus",i),S.a.p(e,"focusin",i),S.a.p(e,"blur",r),S.a.p(e,"focusout",r)},update:function(e,t){var n=!!S.a.c(t());e.__ko_hasfocusUpdating||e.__ko_hasfocusLastValue===n||(n?e.focus():e.blur(),!n&&e.__ko_hasfocusLastValue&&e.ownerDocument.body.focus(),S.l.w(S.a.Da,null,[e,n?"focusin":"focusout"]))}},S.h.ea.hasfocus=!0,S.d.hasFocus=S.d.hasfocus,S.h.ea.hasFocus=!0,S.d.html={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){S.a.Cb(e,t())}},m("if"),m("ifnot",!1,!0),m("with",!0,!1,function(e,t){return e.Zb(t)}),S.d.let={init:function(e,t,n,a,i){return t=i.extend(t),S.Ka(t,e),{controlsDescendantBindings:!0}}},S.e.V.let=!0;var T={};S.d.options={init:function(e){if("select"!==S.a.A(e))throw Error("options binding applies only to SELECT elements");for(;0<e.length;)e.remove(0);return{controlsDescendantBindings:!0}},update:function(e,t,n){function a(){return S.a.La(e.options,function(e){return e.selected})}function i(e,t,n){var a=typeof t;return"function"==a?t(e):"string"==a?e[t]:n}function r(t,a){if(m&&l)S.j.ha(e,S.a.c(n.get("value")),!0);else if(p.length){var i=0<=S.a.o(p,S.j.u(a[0]));S.a.uc(a[0],i),m&&!i&&S.l.w(S.a.Da,null,[e,"change"])}}var s=e.multiple,c=0!=e.length&&s?e.scrollTop:null,d=S.a.c(t()),l=n.get("valueAllowUnset")&&n.has("value"),u=n.get("optionsIncludeDestroyed");t={};var f,p=[];l||(s?p=S.a.fb(a(),S.j.u):0<=e.selectedIndex&&p.push(S.j.u(e.options[e.selectedIndex]))),d&&(void 0===d.length&&(d=[d]),f=S.a.La(d,function(e){return u||e===o||null===e||!S.a.c(e._destroy)}),n.has("optionsCaption")&&null!==(d=S.a.c(n.get("optionsCaption")))&&d!==o&&f.unshift(T));var m=!1;t.beforeRemove=function(t){e.removeChild(t)},d=r,n.has("optionsAfterRender")&&"function"==typeof n.get("optionsAfterRender")&&(d=function(e,t){r(0,t),S.l.w(n.get("optionsAfterRender"),null,[t[0],e!==T?e:o])}),S.a.Bb(e,f,function(t,a,r){return r.length&&(p=!l&&r[0].selected?[S.j.u(r[0])]:[],m=!0),a=e.ownerDocument.createElement("option"),t===T?(S.a.$a(a,n.get("optionsCaption")),S.j.ha(a,o)):(r=i(t,n.get("optionsValue"),t),S.j.ha(a,S.a.c(r)),t=i(t,n.get("optionsText"),r),S.a.$a(a,t)),[a]},t,d),S.l.w(function(){l?S.j.ha(e,S.a.c(n.get("value")),!0):(s?p.length&&a().length<p.length:p.length&&0<=e.selectedIndex?S.j.u(e.options[e.selectedIndex])!==p[0]:p.length||0<=e.selectedIndex)&&S.a.Da(e,"change")}),S.a.Oc(e),c&&20<Math.abs(c-e.scrollTop)&&(e.scrollTop=c)}},S.d.options.xb=S.a.f.I(),S.d.selectedOptions={after:["options","foreach"],init:function(e,t,n){S.a.p(e,"change",function(){var a=t(),i=[];S.a.q(e.getElementsByTagName("option"),function(e){e.selected&&i.push(S.j.u(e))}),S.h.Ea(a,n,"selectedOptions",i)})},update:function(e,t){if("select"!=S.a.A(e))throw Error("values binding applies only to SELECT elements");var n=S.a.c(t()),a=e.scrollTop;n&&"number"==typeof n.length&&S.a.q(e.getElementsByTagName("option"),function(e){var t=0<=S.a.o(n,S.j.u(e));e.selected!=t&&S.a.uc(e,t)}),e.scrollTop=a}},S.h.ea.selectedOptions=!0,S.d.style={update:function(e,t){var n=S.a.c(t()||{});S.a.D(n,function(t,n){null!==(n=S.a.c(n))&&n!==o&&!1!==n||(n=""),e.style[t]=n})}},S.d.submit={init:function(e,t,n,a,i){if("function"!=typeof t())throw Error("The value for a submit binding must be a function");S.a.p(e,"submit",function(n){var a,r=t();try{a=r.call(i.$data,e)}finally{!0!==a&&(n.preventDefault?n.preventDefault():n.returnValue=!1)}})}},S.d.text={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){S.a.$a(e,t())}},S.e.V.text=!0,function(){if(s&&s.navigator)var e=function(e){if(e)return parseFloat(e[1])},t=s.opera&&s.opera.version&&parseInt(s.opera.version()),n=s.navigator.userAgent,a=e(n.match(/^(?:(?!chrome).)*version\/([^ ]*) safari/i)),i=e(n.match(/Firefox\/([^ ]*)/));if(10>S.a.C)var r=S.a.f.I(),c=S.a.f.I(),d=function(e){var t=this.activeElement;(t=t&&S.a.f.get(t,c))&&t(e)},l=function(e,t){var n=e.ownerDocument;S.a.f.get(n,r)||(S.a.f.set(n,r,!0),S.a.p(n,"selectionchange",d)),S.a.f.set(e,c,t)};S.d.textInput={init:function(e,n,r){function s(t,n){S.a.p(e,t,n)}function c(){u||(f=e.value,u=S.a.setTimeout(d,4))}function d(){clearTimeout(u),f=u=o;var t=e.value;p!==t&&(p=t,S.h.Ea(n(),r,"textInput",t))}var u,f,p=e.value,m=9==S.a.C?c:d;10>S.a.C?(s("propertychange",function(e){"value"===e.propertyName&&m(e)}),8==S.a.C&&(s("keyup",d),s("keydown",d)),8<=S.a.C&&(l(e,m),s("dragend",c))):(s("input",d),5>a&&"textarea"===S.a.A(e)?(s("keydown",c),s("paste",c),s("cut",c)):11>t?s("keydown",c):4>i&&(s("DOMAutoComplete",d),s("dragdrop",d),s("drop",d))),s("change",d),S.m(function t(){var a=S.a.c(n());null!==a&&a!==o||(a=""),f!==o&&a===f?S.a.setTimeout(t,4):e.value!==a&&(p=a,e.value=a)},null,{i:e})}},S.h.ea.textInput=!0,S.d.textinput={preprocess:function(e,t,n){n("textInput",e)}}}(),S.d.uniqueName={init:function(e,t){if(t()){var n="ko_unique_"+ ++S.d.uniqueName.Jc;S.a.tc(e,n)}}},S.d.uniqueName.Jc=0,S.d.value={after:["options","foreach"],init:function(e,t,n){if("input"!=e.tagName.toLowerCase()||"checkbox"!=e.type&&"radio"!=e.type){var a=["change"],i=n.get("valueUpdate"),r=!1,o=null;i&&("string"==typeof i&&(i=[i]),S.a.ra(a,i),a=S.a.Ub(a));var s=function(){o=null,r=!1;var a=t(),i=S.j.u(e);S.h.Ea(a,n,"value",i)};!S.a.C||"input"!=e.tagName.toLowerCase()||"text"!=e.type||"off"==e.autocomplete||e.form&&"off"==e.form.autocomplete||-1!=S.a.o(a,"propertychange")||(S.a.p(e,"propertychange",function(){r=!0}),S.a.p(e,"focus",function(){r=!1}),S.a.p(e,"blur",function(){r&&s()})),S.a.q(a,function(t){var n=s;S.a.od(t,"after")&&(n=function(){o=S.j.u(e),S.a.setTimeout(s,0)},t=t.substring(5)),S.a.p(e,t,n)});var c=function(){var a=S.a.c(t()),i=S.j.u(e);if(null!==o&&a===o)S.a.setTimeout(c,0);else if(a!==i)if("select"===S.a.A(e)){var r=n.get("valueAllowUnset");(i=function(){S.j.ha(e,a,r)})(),r||a===S.j.u(e)?S.a.setTimeout(i,0):S.l.w(S.a.Da,null,[e,"change"])}else S.j.ha(e,a)};S.m(c,null,{i:e})}else S.Ja(e,{checkedValue:t})},update:function(){}},S.h.ea.value=!0,S.d.visible={update:function(e,t){var n=S.a.c(t()),a="none"!=e.style.display;n&&!a?e.style.display="":!n&&a&&(e.style.display="none")}},function(e){S.d[e]={init:function(t,n,a,i,r){return S.d.event.init.call(this,t,function(){var t={};return t[e]=n(),t},a,i,r)}}}("click"),S.O=function(){},S.O.prototype.renderTemplateSource=function(){throw Error("Override renderTemplateSource")},S.O.prototype.createJavaScriptEvaluatorBlock=function(){throw Error("Override createJavaScriptEvaluatorBlock")},S.O.prototype.makeTemplateSource=function(e,t){if("string"==typeof e){var n=(t=t||c).getElementById(e);if(!n)throw Error("Cannot find template with ID "+e);return new S.v.n(n)}if(1==e.nodeType||8==e.nodeType)return new S.v.qa(e);throw Error("Unknown template type: "+e)},S.O.prototype.renderTemplate=function(e,t,n,a){return e=this.makeTemplateSource(e,a),this.renderTemplateSource(e,t,n,a)},S.O.prototype.isTemplateRewritten=function(e,t){return!1===this.allowTemplateRewriting||this.makeTemplateSource(e,t).data("isRewritten")},S.O.prototype.rewriteTemplate=function(e,t,n){t=t((e=this.makeTemplateSource(e,n)).text()),e.text(t),e.data("isRewritten",!0)},S.b("templateEngine",S.O),S.Gb=function(){function e(e,t,n,a){e=S.h.yb(e);for(var i=S.h.ta,r=0;r<e.length;r++){var o=e[r].key;if(i.hasOwnProperty(o)){var s=i[o];if("function"==typeof s){if(o=s(e[r].value))throw Error(o)}else if(!s)throw Error("This template engine does not support the '"+o+"' binding within its templates")}}return n="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+S.h.Va(e,{valueAccessors:!0})+" } })()},'"+n.toLowerCase()+"')",a.createJavaScriptEvaluatorBlock(n)+t}var t=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'|[^>]*))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,n=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;return{Pc:function(e,t,n){t.isTemplateRewritten(e,n)||t.rewriteTemplate(e,function(e){return S.Gb.ed(e,t)},n)},ed:function(a,i){return a.replace(t,function(t,n,a,r,o){return e(o,n,a,i)}).replace(n,function(t,n){return e(n,"\x3c!-- ko --\x3e","#comment",i)})},Fc:function(e,t){return S.M.wb(function(n,a){var i=n.nextSibling;i&&i.nodeName.toLowerCase()===t&&S.Ja(i,e,a)})}}}(),S.b("__tr_ambtns",S.Gb.Fc),function(){S.v={},S.v.n=function(e){if(this.n=e){var t=S.a.A(e);this.bb="script"===t?1:"textarea"===t?2:"template"==t&&e.content&&11===e.content.nodeType?3:4}},S.v.n.prototype.text=function(){var e=1===this.bb?"text":2===this.bb?"value":"innerHTML";if(0==arguments.length)return this.n[e];var t=arguments[0];"innerHTML"===e?S.a.Cb(this.n,t):this.n[e]=t};var e=S.a.f.I()+"_";S.v.n.prototype.data=function(t){if(1===arguments.length)return S.a.f.get(this.n,e+t);S.a.f.set(this.n,e+t,arguments[1])};var t=S.a.f.I();S.v.n.prototype.nodes=function(){var e=this.n;if(0==arguments.length)return(S.a.f.get(e,t)||{}).jb||(3===this.bb?e.content:4===this.bb?e:o);S.a.f.set(e,t,{jb:arguments[0]})},S.v.qa=function(e){this.n=e},S.v.qa.prototype=new S.v.n,S.v.qa.prototype.text=function(){if(0==arguments.length){var e=S.a.f.get(this.n,t)||{};return e.Hb===o&&e.jb&&(e.Hb=e.jb.innerHTML),e.Hb}S.a.f.set(this.n,t,{Hb:arguments[0]})},S.b("templateSources",S.v),S.b("templateSources.domElement",S.v.n),S.b("templateSources.anonymousTemplate",S.v.qa)}(),function(){function e(e,t,n){var a;for(t=S.e.nextSibling(t);e&&(a=e)!==t;)n(a,e=S.e.nextSibling(a))}function t(t,n){if(t.length){var a=t[0],i=t[t.length-1],r=a.parentNode,o=S.R.instance,s=o.preprocessNode;if(s){if(e(a,i,function(e,t){var n=e.previousSibling,r=s.call(o,e);r&&(e===a&&(a=r[0]||t),e===i&&(i=r[r.length-1]||n))}),t.length=0,!a)return;a===i?t.push(a):(t.push(a,i),S.a.za(t,r))}e(a,i,function(e){1!==e.nodeType&&8!==e.nodeType||S.Sb(n,e)}),e(a,i,function(e){1!==e.nodeType&&8!==e.nodeType||S.M.Ac(e,[n])}),S.a.za(t,r)}}function n(e){return e.nodeType?e:0<e.length?e[0]:null}function a(e,a,i,o,s){s=s||{};var c=(e&&n(e)||i||{}).ownerDocument,d=s.templateEngine||r;if(S.Gb.Pc(i,d,c),"number"!=typeof(i=d.renderTemplate(i,o,s,c)).length||0<i.length&&"number"!=typeof i[0].nodeType)throw Error("Template engine must return an array of DOM nodes");switch(c=!1,a){case"replaceChildren":S.e.da(e,i),c=!0;break;case"replaceNode":S.a.sc(e,i),c=!0;break;case"ignoreTargetNode":break;default:throw Error("Unknown renderMode: "+a)}return c&&(t(i,o),s.afterRender&&S.l.w(s.afterRender,null,[i,o.$data])),i}function i(e,t,n){return S.H(e)?e():"function"==typeof e?e(t,n):e}var r;S.Db=function(e){if(e!=o&&!(e instanceof S.O))throw Error("templateEngine must inherit from ko.templateEngine");r=e},S.Ab=function(e,t,s,c,d){if(((s=s||{}).templateEngine||r)==o)throw Error("Set a template engine before calling renderTemplate");if(d=d||"replaceChildren",c){var l=n(c);return S.B(function(){var r=t&&t instanceof S.Q?t:new S.Q(t,null,null,null,{exportDependencies:!0}),o=i(e,r.$data,r);r=a(c,d,o,r,s),"replaceNode"==d&&(l=n(c=r))},null,{wa:function(){return!l||!S.a.nb(l)},i:l&&"replaceNode"==d?l.parentNode:l})}return S.M.wb(function(n){S.Ab(e,t,s,n,"replaceNode")})},S.ld=function(e,n,r,s,c){function d(e,n){t(n,u),r.afterRender&&r.afterRender(n,e),u=null}function l(t,n){return u=c.createChildContext(t,r.as,function(e){e.$index=n}),a(null,"ignoreTargetNode",i(e,t,u),u,r)}var u;return S.B(function(){var e=S.a.c(n)||[];void 0===e.length&&(e=[e]),e=S.a.La(e,function(e){return r.includeDestroyed||e===o||null===e||!S.a.c(e._destroy)}),S.l.w(S.a.Bb,null,[s,e,l,r,d])},null,{i:s})};var s=S.a.f.I();S.d.template={init:function(e,t){var n=S.a.c(t());if("string"==typeof n||n.name)S.e.xa(e);else{if("nodes"in n){if(n=n.nodes||[],S.H(n))throw Error('The "nodes" option must be a plain, non-observable array.')}else n=S.e.childNodes(e);n=S.a.lc(n),new S.v.qa(e).nodes(n)}return{controlsDescendantBindings:!0}},update:function(e,t,n,a,i){var r=t();n=!0,a=null,"string"==typeof(t=S.a.c(r))?t={}:(r=t.name,"if"in t&&(n=S.a.c(t.if)),n&&"ifnot"in t&&(n=!S.a.c(t.ifnot))),"foreach"in t?a=S.ld(r||e,n&&t.foreach||[],t,e,i):n?(i="data"in t?i.Zb(t.data,t.as):i,a=S.Ab(r||e,i,t,e)):S.e.xa(e),i=a,(t=S.a.f.get(e,s))&&"function"==typeof t.k&&t.k(),S.a.f.set(e,s,i&&i.ba()?i:o)}},S.h.ta.template=function(e){return 1==(e=S.h.yb(e)).length&&e[0].unknown||S.h.bd(e,"name")?null:"This template engine does not support anonymous templates nested within its templates"},S.e.V.template=!0}(),S.b("setTemplateEngine",S.Db),S.b("renderTemplate",S.Ab),S.a.fc=function(e,t,n){var a,i,r,o,s;if(e.length&&t.length)for(a=i=0;(!n||a<n)&&(o=e[i]);++i){for(r=0;s=t[r];++r)if(o.value===s.value){o.moved=s.index,s.moved=o.index,t.splice(r,1),a=r=0;break}a+=r}},S.a.ib=function(){function e(e,t,n,a,i){var r,o,s,c,d,l=Math.min,u=Math.max,f=[],p=e.length,m=t.length,_=m-p||1,h=p+m+1;for(r=0;r<=p;r++)for(c=s,f.push(s=[]),d=l(m,r+_),o=u(0,r-1);o<=d;o++)s[o]=o?r?e[r-1]===t[o-1]?c[o-1]:l(c[o]||h,s[o-1]||h)+1:o+1:r+1;for(l=[],u=[],_=[],r=p,o=m;r||o;)m=f[r][o]-1,o&&m===f[r][o-1]?u.push(l[l.length]={status:n,value:t[--o],index:o}):r&&m===f[r-1][o]?_.push(l[l.length]={status:a,value:e[--r],index:r}):(--o,--r,i.sparse||l.push({status:"retained",value:t[o]}));return S.a.fc(_,u,!i.dontLimitMoves&&10*p),l.reverse()}return function(t,n,a){return a="boolean"==typeof a?{dontLimitMoves:a}:a||{},n=n||[],(t=t||[]).length<n.length?e(t,n,"added","deleted",a):e(n,t,"deleted","added",a)}}(),S.b("utils.compareArrays",S.a.ib),function(){function e(e,t,n,a,i){var r=[],s=S.B(function(){var o=t(n,i,S.a.za(r,e))||[];0<r.length&&(S.a.sc(r,o),a&&S.l.w(a,null,[n,o,i])),r.length=0,S.a.ra(r,o)},null,{i:e,wa:function(){return!S.a.Rb(r)}});return{ca:r,B:s.ba()?s:o}}var t=S.a.f.I(),n=S.a.f.I();S.a.Bb=function(a,i,r,s,c){function d(e,t){D=p[t],g!==t&&(C[e]=D),D.qb(g++),S.a.za(D.ca,a),h.push(D),y.push(D)}function l(e,t){if(e)for(var n=0,a=t.length;n<a;n++)t[n]&&S.a.q(t[n].ca,function(a){e(a,n,t[n].ja)})}i=i||[],s=s||{};var u,f=S.a.f.get(a,t)===o,p=S.a.f.get(a,t)||[],m=S.a.fb(p,function(e){return e.ja}),_=S.a.ib(m,i,s.dontLimitMoves),h=[],b=0,g=0,v=[],y=[];i=[];for(var D,I,x,C=[],O=(m=[],0);I=_[O];O++)switch(x=I.moved,I.status){case"deleted":x===o&&((D=p[b]).B&&(D.B.k(),D.B=o),S.a.za(D.ca,a).length&&(s.beforeRemove&&(h.push(D),y.push(D),D.ja===n?D=null:i[O]=D),D&&v.push.apply(v,D.ca))),b++;break;case"retained":d(O,b++);break;case"added":x!==o?d(O,x):(D={ja:I.value,qb:S.N(g++)},h.push(D),y.push(D),f||(m[O]=D))}for(S.a.f.set(a,t,h),l(s.beforeMove,C),S.a.q(v,s.beforeRemove?S.$:S.removeNode),O=0,f=S.e.firstChild(a);D=y[O];O++){for(D.ca||S.a.extend(D,e(a,r,D.ja,c,D.qb)),b=0;_=D.ca[b];f=_.nextSibling,u=_,b++)_!==f&&S.e.ic(a,_,u);!D.Xc&&c&&(c(D.ja,D.ca,D.qb),D.Xc=!0)}for(l(s.beforeRemove,i),O=0;O<i.length;++O)i[O]&&(i[O].ja=n);l(s.afterMove,C),l(s.afterAdd,m)}}(),S.b("utils.setDomNodeChildrenFromArrayMapping",S.a.Bb),S.X=function(){this.allowTemplateRewriting=!1},S.X.prototype=new S.O,S.X.prototype.renderTemplateSource=function(e,t,n,a){return(t=9>S.a.C||!e.nodes?null:e.nodes())?S.a.W(t.cloneNode(!0).childNodes):(e=e.text(),S.a.ma(e,a))},S.X.sb=new S.X,S.Db(S.X.sb),S.b("nativeTemplateEngine",S.X),function(){S.vb=function(){var e=this.ad=function(){if(!l||!l.tmpl)return 0;try{if(0<=l.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch(e){}return 1}();this.renderTemplateSource=function(t,n,a,i){if(i=i||c,a=a||{},2>e)throw Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");var r=t.data("precompiled");return r||(r=t.text()||"",r=l.template(null,"{{ko_with $item.koBindingContext}}"+r+"{{/ko_with}}"),t.data("precompiled",r)),t=[n.$data],n=l.extend({koBindingContext:n},a.templateOptions),(n=l.tmpl(r,t,n)).appendTo(i.createElement("div")),l.fragments={},n},this.createJavaScriptEvaluatorBlock=function(e){return"{{ko_code ((function() { return "+e+" })()) }}"},this.addTemplate=function(e,t){c.write("<script type='text/html' id='"+e+"'>"+t+"<\/script>")},0<e&&(l.tmpl.tag.ko_code={open:"__.push($1 || '');"},l.tmpl.tag.ko_with={open:"with($1) {",close:"} "})},S.vb.prototype=new S.O;var e=new S.vb;0<e.ad&&S.Db(e),S.b("jqueryTmplTemplateEngine",S.vb)}()})}()},,function(e,t,n){"use strict";n.d(t,"e",function(){return s}),n.d(t,"a",function(){return c}),n.d(t,"r",function(){return d}),n.d(t,"s",function(){return l}),n.d(t,"l",function(){return f}),n.d(t,"u",function(){return p}),n.d(t,"d",function(){return m}),n.d(t,"c",function(){return _}),n.d(t,"b",function(){return h}),n.d(t,"v",function(){return b}),n.d(t,"g",function(){return g}),n.d(t,"m",function(){return v}),n.d(t,"_",function(){return y}),n.d(t,"p",function(){return S}),n.d(t,"h",function(){return D}),n.d(t,"t",function(){return I}),n.d(t,"n",function(){return x}),n(37);var a=n(49),i=n(18),r=n(34);n.d(t,"f",function(){return r.e}),n.d(t,"y",function(){return r.t});var o=n(41);function s(e){var t,n=Object(o.a)(),i=2===Object(a.t)()?"storage.live-int.com":"onedrive.live.com";return t="https://".concat(n).concat(i,"/redir?resid=").concat(e),"u!".concat(window.btoa(t).replace(/=/g,"").replace(/[+]/g,"-").replace(/\//g,"_"))}function c(e){return void 0===e&&(e="v1.0"),"https://graph.microsoft.com/".concat(e)}function d(){return"https://substrate.office.com"}function l(){return"/picker/accountchooser"===document.location.pathname.toLowerCase()}function u(e){return"photos"===e.v}function f(e){return"places"===e.id&&u(e)}function p(e){return"tags"===e.id&&u(e)}function m(e){return"allmyphotos"===e.qt||"allmyphotos"===e.parQt}function _(e){return"albums"===e.id&&u(e)}function h(e){return!!e.id&&"albums"!==e.id&&"tags"!==e.id&&"places"!==e.id&&!!e.cid&&u(e)&&!m(e)}function b(e){return m(e)&&!!e.tagFilter&&u(e)}function g(e){return!!e.locationFilter&&u(e)}function v(e){return!!e.onThisDay&&u(e)}function y(e){return!!e.onThisMonth&&u(e)}function S(e){return!!e.lastWeekPreviousYears&&u(e)}function D(e){return e===i.e.RecycleBin}function I(e){var t=e.id;if(t){var n=t.indexOf("!");if(n>-1)return t.slice(0,n)}}function x(e){return e.ft}n.d(t,"o",function(){return o.n}),n.d(t,"i",function(){return o.t})},function(e,t,n){"use strict";n.d(t,"i",function(){return _}),n.d(t,"l",function(){return b}),n.d(t,"u",function(){return g}),n.d(t,"a",function(){return v}),n.d(t,"c",function(){return S}),n.d(t,"o",function(){return D}),n.d(t,"t",function(){return I}),n.d(t,"d",function(){return x}),n.d(t,"f",function(){return C}),n.d(t,"r",function(){return O}),n.d(t,"n",function(){return w}),n.d(t,"s",function(){return E}),n.d(t,"h",function(){return A}),n.d(t,"_",function(){return L}),n.d(t,"e",function(){return k}),n.d(t,"p",function(){return M}),n.d(t,"m",function(){return P}),n.d(t,"g",function(){return T}),n.d(t,"b",function(){return U});var a=n(6),i=n(87),r=n(2),o=n(1),s="window",c="JSON",d="XMLHttpRequest",l=null,u=null,f=null,p=null;function m(e,t){var n=!1;if(e){try{if(!(n=t in e)){var i=e[a.l];i&&(n=t in i)}}catch(e){}if(!n)try{var r=new e;n=!Object(o.D)(r[t])}catch(e){}}return n}function _(e){var t=Object(i.e)();return t&&t[e]?t[e]:e===s&&h()?window:null}function h(){return Boolean(typeof window===a.d&&window)}function b(){return h()?window:_(s)}function g(){return Boolean(typeof document===a.d&&document)}function v(){return g()?document:_("document")}function y(){return Boolean(typeof navigator===a.d&&navigator)}function S(){return y()?navigator:_("navigator")}function D(e){return typeof location===a.d&&location?location:_("location")}function I(){return typeof console!==a.u?console:_("console")}function x(){return _("performance")}function C(){return Boolean(typeof JSON===a.d&&JSON||null!==_(c))}function O(){return C()?JSON||_(c):null}function w(){return _("crypto")}function E(){return _("msCrypto")}function A(){var e=S();return!(!e||!e.product)&&"ReactNative"===e.product}function L(){var e=S();if(e&&(e.userAgent!==u||null===l)){var t=((u=e.userAgent)||r.i).toLowerCase();l=Object(o.P)(t,"msie")||Object(o.P)(t,"trident/")}return l}function k(e){var t=Object[a.l].toString.call(e),n=r.i;return"[object Error]"===t?n="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e.name+"'":C()&&(n=O().stringify(e)),t+n}function M(){return null===p&&(p=y()&&Boolean(S().sendBeacon)),p}function P(e){var t=!1;try{t=!!_("fetch");var n=_("Request");t&&e&&n&&(t=m(n,"keepalive"))}catch(e){}return t}function T(){return null===f&&(f=typeof XDomainRequest!==a.u)&&U()&&(f=f&&!m(_(d),"withCredentials")),f}function U(){var e=!1;try{e=!!_(d)}catch(e){}return e}},function(e,t,n){"use strict";var a=n(33);n.d(t,"e",function(){return a.e})},function(e,t,n){"use strict";n.d(t,"s",function(){return a}),n.d(t,"d",function(){return i}),n.d(t,"u",function(){return r}),n.d(t,"l",function(){return o}),n.d(t,"c",function(){return s}),n.d(t,"o",function(){return c}),n.d(t,"t",function(){return d}),n.d(t,"r",function(){return l}),n.d(t,"e",function(){return u}),n.d(t,"n",function(){return f}),n.d(t,"a",function(){return p}),n.d(t,"i",function(){return m});var a="function",i="object",r="undefined",o="prototype",s="hasOwnProperty",c="default",d=Object,l=d[o],u=d.assign,f=d.create,p=d.defineProperty,m=l[s]},,function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"d",function(){return o}),n.d(t,"f",function(){return s}),n.d(t,"l",function(){return c}),n.d(t,"s",function(){return d}),n.d(t,"u",function(){return l}),n.d(t,"e",function(){return u}),n.d(t,"a",function(){return p}),n.d(t,"i",function(){return m}),n.d(t,"o",function(){return _}),n.d(t,"t",function(){return h}),n.d(t,"r",function(){return b}),n.d(t,"n",function(){return g});var a=n(8),i=n(7),r="Wac_JsApi_{0}_{1}",o="EnableWacUseOpenUrlInPlaceOfEditForUnified_{0}",s={EnableOWLJsApiUnifiedBundle:{ODB:!1,ODC:"EnableOWLJsApiUnifiedBundle"},EnableModernAuthWebLoader:{ODB:!1,ODC:"EnableModernAuthWebLoader"},EnableOWLManifestCaching:{ODB:!1,ODC:"EnableOWLManifestCaching"},EnableWacJsApiV2:{ODB:!0,ODC:"EnableWacJsApiV2"},EnableWacOfficeWebLoader:{ODB:!0,ODC:"EnableWacOfficeWebLoader"},EnableWacUnifiedApps:{ODB:!0,ODC:"EnableWacUnifiedApps"},Word:{WacHostFlightWordWordJsApiV2NoWrapper:{ODB:!0,ODC:"Wac_HostFlight_Word_WordJsApiV2NoWrapper"},WacHostFlightWordWordJsApiV2:{ODB:!1,ODC:"Wac_HostFlight_Word_WordJsApiV2"},WacHostFlightWordODCShareLinkPreload:{ODB:!1,ODC:"Wac_HostFlight_Word_ODCShareLinkPreload"},WacHostFlightWordWordScriptsPreload:{ODB:!1,ODC:"Wac_HostFlight_Word_WordScriptsPreload"},WacJsApiWordView:{ODB:!0,ODC:"Wac_JsApi_Word_View"},WacJsApiWordEdit:{ODB:!0,ODC:"Wac_JsApi_Word_Edit"},WacJsApiWordEditNew:{ODB:!0,ODC:"Wac_JsApi_Word_EditNew"},EnableWacUseOpenUrlInPlaceOfEditForUnifiedWord:{ODB:!0,ODC:"EnableWacUseOpenUrlInPlaceOfEditForUnified_Word"}},Excel:{WacHostFlightExcelExcelJsApiV2NoWrapper:{ODB:!0,ODC:"Wac_HostFlight_Excel_ExcelJsApiV2NoWrapper"},WacHostFlightExcelExcelJsApiV2:{ODB:!1,ODC:"Wac_HostFlight_Excel_ExcelJsApiV2"},WacHostFlightExcelExcelLandingPageOfflineTelemetry:{ODB:!1,ODC:"Wac_HostFlight_Excel_ExcelLandingPageOfflineTelemetry"},WacHostFlightExcelInstantShell:{ODB:!0,ODC:"Wac_HostFlight_Excel_InstantShell"},WacHostFlightExcelODCShareLinkPreload:{ODB:!1,ODC:"Wac_HostFlight_Excel_ODCShareLinkPreload"},WacHostFlightExcelExcelAdaptiveLayoutDownload:{ODB:!1,ODC:"Wac_HostFlight_Excel_ExcelAdaptiveLayoutDownload"},WacHostFlightExcelExcelLandingPageObserver:{ODB:!0,ODC:"Wac_HostFlight_Excel_ExcelLandingPageObserver"},WacJsApiExcelView:{ODB:!1,ODC:"Wac_JsApi_Excel_View"},WacJsApiExcelEdit:{ODB:!0,ODC:"Wac_JsApi_Excel_Edit"},WacJsApiExcelEditNew:{ODB:!0,ODC:"Wac_JsApi_Excel_EditNew"},EnableWacUseOpenUrlInPlaceOfEditForUnifiedExcel:{ODB:!0,ODC:"EnableWacUseOpenUrlInPlaceOfEditForUnified_Excel"}},PowerPoint:{WacHostFlightPowerPointPowerPointJsApiV2NoWrapper:{ODB:!0,ODC:"Wac_HostFlight_PowerPoint_PowerPointJsApiV2NoWrapper"},WacHostFlightPowerPointPowerPointJsApiV2:{ODB:!0,ODC:"Wac_HostFlight_PowerPoint_PowerPointJsApiV2"},WacHostFlightPowerPointODCShareLinkPreload:{ODB:!1,ODC:"Wac_HostFlight_PowerPoint_ODCShareLinkPreload"},WacJsApiPowerPointView:{ODB:!1,ODC:"Wac_JsApi_PowerPoint_View"},WacJsApiPowerPointEdit:{ODB:!0,ODC:"Wac_JsApi_PowerPoint_Edit"},WacJsApiPowerPointEditNew:{ODB:!0,ODC:"Wac_JsApi_PowerPoint_EditNew"},EnableWacUseOpenUrlInPlaceOfEditForUnifiedPowerPoint:{ODB:!0,ODC:"EnableWacUseOpenUrlInPlaceOfEditForUnified_PowerPoint"}},OneNote:{WacHostFlightOneNoteOneNoteJsApiV2NoWrapper:{ODB:!1,ODC:"Wac_HostFlight_OneNote_OneNoteJsApiV2NoWrapper"},WacHostFlightOneNoteOneNoteJsApiV2:{ODB:!1,ODC:"Wac_HostFlight_OneNote_OneNoteJsApiV2"},WacHostFlightOneNoteODCShareLinkPreload:{ODB:!1,ODC:"Wac_HostFlight_OneNote_ODCShareLinkPreload"},WacJsApiOneNoteView:{ODB:!0,ODC:"Wac_JsApi_OneNote_View"},WacJsApiOneNoteEdit:{ODB:!0,ODC:"Wac_JsApi_OneNote_Edit"},WacJsApiOneNoteEditNew:{ODB:!0,ODC:"Wac_JsApi_OneNote_EditNew"},EnableWacUseOpenUrlInPlaceOfEditForUnifiedOneNote:{ODB:!0,ODC:"EnableWacUseOpenUrlInPlaceOfEditForUnified_OneNote"}},Visio:{WacHostFlightVisioVisioJsApiV2NoWrapper:{ODB:!1,ODC:"Wac_HostFlight_Visio_VisioJsApiV2NoWrapper"},WacHostFlightVisioVisioJsApiV2:{ODB:!1,ODC:"Wac_HostFlight_Visio_VisioJsApiV2"},WacHostFlightVisioODCShareLinkPreload:{ODB:!1,ODC:"Wac_HostFlight_Visio_ODCShareLinkPreload"},WacJsApiVisioView:{ODB:!0,ODC:"Wac_JsApi_Visio_View"},WacJsApiVisioEdit:{ODB:!1,ODC:"Wac_JsApi_Visio_Edit"},WacJsApiVisioEditNew:{ODB:!1,ODC:"Wac_JsApi_Visio_EditNew"},EnableWacUseOpenUrlInPlaceOfEditForUnifiedVisio:{ODB:!1,ODC:"EnableWacUseOpenUrlInPlaceOfEditForUnified_Visio"}},WacSendPerformanceLog:{ODB:!0,ODC:"WacSendPerformanceLog"}};function c(e,t,n){var a=e.replace(/_/g,"").replace(/\{0\}/g,t).replace(/\{1\}/g,n);return s[t][a]}function d(e){return!!e&&Object(a.E)(e)}function l(e,t,n){return d(c(e,t,n))}i.e.isActivated("528C4A31-D086-4ED5-A4C1-A9049215C434","05/31/2023","enable use cache for wac item");var u={ODB:!1,ODC:"EnableBadgerCookieForWac"},f=!i.e.isActivated("3744c2de-1081-4e62-927c-1cd916990cd7","09/07/2023","KillSwitch to enable use of parameters to test HOOT with OWL"),p={ODB:f,ODC:f},m=!i.e.isActivated("32BD5ECB-915A-4748-AD3E-9D61619A843A","11/01/2023","KillSwitch to redirect to oneup for non-office files"),_=!i.e.isActivated("27322C0D-4351-464B-A155-B0BE3C023889","10/30/2023","KillSwitch to use doc.aspx to open migrated document"),h=!i.e.isActivated("33875A21-7906-42E2-9EC6-7A8CC86E51B6","10/30/2023","KillSwitch to enable retry if OWL bootstrapper fails to load the OWL package"),b=!i.e.isActivated("EA08BEF9-2AF8-4B3F-9964-F371626DD70A","11/08/2023","enable use cache for wac item in OWL"),g=!i.e.isActivated("D0F4C8C3-ADA6-499E-BFD7-476B334962B5","11/13/2023","enable use shares api to get wac item in OWL")},function(e,t,n){"use strict";var a;n.d(t,"e",function(){return i}),function(e){e[e.none=0]="none",e[e.locate=1]="locate",e[e.defaultClick=2]="defaultClick",e[e.download=3]="download",e[e.share=4]="share",e[e.sharing=5]="sharing",e[e.sendSurvey=6]="sendSurvey",e[e.createTextDocument=7]="createTextDocument",e[e.createWord=8]="createWord",e[e.createExcel=9]="createExcel",e[e.createExcelForm=10]="createExcelForm",e[e.createPowerPoint=11]="createPowerPoint",e[e.createOneNote=12]="createOneNote",e[e.openInExcel=13]="openInExcel",e[e.openInWord=14]="openInWord",e[e.openInPowerPoint=15]="openInPowerPoint",e[e.openInOneNote=16]="openInOneNote",e[e.openInVisio=17]="openInVisio",e[e.openInProject=18]="openInProject",e[e.openInPublisher=19]="openInPublisher",e[e.openInOffice=20]="openInOffice",e[e.embed=21]="embed",e[e.reportAbuse=22]="reportAbuse",e[e.addToShared=23]="addToShared",e[e.editBrowser=24]="editBrowser",e[e.feedback=25]="feedback",e[e.versionHistory=26]="versionHistory",e[e.showProperties=27]="showProperties",e[e.edit=28]="edit",e[e.editNew=29]="editNew"}(a||(a={}));var i={};for(var r in a)if("number"==typeof a[r]){var o=r,s=a[o];i[o.toLowerCase()]=s}t.t=a},,function(e,t,n){"use strict";n.d(t,"v",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"s",function(){return c}),n.d(t,"c",function(){return d}),n.d(t,"u",function(){return l}),n.d(t,"p",function(){return u}),n.d(t,"g",function(){return f}),n.d(t,"t",function(){return p}),n.d(t,"f",function(){return m}),n.d(t,"_",function(){return _}),n.d(t,"b",function(){return h}),n.d(t,"o",function(){return b}),n.d(t,"h",function(){return g}),n.d(t,"i",function(){return v}),n.d(t,"n",function(){return y}),n.d(t,"r",function(){return S}),n.d(t,"d",function(){return D});var a=n(3),i=n(8);n.d(t,"e",function(){return i.t}),n.d(t,"l",function(){return i.o}),n.d(t,"m",function(){return i.c}),n.d(t,"y",function(){return i.d}),n.d(t,"S",function(){return i.l}),n.d(t,"D",function(){return i.b}),n.d(t,"I",function(){return i.S}),n.d(t,"x",function(){return i.D}),n.d(t,"C",function(){return i.x}),n.d(t,"O",function(){return i.C}),n.d(t,"w",function(){return i.O}),n.d(t,"E",function(){return i.E}),n(227);var r=window._spPageContextInfo,o={ODC:!0},s=(i.L,{ODC:!0,ODB:!1}),c={ODC:"FamilySharing"},d={ODC:"FamilySharingWacKS"},l={ODC:"ManageAccessRevampConsumer"},u={ODC:"ODCHideNonPremiumLinkFeatures"},f={ODC:"SharingTooltipCalloutKS"},p={ODC:"Enable3SonWacWord"},m={ODC:"ODCFacepileFeature"},_=(i.L||r.listBaseTemplate,a.e.isActivated("63D3DE85-2D59-4622-8BD4-CEEC395F89D6","10/21/2021","Enable anonymous report concern command"),a.e.isActivated("30c4f1d1-fdac-4eca-94ae-a33bfcc410f2","11/17/2023","Killswitch for new Share Dialog for SPO"),{ODC:"PreferGraphV1API",ODB:!1,ECS:1081438}),h=(a.e.isActivated("b8c885e0-1292-4bba-a624-d365f85bf140","05/27/2021","Show the new create shared library UI in ODB"),a.e.isActivated("5b1beb70-aac8-4da3-a4e2-151c7e55cd53","Fallback to global canManageLinks logic"),{ODB:772}),b={ODC:"EnableVroomDocFormatSettings"},g={ODC:"ReadOnlyItemsStore",ODB:-17},v=(a.e.isActivated("61c45046-bce1-4f47-a4dc-477520ba1895","11/16/2021","Do not invalidate item after sharing when in search view"),a.e.isActivated("cce0d731-4a47-460e-b5d5-c31fdf4d347a","9/11/2020","Pass through clientId to hosted OneUp WAC app"),a.e.isActivated("53c310fe-1add-42fe-9e42-26b35764ed1a","12/14/2020","Pass through docClickTime to hosted OneUp WAC app"),a.e.isActivated("bcc0651f-a0de-430b-8435-1afc9875b682","08/03/2021","Pass through uih to hosted OneUp WAC app"),a.e.isActivated("731D9A2D-7DDD-4DE8-98D1-D454F59246E7","05/30/2022","Pass through EmbeddingPageSessionInfo and EmbeddingPageOrigin to hosted OneUp WAC app"),{ODB:826,OneDrive:!0}),y=(a.e.isActivated("8a90e09f-a635-4113-897e-402973bce841","10/21/2021","Use pdf viewer to preview tiff files"),a.e.isActivated("f50a33e2-f57e-4b97-a36d-d6a3be9e5240","02/09/2021","Add forced new token while trying to get token"),a.e.isActivated("97048ac2-781a-4ee8-8f5d-46995f622c82","05/24/2021","Use GraphDatasource to get and refresh driveAccessToken"),a.e.isActivated("d6cee8cb-7162-4dee-a43b-63adeeb1971d","01/27/2021","Sets a query param (correlationId) which can help debug client errors using service logs"),a.e.isActivated("eae1b7c5-a0b3-43b0-839c-30cfbc2e5a9d","4/12/2021","Add sending of playbackSessionId and content category as qsp"),a.e.isActivated("276f3e59-6a18-4296-b221-d9fbe60eca97","2/9/2021","Use a window.fetch  request to check for cors errors"),a.e.isActivated("71913f76-47d4-4293-a492-2205b7c1e655","3/18/2021","Enable sending of heartbeat telemetry"),a.e.isActivated("bdfc077e-7152-4772-874e-1936725cde1f","3/24/2021","Enable max retries check on RequestManager in Dashling."),a.e.isActivated("9d46a6f9-9676-41ed-a4b5-3c01c1080993","3/1/2021","Use the height specified in the adaptation set as the resolution, rather than parsing it from the resolutionId"),a.e.isActivated("d4be6831-a0f7-40f7-b77b-5ad215b528c9","8/19/2020","Control if video dashling telemetry is enabled"),a.e.isActivated("20f62141-0df7-4eb3-943c-ff45219c1ee1","8/19/2020","Control if video dashling decryptor v2 is disabled"),a.e.isActivated("f6b9287b-5835-460b-8651-ae3b92ec34ce","9/14/2020","Control if video dashling supports parallel key call"),a.e.isActivated("336583dd-00a6-40dd-beea-2f2068fb2f0c","8/19/2020","Control if video dashling cdn ref ids telemetry is enabled"),a.e.isActivated("c56be611-10e0-4cde-8a46-1244a42f47b3","9/28/2020","Control if video dashling telemetry info is enabled"),a.e.isActivated("b8133a0d-36a6-4a4d-ba26-fb4563484d41","11/11/2020","Control if video refresh token is enabled"),a.e.isActivated("22f8bf4b-d19c-4c1f-a5a7-cb2fd36c8d6c","10/05/2020","Control if force Meta params are enabled"),a.e.isActivated("351ee0af-7950-49cf-a8f7-2fa77e44fb97","11/05/2020","Control if smart playback is enabled"),a.e.isActivated("45a43ec1-f520-41e6-9f94-4d14af7ccf6d","9/30/2020","Control if video dashling optimizations are enabled"),a.e.isActivated("411555f8-233c-4f56-97f4-586835b5e130","04/03/2021","Retry video metadata call with the access token provided in the playback URLs"),a.e.isActivated("cc74fd4e-2d38-4443-a603-78c3c5024447","09/01/2020","Call MeTa to verify captions exist before showing UI toggle"),a.e.isActivated("c1063c7b-5a82-4f68-84ca-3920d6541988","2/11/2021","Controls teams meeting recordings fallback to ffmpeg when media foundation unsuccessful"),a.e.isActivated("bf4f93e0-a68d-4655-aafa-234b12eeceef","5/12/2023","Change client id for share in Stream view experience"),a.e.isActivated("0f853474-6c72-4456-ac06-ed2da32c4d44","3/9/2021","Identify OneUpPlayer to MeTA transcode service"),a.e.isActivated("174C413E-7F06-49B2-AFBE-D1C3E6972EBA","11/24/2021","Disable SK compliance video block for ODC"),a.e.isActivated("dbecc8cc-2bf6-4a33-bedf-9f71faa71fdf","1/5/2021","Controls DASH playback on Safari"),a.e.isActivated("ce53700c-4498-49ef-b738-21131fdc2551","5/30/2021","Enable pretranscode support"),a.e.isActivated("398DDB43-D6A8-4060-8F69-378A0AEF845A","03/25/2022","Display request access button when no permission (403)"),a.e.isActivated("d047b4a4-477a-4da6-b18c-1eb7daf19cc8","11/03/2021","Add request access button to OneUp curtain"),a.e.isActivated("0b6f3eb5-90ef-4e77-81d9-2286c06c3257","07/20/2021","Engagement Telemetry Enhancement for 1up according to ask from OnePlayer"),a.e.isActivated("ca5833b4-d7d9-406d-8e36-fc28548b52a2","10/21/2020","Update video autoplay behavior"),a.e.isActivated("9ffb3b8b-fbfe-4c66-bd3a-34f3451d6037","02/06/2023","Killswitch to enable teaching bubble for PDF editing"),a.e.isActivated("ecae7a95-d6a0-4940-a5dc-236ef7ab6f55","02/06/2023","Killswitch to enable teaching bubble for PDF extract and merge"),a.e.isActivated("66097d38-1f87-4a2d-983d-89a2ed26b2d8","12/06/2023","Killswitch to enable teaching bubble for PDF get eSignatures"),a.e.isActivated("260364a3-3855-4555-95ad-fc012bfe8d0c","01/06/2022","Enable ER Bug fixes for Universal Annotations"),a.e.isActivated("bd34a99e-6762-42ac-9795-c2123340281b","11/17/2021","Enable FFMPEG transcoding for all HLS sessions"),a.e.isActivated("ac5fc96a-ba27-41c2-8211-39a2d12bd2b0","2/17/2022","When the browser is Safari, force the video files to play using native player"),a.e.isActivated("1ba50e39-1615-4340-82c7-765408f11243","4/27/2022","When progressive playback is used, add cross origin anonymous to the video element"),a.e.isActivated("F6679A55-17E3-4F3B-BECF-7B969EB307C2","02/08/2022","Check if the teams meeting recording has an expiration date."),a.e.isActivated("0c7f0abb-bacf-45f2-814d-61bb1e84f2f5","8/1/2021","move target up to solve keybinding issues"),a.e.isActivated("884acaf3-037b-4c3a-b169-eddffd004e69","06/20/2023","Enables fix for items scope hierarchy to be able to use the useAction hook properly"),a.e.isActivated("2a642dc2-93e1-41f8-b6e1-d7c4c9acecd2","09/08/2022","View button for opening uploaded video in SWA in new tab"),a.e.isActivated("3cf3efe2-3050-4c01-8597-317ed1e0acc2","28/08/2022","Open button for opening moved/copied video in SWA in new tab"),a.e.isActivated("b2895e2b-5ca4-448b-955c-38d728d7e7b2","23/12/2022","Do not show links in SWA upload popup and panel for destination directories"),a.e.isActivated("4678edfd-5753-410d-a418-5ce8e9368075","10/03/2022","Refactoring code for open button showing after moved/copied video in SWA"),a.e.isActivated("f2e15bcb-b2af-40ee-90fa-4d0e27ac3b99","09/13/2022","Opening Video Settings automatically after opening uploaded video"),a.e.isActivated("461e4739-e857-4d71-88da-805c7c90b75e","10/06/2022","Having only one item in new menu dropdown if other is turned off"),a.e.isActivated("D095D1B3-A17F-441B-8855-D465ED3CA91F","12/15/2021",""),a.e.isActivated("25B37479-0FDE-4A4C-B58F-3FD5F9A152BA","05/10/2023","Create ODF document with VROOM FOR COB users"),a.e.isActivated("483a92b4-201c-4b8c-b657-3fe2ce288672","4/22/2022","Show teaching bubble for TMR files consistently before user closes it."),a.e.isActivated("a6183b15-1c4c-4fe0-b52c-b263235d6c3d","5/11/2022","Use UTC time zone for TMR"),a.e.isActivated("744d1129-5df2-4930-b056-7bc0fb82151b","5/11/2022","Feature to check if video codec is in the list of unsupported by browser"),{ODB:!0,ODC:"EnableGraphApiGetEmbedInfo",OneDrive:!1,Fallback:!1}),S=(a.e.isActivated("b2ac1c0f-d8e1-4f24-9d57-41afa45a5f66","10/11/2022","Killswitch to enable prefetching video with low bitrate"),a.e.isActivated("60fdf489-9918-46ee-8151-5a98bc049a81","10/26/2022","Killswitch to add logging for error in fetch operation"),a.e.isActivated("51ee2bb9-9d53-45e8-a198-02a1d377f01d","1/23/2023","Remove tooltip from new button on command bar"),{ODC:"EnableSearchHistorySettingInCob"}),D=(a.e.isActivated("ea1dd803-26eb-41a5-bb51-04e08a8930b6","8/31/2023","Remove KO view param from PlayBackHelper as it can be obtained from navigation directly"),{ODC:!a.e.isActivated("821989C8-65C4-4430-8FD9-6B1F23BBCBBE","07/19/2023","Fix the issue that missing customization option for Excel files in embed dialog.")});a.e.isActivated("912acc33-b0b5-4ff1-88cf-a898791ccda0","08/04/2023","Enables fix for items scope hierarchy to be able to use the us actions with global scope"),a.e.isActivated("9EED27A7-3B37-4C60-AD36-B0B1D12A46B9","08/01/2023","Generate the ConfiguratorUrl of excel files for converged consumers.")},,,function(e,t,n){"use strict";n.d(t,"o",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"i",function(){return s}),n.d(t,"n",function(){return c}),n.d(t,"e",function(){return d}),n.d(t,"t",function(){return l}),n.d(t,"r",function(){return u});var a=n(7),i=(n(91),n(143)),r=window._spPageContextInfo,o=function(){var e=-1!==navigator.userAgent.indexOf("OneDriveWinApp");try{e=e||!!window.sessionStorage.getItem("_isOneDriveWinApp")}catch(e){}return e}(),s=window._spModuleLink&&"SPListWebPack"===window._spModuleLink.manifestName,c=!r||"21"===r.webTemplate&&700===r.listBaseTemplate,d=(window._spModuleLink&&window._spModuleLink.manifestName,window._spModuleLink&&window._spModuleLink.manifestName,window._spModuleLink&&window._spModuleLink.manifestName,window._spModuleLink&&window._spModuleLink.manifestName,a.e.isActivated("31D882E5-E207-4736-8B8E-DF0970630CE7","4/24/2023","Disable select-field data scrubbing in 1DS."),{Fallback:!a.e.isActivated("B35E04AA-346B-44E3-B7A4-88FC1D79C889","01/06/2023","Enable Popup flow for MSAL authentication")}),l=(a.e.isActivated("DC975CAD-8F3C-4979-97E2-DA9970A68919","03/25/2022","Prefer isMySiteOwner check for ODB"),{ODB:!1,ODC:!a.e.isActivated("DE2FA0D9-D704-4B85-916B-9DB19121E9A1","3/21/2023","Fix COB OneUp cannot open thumbnail correctly.")}),u=function(){var e=function(){if(Object(i.t)())return{winappMajorVersion:100,winappMinorVersion:0,winappPatchVersion:0};var e=navigator.userAgent,t=e.substring(e.indexOf("OneDriveWinApp")),n=t&&t.split("/"),a=o&&(n.length>1?n[1].split("."):t);return{winappMajorVersion:a?parseInt(a[0],10):"-1",winappMinorVersion:a?parseInt(a[1],10):"-1",winappPatchVersion:a?parseInt(a[2],10):"-1"}}(),t=e.winappMajorVersion,n=e.winappMinorVersion,a=e.winappPatchVersion;return!(t<19||19===t&&(n<23||23===n&&a<7))}},,,function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"r",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"s",function(){return c}),n.d(t,"c",function(){return d}),n.d(t,"d",function(){return l}),n.d(t,"e",function(){return u}),n.d(t,"n",function(){return f}),n.d(t,"o",function(){return p}),n.d(t,"i",function(){return m});var a=n(4),i=(n(225),new a.t("itemComment"),n(124)),r=(new a.t("list"),new a.t("oAuthTokenDataSource"),new a.t("siteScripts"),n(226),n(170),new a.t("recentList"),new a.t("folder"),new a.t("appsItem"),new a.t("externallySharedItem"),new a.t("popularItem"),new a.t("subsiteItem"),new a.t("mostViewsItem"),new a.t("mostViewersItem"),new a.t("settings"),new a.t("getItem")),o=new a.t("items"),s=(new a.t("versionControl"),new a.t("versionHistory"),new a.t("vault"),i.e),c=(new a.t("peopleCardFactory"),new a.t("peopleCard"),new a.t("language"),new a.t("languagePicker"),new a.t("leftNav"),new a.t("search"),new a.t("sharing")),d=(new a.t("sharingLightSpeed"),new a.t("sharingData")),l=(new a.t("groups"),new a.t("suiteNav"),new a.t("iosMobileAppPath"),new a.t("url")),u=(new a.t("universalAnnotation"),new a.t("download"),new a.t("docFormat"),new a.t("footer"),new a.t("manifests"),new a.t("itemActivityFeed"),new a.t("itemActivityFeedHelper"),new a.t("itemActivityFeedSharingHelper"),new a.t("userInfo"),new a.t("storageInfo"),new a.t("storageOptions"),new a.t("album"),new a.t("tag"),new a.t("shareByLink"),new a.t("folderItemCount"),new a.t("photo"),new a.t("subscriptions"),new a.t("analytics"),new a.t("sendFeedback"),new a.t("embed")),f=(new a.t("application"),new a.t("policyTip"),new a.t("policyTipLightSpeed"),new a.t("customAction"),new a.t("taxonomy"),new a.t("web"),new a.t("floodgate"),new a.t("shortcutsDS"),new a.t("encoding"),new a.t("rating"),new a.t("publish"),new a.t("videoItem"),new a.t("sites"),new a.t("copy"),new a.t("upsell"),new a.t("notifications"),new a.t("command"),new a.t("processFilters"),new a.t("quota"),new a.t("itemColumn"),new a.t("bundle"),new a.t("itemPicker"),new a.t("site"),new a.t("pushChannel"),new a.t("itemAutoRefresh"),new a.t("loginApp"),new a.t("mruRecent"),new a.t("pdf"),new a.t("zip"),new a.t("url2"),new a.t("attachments"),new a.t("spotlight"),new a.t("error"),new a.t("promotedPhotos"),new a.t("fileHandler"),new a.t("fileHandlerFromCache"),new a.t("recycleBin"),new a.t("deleteRestore"),new a.t("instrumentation"),new a.t("shadowCall"),new a.t("graph")),p=(new a.t("formula"),new a.t("appUrl"),new a.t("graphUrl"),new a.t("batchUploaderType"),new a.t("vroomItemIdentityProcessor"),new a.t("preAuth"),new a.t("peopleService"),new a.t("schema")),m=(new a.t("restore"),new a.t("restore"),new a.t("restoreActivities"),new a.t("inAppMessaging"),new a.t("notificationSettings"),new a.t("itemInvalidator"));new a.t("itemUpdator"),new a.t("wopiFrame"),new a.t("wrs"),new a.t("excel"),new a.t("winAppCommunicator"),new a.t("wip"),new a.t("worker"),new a.t("checkUserAccessDataSource"),new a.t("userExpiration"),new a.t("itemMuteNotificationDataSource"),new a.t("ticketRedeemer"),new a.t("recommendList"),new a.t("reportAbuse"),new a.t("requestReview"),new a.t("removeFromShareWithMeList")},function(e,t,n){"use strict";(function(e){var a;n.d(t,"e",function(){return O});var i,r="undefined",o="prototype",s="function",c="_dynClass",d="_unknown_",l=Object,u=l.getPrototypeOf,f=l.getOwnPropertyNames,p=(typeof globalThis!==r&&(i=globalThis),i||typeof self===r||(i=self),i||typeof window===r||(i=window),i||typeof e===r||(i=e),i||{}),m=p.__dynProto$Gbl||(p.__dynProto$Gbl={o:(a={},a.setInstFuncs=!0,a.useBaseInst=!0,a),n:1e3});function _(e,t){return e&&l.prototype.hasOwnProperty.call(e,t)}function h(e){return e&&(e===l.prototype||e===Array.prototype)}function b(e){return h(e)||e===Function.prototype}function g(e){var t;if(e){if(u)return u(e);var n=e.__proto__||e.prototype||(e.constructor?e.constructor.prototype:null);t=e._dyn__proto__||n,_(e,"_dyn__proto__")||(delete e._dynInstProto,t=e._dyn__proto__=e._dynInstProto||e._dyn__proto__,e._dynInstProto=n)}return t}function v(e,t){var n=[];if(f)n=f(e);else for(var a in e)"string"==typeof a&&_(e,a)&&n.push(a);if(n&&n.length>0)for(var i=0;i<n.length;i++)t(n[i])}function y(e,t,n){return"constructor"!==t&&typeof e[t]===s&&(n||_(e,t))}function S(e){throw new TypeError("DynamicProto: "+e)}function D(e,t){for(var n=e.length-1;n>=0;n--)if(e[n]===t)return!0;return!1}function I(e,t,n,a){var i=null;if(e&&_(n,c)){var r=e._dynInstFuncs||{};if((i=(r[n._dynClass]||{})[t])||S("Missing ["+t+"] "+s),!i._dynInstChk&&!1!==r._dynInstChk){for(var o=!_(e,t),d=g(e),l=[];o&&d&&!b(d)&&!D(l,d);){var u=d[t];if(u){o=u===a;break}l.push(d),d=g(d)}try{o&&(e[t]=i),i._dynInstChk=1}catch(e){r._dynInstChk=!1}}}return i}function x(e,t,n){var a=t[e];return a===n&&(a=g(t)[e]),typeof a!==s&&S("["+e+"] is not a "+s),a}function C(e,t){return _(e,o)?e.name||t||d:((e||{}).constructor||{}).name||t||d}function O(e,t,n,a){_(e,o)||S("theClass is an invalid class definition.");var i=e.prototype;(function(e,t){if(u){for(var n=[],a=g(t);a&&!b(a)&&!D(n,a);){if(a===e)return!0;n.push(a),a=g(a)}return!1}return!0})(i,t)||S("["+C(e)+"] not in hierarchy of ["+C(t)+"]");var r=null;_(i,c)?r=i._dynClass:(r="_dynCls$"+C(e,"_")+"$"+m.n,m.n++,i._dynClass=r);var s=O._dfOpts,d=!!s.useBaseInst;d&&a&&void 0!==a.useBaseInst&&(d=!!a.useBaseInst);var l=function(e){var t={};return v(e,function(n){!t[n]&&y(e,n,!1)&&(t[n]=e[n])}),t}(t),f=function(e,t,n,a){function i(e,t,n){var i=t[n];if(i._isDynProxy&&a){var r=e._dynInstFuncs||{};!1!==r._dynInstChk&&(i=(r[t._dynClass]||{})[n]||i)}return function(){return i.apply(e,arguments)}}var r={};v(n,function(e){r[e]=i(t,n,e)});for(var o=g(e),s=[];o&&!b(o)&&!D(s,o);)v(o,function(e){!r[e]&&y(o,e,!u)&&(r[e]=i(t,o,e))}),s.push(o),o=g(o);return r}(i,t,l,d);n(t,f);var p=!!u&&!!s.setInstFuncs;p&&a&&(p=!!a.setInstFuncs),function(e,t,n,a,i){if(!h(e)){var r=n._dynInstFuncs=n._dynInstFuncs||{},o=r[t]=r[t]||{};!1!==r._dynInstChk&&(r._dynInstChk=!!i),v(n,function(t){y(n,t,!1)&&n[t]!==a[t]&&(o[t]=n[t],delete n[t],(!_(e,t)||e[t]&&!e[t]._isDynProxy)&&(e[t]=function(e,t){var n=function(){return(I(this,t,e,n)||x(t,e,n)).apply(this,arguments)};return n._isDynProxy=1,n}(e,t)))})}}(i,r,t,l,!1!==p)}O._dfOpts=m.o}).call(this,n(193))},,function(e,t,n){"use strict";var a;!function(e){e[e.Files=0]="Files",e[e.Recent=1]="Recent",e[e.DocumentLibraries=2]="DocumentLibraries",e[e.SharedWithMe=3]="SharedWithMe",e[e.DocsInCommon=4]="DocsInCommon",e[e.RecycleBin=5]="RecycleBin",e[e.Photos=6]="Photos",e[e.Search=7]="Search",e[e.AllMyPhotos=8]="AllMyPhotos",e[e.AccountChooserPicker=9]="AccountChooserPicker",e[e.AccountChooserMobileSDK=10]="AccountChooserMobileSDK",e[e.Popular=11]="Popular",e[e.RecentUnpopular=12]="RecentUnpopular",e[e.SecondStageRecycleBin=13]="SecondStageRecycleBin",e[e.Apps=14]="Apps",e[e.Subsites=15]="Subsites",e[e.RecentActivity=18]="RecentActivity",e[e.ExternallyShared=19]="ExternallyShared",e[e.SharedByMe=20]="SharedByMe",e[e.Favorites=21]="Favorites",e[e.DetailsPane=22]="DetailsPane",e[e.Channels=24]="Channels",e[e.PhotoStream=25]="PhotoStream",e[e.PhoneLink=26]="PhoneLink",e[e.DefaultDocLib=27]="DefaultDocLib",e[e.ListSyncIssues=28]="ListSyncIssues",e[e.OneDriveHome=29]="OneDriveHome",e[e.TeamsDownloads=30]="TeamsDownloads",e[e.MyLists=31]="MyLists",e[e.Selection=32]="Selection",e[e.People=33]="People",e[e.Meetings=34]="Meetings",e[e.RecentLists=35]="RecentLists",e[e.MyOrganizationAssets=36]="MyOrganizationAssets",e[e.LargestFiles=37]="LargestFiles",e[e.StockImages=38]="StockImages",e[e.Bing=39]="Bing"}(a||(a={})),t.e=a},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"r",function(){return i}),n.d(t,"i",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"n",function(){return s}),n.d(t,"t",function(){return c});var a=String.fromCharCode(9),i="OneUp",r="/next",o="shorturl",s="linknotsupported",c=("https://".concat("onedrive.live.com","/edit.aspx"),"photos.onedrive.com")},,,function(e,t,n){"use strict";var a;!function(e){e[e.File=0]="File",e[e.Folder=1]="Folder",e[e.Media=2]="Media",e[e.OneNote=3]="OneNote",e[e.Unknown=4]="Unknown",e[e.Error=5]="Error",e[e.App=6]="App",e[e.Subsite=7]="Subsite",e[e.Shortcut=8]="Shortcut",e[e.Album=9]="Album",e[e.MultiShare=10]="MultiShare"}(a||(a={}));var i=a;t.e=i},,function(e,t,n){"use strict";n.d(t,"t",function(){return l}),n.d(t,"i",function(){return u}),n.d(t,"e",function(){return f}),n.d(t,"n",function(){return p}),n.d(t,"a",function(){return m});var a=n(17),i=n(31),r=n(1),o=n(179),s=n(2);function c(e){return e?'"'+e.replace(/\"/g,s.i)+'"':s.i}function d(e,t){var n=Object(a.t)();if(n){var i="log";n[e]&&(i=e),Object(r.p)(n[i])&&n[i](t)}}var l=function(){function e(e,t,n,i){void 0===n&&(n=!1);var r=this;r.messageId=e,r.message=(n?"AI: ":"AI (Internal): ")+e;var o=s.i;Object(a.f)()&&(o=Object(a.r)().stringify(i));var d=(t?" message:"+c(t):s.i)+(i?" props:"+c(o):s.i);r.message+=d}return e.dataType="MessageData",e}();function u(e,t){return(e||{}).logger||new f(t)}var f=function e(t){this.identifier="DiagnosticLogger",this.queue=[];var n=0,s={};Object(i.e)(e,this,function(e){function i(e,n){var a=t[e];return Object(r.h)(a)?n:a}function c(e,n){var a=Object(o.e)(t);a&&a.diagLog&&a.diagLog(e,n)}Object(r.h)(t)&&(t={}),e.consoleLoggingLevel=function(){return i("loggingLevelConsole",0)},e.telemetryLoggingLevel=function(){return i("loggingLevelTelemetry",1)},e.maxInternalMessageLimit=function(){return i("maxMessageLimit",25)},e.enableDebugExceptions=function(){return i("enableDebugExceptions",!1)},e.throwInternal=function(t,n,i,o,d){void 0===d&&(d=!1);var u=new l(n,i,d,o);if(e.enableDebugExceptions())throw Object(a.e)(u);var f=1===t?"errorToConsole":"warnToConsole";if(Object(r.D)(u.message))c("throw"+(1===t?"Critical":"Warning"),u);else{var p=e.consoleLoggingLevel();if(d){var m=+u.messageId;!s[m]&&p>=t&&(e[f](u.message),s[m]=!0)}else p>=t&&e[f](u.message);e.logInternalMessage(t,u)}},e.warnToConsole=function(e){d("warn",e),c("warning",e)},e.errorToConsole=function(e){d("error",e),c("error",e)},e.resetInternalMessageCount=function(){n=0,s={}},e.logInternalMessage=function(t,a){if(!(n>=e.maxInternalMessageLimit())){var i=!0,r="AITR_"+a.messageId;if(s[r]?i=!1:s[r]=!0,i&&(t<=e.telemetryLoggingLevel()&&(e.queue.push(a),n++,c(1===t?"error":"warn",a)),n===e.maxInternalMessageLimit())){var o="Internal events throttle limit per PageView reached for this app.",d=new l(23,o,!1);e.queue.push(d),1===t?e.errorToConsole(o):e.warnToConsole(o)}}}})};function p(e,t,n,a,i,r){void 0===r&&(r=!1),(e||new f).throwInternal(t,n,a,i,r)}function m(e,t){(function(e){return e||new f})(e).warnToConsole(t)}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(34),i=n(284);function r(e){var t,n=((t={id:(e=e||{}).id||"root",cid:e.cid||a.t,driveId:e.driveId||"",groupId:e.groupId||"",qt:"".concat(e.qt||"").toLowerCase(),did:e.did||"",q:e.q||"",sft:e.sft||"",beginDate:e.beginDate||"",endDate:e.endDate||"",ft:e.ft||"",ext:e.ext||"",df:e.df||"",sp:e.sp||"",ocid:e.ocid||""})["WT.mc_id"]=e["WT.mc_id"]||"",t.locationFilter=e.locationFilter||"",t.tagFilter=e.tagFilter||"",t.onThisDay=e.onThisDay||"",t.onThisMonth=e.onThisMonth||"",t.lastWeekPreviousYears=e.lastWeekPreviousYears||"",t.scope=e.scope||"",t.useUtilityFiltering=void 0===e.useUtilityFiltering?"":e.useUtilityFiltering,t.startDate=e.startDate||"",t.internalPath=e.internalPath||"",t.psId=e.psId||"",t.u=e.u||"",t.searchsessionid=e.searchsessionid||"",t.mojDate=e.mojDate||"",t.moj=e.moj||"",t.acType=e.acType||"",t.psPostId=e.psPostId||"",t.psRIds=e.psRIds||"",t.pssc=e.pssc||"",t);return Object(i.e)(n,void 0,!0)}},function(e,t,n){"use strict";n.d(t,"t",function(){return u}),n.d(t,"n",function(){return f}),n.d(t,"a",function(){return p}),n.d(t,"i",function(){return m}),n.d(t,"e",function(){return _});var a=n(42),i=n(1),r=n(108),o=n(17),s=n(2),c=n(53),d=0;function l(e,t,n,r){var s=null,c=[];null!==r&&(s=r?function(e,t,n){for(;e;){if(e.getPlugin()===n)return e;e=e.getNext()}return m([n],t.config||{},t)}(e,n,r):e);var d={_next:function(){var e=s;if(s=e?e.getNext():null,!e){var t=c;t&&t.length>0&&(Object(i.e)(t,function(e){try{e.func.call(e.self,e.args)}catch(e){Object(a.n)(n.logger,2,73,"Unexpected Exception during onComplete - "+Object(o.e)(e))}}),c=[])}return e},ctx:{core:function(){return n},diagLog:function(){return Object(a.i)(n,t)},getCfg:function(){return t},getExtCfg:l,getConfig:function(e,n,a){void 0===a&&(a=!1);var r,o=l(e,null);return o&&!Object(i.h)(o[n])?r=o[n]:t&&!Object(i.h)(t[n])&&(r=t[n]),Object(i.h)(r)?a:r},hasNext:function(){return!!s},getNext:function(){return s},setNext:function(e){s=e},iterate:function(e){for(var t;t=d._next();){var n=t.getPlugin();n&&e(n)}},onComplete:function(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];e&&c.push({func:e,self:Object(i.D)(t)?d.ctx:t,args:n})}}};function l(e,n,a){var r;if(void 0===n&&(n={}),void 0===a&&(a=0),t){var o=t.extensionConfig;o&&e&&(r=o[e])}if(r){if(Object(i.g)(n)&&0!==a){var s=Object(i.C)(!0,n,r);t&&2===a&&Object(i.O)(n,function(e){if(Object(i.h)(s[e])){var n=t[e];Object(i.h)(n)||(s[e]=n)}}),r=s}}else r=n;return r}return d}function u(e,t,n,a){var r=l(e,t,n,a),o=r.ctx;return o.processNext=function(e){var t=r._next();return t&&t.processTelemetry(e,o),!t},o.createNew=function(e,a){return void 0===e&&(e=null),Object(i.d)(e)&&(e=m(e,t,n,a)),u(e||o.getNext(),t,n,a)},o}function f(e,t,n){var a=t.config||{},r=l(e,a,t,n),o=r.ctx;return o.processNext=function(e){var t=r._next();return t&&t.unload(o,e),!t},o.createNew=function(e,n){return void 0===e&&(e=null),Object(i.d)(e)&&(e=m(e,a,t,n)),f(e||o.getNext(),t,n)},o}function p(e,t,n){var a=t.config||{},r=l(e,a,t,n).ctx;return r.processNext=function(e){return r.iterate(function(t){Object(i.p)(t.update)&&t.update(r,e)})},r.createNew=function(e,n){return void 0===e&&(e=null),Object(i.d)(e)&&(e=m(e,a,t,n)),p(e||r.getNext(),t,n)},r}function m(e,t,n,l){var f=null,p=!l;if(Object(i.d)(e)&&e.length>0){var _=null;Object(i.e)(e,function(e){if(p||l!==e||(p=!0),p&&e&&Object(i.p)(e.processTelemetry)){var m=function(e,t,n){var l,f=null,p=Object(i.p)(e.processTelemetry),m=Object(i.p)(e.setNextPlugin),_={getPlugin:function(){return e},getNext:function(){return f},processTelemetry:function(a,r){h(r=r||function(){var a;return e&&Object(i.p)(e._getTelCtx)&&(a=e._getTelCtx()),a||(a=u(_,t,n)),a}(),function(t){if(!e||!p)return!1;var n=Object(c.e)(e);return!n.teardown&&!n[s.n]&&(m&&e.setNextPlugin(f),e.processTelemetry(a,t),!0)},"processTelemetry",function(){return{item:a}},!a.sync)||r.processNext(a)},unload:function(t,n){h(t,function(){var a=!1;if(e){var i=Object(c.e)(e),r=e[s.t]||i.core;!e||r&&r!==t[s.t]()||i[s.b]||(i[s.t]=null,i[s.b]=!0,i[s.c]=!1,e[s.b]&&!0===e[s.b](t,n)&&(a=!0))}return a},"unload",function(){},n.isAsync)||t.processNext(n)},update:function(t,n){h(t,function(){var a=!1;if(e){var i=Object(c.e)(e),r=e[s.t]||i.core;!e||r&&r!==t[s.t]()||i[s.b]||e[s.g]&&!0===e[s.g](t,n)&&(a=!0)}return a},"update",function(){},!1)||t.processNext(n)},_id:l=e?e.identifier+"-"+e.priority+"-"+d++:"Unknown-0-"+d++,_setNext:function(e){f=e}};function h(t,n,i,c,d){var u=!1,p=e?e.identifier:"TelemetryPluginChain",m=t._hasRun;return m||(m=t._hasRun={}),t.setNext(f),e&&Object(r.t)(t[s.t](),function(){return p+":"+i},function(){m[l]=!0;try{var e=f?f._id:s.i;e&&(m[e]=!1),u=n(t)}catch(e){var r=!f||m[f._id];r&&(u=!0),f&&r||Object(a.n)(t.diagLog(),1,73,"Plugin ["+p+"] failed during "+i+" - "+Object(o.e)(e)+", run flags: "+Object(o.e)(m))}},c,d),u}return Object(i.w)(_)}(e,t,n);f||(f=m),_&&_._setNext(m),_=m}})}return l&&!f?m([l],t,n):f}var _=function(e,t,n,a){var r=u(e,t,n,a);Object(i.k)(this,r,Object(i.E)(r))}},function(e,t,n){"use strict";n.d(t,"i",function(){return p}),n.d(t,"a",function(){return m}),n.d(t,"t",function(){return _}),n.d(t,"e",function(){return h}),n.d(t,"n",function(){return b});var a=n(17),i=n(1),r=n(2),o=4294967296,s=4294967295,c=!1,d=123456789,l=987654321;function u(e){e<0&&(e>>>=0),d=123456789+e&s,l=987654321-e&s,c=!0}function f(){try{var e=2147483647&Object(i.i)();u((Math.random()*o^e)+e)}catch(e){}}function p(e){return e>0?Math.floor(m()/s*(e+1))>>>0:0}function m(e){var t=0,n=Object(a.n)()||Object(a.s)();return n&&n.getRandomValues&&(t=n.getRandomValues(new Uint32Array(1))[0]&s),0===t&&Object(a._)()&&(c||f(),t=h()&s),0===t&&(t=Math.floor(o*Math.random()|0)),e||(t>>>=0),t}function _(e){e?u(e):f()}function h(e){var t=((l=36969*(65535&l)+(l>>16)&s)<<16)+(65535&(d=18e3*(65535&d)+(d>>16)&s))>>>0&s|0;return e||(t>>>=0),t}function b(e){void 0===e&&(e=22);for(var t=m()>>>0,n=0,a=r.i;a.length<e;)n++,a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&t),t>>>=6,5===n&&(t=(m()<<2&4294967295|3&t)>>>0,n=0);return a}},,,function(e,t,n){"use strict";n.d(t,"n",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"e",function(){return s});var a,i=(a=[],{fireEvent:function(e){a.forEach(function(t){return t(e)})},addListener:function(e){e&&a.push(e)}});function r(){return i}function o(e,t,n){i.fireEvent({level:e,category:t,message:n})}function s(e,t,n){o(0,e,function(){var e=n instanceof Error?n.message:"";return"".concat(t,": ").concat(e)})}},,,,function(e,t,n){"use strict";function a(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]}n.d(t,"e",function(){return a})},function(e,t,n){"use strict";n.d(t,"e",function(){return s}),n.d(t,"t",function(){return c}),n.d(t,"n",function(){return d});var a=n(1),i=n(2),r=n(99),o=Object(r.e)("plugin");function s(e){return o.get(e,"state",{},!0)}function c(e,t){for(var n,r=[],o=null,c=e.getNext();c;){var d=c.getPlugin();d&&(o&&Object(a.p)(o[i.h])&&Object(a.p)(d[i.p])&&o[i.h](d),(Object(a.p)(d[i.c])?d[i.c]():(n=s(d))[i.c])||r.push(d),o=d,c=c.getNext())}Object(a.e)(r,function(a){var r=e.core();a.initialize(e.getCfg(),r,t,e.getNext()),n=s(a),a[i.t]||n[i.t]||(n[i.t]=r),n[i.c]=!0,delete n[i.b]})}function d(e){return e.sort(function(e,t){var n=0,r=Object(a.p)(t[i.p]);return Object(a.p)(e[i.p])?n=r?e[i.u]-t[i.u]:1:r&&(n=-1),n})}},function(e,t,n){"use strict";n.d(t,"e",function(){return _}),n.d(t,"a",function(){return b}),n.d(t,"n",function(){return g}),n.d(t,"t",function(){return v}),n.d(t,"i",function(){return C});var a=n(17),i=n(1),r=n(2),o=n(42),s="toGMTString",c="toUTCString",d=null,l=null,u=null,f=Object(a.a)(),p={},m={};function _(e,t){var n=g._ckMgr||m._ckMgr;return n||(n=g._ckMgr=g(e,t),m._ckMgr=n),n}function h(e){return!e||e.isEnabled()}function b(e,t){var n;if(e)n=e.getCookieMgr();else if(t){var a=t.cookieCfg;n=a._ckMgr?a._ckMgr:g(t)}return n||(n=_(t,(e||{}).logger)),n}function g(e,t){var n=function(e){var t=e.cookieCfg=e.cookieCfg||{};if(Object(i.M)(t,"domain",e.cookieDomain,i.m,i.h),Object(i.M)(t,"path",e.cookiePath||"/",null,i.h),Object(i.h)(t.enabled)){var n=void 0;Object(i.D)(e.isCookieUseDisabled)||(n=!e.isCookieUseDisabled),Object(i.D)(e.disableCookiesUsage)||(n=!e.disableCookiesUsage),t.enabled=n}return t}(e||m),o=n.path||"/",d=n.domain,u=!1!==n.enabled,f={isEnabled:function(){var e=u&&v(t),n=m._ckMgr;return e&&n&&f!==n&&(e=h(n)),e},setEnabled:function(e){u=!1!==e},set:function(e,t,u,p,m){var _=!1;if(h(f)){var b={},g=Object(i.F)(t||r.i),v=g.indexOf(";");if(-1!==v&&(g=Object(i.F)(t.substring(0,v)),b=y(t.substring(v+1))),Object(i.M)(b,"domain",p||d,i.y,i.D),!Object(i.h)(u)){var I=Object(a._)();if(Object(i.D)(b.expires)){var O=Object(i.i)()+1e3*u;if(O>0){var w=new Date;w.setTime(O),Object(i.M)(b,"expires",S(w,I?s:c)||S(w,I?s:c)||r.i,i.y)}}I||Object(i.M)(b,"max-age",r.i+u,null,i.D)}var E=Object(a.o)();E&&"https:"===E.protocol&&(Object(i.M)(b,"secure",null,null,i.D),null===l&&(l=!C((Object(a.c)()||{}).userAgent)),l&&Object(i.M)(b,"SameSite","None",null,i.D)),Object(i.M)(b,"path",m||o,null,i.D),(n.setCookie||x)(e,D(g,b)),_=!0}return _},get:function(e){var t=r.i;return h(f)&&(t=(n.getCookie||I)(e)),t},del:function(e,t){var n=!1;return h(f)&&(n=f.purge(e,t)),n},purge:function(e,i){var o,s=!1;if(v(t)){var c=((o={}).path=i||"/",o.expires="Thu, 01 Jan 1970 00:00:01 GMT",o);Object(a._)()||(c["max-age"]="0"),(n.delCookie||x)(e,D(r.i,c)),s=!0}return s}};return f._ckMgr=f,f}function v(e){if(null===d){d=!1;try{d=void 0!==(f||{}).cookie}catch(t){Object(o.n)(e,2,68,"Cannot access document.cookie - "+Object(i.o)(t),{exception:Object(a.e)(t)})}}return d}function y(e){var t={};if(e&&e.length){var n=Object(i.F)(e).split(";");Object(i.e)(n,function(e){if(e=Object(i.F)(e||r.i)){var n=e.indexOf("=");-1===n?t[e]=null:t[Object(i.F)(e.substring(0,n))]=Object(i.F)(e.substring(n+1))}})}return t}function S(e,t){return Object(i.p)(e[t])?e[t]():null}function D(e,t){var n=e||r.i;return Object(i.O)(t,function(e,t){n+="; "+e+(Object(i.h)(t)?r.i:"="+t)}),n}function I(e){var t=r.i;if(f){var n=f.cookie||r.i;u!==n&&(p=y(n),u=n),t=Object(i.F)(p[e]||r.i)}return t}function x(e,t){f&&(f.cookie=e+"="+t)}function C(e){return!(!Object(i.v)(e)||!Object(i.P)(e,"CPU iPhone OS 12")&&!Object(i.P)(e,"iPad; CPU OS 12")&&!(Object(i.P)(e,"Macintosh; Intel Mac OS X 10_14")&&Object(i.P)(e,"Version/")&&Object(i.P)(e,"Safari"))&&(!Object(i.P)(e,"Macintosh; Intel Mac OS X 10_14")||!Object(i.T)(e,"AppleWebKit/605.1.15 (KHTML, like Gecko)"))&&!Object(i.P)(e,"Chrome/5")&&!Object(i.P)(e,"Chrome/6")&&(!Object(i.P)(e,"UnrealEngine")||Object(i.P)(e,"Chrome"))&&!Object(i.P)(e,"UCBrowser/12")&&!Object(i.P)(e,"UCBrowser/11"))}},,,function(e,t,n){var a;!function(i,r){"use strict";var o=function(e){if("object"!=typeof e.document)throw new Error("Cookies.js requires a `window` with a `document` object");var t=function(e,n,a){return 1===arguments.length?t.get(e):t.set(e,n,a)};return t._document=e.document,t._cacheKeyPrefix="cookey.",t._maxExpireDate=new Date("Fri, 31 Dec 9999 23:59:59 UTC"),t.defaults={path:"/",secure:!1},t.get=function(e){return t._cachedDocumentCookie!==t._document.cookie&&t._renewCache(),t._cache[t._cacheKeyPrefix+e]},t.set=function(e,n,a){return(a=t._getExtendedOptions(a)).expires=t._getExpiresDate(n===r?-1:a.expires),t._document.cookie=t._generateCookieString(e,n,a),t},t.expire=function(e,n){return t.set(e,r,n)},t._getExtendedOptions=function(e){return{path:e&&e.path||t.defaults.path,domain:e&&e.domain||t.defaults.domain,expires:e&&e.expires||t.defaults.expires,secure:e&&e.secure!==r?e.secure:t.defaults.secure}},t._isValidDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())},t._getExpiresDate=function(e,n){if(n=n||new Date,"number"==typeof e?e=e===1/0?t._maxExpireDate:new Date(n.getTime()+1e3*e):"string"==typeof e&&(e=new Date(e)),e&&!t._isValidDate(e))throw new Error("`expires` parameter cannot be converted to a valid Date instance");return e},t._generateCookieString=function(e,t,n){var a=(e=(e=e.replace(/[^#$&+\^`|]/g,encodeURIComponent)).replace(/\(/g,"%28").replace(/\)/g,"%29"))+"="+(t=(t+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent));return a+=(n=n||{}).path?";path="+n.path:"",a+=n.domain?";domain="+n.domain:"",(a+=n.expires?";expires="+n.expires.toUTCString():"")+(n.secure?";secure":"")},t._getCacheFromString=function(e){for(var n={},a=e?e.split("; "):[],i=0;i<a.length;i++){var o=t._getKeyValuePairFromCookieString(a[i]);n[t._cacheKeyPrefix+o.key]===r&&(n[t._cacheKeyPrefix+o.key]=o.value)}return n},t._getKeyValuePairFromCookieString=function(e){var t=e.indexOf("=");return t=t<0?e.length:t,{key:decodeURIComponent(e.substr(0,t)),value:decodeURIComponent(e.substr(t+1))}},t._renewCache=function(){t._cache=t._getCacheFromString(t._document.cookie),t._cachedDocumentCookie=t._document.cookie},t._areEnabled=function(){var e="cookies.js",n="1"===t.set(e,1).get(e);return t.expire(e),n},t.enabled=t._areEnabled(),t},s="object"==typeof i.document?o(i):o;(a=function(){return s}.call(t,n,t,e))===r||(e.exports=a)}("undefined"==typeof window?this:window)},,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Global=void 0;var a,i=n(141),r=n(240),o=n(197),s=n(67);(a=t.Global||(t.Global={})).telemetryLogger=new s.TelemetryLogger,a.envConfigs={},a.envConfigs[i.Environment[i.Environment.WorldWide]]=new r.EnvConfig(o.AbtHost.abtWorldWideSvc,!0,!0),a.envConfigs[i.Environment[i.Environment.Pathfinder]]=new r.EnvConfig(o.AbtHost.abtPathfinderSvc,!1,!0),a.envConfigs[i.Environment[i.Environment.Trailblazer]]=new r.EnvConfig(o.AbtHost.abtTrailblazer,!1,!0)},function(e,t,n){"use strict";n.r(t),n.d(t,"Contracts",function(){return f}),n.d(t,"Result",function(){return S.d}),n.d(t,"Activity",function(){return S.e}),n.d(t,"User",function(){return S.u}),n.d(t,"Funnel",function(){return S.r}),n.d(t,"UserAction",function(){return S.f}),n.d(t,"Platform",function(){return S.s}),n.d(t,"App",function(){return S.t}),n.d(t,"Session",function(){return S.l}),n.d(t,"HealthQosError",function(){return S.o}),n.d(t,"AudienceGroup",function(){return S.a}),n.d(t,"Release",function(){return S.c}),n.d(t,"Copilot",function(){return S.i}),n.d(t,"Asha",function(){return S.n}),n.d(t,"CV",function(){return D}),n.d(t,"makeBooleanDataField",function(){return u.e}),n.d(t,"makeInt64DataField",function(){return u.a}),n.d(t,"makeDoubleDataField",function(){return u.t}),n.d(t,"makeStringDataField",function(){return u.i}),n.d(t,"makeGuidDataField",function(){return u.n}),n.d(t,"getEffectiveEventFlags",function(){return x}),n.d(t,"onNotification",function(){return I.n}),n.d(t,"logNotification",function(){return I.t}),n.d(t,"logError",function(){return I.e}),n.d(t,"SuppressNexus",function(){return C.t}),n.d(t,"cloneEvent",function(){return C.n}),n.d(t,"SimpleTelemetryLogger",function(){return C.e}),n.d(t,"TelemetryLogger",function(){return L}),n.d(t,"EnumObjects",function(){return E}),n.d(t,"sendHealthQosError",function(){return k});var a,i,r,o,s,c,d,l,u=n(13);(a||(a={})).getFields=function(e,t){var n=[];return n.push(Object(u.a)("".concat(e,".Code"),t.code)),void 0!==t.type&&n.push(Object(u.i)("".concat(e,".Type"),t.type)),void 0!==t.tag&&n.push(Object(u.a)("".concat(e,".Tag"),t.tag)),void 0!==t.isExpected&&n.push(Object(u.e)("".concat(e,".IsExpected"),t.isExpected)),n.push(Object(u.i)("zC.Activity.Result","Office.System.Result")),n},(r=i||(i={})).contractName="Office.System.Activity",r.getFields=function(e){var t="Activity",n=[];return void 0!==e.cV&&n.push(Object(u.i)("".concat(t,".CV"),e.cV)),n.push(Object(u.a)("".concat(t,".Duration"),e.duration)),n.push(Object(u.a)("".concat(t,".Count"),e.count)),n.push(Object(u.a)("".concat(t,".AggMode"),e.aggMode)),void 0!==e.success&&n.push(Object(u.e)("".concat(t,".Success"),e.success)),void 0!==e.result&&n.push.apply(n,a.getFields("".concat(t,".Result"),e.result)),n.push(Object(u.i)("zC.Activity",r.contractName)),n},(o||(o={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(Object(u.i)("".concat(e,".Id"),t.id)),void 0!==t.version&&n.push(Object(u.i)("".concat(e,".Version"),t.version)),void 0!==t.sessionId&&n.push(Object(u.i)("".concat(e,".SessionId"),t.sessionId)),n},(s||(s={})).getFields=function(e,t){var n=[];return void 0!==t.alias&&n.push(Object(u.i)("".concat(e,".Alias"),t.alias)),void 0!==t.primaryIdentityHash&&n.push(Object(u.i)("".concat(e,".PrimaryIdentityHash"),t.primaryIdentityHash)),void 0!==t.primaryIdentitySpace&&n.push(Object(u.i)("".concat(e,".PrimaryIdentitySpace"),t.primaryIdentitySpace)),void 0!==t.tenantId&&n.push(Object(u.i)("".concat(e,".TenantId"),t.tenantId)),void 0!==t.tenantGroup&&n.push(Object(u.i)("".concat(e,".TenantGroup"),t.tenantGroup)),void 0!==t.isAnonymous&&n.push(Object(u.e)("".concat(e,".IsAnonymous"),t.isAnonymous)),n},(c||(c={})).getFields=function(e,t){var n=[];return void 0!==t.name&&n.push(Object(u.i)("".concat(e,".Name"),t.name)),void 0!==t.state&&n.push(Object(u.i)("".concat(e,".State"),t.state)),n},(d||(d={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(Object(u.a)("".concat(e,".Id"),t.id)),void 0!==t.name&&n.push(Object(u.i)("".concat(e,".Name"),t.name)),void 0!==t.commandSurface&&n.push(Object(u.i)("".concat(e,".CommandSurface"),t.commandSurface)),void 0!==t.parentName&&n.push(Object(u.i)("".concat(e,".ParentName"),t.parentName)),void 0!==t.triggerMethod&&n.push(Object(u.i)("".concat(e,".TriggerMethod"),t.triggerMethod)),void 0!==t.timeOffsetMs&&n.push(Object(u.a)("".concat(e,".TimeOffsetMs"),t.timeOffsetMs)),n},(l||(l={})).getFields=function(e,t){var n=[];return n.push(Object(u.i)("".concat(e,".ErrorGroup"),t.errorGroup)),n.push(Object(u.a)("".concat(e,".Tag"),t.tag)),void 0!==t.code&&n.push(Object(u.a)("".concat(e,".Code"),t.code)),void 0!==t.id&&n.push(Object(u.a)("".concat(e,".Id"),t.id)),void 0!==t.count&&n.push(Object(u.a)("".concat(e,".Count"),t.count)),n};var f,p=i,m=a,_=l,h=c,b=o,g=d,v=s;!function(e){var t,n;(n=(t=e.Office||(e.Office={})).System||(t.System={})).Activity=p,n.Result=m,n.Error=_,n.Funnel=h,n.Host=b,n.User=v,n.UserAction=g}(f||(f={}));var y,S=n(74),D=function(){function e(e){this.value=e,this.nextChild=0}return e.prototype.getNext=function(){return new e("".concat(this.value,".").concat(++this.nextChild))},e}(),I=n(48);function x(e){var t={costPriority:1,samplingPolicy:1,persistencePriority:1,dataCategories:0,diagnosticLevel:100};return e.eventFlags&&e.eventFlags.dataCategories||Object(I.t)(0,0,function(){return"DataCategories"}),e.eventFlags?(e.eventFlags.costPriority&&(t.costPriority=e.eventFlags.costPriority),e.eventFlags.samplingPolicy&&(t.samplingPolicy=e.eventFlags.samplingPolicy),e.eventFlags.persistencePriority&&(t.persistencePriority=e.eventFlags.persistencePriority),e.eventFlags.dataCategories&&(t.dataCategories=e.eventFlags.dataCategories),e.eventFlags.diagnosticLevel&&(t.diagnosticLevel=e.eventFlags.diagnosticLevel),t):t}var C=n(93),O=n(0),w=function(){return 1e3*Date.now()};"object"==typeof window&&"object"==typeof window.performance&&"now"in window.performance&&(w=function(){return 1e3*Math.floor(window.performance.now())});var E,A=function(e){var t,n=w(),a=Object(C.n)(e.telemetryEvent);return{cv:e.parentCv.getNext(),eventName:e.telemetryEvent.eventName,dataFields:a.dataFields,eventFlags:a.eventFlags,telemetryProperties:a.telemetryProperties,createChildActivity:function(t){return A({telemetryEvent:t,sendTelemetryEvent:e.sendTelemetryEvent,parentCv:this.cv})},setResult:function(e,t,n){this.result={code:e,type:t,tag:n}},endNow:function(){if(!t){void 0===this.success&&void 0===this.result&&Object(I.t)(1,0,function(){return"Activity does not have success or result set"});var a=w();t=!0;var i={duration:a-n,count:1,aggMode:0,cV:this.cv.value,success:this.success,result:this.result},r=this.eventContract&&this.eventContract.dataFields?this.eventContract.dataFields:[];return r.push.apply(r,S.e.getFields(i)),this.eventContract={name:S.e.contractName,dataFields:r},e.sendTelemetryEvent(this)}Object(I.t)(0,0,function(){return"Already ended"})}}},L=function(e){function t(t,n,a){var i=e.call(this,t,n,a)||this;return i.baseCv=function(){if(!y){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=[],n=0;n<22;n++)t.push(e.charAt(Math.floor(Math.random()*e.length)));y=new D(t.join(""))}return y}(),i}return Object(O.a)(t,e),t.prototype.createActivity=function(e){return A({sendTelemetryEvent:this.sendTelemetryEvent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t.prototype.sendActivity=function(e,t,n,a){return this.sendTelemetryEvent({eventName:e,eventContract:{name:S.e.contractName,dataFields:S.e.getFields(t)},dataFields:n,eventFlags:a})},t.prototype.sendError=function(e){var t=function(e){var t="Error",n=[];return n.push(Object(u.i)("".concat(t,".ErrorGroup"),e.errorGroup)),n.push(Object(u.a)("".concat(t,".Tag"),e.tag)),void 0!==e.code&&n.push(Object(u.a)("".concat(t,".Code"),e.code)),void 0!==e.id&&n.push(Object(u.a)("".concat(t,".Id"),e.id)),void 0!==e.count&&n.push(Object(u.a)("".concat(t,".Count"),e.count)),n}(e.error);return null!=e.dataFields&&t.push.apply(t,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:t,eventFlags:e.eventFlags})},t.prototype.createCustomerContentActivity=function(e){return A({sendTelemetryEvent:this.sendCustomerContent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t}(C.e);function k(e,t,n,a,i,r,o,s,c,d,l){a.forEach(function(a){e.sendTelemetryEvent({eventName:t.name+".Qos.Error."+n,eventFlags:{diagnosticLevel:110},dataFields:Object(O.o)(Object(O.o)([],S.o.getFields({veto:a,pillar:i,isIntentional:r,isInternal:o,alertOnPillar:s,isSessionEndingError:c,inStaging:d}),!0),l||[],!0),telemetryProperties:{ariaTenantToken:t.token,nexusTenantToken:C.t}})})}!function(e){e.DataClassification={EssentialServiceMetadata:1,AccountData:2,SystemMetadata:4,OrganizationIdentifiableInformation:8,EndUserIdentifiableInformation:16,CustomerContent:32,AccessControl:64,PublicNonPersonalData:128,EndUserPseudonymousInformation:256,PublicPersonalData:512,SupportData:1024,DirectMeasurementData:2048,Everything:65535},e.DataFieldType={String:0,Boolean:1,Int64:2,Double:3,Guid:4},e.SamplingPolicy={NotSet:0,Measure:1,Diagnostics:2,CriticalBusinessImpact:191,CriticalCensus:192,CriticalExperimentation:193,CriticalUsage:194},e.PersistencePriority={NotSet:0,Normal:1,High:2},e.CostPriority={NotSet:0,Normal:1,High:2},e.DataCategories={NotSet:0,SoftwareSetup:1,ProductServiceUsage:2,ProductServicePerformance:4,DeviceConfiguration:8,InkingTypingSpeech:16},e.DiagnosticLevel={ReservedDoNotUse:0,Required:10,BasicEvent:10,Optional:100,FullEvent:100,RequiredServiceData:110,NecessaryServiceDataEvent:110,RequiredServiceDataForEssentialServices:120,AlwaysOnNecessaryServiceDataEvent:120},e.DnmInterval={Hourly:1,Daily:2},e.AllowedPartA={ReleaseAudienceGroup:1,WacRing:2,AppName:3,AppPlatform:4,AppVersion:5},e.CustomerContentType={None:0,MocaAddIn:1},e.LogLevel={Error:0,Warning:1,Info:2,Verbose:3},e.Category={Core:0,Sink:1,Transport:2},e.PrimaryIdentitySpace={UserObjectId:"UserObjectId",MSACID:"MSACID",OrgIdPuid:"OrgIdPuid",OrgIdPUID:"OrgIdPUID",OrgIdCID:"OrgIdCID",MsaPuid:"MsaPuid",MSAPUID:"MSAPUID",WopiAuth:"WopiAuth",ThirdParty:"ThirdParty",Other:"Other"},e.AudienceGroup={Automation:"Automation",Dogfood:"Dogfood",Microsoft:"Microsoft",Insiders:"Insiders",Production:"Production"}}(E||(E={}))},,,function(e,t,n){"use strict";var a=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),i=0;for(t=0;t<n;t++)for(var r=arguments[t],o=0,s=r.length;o<s;o++,i++)a[i]=r[o];return a};Object.defineProperty(t,"__esModule",{value:!0}),t.LoggingUtils=void 0;var i=n(141),r=n(196),o=n(67),s=n(315),c=n(241),d=n(90),l=n(242),u=n(79),f=n(66);!function(e){function t(e,t,a){return!(t||(null==e||void 0===e||""===e?(n(!0,a)&&console.error("eventName param cannot null, undefined or empty."),1):void 0===f.Global.gAbtEnableLogging||!1===f.Global.gAbtEnableLogging||!f.Global.gIsAbtAriaLoggingInitialized&&(n(!0,a)&&console.warn("Aria logging is not initialized"),1)))}function n(e,n){return!(n||void 0===f.Global.gAbtEnableLogging||!1===f.Global.gAbtEnableLogging||!d.LocalStorageUtils.findItemWithValue(u.AbtStorageId.enableConsoleLogging,u.AbtStorageValue.enableConsoleLogging.toString(),e,!0)&&(t("LoggingUtils",e,!0)&&p("Console logging is not initialized","LoggingUtils",c.EventLevel.warning,"shouldLogToConsole","",0),1))}function p(e,t,n,a,i,r){if(null!=n&&void 0!==n&&(n===c.EventLevel.info||n===c.EventLevel.warning||n===c.EventLevel.error)){var s=i&&""!=i?i:m();f.Global.telemetryLogger.sendTelemetryEvent({eventName:l.LogAttributes.defaultLoggingNamespace+t,eventFlags:{dataCategories:2,diagnosticLevel:10},dataFields:[o.makeStringDataField(l.LogAttributes.messageDataField,e),o.makeStringDataField(l.LogAttributes.levelDataField,n),o.makeStringDataField(l.LogAttributes.correlationIdDataField,s),o.makeStringDataField(l.LogAttributes.actionDataField,null!==a||void 0!==a||""!==a?a:"Empty"),o.makeStringDataField(l.LogAttributes.timeoutDataField,r.toString())]})}}function m(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}function _(e){return r.AuthType[e]==r.AuthType[r.AuthType.Aad]?"OrgIdPuid":r.AuthType[e]==r.AuthType[r.AuthType.Msa]?"MsaPuid":void 0}function h(e){return r.AuthType[e]==r.AuthType[r.AuthType.Aad]?"Enterprise":r.AuthType[e]==r.AuthType[r.AuthType.Msa]?"Consumer":void 0}e.initializeAriaLogging=function(e,t,n,r,c,d,l){if(!l[i.Environment[d]].isAriaEnabled)return!1;var u=o.SuppressNexus;f.Global.telemetryLogger.setTenantToken("Office.WebAuth","bfd38fb74e1b467495106a7dd7b35f27-1110120f-6282-4b11-8fe0-299b50c9309d-7071",u);var p=a(o.User.getFields({primaryIdentityHash:e,primaryIdentitySpace:_(t),tenantGroup:h(t),tenantId:c,isAnonymous:!1}),o.App.getFields({name:n}),o.Session.getFields({id:r})),m=new s.OneDSSink(p,{endpointUrl:s.OneDSEndpoint.PUBLIC});return f.Global.telemetryLogger.addSink(m),!0},e.log=function(e,a,i,r,o,s,d){void 0===i&&(i=""),void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===s&&(s=""),void 0===d&&(d=0),t(a,r,o)&&p(e,a,c.EventLevel.info,i,s,d),n(r,o)&&console.log(e)},e.warn=function(e,a,i,r,o,s,d){void 0===i&&(i=""),void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===s&&(s=""),void 0===d&&(d=0),t(a,r,o)&&p(e,a,c.EventLevel.warning,i,s,d),n(r,o)&&console.warn(e)},e.error=function(e,a,i,r,o,s,d){void 0===i&&(i=""),void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===s&&(s=""),void 0===d&&(d=0),t(a,r,o)&&p(e,a,c.EventLevel.error,i,s,d),n(r,o)&&console.error(e)},e.getRandomGuid=m}(t.LoggingUtils||(t.LoggingUtils={}))},,,,function(e,t,n){"use strict";n.d(t,"d",function(){return d}),n.d(t,"e",function(){return l}),n.d(t,"u",function(){return u}),n.d(t,"r",function(){return f}),n.d(t,"f",function(){return p}),n.d(t,"s",function(){return c}),n.d(t,"t",function(){return _}),n.d(t,"l",function(){return h}),n.d(t,"o",function(){return b}),n.d(t,"a",function(){return m}),n.d(t,"c",function(){return y}),n.d(t,"i",function(){return g}),n.d(t,"n",function(){return v});var a=n(13);function i(e,t){return e?e+"."+t:t}function r(e,t,n,r,o){void 0===o&&(o=4),r&&e.push(Object(a.i)("".concat(i(t,n)),r,o))}function o(e,t,n,r){"boolean"==typeof r&&e.push(Object(a.e)("".concat(i(t,n)),r))}function s(e,t,n,r){"number"==typeof r&&e.push(Object(a.a)("".concat(i(t,n)),r))}var c,d={getFields:function(e){var t="Activity.Result",n=[];return s(n,t,"Code",e.code),r(n,t,"Type",e.type),s(n,t,"Tag",e.tag),o(n,t,"IsExpected",e.isExpected),n.push(Object(a.i)("zC.Activity.Result","Office.System.Result")),n}},l={contractName:"Office.System.Activity",getFields:function(e){var t="Activity",n=[];return r(n,t,"CV",e.cV),s(n,t,"Duration",e.duration),s(n,t,"Count",e.count),s(n,t,"AggMode",e.aggMode),o(n,t,"Success",e.success),e.result&&n.push.apply(n,d.getFields(e.result)),n.push(Object(a.i)("zC.Activity",this.contractName)),n}},u={getFields:function(e){var t="User",n=[];return r(n,t,"PrimaryIdentityHash",e.primaryIdentityHash),r(n,t,"PrimaryIdentitySpace",e.primaryIdentitySpace),r(n,t,"TenantId",e.tenantId,1),r(n,t,"TenantGroup",e.tenantGroup,1),o(n,t,"IsAnonymous",e.isAnonymous),o(n,t,"IsSignedIn",e.isSignedIn),n}},f={getFields:function(e,t){var n=[];return r(n,e,"Name",t.name),r(n,e,"State",t.state),n}},p={getFields:function(e){var t="UserAction",n=[];return s(n,t,"Id",e.id),r(n,t,"Name",e.name),r(n,t,"CommandSurface",e.commandSurface),r(n,t,"ParentName",e.parentName),r(n,t,"TriggerMethod",e.triggerMethod),s(n,t,"TimeOffsetMs",e.timeOffsetMs),n}};!function(e){e.Web="Web",e.Desktop="Desktop",e.Universal="Universal",e.Mobile="Mobile",e.Win32="Win32",e.iOS="iOS",e.Android="Android"}(c||(c={}));var m,_={getFields:function(e){var t="App",n=[];return r(n,t,"Name",e.name,1),r(n,t,"Platform",e.platform,1),r(n,t,"Version",e.version,1),n}},h={getFields:function(e){var t="Session",n=[];return r(n,t,"Id",e.id,1),r(n,t,"EcsETag",e.ecsETag,1),n}},b={getFields:function(e){var t=[];return t.push(Object(a.i)("Pillar",e.pillar)),t.push(Object(a.i)("Veto",e.veto)),t.push(Object(a.e)("IsIntentional",e.isIntentional)),t.push(Object(a.e)("IsInternal",e.isInternal)),t.push(Object(a.e)("AlertOnPillar",e.alertOnPillar)),t.push(Object(a.e)("IsSessionEndingError",e.isSessionEndingError)),o(t,void 0,"InStaging",e.inStaging),t}};!function(e){e.Automation="Automation",e.Dogfood="Dogfood",e.Microsoft="Microsoft",e.Insiders="Insiders",e.Production="Production"}(m||(m={}));var g,v,y={getFields:function(e){var t=[];return r(t,"Release","AudienceGroup",e.audienceGroup,1),t}};!function(e){var t,n,i,s="Copilot";(i=e.FeatureActionType||(e.FeatureActionType={})).IsEnabled="IsEnabled",i.IsSeen="IsSeen",i.IsTried="IsTried",i.IsKept="IsKept",i.IsRejected="IsRejected",(n=e.Capability||(e.Capability={})).ContentGeneration="Content Generation",n.Commanding="Commanding",n.QAandSummaries="QA and Summaries",n.Collaboration="Collaboration",n.Suggestions="Suggestions",(t=e.EntryPoint||(e.EntryPoint={})).Chat="Chat",t.Canvas="Canvas",e.getFields=function(e){var t=[];return r(t,s,"FeatureActionType",e.featureActionType),o(t,s,"IsUserInitiated",e.isUserInitiated),r(t,s,"FeatureName",e.featureName),r(t,s,"Capability",e.capability),o(t,s,"IsThumbsUp",e.isThumbsUp),r(t,s,"EntryPoint",e.entryPoint),t.push(Object(a.i)("zC.".concat(s),"Office.System.Copilot")),t}}(g||(g={})),function(e){var t,n="Asha";(t=e.EventType||(e.EventType={})).Pillar="Pillar",t.Error="Error",e.getFields=function(e){var t=[];return r(t,n,"EventType",e.eventType),r(t,n,"Pillar",e.pillar),r(t,n,"Scenario",e.scenario),r(t,n,"Veto",e.veto),r(t,n,"Error",e.error),o(t,n,"InStaging",e.inStaging),o(t,n,"IsSessionEndingError",e.isSessionEndingError),o(t,n,"IsIntentional",e.isIntentional),o(t,n,"IsInternal",e.isInternal),t.push(Object(a.i)("zC.".concat(n),"Office.System.Asha")),t}}(v||(v={}))},,,function(e,t,n){"use strict";var a;!function(e){e[e.AlbumRoot=0]="AlbumRoot",e[e.TagsRoot=1]="TagsRoot",e[e.Album=2]="Album",e[e.Tag=3]="Tag",e[e.FaceRoot=4]="FaceRoot",e[e.Location=5]="Location"}(a||(a={})),t.e=a},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbtStorageValue=t.AbtStorageId=void 0;var a=function(){function e(){}return e.inFlight="AbtInFlight",e.abtActivity="AbtActivity",e.localAvailable="AbtLocalAvailable",e.enableConsoleLogging="AbtEnableConsoleLogging",e.enableAriaLogLogging="AbtEnableAriaLogLogging",e.enableDebug="AbtEnableDebug",e}();t.AbtStorageId=a;var i=function(){function e(){}return e.inFlight="1",e.enableConsoleLogging="true",e.enableAriaLogLogging="true",e.enableDebug="true",e.localAvailable="AbtLocalAvailable",e}();t.AbtStorageValue=i},function(e,t,n){"use strict";var a=n(236);n.d(t,"e",function(){return a.e})},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(7),i=n(106),r=n(33),o=n(128);function s(e){return"photos"===e.v}function c(e){return"allmyphotos"===e.qt||"allmyphotos"===e.parQt}var d={allmyphotos:r.e.AllMyPhotos,mru:r.e.Recent,recyclebin:r.e.RecycleBin,sharedby:r.e.SharedWithMe,sharedbyme:r.e.SharedByMe,search:r.e.Search,selection:r.e.Selection,people:r.e.People,photostream:r.e.PhotoStream,largestfiles:r.e.LargestFiles};function l(e){var t=Object(i.e)(Object(o.e)(e)).qt;return(t?d[t]:void 0)||(function(e){return"places"===e.id&&s(e)}(e)||function(e){return"tags"===e.id&&s(e)}(e)||!a.e.isActivated("4D0BEE0C-FCE7-4D8F-B6C7-3BC94830A252")&&(function(e){return"albums"===e.id&&s(e)}(e)||function(e){return!!e.id&&"albums"!==e.id&&"tags"!==e.id&&"places"!==e.id&&!!e.cid&&s(e)&&!c(e)}(e)||function(e){return!!e.locationFilter&&s(e)}(e)||function(e){return c(e)&&!!e.tagFilter&&s(e)}(e))?r.e.AllMyPhotos:"/picker/accountchooser"===document.location.pathname.toLowerCase()?"false"===e.load_login?r.e.AccountChooserMobileSDK:r.e.AccountChooserPicker:r.e.Files)}},,,function(e,t,n){"use strict";(function(e){n.d(t,"e",function(){return r}),n.d(t,"n",function(){return o}),n.d(t,"t",function(){return s});var a=n(6),i=null;function r(t){return void 0===t&&(t=!0),i&&t||(typeof globalThis!==a.u&&globalThis&&(i=globalThis),typeof self!==a.u&&self&&(i=self),typeof window!==a.u&&window&&(i=window),typeof e!==a.u&&e&&(i=e)),i}function o(e){throw new TypeError(e)}function s(e){var t=a.n;if(t)return t(e);if(null==e)return{};var n=typeof e;function i(){}return n!==a.d&&n!==a.s&&o("Object prototype may only be an Object:"+e),i[a.l]=e,new i}}).call(this,n(193))},function(e,t,n){"use strict";n.d(t,"o",function(){return x}),n.d(t,"i",function(){return w}),n.d(t,"r",function(){return E}),n.d(t,"e",function(){return A}),n.d(t,"a",function(){return M}),n.d(t,"d",function(){return P}),n.d(t,"t",function(){return T}),n.d(t,"s",function(){return U}),n.d(t,"n",function(){return F}),n.d(t,"c",function(){return H});var a=n(99),i=n(17),r=n(1),o="events",s="visibilitychange",c="pagehide",d="pageshow",l="unload",u="beforeunload",f=Object(a.t)("aiEvtPageHide"),p=Object(a.t)("aiEvtPageShow"),m=/\.[\.]+/g,_=/[\.]+$/,h=1,b=Object(a.e)("events"),g=/^([^.]*)(?:\.(.+)|)/;function v(e){return e&&e.replace?e.replace(/^\s*\.*|\.*\s*$/g,""):e}function y(e,t){if(t){var n="";Object(r.d)(t)?(n="",Object(r.e)(t,function(e){(e=v(e))&&("."!==e[0]&&(e="."+e),n+=e)})):n=v(t),n&&("."!==n[0]&&(n="."+n),e=(e||"")+n)}var a=g.exec(e||"")||[];return{type:a[1],ns:(a[2]||"").replace(m,".").replace(_,"").split(".").sort().join(".")}}function S(e,t,n){void 0===n&&(n=!0);var a=b.get(e,o,{},n),i=a[t];return i||(i=a[t]=[]),i}function D(e,t,n,a){e&&t&&t.type&&(e.removeEventListener?e.removeEventListener(t.type,n,a):e.detachEvent&&e.detachEvent("on"+t.type,n))}function I(e,t,n,a){for(var i=t.length;i--;){var r=t[i];r&&(n.ns&&n.ns!==r.evtName.ns||a&&!a(r)||(D(e,r.evtName,r.handler,r.capture),t.splice(i,1)))}}function x(e,t){return t?y("xx",Object(r.d)(t)?[e].concat(t):[e,t]).ns.split("."):e}function C(e,t,n,a,i){void 0===i&&(i=!1);var r=!1;if(e)try{var o=y(t,a);if(r=function(e,t,n,a){var i=!1;return e&&t&&t.type&&n&&(e.addEventListener?(e.addEventListener(t.type,n,a),i=!0):e.attachEvent&&(e.attachEvent("on"+t.type,n),i=!0)),i}(e,o,n,i),r&&b.accept(e)){var s={guid:h++,evtName:o,handler:n,capture:i};S(e,o.type).push(s)}}catch(e){}return r}function O(e,t,n,a,i){if(void 0===i&&(i=!1),e)try{var s=y(t,a),c=!1;!function(e,t,n){if(t.type)I(e,S(e,t.type),t,n);else{var a=b.get(e,o,{});Object(r.O)(a,function(a,i){I(e,i,t,n)}),0===Object(r.E)(a).length&&b.kill(e,o)}}(e,s,function(e){return!((!s.ns||n)&&e.handler!==n||(c=!0,0))}),c||D(e,s,n,i)}catch(e){}}function w(e,t,n,a){return void 0===a&&(a=!1),C(e,t,n,null,a)}function E(e,t,n,a){void 0===a&&(a=!1),O(e,t,n,null,a)}function A(e,t,n){var a=!1,r=Object(i.l)();r&&(a=C(r,e,t,n),a=C(r.body,e,t,n)||a);var o=Object(i.a)();return o&&(a=C(o,e,t,n)||a),a}function L(e,t,n,a){var i=!1;return t&&e&&e.length>0&&Object(r.e)(e,function(e){e&&(n&&-1!==Object(r.t)(n,e)||(i=A(e,t,a)||i))}),i}function k(e,t,n){e&&Object(r.d)(e)&&Object(r.e)(e,function(e){e&&function(e,t,n){var a=Object(i.l)();a&&(O(a,e,t,n),O(a.body,e,t,n));var r=Object(i.a)();r&&O(r,e,t,n)}(e,t,n)})}function M(e,t,n){return function(e,t,n,a){var i=!1;return t&&e&&Object(r.d)(e)&&!(i=L(e,t,n,a))&&n&&n.length>0&&(i=L(e,t,null,a)),i}([u,l,c],e,t,n)}function P(e,t){k([u,l,c],e,t)}function T(e,t,n){var a=x(f,n),o=L([c],e,t,a);return t&&-1!==Object(r.t)(t,s)||(o=L([s],function(t){var n=Object(i.a)();e&&n&&"hidden"===n.visibilityState&&e(t)},t,a)||o),!o&&t&&(o=T(e,null,n)),o}function U(e,t){var n=x(f,t);k([c],e,n),k([s],null,n)}function F(e,t,n){var a=x(p,n),r=L([d],e,t,a);return!(r=L([s],function(t){var n=Object(i.a)();e&&n&&"visible"===n.visibilityState&&e(t)},t,a)||r)&&t&&(r=F(e,null,n)),r}function H(e,t){var n=x(p,t);k([d],e,n),k([s],null,n)}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalStorageUtils=void 0;var a=n(70),i=n(79),r=n(66);!function(e){var t="LocalStorageUtils";function n(e,n){void 0===e&&(e=!1),void 0===n&&(n=!1);var o="isAvailable",s=!!e||r.Global.gAbtSkipAriaLog;a.LoggingUtils.log("Start checking if local storage is available.",t,o,s,n);try{return localStorage.setItem(i.AbtStorageId.localAvailable,i.AbtStorageValue.localAvailable),localStorage.removeItem(i.AbtStorageId.localAvailable),!0}catch(i){return a.LoggingUtils.error("Local storage not available. Details:  "+i,t,o,e,n),!1}}function o(e,i,o){void 0===i&&(i=!1),void 0===o&&(o=!1);var s="getItemValue",c=!!i||r.Global.gAbtSkipAriaLog;if(a.LoggingUtils.log("Start getting an item from local storage.",t,s,c,o),null==e)return a.LoggingUtils.warn("name param should not be null or undefined.",t,s,i,o),null;if(!n(i,o))return a.LoggingUtils.warn("Local storage is not available. Returning null.",t,s,i,o),null;a.LoggingUtils.log("Looking for "+e+" storage item.",t,s,c,o);try{var d=localStorage.getItem(e);return null===d?(a.LoggingUtils.warn("Didn't find '"+e+"' item in the storage.",t,s,i,o),null):d}catch(n){return a.LoggingUtils.error("Error thrown when trying to get '"+e+"' item from the local storage.",t,s,i,o),null}}e.getItemValue=o,e.findItemWithValue=function(e,i,s,c){void 0===s&&(s=!1),void 0===c&&(c=!1);var d="findItemWithValue",l=!!s||r.Global.gAbtSkipAriaLog;if(a.LoggingUtils.log("Start finding an item in local storage.",t,d,l,c),null==e)return a.LoggingUtils.warn("name param should not be null or undefined.",t,d,s,c),!1;if(null==i)return a.LoggingUtils.warn("value param should not be null or undefined.",t,d,s,c),!1;if(!n(s,c))return a.LoggingUtils.warn("Local storage is not available. Returning false.",t,d,s,c),!1;var u=o(e,s,c);return null===u?(a.LoggingUtils.warn("Didn't find value associated with '"+e+"' storage item in local storage.",t,d,s,c),!1):u===i||(a.LoggingUtils.error("Value associated with '"+e+"' is different than needed.",t,d,s,c),!1)},e.tryCreateItem=function(e,i,o,s){void 0===o&&(o=!1),void 0===s&&(s=!1);var c="tryCreateItem",d=!!o||r.Global.gAbtSkipAriaLog;if(a.LoggingUtils.log("Start creating an item in local storage.",t,c,d,s),null==e)return a.LoggingUtils.warn("name param should not be null or undefined.",t,c,o,s),!1;if(null==i)return a.LoggingUtils.warn("value param should not be null or undefined.",t,c,o,s),!1;if(!n(o,s))return a.LoggingUtils.warn("Local storage is not available. Returning false.",t,c,o,s),!1;try{return a.LoggingUtils.log("Creating "+e+" in local storage.",t,c,d,s),localStorage.setItem(e,i),!0}catch(n){return a.LoggingUtils.error("Error was thrown when creating "+e+" item in local storage.",t,c,o,s),!1}},e.tryDeleteItem=function(e,i,o){void 0===i&&(i=!1),void 0===o&&(o=!1);var s="tryDeleteItem",c=!!i||r.Global.gAbtSkipAriaLog;if(a.LoggingUtils.log("Start deleting an item in local storage.",t,s,c,o),null==e)return a.LoggingUtils.warn("name param should not be null or undefined.",t,s,i,o),!1;if(!n(i,o))return a.LoggingUtils.warn("Local storage is not available. Returning false.",t,s,i,o),!1;try{return a.LoggingUtils.log("Deleting "+e+" from local storage.",t,s,c,o),localStorage.removeItem(e),!0}catch(n){return a.LoggingUtils.error("Error was thrown when deleting "+e+" item from local storage.",t,s,i,o),!1}},e.convertActivitiesToRecords=function(e,n,i){void 0===n&&(n=!1),void 0===i&&(i=!1);var o,s="convertActivitiesToRecords",c=!!n||r.Global.gAbtSkipAriaLog;if(a.LoggingUtils.log("Start converting activities from local storage into records.",t,s,c,i),null==e||void 0===e||""===e)return a.LoggingUtils.warn("Input parameters not in expected format.",t,s,n,i),null;try{o=JSON.parse(e)}catch(e){return a.LoggingUtils.error("Exception occurred while parsing activities data from local storage to IAbtRecords. Returning null. Exception details: "+e.message+".",t,s,n,i),null}return void 0===o?(a.LoggingUtils.error("Couldn't parse provided activities data. Returning null.",t,s,n,i),null):o}}(t.LocalStorageUtils||(t.LocalStorageUtils={}))},function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(279),i=window._spPageContextInfo,r=function(e){if(i&&i.farmSettings)return i.farmSettings[e]},o=function(e){return e.serviceSetting?(t=e.serviceSetting,1===Number(r(t))||"true"===r(t)):a.n.isFeatureEnabled(e);var t}},,function(e,t,n){"use strict";n.d(t,"t",function(){return p}),n.d(t,"n",function(){return m}),n.d(t,"e",function(){return _});var a=n(0),i=n(48),r={};function o(e,t){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?r[e]?(t.ariaTenantToken&&(r[e].ariaTenantToken=t.ariaTenantToken),t.dnmToken&&(r[e].dnmToken=t.dnmToken)):r[e]=t:Object(i.t)(0,0,function(){return"Namespace: ".concat(e)})}function s(e,t){for(var n=e.length;n>0;){var a=e.substr(0,n);if(r[a]){var i=r[a];return t.ariaTenantToken=i.ariaTenantToken,t.dnmToken=i.dnmToken,!0}n=e.lastIndexOf(".",n-1)}return!1}var c=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,d=/^[a-zA-Z0-9_\.]{1,95}$/;function l(e){return d.test(e)}function u(e){e&&e.forEach(function(e){if("string"!=typeof e.name||!l(e.name))throw new Error("Invalid dataField name");2===e.dataType&&function(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<-9007199254740991||e>9007199254740991)throw new Error("Invalid integer ".concat(JSON.stringify(e)))}(e.value)})}var f=n(13),p=-1;function m(e){var t={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?Object(a.e)({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t}var _=function(){function e(e,t,n){var i,r,o;this.telemetrySinks=[],this.persistentDataFields=[],this.partAFields=[],this.eventQueue=[],this.config=n||{},e&&(this.telemetrySinks=e.telemetrySinks,(i=this.persistentDataFields).push.apply(i,e.persistentDataFields),this.config=Object(a.e)(Object(a.e)({},e.getConfig()),this.config),(r=this.partAFields).push.apply(r,e.partAFields)),t&&(o=this.persistentDataFields).push.apply(o,t)}return e.prototype.addEventContentType=function(e,t){e.push(Object(f.a)("EventContent.Type",t))},e.prototype.sendTelemetryEvent=function(e){var t=m(e),n=t.telemetryProperties;n.nexusTenantToken=p;var a=n.ariaTenantToken;a||s(t.eventName,n)||a?this.sendTelemetryEventInternal(t,1):Object(i.t)(0,0,function(){return"No tenant token: "+e.eventName})},e.prototype.sendCustomerContent=function(e){var t=m(e),n=t.telemetryProperties,a=n.customerContentVersion;return(!a||a>2)&&(n.customerContentVersion=2),n.ariaTenantToken=void 0,n.nexusTenantToken=void 0,n.dnmToken=void 0,this.addEventContentType(t.dataFields,2),this.sendTelemetryEventInternal(t,2)},e.prototype.sendDirectNumericEvent=function(e){var t=m(e),n=t.telemetryProperties;n.dnmToken||s(t.eventName,n)||n.dnmToken?(this.addEventContentType(t.dataFields,1),this.sendTelemetryEventInternal(t,3)):Object(i.t)(0,0,function(){return"No dnm token: "+t.eventName})},e.prototype.sendTelemetryEventInternal=function(e,t){if(2===t||!e.telemetryProperties.customerContentVersion&&!e.telemetryProperties.customerContentType){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push([e,t]):Object(i.t)(1,0,function(){return"No telemetry sinks are attached."}));this.processTelemetryEvent(e,t)}catch(e){return void Object(i.e)(0,"SendTelemetryEvent",e)}this.telemetrySinks.forEach(function(n){try{3===t||2===t?n.sendNonStandardEvent&&n.sendNonStandardEvent(e,t):n.sendTelemetryEvent(e)}catch(e){}})}else Object(i.t)(0,0,function(){return"Customer content"})},e.prototype.processTelemetryEvent=function(e,t){var n,a,i;if(e.dataFields&&(null===(i=e.dataFields)||void 0===i||i.unshift(Object(f.i)("OTelJS.Version","4.17.1")),3!==t&&this.persistentDataFields&&(n=e.dataFields).unshift.apply(n,this.persistentDataFields)),this.partAFields.length>0){var r=e.eventContract||{name:"",dataFields:[]};(a=r.dataFields).push.apply(a,this.partAFields),e.eventContract=r}this.config.disableValidation||function(e){if(!(t=e.eventName)||t.length>98||!c.test(t))throw new Error("Invalid eventName");var t,n=e.eventContract;if(n){if(n.name&&!l(n.name))throw new Error("Invalid eventContract");u(n.dataFields)}u(e.dataFields)}(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e),this.flushQueue()},e.prototype.flushQueue=function(){var e=this.eventQueue;if(this.eventQueue=[],this.telemetrySinks.length>0)for(var t=0,n=e;t<n.length;t++){var a=n[t],i=a[0],r=a[1];this.sendTelemetryEventInternal(i,r)}},e.prototype.setTenantToken=function(e,t,n){o(e,{ariaTenantToken:t,nexusTenantToken:n})},e.prototype.setDNMToken=function(e,t){o(e,{dnmToken:t})},e.prototype.cloneEvent=function(e){return m(e)},e.prototype.getConfig=function(){return this.config},e}()},,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return l}),n.d(t,"e",function(){return u});var a=n(6),i=n(1),r=n(45),o=a.a,s="."+Object(r.n)(6),c=0;function d(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType}function l(e,t){return void 0===t&&(t=!1),Object(i.I)(e+c+++(t?".2.8.3":"")+s)}function u(e){var t={id:l("_aiData-"+(e||"")+".2.8.3"),accept:function(e){return d(e)},get:function(e,n,a,r){var s=e[t.id];return s?s[Object(i.I)(n)]:(r&&((s=function(e,t){var n=t[e.id];if(!n){n={};try{d(t)&&(function(e,t,n){if(o)try{return o(e,t,{value:n,enumerable:!1,configurable:!0}),!0}catch(e){}return!1}(t,e.id,n)||(t[e.id]=n))}catch(e){}}return n}(t,e))[Object(i.I)(n)]=a),a)},kill:function(e,t){if(e&&e[t])try{delete e[t]}catch(e){}}};return t}},,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"t",function(){return c}),n.d(t,"n",function(){return d});var a=n(31),i=n(1),r=function(){function e(t,n,a){var r,o=this,s=!1;o.start=Object(i.i)(),o.name=t,o.isAsync=a,o.isChildEvt=function(){return!1},Object(i.p)(n)&&(s=Object(i.x)(o,"payload",function(){return!r&&Object(i.p)(n)&&(r=n(),n=null),r})),o.getCtx=function(t){return t?t===e.ParentContextKey||t===e.ChildrenContextKey?o[t]:(o.ctx||{})[t]:null},o.setCtx=function(t,n){t&&(t===e.ParentContextKey?(o[t]||(o.isChildEvt=function(){return!0}),o[t]=n):t===e.ChildrenContextKey?o[t]=n:(o.ctx=o.ctx||{})[t]=n)},o.complete=function(){var t=0,a=o.getCtx(e.ChildrenContextKey);if(Object(i.d)(a))for(var r=0;r<a.length;r++){var c=a[r];c&&(t+=c.time)}o.time=Object(i.i)()-o.start,o.exTime=o.time-t,o.complete=function(){},!s&&Object(i.p)(n)&&(o.payload=n())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),o=function e(t){this.ctx={},Object(a.e)(e,this,function(e){e.create=function(e,t,n){return new r(e,t,n)},e.fire=function(e){e&&(e.complete(),t&&Object(i.p)(t.perfEvent)&&t.perfEvent(e))},e.setCtx=function(t,n){t&&((e.ctx=e.ctx||{})[t]=n)},e.getCtx=function(t){return(e.ctx||{})[t]}})},s="CoreUtils.doPerf";function c(e,t,n,a,o){if(e){var c=e;if(Object(i.p)(c.getPerfMgr)&&(c=c.getPerfMgr()),c){var d=void 0,l=c.getCtx(s);try{if(d=c.create(t(),a,o)){if(l&&d.setCtx&&(d.setCtx(r.ParentContextKey,l),l.getCtx&&l.setCtx)){var u=l.getCtx(r.ChildrenContextKey);u||(u=[],l.setCtx(r.ChildrenContextKey,u)),u.push(d)}return c.setCtx(s,d),n(d)}}catch(e){d&&d.setCtx&&d.setCtx("exception",e)}finally{d&&c.fire(d),c.setCtx(s,l)}}}return n()}function d(){return null}},,function(e,t,n){"use strict";(function(e){n.d(t,"e",function(){return r}),n.d(t,"n",function(){return o}),n.d(t,"t",function(){return s});var a=n(19),i=null;function r(t){void 0===t&&(t=!0);var n=!1===t?null:i;return n||(typeof globalThis!==a.u&&(n=globalThis),n||typeof self===a.u||(n=self),n||typeof window===a.u||(n=window),n||typeof e===a.u||(n=e),i=n),n}function o(e){throw new TypeError(e)}function s(e){var t=a.n;if(t)return t(e);if(null==e)return{};var n=typeof e;function i(){}return n!==a.d&&n!==a.s&&o("Object prototype may only be an Object:"+e),i[a.l]=e,new i}}).call(this,n(193))},,,,,,,,,function(e,t,n){"use strict";n.d(t,"o",function(){return i}),n.d(t,"a",function(){return r}),n.d(t,"r",function(){return o}),n.d(t,"t",function(){return s}),n.d(t,"n",function(){return c}),n.d(t,"e",function(){return d}),n.d(t,"i",function(){return l});var a=n(4),i=(new a.t("provider.suiteNav"),new a.t("provider.peopleCard"),new a.t("provider.shareByLink"),new a.t("provider.groupsLeftNav"),new a.t("provider.publishingSiteProvider"),new a.t("provider.userInfo")),r=(new a.t("provider.tag"),new a.t("provider.photo"),new a.t("provider.notification"),new a.t("provider.notificationManager"),new a.t("provider.instrumentation")),o=new a.t("provider.teachingBubble"),s=new a.t("provider.embed"),c=(new a.t("provider.storageInfo"),new a.t("provider.storageOptions"),new a.t("provider.subscriptions"),new a.t("provider.customAction"),new a.t("provider.taxonomy"),new a.t("provider.thumbnail"),new a.t("provider.appsItem"),new a.t("provider.externallySharedItem")),d=(new a.t("provider.popularItem"),new a.t("provider.mostViewsItem"),new a.t("provider.mostViewersItem"),new a.t("provider.subsiteItem"),new a.t("provider.itemHistory"),new a.t("provider.spotlight"),new a.t("provider.error"),new a.t("provider.publish"),new a.t("provider.bundleLoader")),l=(new a.t("provider.upsell"),new a.t("provider.profile"),new a.t("provider.processFilters"),new a.t("provider.userState"));new a.t("provider.ransomwareDetection"),new a.t("provider.promotedPhotos"),new a.t("provider.site"),new a.t("provider.graphToken"),new a.t("provider.dragAndDropRobot"),new a.t("provider.recycleBin"),new a.t("provider.premiumState"),new a.t("provider.mruRecent"),new a.t("provider.userExpiration"),new a.t("provider.requestReview")},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(4),i=n(56),r=new a.t("identity");new a.t({name:"IdentityDataSource.key",loader:new i.t(function(){return n.ee([26],342).then(function(e){return e.resourceKey})})})},,function(e,t,n){"use strict";var a=n(0),i=n(232),r=function(e){function t(t,n){return e.call(this,t,n)||this}return Object(a.a)(t,e),t}(function(){function e(e,t){this.value=e,this.extraClasses=t}return e.prototype.getClass=function(){var e=this.value?Object(i.b)(this.value):void 0;return"ms-Icon ms-Icon--".concat(this.value," ").concat(e||"").concat(this.extraClasses?" "+this.extraClasses:"")},e.prototype.getExtraClasses=function(){return this.extraClasses},e.prototype.toString=function(){return this.value},e}());t.e=r},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(0),i=n(43);function r(e){var t=Object(a.e)({},e);return(t.parId||t.parQt||t.parCid)&&(delete t.id,delete t.qt,delete t.internalPath,t.parId&&(t.id=t.parId,delete t.parId),t.parQt&&(t.qt=t.parQt,delete t.parQt),t.parCid&&(t.cid=t.parCid,delete t.parCid)),delete t.u,Object(i.e)(t)}},function(e,t,n){"use strict";var a=n(316);t.e=a.e},function(e,t,n){"use strict";n.d(t,"e",function(){return I});var a=n(0),i=n(132),r=n(69),o=n(85),s=n(4),c=n(56),d=n(12),l=n(105),u=n(40);function f(e){var t;t={};for(var n=[],a=0,i=e;a<i.length;a++){var r=i[a],o="".concat(r);t[o]||(t[o]=!0,n.push(r))}return n}var p=n(211),m=n(24),_=Object(m.E)(m.h),h="token=",b="result=",g="item_write=",v="item=";function y(e){return e&&e.item&&e.item.peek().key}function S(e){e.isExpired=!0;var t=e.content,n=t.peek();n.groupings=null,n.items=[],t.valueHasMutated()}var D=function(e){function t(){var t=e.call(this,"ItemsStore")||this;return t._itemSetsKeys={},t._observables=new o.e({owner:t}),t._vaultItemsToPurge=[],window.odstore=t,t}return Object(a.a)(t,e),t.prototype.dispose=function(){this._observables.dispose()},t.prototype.setItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this._handleSetItem.apply(this,Object(a.o)([e],t,!1))},t.prototype.getItem=function(e){return this.getValue(v+e)},t.prototype.setItemSet=function(e,t){var n=b+e;this.setValue(n,t),this._itemSetsKeys[n]=1},t.prototype.getItemSetFromItemKey=function(e){var t;for(var n in this._itemSetsKeys){var a=(t=this.getValue(n)).content&&t.content.peek(),i=a&&a.items;if(i)for(var r=0,o=i;r<o.length;r++){var s=o[r];if(s&&s.peek().parentKey===e)return t}}},t.prototype.getItemSet=function(e){return this.getValue(b+e)},t.prototype.getAllItemSetKeys=function(){var e=[];for(var t in this._itemSetsKeys)e.push(t.slice(b.length));return e},t.prototype.setNextRequestToken=function(e,t,n){var a=h+t;n?this.setValue(a,n):this.remove(a)},t.prototype.getNextRequestToken=function(e){return this.getValue(h+e)},t.prototype.invalidateItem=function(e,t){var n=(void 0===t?{}:t).purgeCache,a=void 0!==n&&n;return this._handleItemInvalidation(e,this.getItem(e),a)},t.prototype.invalidateItemSet=function(e){var t=this.getValue(b+e);t&&S(t)},t.prototype.emptyAllOtherSets=function(e){var t;for(var n in this._itemSetsKeys)(t=this.getValue(n)).item&&(0===e.length||e.indexOf(t.item.peek().key)<0)&&S(t)},t.prototype.invalidateLocation=function(e){var t;for(var n in this._itemSetsKeys){var a=y(t=this.getValue(n));if(a){var i=d.e(a),r=i&&i.locationFilter;r&&r.indexOf(e)>=0&&(t.isExpired=!0)}}},t.prototype.invalidateTag=function(e){var t;for(var n in this._itemSetsKeys){var a=y(t=this.getValue(n));if(a){var i=d.e(a);i&&i.tagFilter===e&&(t.isExpired=!0)}}},t.prototype.invalidateAllPhotos=function(){var e;for(var t in this._itemSetsKeys){var n=(e=this.getValue(t)).item&&e.item.peek();n&&n.key&&n.key.indexOf("allmyphotos")>=0&&(e.isExpired=!0,this._invalidateItem(n))}},t.prototype.invalidateAllVault=function(){for(var e=0,t=Object(a.o)([],this._vaultItemsToPurge,!0);e<t.length;e++){var n=t[e],r=void 0;n.vault&&n.vault.root&&((r=new i.e(n.key)).name=n.name,r.displayName=n.displayName,r.dateModified=" ",r.folder={},r.vault={isLocked:!0,root:{}}),this._purgeItem(n,r)}this._vaultItemsToPurge=[]},t.prototype._handleItemInvalidation=function(e,t,n){var a=this;if(t){var i=t.peek(),r=!1,o=[];if(i)switch(o.push(i),i.type){case u.e.Folder:case u.e.Media:r=!0}for(var s in this._itemSetsKeys){var c=this.getValue(s),d=c.item&&c.item.peek(),l=d&&d.key;l&&(l===e||r&&l.indexOf("allmyphotos")>-1)&&(l===e?this.setNextRequestToken(e,c.key,""):o.push(d),c.isExpired=!0)}o.forEach(n?function(e){return a._purgeItem(e)}:function(e){return a._invalidateItem(e)})}},t.prototype._purgeItem=function(e,t){var n=t||new i.e(e.key);this.setItem(n)},t.prototype._invalidateItem=function(e){var t=new i.e(e.key);Object(p.e)(t,e),Object(p.e)(t,{revision:e.revision+1}),this.setItem(t)},t.prototype._handleSetItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=[];_&&!Object.isFrozen(e)&&Object.freeze(e),e.vault&&this._vaultItemsToPurge.push(e);for(var r=function(t){var n="".concat(v).concat(t),a=_?"".concat(g).concat(t):n,r=o.getValue(n),s=o.getValue(a);s?s(e):((s=o._observables.create(e)).equalityComparer=l.t,o.setValue(a,s),r=_?o._observables.pureCompute(function(){return s()}):s,o.setValue(n,r)),i.push(r)},o=this,s=0,c=f(Object(a.o)([e.key],t,!0));s<c.length;s++){var d=c[s];r(d)}return i[0]},t}(r.e),I=new s.t({name:"ItemsStore",factory:new c.a(D)})},,function(e,t,n){"use strict";var a=n(18);t.e=function(e){void 0===e&&(e=""),this.isDropEnabled=!1,this.permissions={High:0,Low:0},this.key=e,this.revision=0,this.queryType=a.e.Files,this.displayType=a.e.Files,this.isPlaceholder=!0,this.properties={},this.recycleBinProperties={},this.reputationProperties={},this.statistics={views:0,viewsUnique:0,viewsLast2Weeks:0,viewsLast2WeeksUnique:0,viewsLastWeek:0,viewsLastWeekUnique:0,viewsLastMonth:0,viewsLastMonthUnique:0},this.urls={},this.state={upload:{status:5},removing:!1}}},,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Environment=void 0;var a,i=n(240),r=n(197);!function(e){e[e.WorldWide=1]="WorldWide",e[e.Trailblazer=4]="Trailblazer",e[e.Pathfinder=5]="Pathfinder"}(a=t.Environment||(t.Environment={}));var o={};o[a[a.WorldWide]]=new i.EnvConfig(r.AbtHost.abtWorldWideSvc,!0,!0),o[a[a.Pathfinder]]=new i.EnvConfig(r.AbtHost.abtPathfinderSvc,!1,!0),o[a[a.Trailblazer]]=new i.EnvConfig(r.AbtHost.abtTrailblazer,!1,!0)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbtActions=void 0;var a=function(){function e(){}return e.update="UPDATE",e.signIn="SIGNIN",e.signOut="SIGNOUT",e.shouldPrompt="SHOULD_PROMPT",e.shouldSignOut="SHOULD_SIGNOUT",e}();t.AbtActions=a},function(e,t,n){"use strict";var a;function i(){try{return!!window.sessionStorage.getItem("_isOneDriveWinApp")}catch(e){return!1}}function r(){return void 0===a&&(a=-1!==navigator.userAgent.indexOf("OneDriveWinApp")||i()),a}n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r})},,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(4),i=new a.t("ODCUrlDataSource");new a.t("ODCRecycleBinDataSource"),new a.t("ODCItemDataSource")},,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return a}),n.d(t,"e",function(){return i});var a="iKey",i="extensionConfig"},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(33);function i(e){return e===a.e.Search}},,function(e,t,n){"use strict";n.d(t,"t",function(){return p}),n.d(t,"n",function(){return m}),n.d(t,"e",function(){return _});var a,i=n(6),r=n(87),o=n(54),s=n(17),c=n(1),d=n(88),l=n(45),u=n(2),f=null;function p(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(b,function(e){var t=0|Object(l.i)(15);return("x"===e?t:3&t|8).toString(16)})}function m(){var e=Object(s.d)();return e&&e.now?e.now():Object(c.i)()}function _(){for(var e,t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n=u.i,a=0;a<4;a++)n+=t[15&(e=Object(l.a)())]+t[e>>4&15]+t[e>>8&15]+t[e>>12&15]+t[e>>16&15]+t[e>>20&15]+t[e>>24&15]+t[e>>28&15];var i=t[8+(3&Object(l.a)())|0];return n.substr(0,8)+n.substr(9,4)+"4"+n.substr(13,3)+i+n.substr(16,3)+n.substr(19,12)}i.u;var h={_canUseCookies:void 0,isTypeof:c.S,isUndefined:c.D,isNullOrUndefined:c.h,hasOwnProperty:c.c,isFunction:c.p,isObject:c.g,isDate:c.u,isArray:c.d,isError:c.f,isString:c.v,isNumber:c.b,isBoolean:c.l,toISOString:c.R,arrForEach:c.e,arrIndexOf:c.t,arrMap:c.n,arrReduce:c.a,strTrim:c.F,objCreate:r.t,objKeys:c.E,objDefineAccessors:c.x,addEventHandler:d.e,dateNow:c.i,isIE:s._,disableCookies:function(){var e,t;(e=Object(o.e)(undefined,undefined),t=h._canUseCookies,null===f&&(f=[],a=t,Object(c.x)(h,"_canUseCookies",function(){return a},function(e){a=e,Object(c.e)(f,function(t){t.setEnabled(e)})})),-1===Object(c.t)(f,e)&&f.push(e),Object(c.l)(t)&&e.setEnabled(t),Object(c.l)(a)&&e.setEnabled(a),e).setEnabled(!1)},newGuid:p,perfNow:m,newId:l.n,randomValue:l.i,random32:l.a,mwcRandomSeed:l.t,mwcRandom32:l.e,generateW3CId:_},b=/[xy]/g;d.i,d.i,d.r,d.r},,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActivityUtils=void 0;var a=n(90),i=n(70),r=n(201),o=n(79),s=n(202),c=n(167),d=n(142),l=n(168),u=n(169),f=n(66);!function(e){var t="ActivityUtils";function n(e){var n="shouldSendActivityToServer";i.LoggingUtils.log("Start executing the check for should send activity to the server.",t,n,f.Global.gAbtSkipAriaLog);var r=a.LocalStorageUtils.convertActivitiesToRecords(a.LocalStorageUtils.getItemValue(o.AbtStorageId.abtActivity)),u=!1,p=void 0;if(null==r||null==r.records||void 0===r.records||r.records.length<=0)i.LoggingUtils.error("Didn't get data from local activities item. No need to send activity to the server for '"+e+"'.",t,n);else{for(var m=0,_=r.records;m<_.length;m++){var h=_[m];if(null!==h.userId&&void 0!==h.userId&&h.userId===e){var b=new Date;b.setMinutes(b.getMinutes()-s.AbtTimer.activityInterval/6e4);var g=void 0===h.activityDateTime||null===h.activityDateTime?void 0:new Date(h.activityDateTime),v=void 0===h.broadcastedActivityDateTime||null===h.broadcastedActivityDateTime?void 0:new Date(h.broadcastedActivityDateTime);if(null==b)return;if(void 0===g)continue;if(b.getTime()<g.getTime()&&void 0===v){i.LoggingUtils.log("Based on local data, activities must be sent to the server.\n\t\t\t\t\t\t\tDateTime to send new activities was '"+b.toUTCString()+"' and Current time is '"+(new Date).toUTCString()+"'.",t,n,f.Global.gAbtSkipAriaLog),u=!0,p=h;break}return void i.LoggingUtils.log("No need to send activities.\n\t\t\t\t\t\t\tActivities occurred before last update at '"+b.toUTCString()+"' and Current time is '"+(new Date).toUTCString()+"'.",t,n,f.Global.gAbtSkipAriaLog)}}u?(i.LoggingUtils.log("Sending activity to the server.",t,n,f.Global.gAbtSkipAriaLog),c.RequestUtils.sendPostRequest(p.userId,0,p.timeout,d.AbtActions.update,l.InFlightUtils.deleteItem,p),i.LoggingUtils.log("Finish executing the check for should send activity to the server.",t,n,f.Global.gAbtSkipAriaLog)):i.LoggingUtils.error("No activities were registered for the current user '"+e+"'. Not sending activity to the server.",t,n)}}function p(){i.LoggingUtils.log("Stop checking if activity need to be send to the server",t,"stopActivityChecks",f.Global.gAbtSkipAriaLog),f.Global.gAbtStartedActivityChecks=!1,clearInterval(f.Global.gAbtActivityTimer)}e.extendLocalActivity=function(e,n){var s="extendLocalActivity";if(i.LoggingUtils.log("Start extending the time of the local activity.",t,s,f.Global.gAbtSkipAriaLog),null==e||""===e||null==n||n<=0)i.LoggingUtils.error("Input parameters not in expected format.",t,s);else{var c=a.LocalStorageUtils.convertActivitiesToRecords(a.LocalStorageUtils.getItemValue(o.AbtStorageId.abtActivity)),d={records:new Array},l=!1;if(null==c||null==c.records||void 0===c.records||c.records.length<=0)i.LoggingUtils.error("Didn't get any user data from local activities item while looking for '"+e+"' which was unexpected.",t,s);else{for(var u=0,p=c.records;u<p.length;u++){var m=p[u];if(null!==m.userId&&void 0!==m.userId&&m.userId===e){var _=(new Date).toUTCString(),h=r.TimeUtils.addSeconds(_,-n);if(null==h)return;var b={userId:m.userId,timeout:m.timeout,activityDateTime:h.toUTCString(),broadcastedActivityDateTime:_};d.records.push(b),l=!0}else d.records.push(m)}l&&(a.LocalStorageUtils.tryCreateItem(o.AbtStorageId.abtActivity,JSON.stringify(d))||i.LoggingUtils.error("Failed to create item for activities.",t,s)),i.LoggingUtils.log("Finish extending the time of the local activity.",t,s,f.Global.gAbtSkipAriaLog)}}},e.shouldSendActivityToServer=n,e.updateUserLocalRecords=function(e){var n="updateUserLocalRecords",r=a.LocalStorageUtils.convertActivitiesToRecords(a.LocalStorageUtils.getItemValue(o.AbtStorageId.abtActivity)),s={records:new Array},c=!1;if(null==r||null==r.records||void 0===r.records||r.records.length<=0)i.LoggingUtils.warn("Didn't get data from local activities item.",t,n),s.records.push(e),c=!0;else for(var d=0,l=r.records;d<l.length;d++){var u=l[d];null!==u.userId&&void 0!==u.userId&&u.userId===e.userId?(s.records.push(e),c=!0):s.records.push(u)}c||s.records.push(e),a.LocalStorageUtils.tryCreateItem(o.AbtStorageId.abtActivity,JSON.stringify(s))||i.LoggingUtils.error("Failed to create item for activities.",t,n)},e.isActivityRecent=function(e,n){var r="isActivityRecent";i.LoggingUtils.log("Start checking if the activity is recent.",t,r,f.Global.gAbtSkipAriaLog);var s=a.LocalStorageUtils.convertActivitiesToRecords(a.LocalStorageUtils.getItemValue(o.AbtStorageId.abtActivity));if(null==s||null==s.records||void 0===s.records||s.records.length<=0)return i.LoggingUtils.error("Didn't get data from local activities item for '"+e+"'.",t,r),!1;for(var c=0,d=s.records;c<d.length;c++){var l=d[c];if(null!==l.userId&&void 0!==l.userId&&l.userId===e)return i.LoggingUtils.log("Finish checking if the activity is recent.",t,r,f.Global.gAbtSkipAriaLog),n<=60*u.PromptUtils.getTimeBeforePrompt(l.timeout)*2}return i.LoggingUtils.log("Finish checking if the activity is recent.",t,r,f.Global.gAbtSkipAriaLog),!1},e.startActivityChecks=function(e){i.LoggingUtils.log("Start checking if activity need to be send to the server",t,"startActivityChecks",f.Global.gAbtSkipAriaLog),!0===f.Global.gAbtStartedActivityChecks&&null!=f.Global.gAbtActivityTimer&&-1!=f.Global.gAbtActivityTimer._idleTimeout||(p(),f.Global.gAbtStartedActivityChecks=!0,f.Global.gAbtActivityTimer=setInterval(n,s.AbtTimer.activityInterval,e))},e.stopActivityChecks=p}(t.ActivityUtils||(t.ActivityUtils={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RequestUtils=void 0;var a=n(200),i=n(79),r=n(70),o=n(243),s=n(142),c=n(244),d=n(66),l=n(141),u=n(168),f=n(90),p=n(166);!function(e){var t="RequestUtils";function n(e,n){var a="convertServiceResponse";r.LoggingUtils.log("Start converting the service response.",t,a,d.Global.gAbtSkipAriaLog);var i,o=!1,s=!1;if(null==e||void 0===e||""===e)return r.LoggingUtils.warn("Empty/null/undefined webResponse. Returning null.",t,a,o,s,n),null;try{i=JSON.parse(e)}catch(e){return r.LoggingUtils.error("Exception occurred while parsing web response of ABT service. Returning null. Exception details: "+e.message+".",t,a,o,s,n),null}return void 0===i?(r.LoggingUtils.error("Couldn't parse web response from ABT service data. Returning null.",t,a,o,s,n),null):i}function m(e,n,a,i){var o="getUriGetRequest";if(r.LoggingUtils.log("Start getting the uri for get request.",t,a,d.Global.gAbtSkipAriaLog),null==e||""===e)return r.LoggingUtils.warn("userId param cannot be null, undefined or empty.",t,o),null;if(null==n||""===n)return r.LoggingUtils.warn("market param cannot be null, undefined or empty.",t,o),null;if(null==a||""===a)return r.LoggingUtils.warn("action param cannot be null, undefined or empty.",t,o),null;if(null==i||""===i)return r.LoggingUtils.warn("workload param cannot be null, undefined or empty.",t,o),null;var s=_(),l=c.AbtRequestParams.userId+"="+e+"&"+c.AbtRequestParams.market+"="+n+"&"+c.AbtRequestParams.action+"="+a+"&"+c.AbtRequestParams.workload+"="+i;return r.LoggingUtils.log("Returning Uri for '"+a+"' action.",t,o,!0),s.concat("?",l)}function _(){return o.UriScheme.https+o.UriSeparator.separator+d.Global.envConfigs[l.Environment[d.Global.gAbtEnvironment]].abtSvcHost+o.UriFormats.abtSvc}function h(e,n,a){null!=e&&null!==e.diagnostics&&void 0!==e.diagnostics?r.LoggingUtils.log(JSON.stringify(e.diagnostics),t,n,d.Global.gAbtSkipAriaLog,!1,a):r.LoggingUtils.warn("Received null/undefined response or diagnostics object.",t,n,d.Global.gAbtSkipAriaLog,!1,a)}e.sendGetRequest=function(e,a,i){var s="sendGetRequest";r.LoggingUtils.log("Start sending get request to the server.",t,a,d.Global.gAbtSkipAriaLog);var c=!1,l=!1,u=r.LoggingUtils.getRandomGuid();if(null!=e&&""!==e)if(null!=a&&""!==a){r.LoggingUtils.log("Sending a GET request for '"+a+"' action.",t,s,d.Global.gAbtSkipAriaLog,l,u);var f=new XMLHttpRequest;f.open(o.HttpMethod.get,m(e,d.Global.gAbtMarket,a,d.Global.gAbtWorkloadName)),f.setRequestHeader("X-CorrelationId",u),f.setRequestHeader("X-UserTenantID",d.Global.gAbtTenantId),f.withCredentials=!0,f.onload=function(){var o=n(f.responseText,u);h(o,s,u),200===f.status?null!=o.error||null!=o.error?r.LoggingUtils.error("Received an error from ABT service.\n\t\t\t\t\t\tError code: '"+o.error.errorCode+"'.\n\t\t\t\t\t\tError message: '"+o.error.message+".\n\t\t\t\t\t\tStatus code: "+f.status+". Data Center: "+o.diagnostics.dataCenter+".\n\t\t\t\t\t\tMachine: "+o.diagnostics.machine+".\n\t\t\t\t\t\tBuild Version: "+o.diagnostics.buildVersion+"'",t,s,c,l,u):r.LoggingUtils.log("Get request for user '"+e+"' succeeded. Status code: "+f.status+" Action: "+a,t,s,c,l,u):500===f.status?r.LoggingUtils.error("Received an error from ABT service.\n\t\t\t\t\tStatus code: "+f.status+"'.\n\t\t\t\t\tResponse details: "+f.responseText+".\n\t\t\t\t\tData Center: "+o.diagnostics.dataCenter+".\n\t\t\t\t\tMachine: "+o.diagnostics.machine+".\n\t\t\t\t\tBuild Version: "+o.diagnostics.buildVersion,t,s,c,l,u):r.LoggingUtils.error("Received an error from ABT service.\n\t\t\t\t\tError code: '"+o.error.errorCode+"'.\n\t\t\t\t\tError message: '"+o.error.message+".\n\t\t\t\t\tStatus code: "+f.status+"'.\n\t\t\t\t\tData Center: "+o.diagnostics.dataCenter+".\n\t\t\t\t\tMachine: "+o.diagnostics.machine+".\n\t\t\t\t\tBuild Version: "+o.diagnostics.buildVersion,t,s,c,l,u),i(o)},f.send(),r.LoggingUtils.log("Sent a GET request for '"+a+"' action.",t,s,c,l,u)}else r.LoggingUtils.warn("action param cannot be null, undefined or empty.",t,s);else r.LoggingUtils.warn("userId param cannot be null, undefined or empty.",t,s)},e.sendPostRequest=function(e,c,l,m,b,g){void 0===g&&(g=void 0);var v="sendPostRequest";r.LoggingUtils.log("Start sending post request to the server.",t,v,d.Global.gAbtSkipAriaLog);var y=!1,S=!1,D=r.LoggingUtils.getRandomGuid();if(u.InFlightUtils.isPresent()&&r.LoggingUtils.warn("In-flight item are still present even after waiting for "+a.AbtRegistration.timeToSleepInMsecs+" * "+a.AbtRegistration.maxAttempts+", override them",t,v),f.LocalStorageUtils.tryCreateItem(i.AbtStorageId.inFlight,i.AbtStorageValue.inFlight.toString())||r.LoggingUtils.warn("Failed to write in-Flight item.",t,v),null!=e&&""!==e)if(null==c||c<0)r.LoggingUtils.warn("pTimeSinceActivity param cannot be null, undefined or negative.",t);else if(null!=m&&""!==m)if(m!=s.AbtActions.signOut&&null===l||void 0===l||l<=0)r.LoggingUtils.warn("pTimeout param cannot be null, undefined, zero or negative.",t);else{r.LoggingUtils.log("Sending a POST request for '"+m+"' action.",t,v,d.Global.gAbtSkipAriaLog,S,D);var I={userId:e.toUpperCase(),timeSinceActivity:c,timeout:l,action:m,workload:d.Global.gAbtWorkloadName},x=new XMLHttpRequest;x.open(o.HttpMethod.post,_()),x.setRequestHeader("X-CorrelationId",D),x.setRequestHeader("X-UserTenantId",d.Global.gAbtTenantId),x.withCredentials=!0,x.onload=function(){if(h(n(x.responseText,D),v,D),200===x.status){if(r.LoggingUtils.log("Post request for user "+e+" succeeded.\n\t\t\t\t\tStatus code: "+x.status+".\n\t\t\t\t\tResponse text: "+x.responseText+".\n\t\t\t\t\tAction: "+m,t,v,y,d.Global.gAbtSkipAriaLog,D),null!=g){var a=(new Date).toUTCString();g.broadcastedActivityDateTime=a,p.ActivityUtils.updateUserLocalRecords(g)}}else 500===x.status?r.LoggingUtils.error("Received an error from ABT service. Status code: "+x.status+"'.\n\t\t\t\t\tResponse details: "+x.responseText,t,v,y,S,D):r.LoggingUtils.error("Received an error from ABT service.\n\t\t\t\t\tStatus code: "+x.status+"'\n\t\t\t\t\tResponse text: "+x.responseText,t,v,y,S,D);b()},x.send(JSON.stringify(I)),r.LoggingUtils.log("Sent a POST request for '"+m+"' action.",t,v,y,S,D)}else r.LoggingUtils.warn("pAction param cannot be null, undefined or empty.",t);else r.LoggingUtils.warn("pUserId param cannot be null, undefined or empty.",t)},e.convertServiceResponse=n,e.getUriGetRequest=m}(t.RequestUtils||(t.RequestUtils={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InFlightUtils=void 0;var a=n(90),i=n(200),r=n(79),o=n(70),s=n(66);!function(e){var t="InFlightUtils";function n(e){var n="sleep";return o.LoggingUtils.log("Sleeping for "+e+" ms.",t,n,s.Global.gAbtSkipAriaLog),e<0?(o.LoggingUtils.warn("Time to sleep cannot be less than zero. Returning immediately without sleeping.",t,n),new Promise(function(e){return setTimeout(e,0)})):new Promise(function(t){return setTimeout(t,e)})}e.isPresent=function(){var e="isPresent";o.LoggingUtils.log("Start checking if an item was already registered in-flight",t,e,s.Global.gAbtSkipAriaLog);for(var c=1;c<=i.AbtRegistration.maxAttempts;c++){if(!a.LocalStorageUtils.findItemWithValue(r.AbtStorageId.inFlight,r.AbtStorageValue.inFlight.toString()))return!1;if(o.LoggingUtils.log("AbtInFlight item is present. Attempt#."+c,t,e,s.Global.gAbtSkipAriaLog),c===i.AbtRegistration.maxAttempts)return!0;n(i.AbtRegistration.timeToSleepInMsecs)}return o.LoggingUtils.warn("There is still an element present in-flight.",t,e),!0},e.deleteItem=function(){var e="deleteItem";o.LoggingUtils.log("Start deleting in-flight item.",t,e,s.Global.gAbtSkipAriaLog),a.LocalStorageUtils.tryDeleteItem(r.AbtStorageId.inFlight)||o.LoggingUtils.error("Failed to delete in-flight item.",t,e)}}(t.InFlightUtils||(t.InFlightUtils={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PromptUtils=void 0;var a=n(70),i=n(166),r=n(199),o=n(90),s=n(201),c=n(167),d=n(307),l=n(142),u=n(198),f=n(242),p=n(241),m=n(79),_=n(202),h=n(245),b=n(66),g=n(67);!function(e){var t="PromptUtils";function n(e){var n="showPrompt";if(a.LoggingUtils.log("Start showing the prompt operation.",t,n,!0),null!=e)if(null===e.error||void 0===e.error)if(S(),e.result||(a.LoggingUtils.log("Not showing prompt based on server data.",t,n,!0),i.ActivityUtils.extendLocalActivity(e.userId,e.timeSinceActivity),y(e.userId)),e.respectResult){if(e.result){var o={title:e.ui.title,description:e.ui.description,question:e.ui.question,buttonSignOut:e.ui.signOutButton,buttonStaySignIn:e.ui.keepMeActiveButton,divName:e.ui.divName,userId:e.userId,timeout:e.timeout},s='{ "'+r.AbtEventProperty.eventId+'": "'+u.AbtEvent.promptShown+'", "'+r.AbtEventProperty.userId+'": "'+e.userId+'" }',c=JSON.parse(s),d=JSON.stringify(c);if(a.LoggingUtils.log("Show prompt post message "+d,t,n,!0),window.postMessage(d,window.location.origin),null!=window.AbtUI)window.AbtUI.AbtRenderPrompt(o);else{if(null==window.LoadAbtPromptJs)return void a.LoggingUtils.error("Can't find the declaration of the prompt. Not showing prompt.",t,n);var l=b.Global.telemetryLogger.createActivity({eventName:f.LogAttributes.defaultLoggingNamespace+"LoadAbtPromptJs",eventFlags:{dataCategories:2,diagnosticLevel:10},dataFields:[g.makeStringDataField(f.LogAttributes.messageDataField,"ABT prompt JS has been downloaded."),g.makeStringDataField(f.LogAttributes.levelDataField,p.EventLevel.info),g.makeStringDataField(f.LogAttributes.correlationIdDataField,a.LoggingUtils.getRandomGuid())]});window.LoadAbtPromptJs.Download(function(){return window.AbtUI.AbtRenderPrompt(o)}),l.setResult(1,"HRESULT"),l.endNow()}h.SignOutUtils.startSignOutChecks(o.userId),a.LoggingUtils.log("Successfully shown prompt.",t,n,void 0,void 0,void 0,e.timeout)}}else a.LoggingUtils.log("RespectResult is set to 'false'. Not showing prompt. The result was:'"+e.result+"'",t,n,!0);else a.LoggingUtils.error("Error found in the ABT service response. ErrorCode: '"+e.error.errorCode+"'. Not showing prompt.",t,n);else a.LoggingUtils.warn("WebResponse provided was null or undefined. Not showing prompt.",t,n)}function v(e){var i="shouldShowPrompt";a.LoggingUtils.log("Start executing the check for should shown the prompt.",t,i,b.Global.gAbtSkipAriaLog);var r=o.LocalStorageUtils.convertActivitiesToRecords(o.LocalStorageUtils.getItemValue(m.AbtStorageId.abtActivity)),d=!1;if(null==r||null==r.records||void 0===r.records||r.records.length<=0)a.LoggingUtils.error("Didn't get data from local activities item. No need to prompt for '"+e+"'.",t,i);else{for(var u=0,f=r.records;u<f.length;u++){var p=f[u];if(null!==p.userId&&void 0!==p.userId&&p.userId===e){var _=s.TimeUtils.addMinutes(p.activityDateTime,p.timeout-D(p.timeout));if(null==_)return void a.LoggingUtils.warn("DateTimeToShow promp null or undefined.",t,i);if(_.getTime()<(new Date).getTime()){a.LoggingUtils.log("Based on local data, we might need to show prompt for '"+e+"'.\n\t\t\t\t\t\t\tWe will reach out to server to confirm that.\n\t\t\t\t\t\t\tDateTime to show prompt was '"+_.toUTCString()+"' and Current time is '"+(new Date).toUTCString()+"'.\n\t\t\t\t\t\t\tTimeout value was: '"+p.timeout+"'.",t,i),d=!0;break}return void a.LoggingUtils.log("No need to prompt for '"+e+"'.\n\t\t\t\t\t\t\tDateTime to show prompt was '"+_.toUTCString()+"' and Current time is '"+(new Date).toUTCString()+"'.\n\t\t\t\t\t\t\tTimeout value was: '"+p.timeout+"'.",t,i,b.Global.gAbtSkipAriaLog)}}d?c.RequestUtils.sendGetRequest(e,l.AbtActions.shouldPrompt,n):a.LoggingUtils.error("No record for '"+e+"'. Not showing prompt.",t,i)}}function y(e){a.LoggingUtils.log("Start checking if the prompt should be shown.",t,"startPromptChecks",b.Global.gAbtSkipAriaLog),!0!==b.Global.gAbtStartedPromptChecks&&(S(),h.SignOutUtils.stopSignOutChecks(),b.Global.gAbtStartedPromptChecks=!0,b.Global.gAbtPromptTimer=setInterval(v,_.AbtTimer.promptInterval,e))}function S(){a.LoggingUtils.log("Stop checking if the prompt should be shown.",t,"stopPromptChecks",b.Global.gAbtSkipAriaLog),b.Global.gAbtStartedPromptChecks=!1,clearInterval(b.Global.gAbtPromptTimer)}function D(e){a.LoggingUtils.log("Start executing the get time before prompt operation.",t,"getTimeBeforePrompt",b.Global.gAbtSkipAriaLog);var n=e*(d.AbtPromptValue.percentageTimeout/100);return n>d.AbtPromptValue.minPromptWindow&&n<d.AbtPromptValue.maxPromptWindow?n:n<=d.AbtPromptValue.minPromptWindow?d.AbtPromptValue.minPromptWindow:(d.AbtPromptValue.maxPromptWindow,d.AbtPromptValue.maxPromptWindow)}e.showPrompt=n,e.startPromptChecks=y,e.stopPromptChecks=S,e.getTimeBeforePrompt=D}(t.PromptUtils||(t.PromptUtils={}))},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(4).t)("urlLite")},function(e,t,n){"use strict";n.d(t,"t",function(){return o}),n.d(t,"e",function(){return s});var a=n(164),i="text/plain",r={abap:i,ada:i,adp:i,ahk:i,as:i,as3:i,asc:i,ascx:"text/xml",asm:i,asp:i,awk:i,bash:i,bash_login:i,bash_logout:i,bash_profile:i,bashrc:i,bat:"text/x-bat",bib:i,bsh:"text/x-java",build:i,builder:i,c:"text/x-cpp","c++":"text/x-c++src",capfile:i,cc:"text/x-c++src",cfc:i,cfm:i,cfml:i,cl:i,clj:i,cls:i,cmake:i,cmd:"text/x-bat",coffee:"text/coffeescript",cpp:"text/x-cpp",cpt:"text/xml",cpy:i,cs:"text/x-csharp",cshtml:"text/x-cshtml",cson:"text/coffeescript",csproj:"text/xml",css:"text/css",ctp:"text/html",cxx:"text/x-c++src",d:i,db:i,ddl:i,di:i,dif:i,diff:i,disco:"text/xml",dml:i,dtd:"text/xml",dtml:"text/xml",el:i,emakefile:i,erb:i,erl:i,f:i,f90:i,f95:i,fs:"text/x-fsharp",fsi:"text/x-fsharp",fsscript:"text/x-fsharp",fsx:"text/x-fsharp",gemfile:i,gemspec:"text/ruby",gitconfig:"text/x-ini",go:i,groovy:i,gvy:i,h:"text/x-cpp","h++":"text/x-c++hdr",haml:i,handlebars:"text/x-handlebars-template",hbs:"text/x-handlebars-template",hcp:i,hh:"text/x-c++hdr",hpp:"text/x-cpp",hrl:i,hs:i,htc:"text/javascript",htm:"text/html",html:"text/html",hxx:"text/x-c++hdr",idl:"text/x-c++hdr",iim:i,inc:"text/html",inf:i,ini:"text/x-ini",inl:"text/x-c++src",ipp:"text/x-c++src",irbrc:i,jade:"text/x-jade",jav:"text/x-java-source",java:"text/x-java-source",js:"text/javascript",json:"application/json",jsp:i,jsx:"text/javascript",l:i,less:"text/x-less",lhs:i,lisp:i,log:i,lst:i,ltx:i,lua:"text/x-lua",m:i,mak:i,make:i,markdn:"text/x-web-markdown",markdown:"text/x-web-markdown",md:"text/x-web-markdown",mdown:"text/x-web-markdown",mkdn:"text/x-web-markdown",ml:i,mli:i,mll:i,mly:i,mm:i,mud:i,nfo:i,opml:"text/xml",osascript:i,osts:"text/javascript",out:i,p:i,pas:i,patch:i,php:"application/x-php",php2:"application/x-php",php3:"application/x-php",php4:"application/x-php",php5:"application/x-php",phtml:"text/html",pl:i,plist:i,pm:i,pod:i,pp:i,profile:i,properties:i,ps1:"text/x-powershell",ps1xml:"text/x-powershell",psd1:"text/x-powershell",psm1:"text/x-powershell",pt:"text/xml",py:"text/python",pyw:i,r:i,rake:i,rb:"text/ruby",rbx:i,rc:i,re:i,reg:i,rest:i,resw:"text/xml",resx:"text/xml",rhtml:i,rjs:i,rprofile:i,rpy:i,rss:"text/xml",rst:i,rxml:i,s:i,sass:"text/scss",scala:i,scm:i,sconscript:i,sconstruct:i,script:i,scss:"text/scss",sgml:"text/xml",sh:i,shtml:"text/html",sml:"text/xml",sql:i,sty:i,t:i,tcl:i,tex:i,text:i,textile:i,tld:"text/xml",tli:"text/x-c++hdr",tmpl:"text/html",tpl:"text/html",ts:"text/typescript",txt:i,vb:"text/x-vb",vi:i,vim:i,wsdl:"text/xml",xaml:"text/xml",xhtml:"text/html",xml:"text/xml",xoml:"text/xml",xsd:"text/xml",xsl:i,xslt:i,yaml:i,yaws:i,yml:i,zsh:i};function o(e,t){return!!e&&s(e,t)}function s(e,t){return function(e){return e=function(e){return((e&&"."===e[0]?e.substring(1):e)||"").toLowerCase()}(e),r.hasOwnProperty(e)}(e)&&(t===a.e.File||t===a.e.Media||t===a.e.Unknown)}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=function(){function e(e){this._value=e,this._observers=new Set}return e.prototype.get=function(){return this._value},e.prototype.set=function(e){this._value=e,this._observers.forEach(function(e){e()})},e.prototype.subscribe=function(e){var t=this;return this._observers.add(e),function(){t._observers.delete(e)}},e}()},,function(e,t,n){"use strict";var a,i=n(0),r=n(40),o=n(9),s=n(18),c=n(153);!function(e){e[e.requestFailed=0]="requestFailed",e[e.authenticationExpired=1]="authenticationExpired",e[e.accessDenied=2]="accessDenied",e[e.marketBlocked=3]="marketBlocked",e[e.userSuspended=4]="userSuspended",e[e.userNotReady=5]="userNotReady",e[e.passwordRequired=6]="passwordRequired",e[e.mfaRequired=7]="mfaRequired",e[e.insufficientVaultQuota=8]="insufficientVaultQuota",e[e.requestAccess=9]="requestAccess"}(a||(a={}));var d,l=n(77),u=n(22);!function(e){e[e.iosappstore=0]="iosappstore"}(d||(d={}));var f,p,m=d,_=n(24),h=n(12),b=n(118),g=n(81);!function(e){e[e.all=0]="all",e[e.folders=1]="folders",e[e.photos=2]="photos",e[e.documents=3]="documents",e[e.music=4]="music"}(f||(f={})),function(e){e[e.anyDate=0]="anyDate",e[e.oneDay=1]="oneDay",e[e.oneWeek=2]="oneWeek",e[e.oneMonth=3]="oneMonth",e[e.oneYear=4]="oneYear"}(p||(p={})),n(185),n(126);var v,y,S,D,I,x=n(50),C="ms-word",O="onenote|UsePlain",w="ms-powerpoint",E="ms-excel",A="ms-visio",L="ms-publisher",k="ms-project";(v={})[C]=x.p,v[O]=x.r,v[w]=x.s,v[E]=x.n,v[A]=x.u,(y={})[C]=x.f,y[O]=x.i,y[w]=x.o,y[E]=x.t,y[A]=x.l,y[L]=x.d,y[k]=x.c,y["ms-infopath"]=x.a;var M=((S={})[C]="Word",S[O]="OneNote",S[w]="PowerPoint",S[k]="Project",S[A]="Visio",S[E]="Excel",S);(D={})[C]="WordLogo",D[O]="OneNoteLogo",D[w]="PowerPointLogo",D[E]="ExcelLogo",D[A]="VisioLogo",D[L]="Page",(I={})[C]="svg/word_16x1.svg",I[O]="svg/onenote_16x1.svg",I[w]="svg/powerpoint_16x1.svg",I[E]="svg/excel_16x1.svg",I[A]="svg/visio_16x1.svg",I[L]="Page",I.Stream="svg/stream_16x1.svg";var P,T=n(106),U=n(75),F=n(26),H=n(4),R=n(56),N=n(46),B=n(80),j=n(171),V=n(84),z=n(128),G=n(43),K=n(10),W=n(127),q=n(16),Q=n(37),Y=n(49),J=n(58),X=n(7);function Z(e){var t=e.itemInfo,n=e.parentItemInfo,a=e.viewParams,i=n&&n.itemKey,r=Object(K.u)({itemKey:t.itemKey,itemInfo:t,page:o.e.TextFileEditor,viewParams:a}),s=Object(K.p)(i||"");r.parId=s.id;var c=h.t(r,null,!0);return"TextFileEditor"!==a.v?Object(K.o)(2,c):"#"+c}function $(e){var t=e.itemInfo,n=e.parentItemInfo;return X.e.isActivated("6DCD168B-9EA1-4AD3-A81F-12E38ED97BF2","10/21/2021","Use getParentItemInfo")?n:n&&n.itemKey!==t.itemKey&&n||t.parentFolderItemInfo}function ee(e){var t,n=e.itemInfo,a=$({itemInfo:n,parentItemInfo:e.parentItemInfo}),r=!1;X.e.isActivated("1065E6DF-81FE-4F4A-BB9A-625CC03793AA","10/21/2021","Compute URL using AllPhotos parentKey")||(r=Boolean("photos"===e.viewParams.v&&(n.itemIsVideo||n.itemIsPhoto)&&"allmyphotos"!==e.viewParams.qt&&!e.viewParams.parId&&!e.viewParams.parQt&&a&&!a.itemIsAlbum));var o=e;if(r){var s=Object(G.e)(((t={}).qt="allmyphotos",t.id="root",t.cid=K.A,t));o=Object(i.e)(Object(i.e)({},e),{parentItemInfo:{itemKey:s}})}return te(o)}function te(e){var t=e.itemInfo,n=e.parentItemInfo,a=e.viewParams,r=e.additionalViewParams,o=n&&n.itemKey||"",s=Object(K.p)(t.itemKey),c=Object(K.u)(Object(i.e)(Object(i.e)({},e),{itemKey:o,itemInfo:n}));r&&Object(J.e)(s,r),a&&a.commentId&&(s.commentId=a.commentId),s.parId=c.id,s.parQt=c.qt,s.cid!==c.cid&&(s.parCid=c.cid,delete c.cid),delete c.internalPath,delete c.qt,delete c.id,delete s.u;var d=c.action;return d?a&&a.commentId&&"showproperties"===d.toLowerCase()?(delete c.action,s.o=Q.r):(delete c.action,s.action=d):s.o=Q.r,"#"+h.t(s,c,!0)}!function(e){e[e.current=0]="current",e[e.focus=1]="focus",e[e.external=2]="external"}(P||(P={}));var ne,ae=(window.FilesConfig&&window.FilesConfig.skyApiDomain)+"/API/2/",ie=n(36),re=n(276),oe=n(23);function se(e,t){void 0===t&&(t={});var n=t.viewParams,a=void 0===n?{}:n,r=t.item;return Object(K.f)(Object(i.e)(Object(i.e)({},t),{itemKey:e,itemInfo:r&&{itemKey:r.key,itemIsPlaceholder:r.isPlaceholder,itemVirtualItemType:r.virtualItemType,itemExtension:r.extension,itemType:r.type},viewParams:a}))}var ce,de=window.$Config&&window.$Config.isINT,le=window.FilesConfig&&window.FilesConfig.skyApiDomain,ue=window.FilesConfig&&window.FilesConfig.storageDomain,fe=window.FilesConfig&&window.FilesConfig.mpcDomain;!function(e){e[e.DateCreated=0]="DateCreated",e[e.DateModified=1]="DateModified"}(ce||(ce={}));var pe=X.e.isActivated("6CEBAB53-E3AA-4B32-A437-CEC98812ABB4","10/21/2021","Refactor URL DataSource"),me=!X.e.isActivated("71CADB9F-8CE9-47DA-A4A3-0340D883A255","03/02/2023","Propogates redeemTokem if available in WAC open URLs"),_e=!X.e.isActivated("84da682b-95a0-41d5-96c7-c5039e03fe3d","06/14/2023","Move generating Moj url out of OdcUrlDataSource to avoid consume OdcUrlDataSource in Moj"),he=!X.e.isActivated("A1B9808D-D7B3-41D5-9954-CC3BF1A89881","10/09/2023","Adds ReturnURL as a prop instead of just wreply for signins (for SPO)"),be=!X.e.isActivated("CA949581-487C-4A90-9D63-81958797F222","10/21/2021","Fast OneUp in ODC")&&Object(_.E)(_.D),ge=new H.t({name:"".concat("UrlDataSource",".useRefactoredGetDefaultClickUrl"),factory:new H.e(!pe)}),ve=new H.t({name:"".concat("UrlDataSource",".enableFastOneUp"),factory:new H.e(be)}),ye=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t={});var n=this,a=t.navigation,i=void 0===a?this.resources.consume(B.e):a,r=t.enableFastOneUp,o=void 0===r?this.resources.consume(ve):r,s=t.useRefactoredDefaultClickUrl,c=void 0===s?this.resources.consume(ge):s;this._navigation=i,this._enableFastOneUp=o,this._useRefactoredDefaultClickUrl=c,this.getCurrentPageBaseUrl=e&&e._getCurrentPageBaseUrl||(this._useRefactoredDefaultClickUrl?K.r:this.getCurrentPageBaseUrl),this._getCurrentUrlPathName=e&&e._getCurrentUrlPathName||this._getCurrentUrlPathName,this._events=new N.t(this),(this._mayBeFastOneUp=this._enableFastOneUp&&Object(_.E)(_.D)&&!!this.getFocusItemKey(this._navigation.viewParams))&&this._events.on(this._navigation,"change",function(){n.getFocusItemKey(n._navigation.viewParams)||(n._mayBeFastOneUp=!1,n._events.off(n._navigation))})}return e.getKey=function(e){return void 0===e&&(e={}),Object(G.e)(e)},e.getKeyParams=function(e){return Object(K.p)(e)},e.getIsSyncUserBusiness=function(e){return"b"===e.pt},e.getWtMcIdParamKeyIsSync=function(e){var t=e.ocid||e["WT.mc_id"];return t&&t.toLowerCase().indexOf("sync")>=0},e.getRedeemCodeParam=function(e){var t=e.redeemCode;return"undefined"===t?"":t},e.getProfileImage=function(t){return e.storageBaseUrl+"/users/0x"+t+"/myprofile/expressionprofile/profilephoto:UserTileLarge,UserTileStatic/MeControlMediumUserTile?ck=1&ex=24&fofoff=1"},e.getTermsUrl=function(){return"https://g.live.com/8seskydrive/tou"},e.getPrivacyUrl=function(){return"https://go.microsoft.com/fwlink/?LinkId=521839"},e.getImpressumUrl=function(){return Object(K.d)()},e.getResourceRedirectUrl=function(e){return"https://onedrive.live.com/redir.aspx?"+h.t({resid:e})},e.encodeSharingUrl=function(e){return Object(q.e)(e)},e.getThumbnailUrl=function(t,n,a,i){return i=i||a,b.n(e.storageBaseUrl+"/Items/{1}:CustomThumbnailSource,HighRes,Default?{2}",t,n,h.t({width:a,height:i,cropmode:"center"}))},e.getVroomBaseUrl=function(e){return Object(q.o)(e)},e.getAutoRedeemRedirectUrl=function(t){var n="",a=t.viewParams,i=a.id,r=a.cid,o=a.action;return a.autoredeeem&&i&&r&&o&&(n=e.getAutoRedeemLoginUrl(i,r,o,t)),n},e.getAutoRedeemLoginUrl=function(t,n,a,i){var r,o=e._getAutoRedeemUrl(t,n,a,!1,i.viewParams),s=((r={}).ru=o,r.wreply=o,r);return F.e.signInUrl+"&"+h.t(s,null,!0)},e.getAutoRedeemLogoutUrl=function(t,n,a,i){var r,o=e._getAutoRedeemUrl(t,n,a,!0,i.viewParams),s=((r={}).lru=o,r);return F.e.autoRedeemSignOut+"&"+h.t(s,null,!0)},e.getCookieDomain=function(){return window.$Config.sd},e.getEnvironment=function(){return Object(Y.t)()},e.areCidsEqual=function(e,t){return Object(W.e)(e,t)},e._getAutoRedeemUrl=function(e,t,n,a,i){var r,o=((r={}).id=e,r.cid=t,r.action=n,r.authkey=i.authkey,r);return a&&(o.autoredeeem="1"),window.location.protocol+"//"+window.location.host+document.location.pathname+"?"+h.t(o,null,!0)},e.prototype.getDefaultRootItemId=function(){return"root"},e.prototype.getKey=function(t){return e.getKey(t)},e.prototype.getKeyParams=function(e){return Object(K.p)(e)},e.prototype.getRequestAccessLogoutUrl=function(e,t,n){var a,i,r=((a={resid:e,ithint:t}).challengeToken=n,a.v="requestaccess",a),o=window.location.protocol+"//"+window.location.host+document.location.pathname+"?"+h.t(r,null,!0),s=((i={}).lru=o,i);return F.e.autoRedeemSignOut+"&"+h.t(s,null,!0)},e.prototype.getItemHintRedirectViewParams=function(e){return void 0===e&&(e={}),Object(K.l)(e)},e.prototype.getQueryType=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(V.e)(e)},e.prototype.getPhotoType=function(e){return Object(K.g)(e)},e.prototype.getPageType=function(e,t){return void 0===e&&(e=this._navigation.viewParams),Object(K.b)(e,this._mayBeFastOneUp||t)},e.prototype.getViewerType=function(e){return function(e){var t=e.viewer;switch(t){case"3d":case"Audio":case"Error":case"FileHandler":case"Html":case"OnePlayerVideo":case"OnePlayerAudio":case"Other":case"Panorama":case"Image360":case"Pdf":case"MSPdf":case"Photo":case"TextFile":case"Thumbnail":case"Video":case"WAC":case"Wrs":case"Zip":return t}}(e)},e.prototype.saveViewerType=function(e){return function(e){var t;return(t={}).viewer=e,t}(e)},e.prototype.getFocusItemKey=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(K.c)(e)},e.prototype.getCurrentItemKey=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(z.e)(e)},e.prototype.areKeysEqual=function(e,t){var n=this.getKeyParams(e),a=this.getKeyParams(t);return delete n.u,delete a.u,this.getKey(n)===this.getKey(a)},e.prototype.getRootItemKey=function(e){return void 0===e&&(e=s.e.Files),Object(K.S)(e)},e.prototype.isRecycleBin=function(e){return this._useRefactoredDefaultClickUrl?Object(q.h)(e):e===s.e.RecycleBin},e.prototype.isCurrentQueryPhotoStream=function(e){return void 0===e&&(e=this._navigation.viewParams),"photostream"===e.qt},e.prototype.isCurrentQueryFiles=function(e){void 0===e&&(e=this._navigation.viewParams);var t=!X.e.isActivated("4B9ACAFF-DC04-4EA0-93FF-9439B92FD516","10/21/2021","Check is Search in Files pivot")&&(e.searchsessionid||"search"===e.parQt);return Object(K.C)(e)||0===Object.keys(e).length||!e.qt&&!e.v&&!t&&Object(K.t)(e)},e.prototype.isCurrentQueryRecent=function(e){return void 0===e&&(e=this._navigation.viewParams),"mru"===e.qt},e.prototype.isCurrentQuerySharedWithMe=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(K.x)(e)},e.prototype.isCurrentQuerySharedByMe=function(e){return void 0===e&&(e=this._navigation.viewParams),"sharedbyme"===e.qt},e.prototype.isCurrentQuerySharedFilesRoot=function(e){return void 0===e&&(e=this._navigation.viewParams),"sharedbyme"===e.qt||"sharedby"===e.qt},e.prototype.isCurrentQueryRecycleBin=function(e){return void 0===e&&(e=this._navigation.viewParams),"recyclebin"===e.qt},e.prototype.getDisableQueryAlteration=function(e){return void 0===e&&(e=this._navigation.viewParams),!1},e.prototype.isCurrentQuery=function(e,t){switch(void 0===t&&(t=this._navigation.viewParams),e){case s.e.Files:return this.isCurrentQueryFiles();case s.e.Recent:return this.isCurrentQueryRecent();case s.e.SharedWithMe:return this.isCurrentQuerySharedWithMe();case s.e.SharedByMe:return this.isCurrentQuerySharedByMe();case s.e.RecycleBin:return this.isCurrentQueryRecycleBin();case s.e.Photos:case s.e.AllMyPhotos:return Object(K.I)(t);case s.e.PhotoStream:return this.isCurrentQueryPhotoStream(t);default:return!!t.qt&&t.qt.toString().toLowerCase()===s.e[e].toString().toLowerCase()}},e.prototype.getFilesQueryUrl=function(){return this._requireAuthentication(this.getItemUrl(this.getKey({}),{page:o.e.Files}))},e.prototype.getRecycleBinQueryUrl=function(){var e;return Object(ie.e)(K.A)&&!Object(_.E)(_.e)?"".concat(this.getMpcOneDriveUrl(),"?view=5"):this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt="recyclebin",e)),{page:o.e.Files}))},e.prototype.getRecentQueryUrl=function(){var e;return this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt="mru",e)),{page:o.e.Files}))},e.prototype.getLargestFilesQueryUrl=function(){var e;return this.getItemUrl(this.getKey(((e={}).qt="largestfiles",e)),{page:o.e.Files})},e.prototype.getPhotoStreamQueryUrl=function(e,t){var n;void 0===t&&(t=!1);var a=Object(i.e)({},this._navigation.viewParams);return t||delete a.psShareId,this._requireAuthentication(this.getItemUrl(this.getKey(((n={}).qt="photostream",n.v="photoStream",n.psId=e||"me",n.psShareId=a.psShareId,n.psPostId=a.psPostId,n.pssc=a.pssc,n)),{page:o.e.PhotoStream,viewParams:a}))},e.prototype.getPhotoStreamMyFeedQueryUrl=function(e){var t;void 0===e&&(e=!1);var n=Object(i.e)({},this._navigation.viewParams);return e||delete n.psShareId,this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="photostream",t.v="photoStream",t.psShareId=n.psShareId,t.psPostId=n.psPostId,t.pssc=n.pssc,t)),{page:o.e.PhotoStream,viewParams:n}))},e.prototype.getPhotoStreamShareIdUrl=function(e){var t,n=((t={}).id="root",t.qt="photostream",t.v="photoStream",t.psShareId=e,t);return this.getCurrentPageBaseUrl()+"?"+h.t(n,null,!0)},e.prototype.getPhotoStreamForMojsQueryUrl=function(e,t,n){var a,r=Object(i.e)({},this._navigation.viewParams);return delete r.psShareId,this._requireAuthentication(this.getItemUrl(this.getKey(((a={}).qt="photostream",a.v="photoStream",a.mojDate=e,a.moj=t,a.psRIds=n.join(","),a)),{page:o.e.PhotoStream,viewParams:r}))},e.prototype.getAllMyPhotosQueryUrl=function(t){var n;return this._requireAuthentication(this.getItemUrl(this.getKey(((n={}).qt="allmyphotos",n.id=t,n.cid=e.viewerId,n)),{page:o.e.Photos}))},e.prototype.getAlbumsQueryUrl=function(e){var t;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).id="albums",t)),{page:o.e.Photos}))},e.prototype.getTagsQueryUrl=function(e){var t;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).id="tags",t)),{page:o.e.Photos}))},e.prototype.getPlacesQueryUrl=function(e){var t;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).id="places",t)),{page:o.e.Photos}))},e.prototype.getOnThisDayQueryUrl=function(e,t){var n,a;return _e?function(e,t){var n,a;return Object(K.w)(se(Object(G.e)(((n={}).qt="allmyphotos",n.onThisDay=!0,n.moj="onThisDay",n)),{page:o.e.Photos,additionalViewParams:(a={},a.sc=e&&e.sc||"",a)}))}(e):this._requireAuthentication(this.getItemUrl(this.getKey(((n={}).qt="allmyphotos",n.onThisDay=!0,n.moj="onThisDay",n)),{page:o.e.Photos,additionalViewParams:(a={},a.sc=e&&e.sc||"",a)}))},e.prototype.getOnThisMonthQueryUrl=function(e){var t,n;return _e?function(e){var t,n;return Object(K.w)(se(Object(G.e)(((t={}).qt="allmyphotos",t.onThisMonth=!0,t.moj="onThisMonth",t.useUtilityFiltering=e.useUtilityFiltering,t)),{page:o.e.Photos,additionalViewParams:(n={},n.sc=e&&e.sc||"",n)}))}(e):this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="allmyphotos",t.onThisMonth=!0,t.moj="onThisMonth",t.useUtilityFiltering=e.useUtilityFiltering,t)),{page:o.e.Photos,additionalViewParams:(n={},n.sc=e&&e.sc||"",n)}))},e.prototype.getLastWeekPreviousYearsQueryUrl=function(e){var t,n;return _e?function(e){var t,n;return Object(K.w)(se(Object(G.e)(((t={}).qt="allmyphotos",t.lastWeekPreviousYears=!0,t.moj="lastWeekPreviousYears",t.useUtilityFiltering=e.useUtilityFiltering,t)),{page:o.e.Photos,additionalViewParams:(n={},n.sc=e&&e.sc||"",n)}))}(e):this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="allmyphotos",t.lastWeekPreviousYears=!0,t.moj="lastWeekPreviousYears",t.useUtilityFiltering=e.useUtilityFiltering,t)),{page:o.e.Photos,additionalViewParams:(n={},n.sc=e&&e.sc||"",n)}))},e.prototype.getRecentPhotoUrl=function(e){var t,n;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).parQt=e.parQt,t.id=e.id,t.cid=e.cid,t)),{page:o.e.Photos,additionalViewParams:(n={},n.sc=e&&e.sc||"",n)}))},e.prototype.getAllPhotosForPlaceUrl=function(e,t){var n;return this.getItemUrl(this.getKey(((n={}).id=t,n.locationFilter=e,n.qt="allmyphotos",n)),{page:o.e.Photos})},e.prototype.getSharedByQueryUrl=function(){var e;return this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt="sharedby",e)),{page:o.e.Files}))},e.prototype.getSharedByYouQueryUrl=function(){var e;return this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt="sharedbyme",e)),{page:o.e.Files}))},e.prototype.getOneDriveAppsUrl=function(){return"https://g.live.com/8SESkyDrive/SkyDriveApps?biciid=lhnlink"},e.prototype.getOptionsUrl=function(e){return void 0===e&&(e=this._navigation.viewParams),this.getNewManageStorageUrl()},e.prototype.getManageStorageUrl=function(){return this.getCurrentPageBaseUrl()+"/options/ManageStorage"},e.prototype.getPhotoPreferencesUrl=function(){var e,t=((e={}).v="photopreferences",e),n="#"+h.t(t,null,!0);return this._requireAuthentication(n)},e.prototype.getManageVaultUrl=function(){var e,t=((e={}).v="ManageVault",e),n="#"+h.t(t,null,!0);return this._requireAuthentication(n)},e.prototype.getTagPreferencesUrl=function(){var e,t=((e={}).v="tagpreferences",e),n="#"+h.t(t,null,!0);return this._requireAuthentication(n)},e.prototype.getOfficeFileOptionsUrl=function(){var e;if(Object(_.E)(_.o)&&Object(ie.e)(K.A)){var t=((e={}).v="documentoptions",e),n="#"+h.t(t,null,!0);return this._requireAuthentication(n)}return this.getCurrentPageBaseUrl()+"/options/DocumentOptions"},e.prototype.getPhotosOptionsUrl=function(){return this.getCurrentPageBaseUrl()+"/options/PeopleOptions"},e.prototype.getUpgradeOptionsUrl=function(e,t){return this.getNewUpgradeOptionsUrl(e,this._navigation.viewParams,t)},e.prototype.getNotificationOptionsUrl=function(){var e,t=((e={}).v="NotificationOptions",e),n="#"+h.t(t,null,!0);return this._requireAuthentication(n)},e.prototype.getDeviceBackupsOptionsUrl=function(){return this.getCurrentPageBaseUrl()+"/options/DeviceBackups"},e.prototype.getSearchOptionsUrl=function(){var e;if(Object(_.E)(_.r)&&Object(ie.e)(K.A)){var t=((e={}).v="search",e),n="#"+h.t(t,null,!0);return this._requireAuthentication(n)}return this.getCurrentPageBaseUrl()+"/options/Search"},e.prototype.getNewManageStorageUrl=function(e){var t;void 0===e&&(e=this._navigation.viewParams);var n=((t={}).ocid=e.ocid||e["WT.mc_id"],t.v="managestorage",t),a="#"+h.t(n,null,!0);return this._requireAuthentication(a)},e.prototype.getNewUpgradeOptionsUrl=function(e,t,n){return void 0===t&&(t=this._navigation.viewParams),Object(K.h)({wtcParam:e,viewParams:t,hideLeftNav:n})},e.prototype.getNewRestoreOptionsUrl=function(e,t){var n;void 0===t&&(t=this._navigation.viewParams);var a=((n={}).ocid=t.ocid||t["WT.mc_id"]||e,n.v="restore",n),i="#"+h.t(a,null,!0);return this._requireAuthentication(i)},e.prototype.getTaggingOptionsUrl=function(){return"/options/PeopleOptions"},e.prototype.getPeopleApiUrl=function(t){var n={prefix:t};return e.peopleBaseUrl+"/directory/search?"+h.t(n)},e.prototype.getUserInfoApiUrl=function(){return ae+"GetUserInfo"},e.prototype.setUserInfoApiUrl=function(){return ae+"SetUserInfo"},e.prototype.getPublishToWalgreensUrl=function(){return e.skyApiBaseUrl+"PublishToWalgreens"},e.prototype.getDownloadUrl=function(e,t){void 0===t&&(t=this._navigation.viewParams);var n=e.ownerId,a=this.getAuthKeyParamValue(t),i=this.getTicketParamValue(t),r=F.e.canary,o={cid:n,authKey:a,ticket:i,resid:e.id,canary:r};if(e.video){var s=Math.ceil((1.25*e.video.duration||0)/6e4);o.duration=Math.min(Math.max(1,s)+60,1440)}return this.getCurrentPageBaseUrl()+"/GetDownloadUrl?"+h.t(o,null,!0)},e.prototype.getEmbedInfoUrl=function(t){var n={id:t.id};return e.skyApiBaseUrl+"GetEmbedInfo?"+h.t(n,null,!0)},e.prototype.getEmbedPageUrl=function(e){var t={cid:e.ownerId,resid:e.id};return this.getCurrentPageBaseUrl()+"/embed?"+h.t(t,null,!0)},e.prototype.getPermissionsUrl=function(t,n){var a;void 0===n&&(n=this._navigation.viewParams);var i=this.getAuthKeyParamValue(n),r=((a={}).id=t.id,a);return i&&(r.authkey=i),e.skyApiBaseUrl+"GetPermissions?"+h.t(r)},e.prototype.getSearchQueryUrl=function(e,t){var n,a=e.query,i=e.dateFilter,r=e.conversationId,o=e.largestSize,s=e.filter;s||(s=Object(K.I)(this._navigation.viewParams)?f.photos:f.all);var c=((n={}).qt="search",n.q=a,n.searchsessionid=r,n.ft=K.e[f[s]],n);if("number"==typeof i&&i!==p.anyDate){var d=new Date,l=this._getDateDuration(i,d);c.df=ce[ce.DateCreated],c.beginDate=l.toISOString(),c.endDate=d.toISOString()}return o&&(c.sp="size"),this.getItemUrl(this.getKey(c),t)},e.prototype.getSearchFilterQueryUrl=function(e,t){return void 0===t&&(t=this._navigation.viewParams),this.getSearchQueryUrl({query:t.q,conversationId:t.searchsessionid,filter:e,dateFilter:this.getAppliedDateFilter()})},e.prototype.isSearchFilterApplied=function(e,t){return void 0===t&&(t=this._navigation.viewParams),this.getContextualFilter(t)===String(K.e[f[e]])},e.prototype.getSearchByDateFilterQueryUrl=function(e,t){return void 0===t&&(t=this._navigation.viewParams),this.getSearchQueryUrl({query:t.q,conversationId:t.searchsessionid,filter:f[String(K.e[this.getContextualFilter(t)])],dateFilter:e})},e.prototype.isSearchByDateFilterApplied=function(e){return this.getAppliedDateFilter()===e},e.prototype.getAutoActionType=function(e){if(this._useRefactoredDefaultClickUrl)return Object(K.i)(e);var t=e.action||"";return u.e[t.toLowerCase()]||u.t.none},e.prototype.getQueryParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.q},e.prototype.getCommentIdParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.commentId},e.prototype.getLayoutContentType=function(t){void 0===t&&(t=this._navigation.viewParams);var n=t.layout;return n&&e.contentTypeByLayoutType[n]},e.prototype.getItemTypeFilter=function(e){var t=[],n=Number(e.ft)||0;7==(7&n)&&t.push(U.e.folder),16==(16&n)&&t.push(U.e.document),8==(8&n)&&t.push(U.e.media);for(var a=0,i=(e.ext||"").split(";");a<i.length;a++){var r=i[a];t.push(r)}return{filters:t}},e.prototype.saveItemTypeFilter=function(e){return void 0===e&&(e={filters:[]}),Object(K.E)(e)},e.prototype.getUsersFilter=function(e){var t=e.userFilters;return t&&t.split(";#")},e.prototype.saveUsersFilter=function(e){var t={};return t.userFilters=e&&e.join(";#"),t},e.prototype.saveDateDurationFilter=function(e){return{}},e.prototype.getDateDurationFilter=function(e){return""},e.prototype.getIAmValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.iam},e.prototype.getFeedbackUrl=function(){return e.skyApiBaseUrl+"GetFeedBackUrl"},e.prototype.getCidFromResourceId=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(q.t)(e)},e.prototype.getCreateTextDocumentUrl=function(t,n,a){void 0===a&&(a=this._navigation.viewParams);var i={};i.id=t,i.cid=n,i.iam=this.getIAmParamValue(a),i.action=e.createTextDocumentActionValue,i.v="TextFileEditor";var r=h.t(i,null,!0);return this._getCurrentPageUrl(2,r)},e.prototype.getCreateDocumentInTabUrl=function(e,t,n,a){var i;void 0===a&&(a=this._navigation.viewParams);var r,o=this.getAuthKeyParamValue(a),s=this.getTicketParamValue(a),c=this.getIAmParamValue(a),d=a.qt,l=1===e.documentFormat?"odf":"",f=((i={}).cid=e.ownerId,i.wacqt=d||"",i.wdo=1,i);if(n){r="?",f.id=e.id;var p=void 0;switch(t){case"w":p=u.t.createWord;break;case"x":p=u.t.createExcel;break;case"p":p=u.t.createPowerPoint;break;case"n":p=u.t.createOneNote}f.action=p&&u.t[p].toLowerCase()||""}else r="/create.aspx?",f.parId=e.id,f.nd=t+l;return o&&(f.authkey=o),s&&(f.ticket=s),c&&(f.iam=c),r+h.t(f)},e.prototype.getDownloadItemUrl=function(e,t,n,a){if(void 0===a&&(a=this._navigation.viewParams),e.processFilters)return e.processFilters.thumbnailUrl;var i=this.getAuthKeyParamValue(a),r=this.getTicketParamValue(a),o=this.getIAmParamValue(a),s={cid:e.ownerId,authKey:i,ticket:r,iam:o,resid:e.id,canary:t,ithint:e.extension&&e.extension.toLowerCase(),open:n||void 0};return this.getCurrentPageBaseUrl()+"/download.aspx?"+h.t(s,null,!0)},e.prototype.getVersionHistoryUrl=function(e,t,n){var a,r;void 0===n&&(n=this._navigation.viewParams);var o=this.getIAmParamValue(n),s=this.getAuthKeyParamValue(n),c=n.redeem,d=Object(i.e)(Object(i.e)({cid:e,resid:t,iam:o},s?((a={}).authkey=s,a):{}),me&&c?((r={}).redeem=c,r):{});return"/versions.aspx?"+h.t(d,null,!0)},e.prototype.getOpenInOfficeOnlineUrl=function(e,t,n){void 0===n&&(n={});var a,i=n.forceReadOnly,r=void 0!==i&&i,o=e.properties.commandsSupported,s=(void 0===o?{}:o).defc,c=e.openUrl;a=r?"view.aspx":"2"===s?"edit.aspx":"view.aspx";var d=(null==e?void 0:e.itemId)||(null==e?void 0:e.id);if(d){var l=new oe.t("/".concat(a));l.setQueryParameter("resid",d);var u=this.getAuthKeyParamValue(t);u&&l.setQueryParameter("authkey",u);var f=t.redeem;for(var p in me&&f&&l.setQueryParameter("redeem",f),t)p.startsWith("wd")&&l.setQueryParameter(p,t[p]);return l.toString()}var m=function(e){var t=e.extension;return t&&".pdf"===t.toLowerCase()?"WordPdf":M[e.appMap]||"Word"}(e),_=c.indexOf("?")>0?"&":"?";return c.replace("redir.aspx",a).replace("download.aspx",a)+_+h.t({app:m,wdo:1,wacqt:t.qt},null,!0)},e.prototype.getOpenInOfficeClientUrl=function(e,t,n){var a,r,o;if(void 0===t&&(t=this._navigation.viewParams),!X.e.isActivated("C1567AF7-26C3-4CFC-A439-2A58F8558245","07/18/2022","open history file in office client")&&Object(ie.e)(e.ownerId)){var s=null===(r=e.itemFromServer)||void 0===r?void 0:r.webDavUrl;return(null===(o=e.properties)||void 0===o?void 0:o.path)&&(s=e.properties.path),Object(re.e)(e.appMap,s,e.extension,!0,!1)}var c=this.getAuthKeyParamValue(t),d=this.getIAmParamValue(t),l=t.redeem,u=Object(i.e)({cid:n,resid:e.id,authKey:c,iam:d,autoRedirect:"false"},me&&l?((a={}).redeem=l,a):{});return this.getCurrentPageBaseUrl()+"/openinclient?"+h.t(u,null,!0)},e.prototype.getNewInOfficeClientUrl=function(e,t,n){return""},e.prototype.getDownloadAsZipIframeUrl=function(e,t){void 0===t&&(t=this._navigation.viewParams);var n={canary:e,iam:this.getIAmParamValue(t)};return this.getCurrentPageBaseUrl()+"/downloadasziplanding?"+h.t(n,null,!0)},e.prototype.getDownloadAsZipPostUrl=function(t,n,a){void 0===a&&(a=this._navigation.viewParams);var i=b.n(e.storageBaseUrl+"/downloadfiles/V1/Zip",t),r=a,o={authKey:r.authkey,ticket:r.ticket,iam:this.getIAmParamValue(r),application:n};return i+"?"+h.t(o,null,!0)},e.prototype.getOwnerId=function(t,n){return this.getKeyParams(t||this.getCurrentItemKey(n)).cid||e.viewerId},e.prototype.getSharedByUrl=function(e,t,n){var a,r;return this.getItemUrl(this.getKey(Object(i.e)(((a={}).qt="sharedby",a.id=e,a.cid=t,a),n?((r={}).groupId=n,r):{})))},e.prototype.getExternalUrl=function(t){var n=m[t];if(!n)throw new Error("Invalid external alias provided to fetch external url.");return this.getCurrentPageBaseUrl()+e.EXTERNAL_URL_FORMAT+n},e.prototype.getUploadStorageUrl=function(t,n){return"root"===t.id?b.n(e.storageBaseUrl,[t.ownerId])+"/MyCIDStuff/0x"+t.ownerId+"/LiveFolders/"+g.e.encodeURIComponent(n):b.n(e.storageBaseUrl,[t.uploadOwnerId])+"/items/"+t.id+"/"+g.e.encodeURIComponent(n)},e.prototype.getAppSubfolder=function(){return"odc"},e.prototype.getDefaultClickUrl=function(e,t){var n,s,c,d,l,f,p,m,b;void 0===t&&(t={});var g,v=t.viewParams,y=void 0===v?this._navigation.viewParams:v,S=t.itemSet,D=t.urlType,I=void 0===D?"default":D,x=t.preserveAction,C=void 0!==x&&x,O=t.action,w=void 0===O?C&&this.getAutoActionType(y)||void 0:O;if(!e||!e.key)return"";if(Object(_.E)(_.S)&&Object(ie.e)(K.A)&&((null===(f=null===(l=e.itemFromServer)||void 0===l?void 0:l.remoteItem)||void 0===f?void 0:f.containingDrivePolicyScenarioViewpoint)&&(e=Object(i.e)(Object(i.e)({},e),{key:h.t((n={},n.mcid=h.e(e.key).cid,n.mid=h.e(e.key).id,n.cid=(null===(p=e.graph)||void 0===p?void 0:p.driveId)||"",n.id="root",n))})),e.ownerId&&h.e(e.key).cid!==e.ownerId&&(e=Object(i.e)(Object(i.e)({},e),{key:h.t(Object(i.e)(Object(i.e)({},h.e(e.key)),(s={},s.cid=e.ownerId,s)))}))),y.sb&&(!this.isCurrentQuery(e.queryType,y)||(e=Object(i.e)(Object(i.e)({},e),{key:h.t(Object(i.e)(Object(i.e)({},h.e(e.key)),(c={},c.sb=y.sb,c.sd=y.sd,c)))}))),y.mcid&&this.getKeyParams(e.key).cid===(y.cid||y.parCid)&&(e=Object(i.e)(Object(i.e)({},e),{key:h.t(Object(i.e)(Object(i.e)({},h.e(e.key)),(d={},d.mcid=y.mcid,d.mid=y.mid,d)))})),this._useRefactoredDefaultClickUrl){var E=null===(b=null===(m=null==e?void 0:e.properties)||void 0===m?void 0:m.commandsSupported)||void 0===b?void 0:b.defc,A=S&&S.item.peek(),L=A&&A.key!==e.key&&A||e.UNSAFE_parent,k=L&&L.key,M=void 0;return E&&(M="1"===E),function(e){var t,n=e.urlType,i=void 0===n?"default":n,s=e.preserveAction,c=void 0!==s&&s,d=e.viewParams,l=e.itemInfo.itemType,f=e.action,p=void 0===f?c&&Object(K.i)(d)||void 0:f,m=function(e){var t;switch(e){case r.e.Media:t=P.focus;break;case r.e.Folder:case r.e.Error:t=P.current;break;default:t=P.external}return t}(l),_=!!X.e.isActivated("CBF950BB-C412-4331-9430-066677E49966","10/21/2021","Compute OneUp URL for media items in mount points")||l!==r.e.Media;d.mid&&_&&(m=P.current),t=l===r.e.Error?P.external:"existing"===i?function(e){return Object(K.c)(e)?P.focus:P.current}(d):"focus"===i||p?p&&p!==u.t.locate&&m===P.current?m:P.focus:m;var b=function(e,t){var n=t.itemInfo,i=t.parentItemInfo,s=t.viewParams,c=t.queryType,d=t.page,l=void 0===d?Object(K.b)(s):d,f=n.itemKey,p=n.itemExtension,m=n.itemType;if(e!==P.current&&l===o.e.FilePicker)return"";var _,b=Object(K.p)(f);if(Object(q.h)(c)&&!Object(q.h)(Object(V.e)(b)))return"";if(p&&Object(j.e)(p,m))e=l===o.e.TextFileEditor?P.external:P.focus;else if(l===o.e.TextFileEditor&&Object(K.i)(s)===u.t.createTextDocument)return"#"+h.t(s,null,!0);switch(e){case P.current:_=function(e){var t=e.itemInfo,n=e.preserveAction,a=e.action,i=e.viewParams,r=e.page,o=e.additionalViewParams,s=t.itemKey;if(t.itemIsStub){var c=Object(K.c)(i);if(c)return Object(K.i)(i)===u.t.locate?"":(delete i.viewer,te({itemInfo:{itemKey:c},parentItemInfo:t,action:u.t.locate,viewParams:i}))}return Object(K.f)({itemKey:s,itemInfo:t,preserveAction:n,action:a,viewParams:i,page:r,additionalViewParams:o})}(t);break;case P.focus:_=ee(t);break;default:_=function(e){var t,n=e.itemInfo,i=e.viewParams,o=$({itemInfo:n,parentItemInfo:e.parentItemInfo}),s=n.itemKey,c=n.openItemByDefault,d=n.itemExtension,l=n.itemType,f=n.itemErrorType,p=n.itemOpenUrl;return t=l===r.e.Error?function(e){var t,n=e.itemKey,i=e.viewParams;switch(e.itemErrorType||a.requestFailed){case a.marketBlocked:return Object(K._)();case a.userNotReady:return Object(K.O)(Object(K.f)({itemKey:n,viewParams:i}));case a.accessDenied:var r=i.lor;return r&&r.toLowerCase()===Q.a?"?".concat("v","=").concat("error","&").concat("type","=").concat(Q.n):Object(K.w)(Object(K.f)({itemKey:n,viewParams:i,additionalViewParams:(t={},t.sc=i.sc||"",t)}));case a.authenticationExpired:return Object(K.w)(Object(K.f)({itemKey:n,viewParams:i}),!0);case a.userSuspended:var o=Object(K.i)(i)===u.t.feedback?u.t.feedback:void 0;return F.e.si?Object(K.w)(Object(K.f)({itemKey:n,viewParams:i,action:o}),!0):Object(K.f)({itemKey:n,action:o,viewParams:i});case a.passwordRequired:return Object(K.D)(i);case a.requestAccess:return Object(K.y)(i)}return Object(K.f)({itemKey:n,viewParams:i})}({itemKey:s,viewParams:i,itemErrorType:f}):d&&Object(j.e)(d,l)?Z({itemInfo:n,parentItemInfo:o,viewParams:i}):void 0===c||c?c&&p&&-1===p.indexOf("redir.aspx")||d&&(".fluid"===d.toLowerCase()||".loop"===d.toLowerCase())?p:ee({itemInfo:n,parentItemInfo:o,action:u.t.locate,viewParams:i}):ee({itemInfo:n,parentItemInfo:o,action:u.t.defaultClick,viewParams:i}),t}({itemInfo:n,parentItemInfo:i,viewParams:s})}return _}(t,e);return b}({itemInfo:{itemKey:e.key,itemIsStub:e.isStub,itemIsPlaceholder:e.isPlaceholder,itemIsPhoto:!!e.photo,itemIsVideo:!!e.video,itemVirtualItemType:e.virtualItemType,itemExtension:e.extension,itemType:e.type,itemOpenUrl:e.openUrl,itemErrorType:e.error&&e.error.type,openItemByDefault:M},parentItemInfo:L&&{itemKey:k,itemIsAlbum:L.isAlbum,itemIsPlaceholder:L.isPlaceholder,itemIsStub:L.isStub,itemVirtualItemType:L.virtualItemType,itemExtension:L.extension,itemType:L.type,itemOpenUrl:L.openUrl,itemErrorType:L.error&&L.error.type},preserveAction:C,action:w,viewParams:y,page:t.page,queryType:e.queryType,additionalViewParams:t.additionalViewParams,urlType:I})}var T=this._getDefaultUrlFormat(e),U=!!X.e.isActivated("CBF950BB-C412-4331-9430-066677E49966","10/21/2021","Compute OneUp URL for media items in mount points")||e.type!==r.e.Media;return y.mid&&U&&(T=P.current),g=e.type===r.e.Error?P.external:"existing"===I?this._getCurrentUrlFormat(y):"focus"===I||w?w&&w!==u.t.locate&&T===P.current?T:P.focus:T,this._getItemClickUrl(e,S,g,t)},e.prototype.getTagUrl=function(e){var t,n;return n=e.localizedTag&&e.localizedTag!==e.tag?"".concat(e.localizedTag,";").concat(e.tag):e.tag,this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="allmyphotos",t.tagFilter=n,t)),{page:o.e.Photos}))},e.prototype.getAuthenticateUrl=function(e){if(this._useRefactoredDefaultClickUrl)return Object(K.a)(e);var t=F.e.signInUrl;return window.location.href.indexOf("iam=")>-1?(t+="&redirect_uri={0}",e=this.getCurrentPageBaseUrl()+"/business"):t+="&ru={0}&wreply={0}",b.n(t,g.e.encodeURIComponent(e||window.location.href))},e.prototype.getLanguageWithAuthenRedirectUrl=function(){return Object(K.m)()},e.prototype.getRootUrl=function(e){var t;void 0===e&&(e=this._navigation.viewParams);var n=((t={}).iam=this.getIAmParamValue(e),t);return this.getCurrentPageBaseUrl()+"?"+h.t(n,null,!0)},e.prototype.getCurrentSiteUrl=function(){return window.location.href},e.prototype.getCurrentPageBaseUrl=function(){return window.location.protocol+"//"+window.location.host},e.prototype.getMarketBlockedUrl=function(){return this._useRefactoredDefaultClickUrl?Object(K._)():this.getCurrentPageBaseUrl()+"/marketblockerror.aspx"},e.prototype.getValidatePermissionUrl=function(){if(this._useRefactoredDefaultClickUrl)return Object(K.D)(this._navigation.viewParams);var e={};return e.id=this._navigation.viewParams.id,e.challengeToken=this._navigation.viewParams.authkey,e.v="validatepermission",this.getCurrentPageBaseUrl()+"?"+h.t(e,null,!0)},e.prototype.getRequestAccessUrl=function(){if(this._useRefactoredDefaultClickUrl)return Object(K.y)(this._navigation.viewParams);var e={};return e.id=this._navigation.viewParams.id,e.challengeToken=this._navigation.viewParams.authkey,e.v="requestaccess",this.getCurrentPageBaseUrl()+"?"+h.t(e,null,!0)},e.prototype.handleFatalErrorDuringViewLoad=function(){try{throw new Error("Fatal error during view load")}catch(e){console.error(e)}0===document.cookie.indexOf("sr=3")||document.cookie.indexOf("; sr=3")>-1?this._setFatalErrorCookie(0,!0):0===document.cookie.indexOf("sr=2")||document.cookie.indexOf("; sr=2")>-1?(this._setFatalErrorCookie(3,!1),window.top.location=document.location.href):0===document.cookie.indexOf("sr=")||document.cookie.indexOf("; sr=")>-1?(this._setFatalErrorCookie(2,!1),location.reload(!0)):(this._setFatalErrorCookie(1,!1),window.top.location=document.location.href)},e.prototype.getForceLoginDownloadUrl=function(e){var t="https://"+location.host+"?"+this.getDefaultClickUrl(e.UNSAFE_parent).substring(1);return this.getAuthenticateUrl(t)},e.prototype.getItemUrl=function(e,t){if(void 0===t&&(t={}),this._useRefactoredDefaultClickUrl){var n=t.viewParams,a=void 0===n?this._navigation.viewParams:n,r=t.item;return Object(K.f)(Object(i.e)(Object(i.e)({},t),{itemKey:e,itemInfo:r&&{itemKey:r.key,itemIsPlaceholder:r.isPlaceholder,itemVirtualItemType:r.virtualItemType,itemExtension:r.extension,itemType:r.type},viewParams:a}))}var o=this._getItemQueryParams(e,t),s=t.additionalViewParams;return s&&s.sc?Object(J.e)(o,s):delete o.sc,"#"+h.t(o,null,!0)},e.prototype.getSuiteNavConfigUrl=function(e){var t;void 0===e&&(e=this._navigation.viewParams);var n=((t={}).iam=this.getIAmParamValue(e),t);return"/getsuitenavconfig?"+h.t(n,null,!0)},e.prototype.getApiName=function(){return"Vroom"},e.prototype.getApiBaseUrl=function(t){return e.getVroomBaseUrl(t)},e.prototype.getAppliedDateFilter=function(e){var t;if(void 0===e&&(e=this._navigation.viewParams),!e.df)return p.anyDate;var n=(Date.parse(e.endDate)-Date.parse(e.beginDate))/864e5;switch(Math.floor(n)){case 1:t=p.oneDay;break;case 30:t=p.oneMonth;break;case 7:t=p.oneWeek;break;case 365:t=p.oneYear}return t},e.prototype.getResourcePreloadUrl=function(){return"/preload?manifest=wac"},e.prototype.getHipCheckUrl=function(){return"https://mail.".concat(de?"live-int":"live",".com/?rru=hip")},e.prototype.getVerifyAccountUrl=function(){return"https://g.live.com/8SESkydrive/VerifyAccount"},e.prototype.isSearchPassThrough=function(e){return void 0===e&&(e=this._navigation.viewParams),!!e.sp},e.prototype.isLargestFilesView=function(e){return void 0===e&&(e=this._navigation.viewParams),"size"===e.sp},e.prototype.isManageStorageView=function(e){return void 0===e&&(e=this._navigation.viewParams),"managestorage"===e.v},e.prototype.getNavLinkClickUrl=function(e){return""},e.prototype.qualifyUrl=function(e){return this._useRefactoredDefaultClickUrl?Object(K.O)(e):(0===e.indexOf("#")&&(e=this._getCurrentPageUrl(2,e.substring(1))),e)},e.prototype.getSignInUrlWithAction=function(e,t){var n=t||F.e.si;if(!n)return"";var a=T.t(n),i=h.e(a),r=i.wreply,o="wreply";he&&(o=r?"wreply":"ReturnUrl",r=r||i.ReturnUrl);var s=T.t(r),c=h.e(s);return c.action=u.t[e],i[o]="".concat(T.n(r),"?").concat(h.t(c)),"".concat(T.n(n),"?").concat(h.t(i))},e.prototype.getNewPlaceholderItemKey=function(){var t;return h.t(((t={}).id="placeHolder ".concat(e.placeholderId++),t))},e.prototype.getIAmParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.iam},e.prototype.getAuthKeyParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(K.n)(e)},e.prototype.getTicketParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.ticket},e.prototype.getReferrer=function(e){return void 0===e&&(e=this._navigation.viewParams),e.referrer},e.prototype.getContextualFilter=function(e){return void 0===e&&(e=this._navigation.viewParams),this._useRefactoredDefaultClickUrl?Object(q.n)(e):e.ft},e.prototype.getMyRestorePageUrl=function(){return Promise.resolve("")},e.prototype.getTextEditorItemUrl=function(e,t){var n=t.parentItem,a=t.viewParams;if(this._useRefactoredDefaultClickUrl)return Z({itemInfo:{itemKey:e.key,itemExtension:e.extension,itemType:e.type},parentItemInfo:n&&{itemKey:n.key},viewParams:a});var i=this._getItemQueryParams(e.key,{item:e,page:o.e.TextFileEditor,viewParams:a}),r=n||e.UNSAFE_parent,s=this.getKeyParams(r&&r.key||"");i.parId=s.id;var c=h.t(i,null,!0);return"TextFileEditor"!==a.v?this._getCurrentPageUrl(2,c):"#"+c},e.prototype.getQueryUrl=function(e,t){return this._requireAuthentication(this.getItemUrl(this.getRootItemKey(t),{page:e}))},e.prototype.getMpcOneDriveUrl=function(){return"".concat(fe,"/personal/").concat(e.viewerId,"/_layouts/15/onedrive.aspx")},e.prototype.getOneDriveAppGalleryViewUrl=function(){return"https://".concat(Q.t,"/")},e.prototype.getOneDriveAppExplorePageUrl=function(){return"https://".concat(Q.t,"/explore")},e.prototype.getOneDriveAppSingleTagPageUrl=function(e){return e?"https://".concat(Q.t,"/explore/things/thing?name=").concat(e,"&fallback=%2Fexplore"):""},e.prototype.getOneDriveAppSingleLocationPageUrl=function(e){if(!e)return"";var t=e.split("\t"),n=t[0],a=t[1],i=t[2];return"https://".concat(Q.t,"/explore/places/place?country=").concat(n||"","&state=").concat(a||"","&city=").concat(i||"","&fallback=%2Fexplore")},e.prototype.getOneDriveAppAllAlbumsPageUrl=function(){return"https://".concat(Q.t,"/albums")},e.prototype.getOneDriveAppSingleAlbumPageUrl=function(e){return e?"https://".concat(Q.t,"/albums/").concat(e):""},e.prototype._getItemQueryParams=function(e,t){var n=void 0===t?{}:t,a=n.item,r=n.page,o=n.action,d=n.preserveAction,f=void 0!==d&&d,p=n.viewParams,m=void 0===p?this._navigation.viewParams:p,_=this.getKeyParams(e),h=Object(i.e)({},_),b=Object(K.v)(m);void 0!==r&&(b.v=this._getPageParamValue(r,m));var g=!1,v=Object(j.t)(null==a?void 0:a.extension,null==a?void 0:a.type);if(a&&!a.isPlaceholder)switch("TextFileEditor"===b.v&&(v||(b.v="")),a.virtualItemType){case l.e.Album:case l.e.AlbumRoot:case l.e.Tag:case l.e.TagsRoot:b.v="photos",g=!0}else switch(h.id){case"tags":case"places":case"albums":b.v="photos",g=!0}"allmyphotos"===_.qt&&(h.v="photos",g=!0,"true"!==_.onThisDay&&"true"!==_.onThisMonth&&"true"!==_.lastWeekPreviousYears||(m&&m.startDate&&(h.startDate=m.startDate),m&&m.cid&&(h.cid=m.cid))),"photostream"===_.qt&&(h.v="photoStream",h.psShareId=m.psShareId);var y=this.getQueryType(_);v||!a||g||y===s.e.Search||y===s.e.AllMyPhotos||y===s.e.PhotoStream||(h.v=""),!v&&Object(c.e)(y)&&("photos"!==b.v&&"photoStream"!==b.v||this.getContextualFilter(_)!==K.e.photos.toString())&&(h.v=""),this._isFilePickerPage(b.v)&&(h.v=b.v),delete h.u;var S=this.getAutoActionType(m);return o?h.action=o&&u.t[o]&&u.t[o].toLowerCase()||"":f&&S&&(S===u.t.showProperties&&h.o||(h.action=u.t[S].toLowerCase())),Object(J.e)(b,h),b},e.prototype._getDateDuration=function(e,t){var n=new Date(t.toString())||new Date;switch(e){case p.oneDay:n.setDate(n.getDate()-1);break;case p.oneMonth:n.setDate(n.getDate()-30);break;case p.oneWeek:n.setDate(n.getDate()-7);break;case p.oneYear:n.setDate(n.getDate()-365)}return n},e.prototype._setFatalErrorCookie=function(e,t){var n="sr="+e+"requireDeps;path=/;domain="+window.$Config.urlHost+";";t&&(n+="expires="+new Date(2e3,1,1).toUTCString()+";"),document.cookie=n},e.prototype._getCurrentUrlFormat=function(e){return void 0===e&&(e=this._navigation.viewParams),this.getFocusItemKey(e)?P.focus:P.current},e.prototype._getDefaultUrlFormat=function(e){var t;switch(e.type){case r.e.Media:t=P.focus;break;case r.e.Folder:case r.e.Error:t=P.current;break;default:t=P.external}return t},e.prototype._getItemClickUrl=function(e,t,n,a){var i=a.viewParams,r=void 0===i?this._navigation.viewParams:i,s=a.page,c=void 0===s?this.getPageType(r):s;if(n!==P.current&&c===o.e.FilePicker)return"";var d,l=this.getKeyParams(e.key);if(this.isRecycleBin(e.queryType)&&!this.isRecycleBin(this.getQueryType(l)))return"";if(Object(j.t)(e.extension,e.type))n=c===o.e.TextFileEditor?P.external:P.focus;else if(c===o.e.TextFileEditor&&this.getAutoActionType(r)===u.t.createTextDocument)return"#"+h.t(r,null,!0);switch(n){case P.current:d=this._getCurrentItemUrl(e,a);break;case P.focus:d=this._getFocusItemUrl(e,t,a);break;default:d=this._getDefaultItemUrl(e,{itemSet:t,viewParams:r})}return d},e.prototype._getCurrentItemUrl=function(e,t){var n=void 0===t?{}:t,a=n.preserveAction,i=n.action,r=n.viewParams,o=void 0===r?this._navigation.viewParams:r,s=n.page,c=n.additionalViewParams;if(e.isStub){var d=this.getFocusItemKey(o);if(d)return this.getAutoActionType(o)===u.t.locate?"":this._getFocusItemUrlFromKey(d,e,{action:u.t.locate,viewParams:o})}return this.getItemUrl(e.key,{item:e,preserveAction:a,action:i,viewParams:o,page:s,additionalViewParams:c})},e.prototype._getFocusItemUrl=function(t,n,a){var i,r=this._getParentItem(t,n),o=!!a.viewParams&&Boolean("photos"===a.viewParams.v&&(t.video||t.photo)&&"allmyphotos"!==a.viewParams.qt&&!a.viewParams.parId&&!a.viewParams.parQt&&r&&!r.isAlbum),s={key:this.getKey((i={},i.qt="allmyphotos",i.id="root",i.cid=e.viewerId,i))};return this._getFocusItemUrlFromKey(t.key,o?s:r,a)},e.prototype._getFocusItemUrlFromKey=function(t,n,a){var i=void 0===a?{}:a,r=i.preserveAction,o=void 0!==r&&r,s=i.action,c=i.viewParams,d=void 0===c?this._navigation.viewParams:c,l=i.additionalViewParams,u=n&&n.key||"",f=this.getKeyParams(t),p=this._getItemQueryParams(u,{item:n,preserveAction:o,action:s,viewParams:d});d&&d.commentId&&(f.commentId=d.commentId),f.parId=p.id,f.parQt=p.qt,f.cid!==p.cid&&(f.parCid=p.cid,delete p.cid),delete p.internalPath,delete p.qt,delete p.id,delete f.u;var m=p.action;return m?d&&d.commentId&&"showproperties"===m.toLowerCase()?(delete p.action,f.o=e.oneUpOverlayValue):(delete p.action,f.action=m):f.o=e.oneUpOverlayValue,l&&Object(J.e)(f,l),"#"+h.t(f,p,!0)},e.prototype._getPageParamValue=function(e,t){var n,a=t.v;switch(e){case o.e.FilePicker:n=this._isFilePickerPage(a)?a:"FilePickerView";break;case o.e.TextFileEditor:n="TextFileEditor";break;case o.e.Photos:n="photos";break;case o.e.RansomwareDetection:n="RansomwareDetection";default:case o.e.Files:}return n},e.prototype._getErrorItemUrl=function(t,n){var i;switch(void 0===n&&(n=this._navigation.viewParams),t&&t.error&&t.error.type||a.requestFailed){case a.marketBlocked:return this.getMarketBlockedUrl();case a.userNotReady:return this.qualifyUrl(this.getItemUrl(t.key));case a.accessDenied:var r=n.lor;return r&&r.toLowerCase()===e.linkOriginParamValue?"?".concat("v","=").concat("error","&").concat("type","=").concat(e.linkNotSupportedParamValue):this._requireAuthentication(this.getItemUrl(t.key,{viewParams:n,additionalViewParams:(i={},i.sc=n.sc||"",i)}));case a.authenticationExpired:return this._requireAuthentication(this.getItemUrl(t.key,{viewParams:n}),!0);case a.userSuspended:var o=this.getAutoActionType(n)===u.t.feedback?u.t.feedback:void 0;return F.e.si?this._requireAuthentication(this.getItemUrl(t.key,{viewParams:n,action:o}),!0):this.getItemUrl(t.key,{action:o});case a.passwordRequired:return this.getValidatePermissionUrl();case a.requestAccess:return this.getRequestAccessUrl()}return this.getItemUrl(t.key)},e.prototype._getDefaultItemUrl=function(e,t){var n,a,i=void 0===t?{}:t,o=i.itemSet,s=i.viewParams,c=void 0===s?this._navigation.viewParams:s,d=this._getParentItem(e,o);if(e.type===r.e.Error)a=this._getErrorItemUrl(e,c);else if(Object(j.t)(e.extension,e.type))a=this.getTextEditorItemUrl(e,{parentItem:d,viewParams:c});else{var l=null===(n=null==e?void 0:e.properties)||void 0===n?void 0:n.commandsSupported,f=(null==l?void 0:l.defc)||"";a=f&&"1"!==f?this._getFocusItemUrl(e,o,{action:u.t.defaultClick,viewParams:c}):"1"===f&&e.openUrl&&(-1===e.openUrl.indexOf("redir.aspx")||e.extension&&(".fluid"===e.extension.toLowerCase()||".loop"===e.extension.toLowerCase()))?e.openUrl:this._getFocusItemUrl(e,o,{action:u.t.locate,viewParams:c})}return a},e.prototype._getCurrentPageUrl=function(t,n){if(this._useRefactoredDefaultClickUrl)return Object(K.o)(t,n);var a=[];switch(a.push(this.getCurrentPageBaseUrl()),t){case 0:a.push("/");break;case 1:a.push(e.nextSiteUrlPrefix);break;default:a.push(this._getCurrentUrlPathName())}return a.push("?"),a.push(n),a.join("")},e.prototype._getCurrentUrlPathName=function(){return this._useRefactoredDefaultClickUrl?Object(K.s)():window.location.pathname},e.prototype._isFilePickerPage=function(e){var t;switch(e){case"FilePickerView":case"2":case"FolderPickerView":case"1":case"pickerconsent":t=!0;break;default:t=!1}return t},e.prototype._requireAuthentication=function(e,t){return void 0===t&&(t=!1),this._useRefactoredDefaultClickUrl?Object(K.w)(e,t):t||F.e.si?this.getAuthenticateUrl(this.qualifyUrl(e)):e},e.prototype._getParentItem=function(e,t){var n=t&&t.item.peek();return n&&n.key!==e.key&&n||e.UNSAFE_parent},e.dependencies={navigation:B.e,useRefactoredDefaultClickUrl:ge,enableFastOneUp:ve},e.oneUpOverlayValue=Q.r,e.EXTERNAL_URL_FORMAT="/externalredirector?alias=",e.skyApiBaseUrl=le+"/API/2/",e.viewerId=K.A,e.storageBaseUrl=ue,e.feedbackBaseUrl="https://cid-{0}.users.storage.live.com",e.tagsFeedbackBaseUrl="https://storage.live.com",e.peopleBaseUrl="https://people.onedrive.com",e.nextSiteUrlPrefix=Q.i,e.scenarioName="odweb",e.locateActionName="locate",e.linkOriginParamValue="shorturl",e.linkNotSupportedParamValue="linknotsupported",e.createTextDocumentActionValue="createTextDocument",e.contentTypeByLayoutType=((ne={}).photo="Album",ne.list="List",ne.grid="Grid",ne),e.placeholderId=0,e}();t.e=ye,Object(R.i)("UrlDataSource",ye)},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return c}),n.d(t,"t",function(){return d});var a,i=n(17),r=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],o=null;function s(e,t){return function(){var n=arguments,a=c(t);if(a){var i=a.listener;i&&i[e]&&i[e].apply(i,n)}}}function c(e){var t,n=o;return n||!0===e.disableDbgExt||(n=o||((t=Object(i.i)("Microsoft"))&&(o=t.ApplicationInsights),o)),n?n.ChromeDbgExt:null}function d(e){if(!a){a={};for(var t=0;t<r.length;t++)a[r[t]]=s(r[t],e)}return a}},function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(42),i=n(17),r=n(1);function o(){var e=[];return{add:function(t){t&&e.push(t)},run:function(t,n){Object(r.e)(e,function(e){try{e(t,n)}catch(e){Object(a.n)(t.diagLog(),2,73,"Unexpected error calling unload handler - "+Object(i.e)(e))}}),e=[]}}}},,,function(e,t,n){"use strict";var a=n(0),i=n(131),r=n(15),o=n(65),s=n(371),c=n(57),d=n(26),l=n(12),u=n(7),f=!u.e.isActivated("A16A5721-519F-48ED-BB73-3808D363EDDC","11/03/2023","Retries on invalid canary"),p={canary:d.e.canary,Accept:"application/json",AppId:d.e.appId,"Cache-Control":"private","X-ForceCache":"1"};d.e.oauthToken&&(p["X-Auth"]=d.e.oauthToken);var m=function(){function e(){}return e.prototype.canHandleRequest=function(e){return!0},e.prototype.handleRequest=function(e,t){var n=new s.e(t);try{var i=new XMLHttpRequest;e.withCredentials&&(i.withCredentials=!0),i.open(e.requestType||"GET",e.url,!0),e.responseType&&(i.responseType=e.responseType),i.timeout=6e4;var r=e.useDefaultHeaders?function(e){var t=Object(a.e)(Object(a.e)({},p),e||{}),n=function(){var e=window.location.search,t="";if(e){var n=l.e(e.substring(1)).iam,a=c.get("aad_auth:"+n);if(a){var i="id_token=",r=a.indexOf(i);t=a.substring(r+i.length,a.indexOf("&",r))}}return t}();return n&&(t.Authorization="Bearer "+n),!d.e.canary||d.e.canary===t.canary||f&&d.e.skyApiCanary===t.canary||(t.canary=d.e.canary),t}(e.headers):e.headers||{};for(var o in r.Accept||i.setRequestHeader("Accept","application/json;odata=verbose"),e.postData&&!r["Content-Type"]&&i.setRequestHeader("Content-Type","application/json;odata=verbose"),r)r[o]&&i.setRequestHeader(o,r[o]);i.onreadystatechange=function(){4===i.readyState&&n.complete(i)},i.send(e.postData)}catch(e){n.error(e)}return n.getPromise()},e}(),_=window.FilesConfig&&window.FilesConfig.skyApiDomain,h=function(){function e(){this._requests=[]}return e.prototype.canHandleRequest=function(e){return e.indexOf(_)>-1},e.prototype.handleRequest=function(e,t){var n=this,a=new s.e(function(){n._removeSignal(a),t()});return this._bypassProxy(a,e),a.getPromise()},e.prototype._bypassProxy=function(e,t){var n;this._basicRequestor||(this._basicRequestor=new m),t.disableLogging||(n=new o.e({url:t.url,name:t.qosName||"DataRequest.NoSkyProxy."+t.apiName})),t.withCredentials=!0,t.useDefaultHeaders=!0,this._basicRequestor.handleRequest(t,function(){n&&n.end({resultType:r.t.ExpectedFailure}),e.cancel()}).then(function(t){e.complete(t),n&&n.end({resultType:r.t.Success})},function(t){e.error(t),n&&n.end({resultType:r.t.Failure})})},e.prototype._removeSignal=function(e){this._requests=this._requests.filter(function(t){return e!==t.signal})},e}(),b=function(){function e(){}return e.prototype.canHandleRequest=function(e){return e.indexOf("storage.live.com")>-1},e.prototype.handleRequest=function(e,t){var n=new s.e(t);return this._bypassProxy(n,e),n.getPromise()},e.prototype._bypassProxy=function(e,t){var n;this._basicRequestor||(this._basicRequestor=new m),t.disableLogging||(n=new o.e({url:t.url,name:t.qosName||"BaseStorageRequest."+t.apiName})),t.withCredentials=!0,this._basicRequestor.handleRequest(t,function(){null==n||n.end({resultType:r.t.ExpectedFailure}),e.cancel()}).then(function(t){e.complete(t),null==n||n.end({resultType:r.t.Success})},function(t){e.error(t),null==n||n.end({resultType:r.t.Failure})})},e}(),g=function(){function e(){}return e.prototype.canHandleRequest=function(e){return e.indexOf(".users.storage.live.com")>-1},e.prototype.handleRequest=function(e,t){var n=new s.e(t);return this._bypassProxy(n,e),n.getPromise()},e.prototype._bypassProxy=function(e,t){var n;this._basicRequestor||(this._basicRequestor=new m),t.disableLogging||(n=new o.e({url:t.url,name:t.qosName||"StorageRequest."+t.apiName})),t.withCredentials=!0,this._basicRequestor.handleRequest(t,function(){null==n||n.end({resultType:r.t.ExpectedFailure}),e.cancel()}).then(function(t){e.complete(t),null==n||n.end({resultType:r.t.Success})},function(t){e.error(t),null==n||n.end({resultType:r.t.Failure})})},e}(),v=n(125),y=[{Constructor:h},{Constructor:g},{Constructor:b},{Constructor:m}],S=!u.e.isActivated("A16A5721-519F-48ED-BB73-3808D363EDDC","11/03/2023","Retries on invalid canary"),D=function(){function e(){}return e.prototype.send=function(e){return I(e)},e.prototype.sendPost=function(e,t,n){return I({apiName:e,url:t,requestType:"POST",postData:n})},e.prototype.sendPostUrlEncoded=function(e,t,n){return I({apiName:e,url:t,requestType:"POST",postData:n,headers:{"Content-Type":"application/x-www-form-urlencoded;"}})},e}();function I(e,t){var n;if(void 0===t&&(t=!1),e.requestType=e.requestType||"GET",!e.disableLogging){var s=e.url;s=s&&s.replace(/authkey=[^&]+&?/gi,""),n=new o.e({url:s,name:e.qosName||"DataRequest."+e.apiName})}var c,d=function(e){for(var t=0,n=y;t<n.length;t++){var a=n[t];if(a.instance||(a.instance=new a.Constructor),a.instance.canHandleRequest(e.url))return a.instance}}(e),l=d.getHandlerContentWindow&&d.getHandlerContentWindow(),u=(c=l||window)&&c.performance||void 0,f=u&&u.now();return d.handleRequest(e,function(){n&&n.end({resultType:r.t.ExpectedFailure})}).then(function(o){if(!e.returnRawXHR){var s=function(e){var t,n=e.data,a=e.apiEvent;if(!n||0===n.status)return a.end({error:"Unkown client side request error (status code 0)",resultType:r.t.ExpectedFailure}),i.t.reject({message:"Promise failed with empty error response",url:n&&n.responseURL||"",status:0,data:void 0});if(200===n.status||201===n.status){var o=JSON.parse(n.responseText);return a&&a.end({resultType:r.t.Success}),o}var s="",c="";try{var d=JSON.parse(n.responseText);t=d&&d.error||d,s=d&&d.transactionId||"",c=n.getResponseHeader("MS-CV")||""}catch(e){t={message:n.responseText}}var l=t,u=t&&t.items;if(u)for(var f=0,p=u;f<p.length;f++){var m=p[f];if(m.error){l=m.error;break}}l||(l={}),l.transactionId=s,l.msCorrelationVector=c;var _={errorCode:l&&l.code||"",errorTitle:""},h=e.isErrorExpectedCallback&&e.isErrorExpectedCallback(_);return a&&function(e,t,n,a){var i={resultCode:n&&n.code||"",resultType:a?r.t.ExpectedFailure:r.t.Failure,extraMetrics:{httpStatus:e.status,httpStatusText:e.statusText}};if(n&&n.items)for(var o=0,s=n.items;o<s.length;o++){var c=s[o];if(c.error){n=c.error;break}}n&&(i.error=n.debugMessage||n.message,i.extraData={stack:n.stackTrace,isExpected:n.isExpected,transactionId:n.transactionId,msCorrelationVector:n.msCorrelationVector}),t.end(i)}(n,a,l,h),i.t.reject({message:"Promise failed without error handler",url:n.responseURL||"",status:n.status,data:t})}({data:o,apiEvent:n,isErrorExpectedCallback:e.isErrorExpectedCallback});return S&&FilesConfig.skyApiCanary&&s.catch?s.catch(function(n){var i;return 103!==(null===(i=n.data)||void 0===i?void 0:i.code)||t?s:(e.headers=Object(a.e)(Object(a.e)({},e.headers),{canary:FilesConfig.skyApiCanary}),I(e,!0))}):s}var c=Object(v.e)(e.url,f,l);return n&&n.end({resultType:r.t.Success,extraData:{rawRequestDuration:c.duration,performanceEntry:JSON.stringify(c)}}),o},function(t){if(t&&t.isProxyFailure)return n.end({error:t.message,resultType:r.t.ExpectedFailure}),i.t.reject(t.message);if(n){var a=Object(v.e)(e.url,f,l),o=t&&t.message||t||"Unkown error occurred while creating API request";n.end({error:o,resultType:r.t.Failure,extraData:{rawRequestDuration:a.duration,performanceEntry:JSON.stringify(a)}})}return i.t.reject(t)})}t.e=D},,,function(e,t,n){"use strict";n.d(t,"e",function(){return p}),n.d(t,"d",function(){return h}),n.d(t,"r",function(){return b}),n.d(t,"c",function(){return g}),n.d(t,"u",function(){return v}),n.d(t,"a",function(){return y}),n.d(t,"i",function(){return S}),n.d(t,"t",function(){return D}),n.d(t,"n",function(){return I}),n.d(t,"o",function(){return x}),n.d(t,"f",function(){return C}),n.d(t,"s",function(){return w}),n.d(t,"l",function(){return E});var a,i=n(19),r=n(110),o=n(17),s=n(1),c=n(54),d=n(155),l=n(6),u=n(88),f=n(45),p="1DS-Web-JS-3.2.2",m="withCredentials",_=((a={})[0]=0,a[2]=6,a[1]=1,a[3]=7,a[4098]=6,a[4097]=1,a[4099]=7,a);function h(e){return!(""===e||Object(s.h)(e))}function b(e){if(e){var t=e.indexOf("-");if(t>-1)return e.substring(0,t)}return""}function g(e){return!!(e&&Object(s.b)(e)&&e>=1&&e<=4)}function v(e,t,n){if(!t&&!h(t)||"string"!=typeof e)return null;var a,i=typeof t;if("string"===i||"number"===i||"boolean"===i||Object(s.d)(t))t={value:t};else if("object"!==i||t.hasOwnProperty("value")){if(Object(s.h)(t.value)||""===t.value||!Object(s.v)(t.value)&&!Object(s.b)(t.value)&&!Object(s.l)(t.value)&&!Object(s.d)(t.value))return null}else t={value:n?JSON.stringify(t):t};if(Object(s.d)(t.value)&&!(t.value.length>0))return null;if(!Object(s.h)(t.kind)){if(Object(s.d)(t.value)||!(0===(a=t.kind)||a>0&&a<=13||32===a))return null;t.value=t.value.toString()}return t}function y(e,t,n){var a=-1;if(!Object(s.D)(e))if(t>0&&(32===t?a=8192:t<=13&&(a=t<<5)),function(e){return e>=0&&e<=9}(n))-1===a&&(a=0),a|=n;else{var i=_[O(e)]||-1;-1!==a&&-1!==i?a|=i:6===i&&(a=i)}return a}function S(e,t,n){var a;return void 0===n&&(n=!0),e&&(a=e.get(t),n&&a&&decodeURIComponent&&(a=decodeURIComponent(a))),a||""}function D(e){void 0===e&&(e="D");var t=Object(d.t)();return"B"===e?t="{"+t+"}":"P"===e?t="("+t+")":"N"===e&&(t=t.replace(/-/g,"")),t}function I(e,t,n,a,i){var r={},o=!1,c=0,d=arguments.length,u=Object[l.l],f=arguments;for("[object Boolean]"===u.toString.call(f[0])&&(o=f[0],c++);c<d;c++)e=f[c],Object(s.O)(e,function(e,t){o&&t&&Object(s.g)(t)?Object(s.d)(t)?(r[e]=r[e]||[],Object(s.e)(t,function(t,n){t&&Object(s.g)(t)?r[e][n]=I(!0,r[e][n],t):r[e][n]=t})):r[e]=I(!0,r[e],t):r[e]=t});return r}Boolean(Object(o.a)()),Boolean(Object(o.l)());var x=d.n;function C(e,t){var n=e;n.timings=n.timings||{},n.timings.processTelemetryStart=n.timings.processTelemetryStart||{},n.timings.processTelemetryStart[t]=x()}function O(e){var t=0;if(null!=e){var n=typeof e;"string"===n?t=1:"number"===n?t=2:"boolean"===n?t=3:n===i.d&&(t=4,Object(s.d)(e)?(t=4096,e.length>0&&(t|=O(e[0]))):Object(s.c)(e,"value")&&(t=8192|O(e.value)))}return t}function w(){return!!Object(o.i)("chrome")}function E(e,t,n,a,i,r){function o(e,t,n){try{e[t]=n}catch(e){}}void 0===a&&(a=!1),void 0===i&&(i=!1);var s=new XMLHttpRequest;return a&&o(s,"Microsoft_ApplicationInsights_BypassAjaxInstrumentation",a),n&&o(s,m,n),s.open(e,t,!i),n&&o(s,m,n),!i&&r&&o(s,"timeout",r),s}l.u,l.d,l.u,s.e,s.t,s.n,s.a,s.E,s.R,o.h,s.v,s.b,s.l,s.p,s.d,s.g,s.F,o.p,s.R,o.g,c.t,c.i,s.x,u.a,u.e,s.T,s.O,s.S,s.D,s.h,s.c,s.p,s.g,s.u,s.d,s.f,s.v,s.b,s.l,s.R,s.e,s.t,s.n,s.a,s.F,r.t,s.E,s.x,u.e,s.i,o._,d.t,d.n,f.n,f.i,f.a,f.t,f.e,d.e},,,,,,,function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},,,function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),t.AuthType=void 0,(a=t.AuthType||(t.AuthType={}))[a.Aad=1]="Aad",a[a.Msa=2]="Msa"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbtHost=void 0;var a=function(){function e(){}return e.abtWorldWideSvc="identity.osi.office.net",e.abtTrailblazer="identity.osi.office365.us",e.abtPathfinderSvc="identity.osi.apps.mil",e.abtSignOut="odc.officeapps.live.com",e}();t.AbtHost=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbtEvent=void 0;var a=function(){function e(){}return e.hostSignOut="abtSignOutEventForHost",e.hostSignOutUserGenerated="abtSignOutEventForHostUserGenerated",e.initializeResult="abtInitializeResult",e.promptShown="abtPromptShown",e}();t.AbtEvent=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbtEventProperty=void 0;var a=function(){function e(){}return e.detail="detail",e.eventId="eventId",e.signOutPageUrl="signoutPageUrl",e.userId="userId",e.initializeResult="initializeResult",e.initializeMessage="initializeMessage",e}();t.AbtEventProperty=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbtRegistration=void 0;var a=function(){function e(){}return e.maxAttempts=3,e.timeToSleepInMsecs=10,e}();t.AbtRegistration=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TimeUtils=void 0;var a,i,r=n(70),o=n(66);a=t.TimeUtils||(t.TimeUtils={}),i="TimeUtils",a.addMinutes=function(e,t){var n="addMinutes";if(r.LoggingUtils.log("Start add minutes operation",i,n,o.Global.gAbtSkipAriaLog),null==e)return r.LoggingUtils.warn("date param cannot be null, undefined or empty.",i,n),null;var a=new Date(e);return"Invalid Date"===a.toString()?(r.LoggingUtils.error("date param doesn't have valid date value - '"+a.toString()+"'",i,n),null):(a.setTime(a.getTime()+6e4*t),a)},a.addSeconds=function(e,t){var n="addSeconds";if(r.LoggingUtils.log("Start add seconds operation",i,n,o.Global.gAbtSkipAriaLog),null==e)return r.LoggingUtils.warn("date param cannot be null, undefined or empty.",i),null;var a=new Date(e);return"Invalid Date"===a.toString()?(r.LoggingUtils.error("date param doesn't have valid date value - '"+a.toString()+"'",i,n),null):(a.setTime(a.getTime()+1e3*t),a)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbtTimer=void 0;var a=function(){function e(){}return e.promptInterval=6e4,e.signOutInterval=6e4,e.activityInterval=6e4,e}();t.AbtTimer=a},,,function(e,t,n){"use strict";n.d(t,"e",function(){return w});var a=n(0),i=n(100),r=n(81),o=n(131),s=n(371),c=n(15),d=n(56),l=n(23),u=new(n(4).t)("TokenFetcher.key"),f=n(222),p=n(8),m=n(183),_=n(106),h=n(7),b={showFre:"showFre",showPremiumPositioning:"showPremiumPositioning",showNewFeaturesExperience:"showNewFeaturesExperience",showWelcomeExperience:"showWelcomeExperience",showFamiliesFre:"showFamiliesFre",showGroupsFre:"showGroupsFre",showHolidayPosFre:"showHolidayPosFre",showQuotaLevelUpsellFre:"showQuotaLevelUpsellFre",upsellOverride:"upsell",resetUpsellParams:"resetUpsells",spoSandbox:"spoSandbox",showPwaInstallDialog:"showPwaInstallDialog"};h.e.isActivated("8C62316A-3AF9-4CDB-875D-5C08EA8E7C21","02/24/2022","Stash ODC test hooks to window so that they persist throughout page load and in-app navigations")||function(){if(!window.__testHooks){window.__testHooks={};var e=location.search?location.search.substring(1):"",t=Object(_.e)(e);for(var n in b)t[n]&&(window.__testHooks[n]=t[n])}}();var g=n(46),v=n(71),y=n(47),S=n(195),D=n(57),I=n(16),x=!h.e.isActivated("51FC098A-B1A9-4476-B1F9-A8A3A0120F40","03/01/2023","Set substrate token expiration time manually to an hour"),C=!h.e.isActivated("B257F8BA-2071-43EB-B574-F547E86F454C","04/24/2023","Check for missing email in auth error case"),O=function(){function e(e,t){var n,a,r,o=this;if(this._getResouceByTokenType=function(e){switch(e){case"graph_auth:":return Object(I.a)();case"substrate_auth:":return Object(I.r)();default:return Object(I.i)()}},this._tokenFetcher=t.tokenFetcher,this._tokenCache=new f.t,this._pendingSignals={"msa_auth:":void 0,"graph_auth:":void 0,"msa_strong_auth:":void 0,"phone_link:":void 0,"substrate_auth:":void 0},this._authFrameAttempts={"msa_auth:":0,"graph_auth:":0,"msa_strong_auth:":0,"phone_link:":0,"substrate_auth:":0},this._tokenRefreshCooldowns={"msa_auth:":void 0,"graph_auth:":void 0,"msa_strong_auth:":void 0,"phone_link:":void 0,"substrate_auth:":void 0},this._scope=new v.e,this._async=this._scope.attach(new y.e),this.getIdentity().type===i.e.msa){var s=this._scope.attach(new g.t(this));this._silentAuthOrigin=document.location.protocol+"//"+document.location.hostname,s.on(window,"message",this._onMessageReceived),this._sessionId=$Config.authSessionId||"0",h.e.isActivated("DA868920-AFA9-4023-A5F0-16185C12D46B","10/21/2021","Web canary refresh")||(this._lastCanaryRefreshTime=Date.now(),s.on(window,"focus",function(){Date.now()-o._lastCanaryRefreshTime>6e4&&(o._lastCanaryRefreshTime=Date.now(),o._refreshCanary())}))}n=b.spoSandbox,void 0===a&&(a={}),((null===(r=window.__testHooks)||void 0===r?void 0:r[n])||a[n])&&this.signOut()}return e.prototype.dispose=function(){this._scope.dispose()},e.prototype.getIdentity=function(){var e=i.e.anonymous,t="";return"UnAuth"!==$Config.unid&&(t=$Config.unid,e=$Config.aadClientId&&"live.com"===$Config.domain?i.e.aad:i.e.msa),{email:$Config.email,id:t,loginName:"",type:e,sessionState:""}},e.prototype.getSignInUrl=function(){return FilesConfig.si},e.prototype.signOut=function(){this._expireAuthCookie("msa_auth:"),this._expireAuthCookie("graph_auth:"),this._expireAuthCookie("substrate_auth:")},e.prototype.getSessionToken=function(e,t,n){void 0===e&&(e=!1),void 0===t&&(t=!1);var a=t?"msa_strong_auth:":"msa_auth:";return this._getToken(a,this._getResouceByTokenType(a),e,n)},e.prototype.getGraphToken=function(e){var t=e.forceRefresh,n=void 0!==t&&t,a=e.claimsChallenge;return this._getToken("graph_auth:",this._getResouceByTokenType("graph_auth:"),n,a)},e.prototype.getPhoneLinkToken=function(e){var t=e.resource,n=e.forceRefresh,a=void 0!==n&&n,i=e.claimsChallenge;return this._getToken("phone_link:",t,a,i)},e.prototype.getSubstrateToken=function(e){return this._getToken("substrate_auth:",this._getResouceByTokenType("substrate_auth:"),(null==e?void 0:e.skipCache)||!1)},e.prototype.getAuthUrl=function(e,t){var n=new l.t("https://login.live.com/oauth20_authorize.srf");if(n.setQueryParameter("client_id","00000000481710A4"),n.setQueryParameter("res","success"),n.setQueryParameter("resuictx","selection"),n.setQueryParameter("response_type","token"),this.getIdentity().type===i.e.msa){var a="sa.html";t?a="saroot.html":"soak2"===FilesConfig.env?a="sasoak2.html":"soak3"===FilesConfig.env?a="sasoak3.html":"dev"===FilesConfig.env?a="sadev.html":"onebox"===FilesConfig.env?a="sasb.html":"edog"===FilesConfig.env?a="saedog.html":"prodbubble"===FilesConfig.env&&(a="sadf.html"),n.setQueryParameter("redirect_uri","https://p.sfx.ms/".concat(a)),t||"msa_strong_auth:"===e||n.setQueryParameter("display","none");var r=void 0;switch(e){case"msa_auth:":case"msa_strong_auth:":r="dev"===FilesConfig.env||FilesConfig.isSpoSandbox?"onedrive-devbox.access":"msa_strong_auth:"===e?"onedrive_implicit_forceSA.access":"onedrive_implicit.access";break;case"graph_auth:":Object(p.E)(p.S)?(r="contacts.read Files.ReadWrite people.read",Object(S.e)()&&(r+=" Mail.Read"),Object(p.E)(p.r)&&(r+=" Family.Read")):r="contacts.read";break;case"substrate_auth:":r="https://substrate.office.com/M365.Access"}return n.setQueryParameter("scope",r),h.e.isActivated("EF2D0BBC-FA1F-44F7-A93D-899C2AB1F098","","")||n.setQueryParameter("login_hint",$Config.email),n.toString()}return $Config.silentAuth},e.prototype.refreshAuthTicket=function(){this._silentAuthRpsIframe&&document.body.removeChild(this._silentAuthRpsIframe),this._rpsIFrameQosEvent=new c.e({name:"IdentityDataSource.refreshAuthTicket"}),this._silentAuthRpsIframe=document.createElement("iframe");var e=$Config.silentAuth;this._silentAuthRpsIframe.src=e.replace(r.e.encodeURIComponent("{{RU}}"),r.e.encodeURIComponent("https://onedrive.live.com/sa?msaCallback=1")),document.body.appendChild(this._silentAuthRpsIframe)},e.prototype._refreshCanary=function(){(new m.e).send({apiName:"getPageContext",url:"/getpagecontext"}).then(function(e){e.canary&&FilesConfig.canary!==e.canary&&(FilesConfig.canary=e.canary)})},e.prototype._getToken=function(e,t,n,r){if(!this._tokenFetcher){if(this.getIdentity().type===i.e.aad)return o.t.reject("Unable to get a token for a business account");if(Object(p.E)(p.n)&&this.getIdentity().type===i.e.anonymous)return o.t.reject("Unable to silent auth anonymous unauth users.")}var d;switch(e){case"graph_auth:":d="Graph";break;case"msa_strong_auth:":d="MSAStrong";break;case"phone_link:":d="PhoneLink";break;case"substrate_auth:":d="Substrate";break;default:d="MSA"}var l=new c.e({name:"IdentityDataSource.get".concat(d,"Token")}),u=this._getTokenFromCache(e),f=u.token,m=u.shouldRefresh,_=u.hadCookie;if(n||r){f=void 0;var h=this._tokenRefreshCooldowns[e];h&&h.complete()}if((m||!f)&&!this._pendingSignals[e]){var b=this._pendingSignals[e]=new s.e;this._tokenFetcher?this._tokenFetcher.getToken({resource:t,tokenType:d,name:d,claimsChallenge:r}).then(function(e){b.complete(Object(a.e)({accessToken:e.access_token},"WLID1.1"===e.scheme?{wlidToken:e.access_token}:{}))},function(e){b.error(e)}):this._setupSilentAuthIframe(e)}return f?(l.end({resultType:c.t.Success,resultCode:m?"withinExpiration":"cached",error:_?void 0:"noCookie"}),o.t.resolve({accessToken:f})):this._pendingSignals[e].getPromise().then(function(e){return l.end({resultType:c.t.Success,resultCode:"fullRefresh"}),e},function(e){return l.end({resultType:c.t.Failure,error:e&&e.message}),o.t.reject(e)})},e.prototype._writeTokenToCache=function(e,t,n){this._writeAuthCookie(e,t,n);var a=Date.now()+1e3*(x&&"substrate_auth:"===e?3600:n);if(this._tokenCache){var i=this._getTokenCacheKey(e);this._tokenCache.setValue(i,{value:t,expiration:a})}},e.prototype._getTokenFromCache=function(e){var t=this._getTokenFromCookie(e);if(this._tokenCache){var n=Date.now(),a=this._getTokenCacheKey(e),i=this._tokenCache.getValue(a,n);if(i)return{token:i.value,shouldRefresh:n+6e4>i.expiration,hadCookie:!!t}}return{token:t,shouldRefresh:!t,hadCookie:!!t}},e.prototype._writeAuthCookie=function(e,t,n){var a=this._getTokenCacheKey(e),i=Date.now()+1e3*(x&&"substrate_auth:"===e?3600:n);D.set(a,t,{path:"/",secure:!0,expires:new Date(i).toUTCString()})},e.prototype._getTokenFromCookie=function(e){var t=this._getTokenCacheKey(e);return D.get(t)},e.prototype._expireAuthCookie=function(e){var t=this._getTokenCacheKey(e);D.expire(t,{secure:!0,path:"/"})},e.prototype._getTokenCacheKey=function(e){return e+this.getIdentity().id+this._sessionId},e.prototype._onMessageReceived=function(e){if(this._silentAuthRpsIframe&&e.source===this._silentAuthRpsIframe.contentWindow&&e.origin===window.location.origin&&e.data){var t=this._rpsIFrameQosEvent;"MSA_AuthenticationSuccess"===e.data?(this._refreshCanary(),t.end({resultType:c.t.Success})):"MSA_AuthenticationError"===e.data&&t.end({resultType:c.t.Failure,resultCode:"error"})}else if(this._silentAuthIframe&&e.source===this._silentAuthIframe.contentWindow&&e.origin===this._silentAuthOrigin&&void 0!==this._silentAuthIframeTokenType){t=this._currentIFrameQosEvent;var n="",a=0;if(e.data&&"object"==typeof e.data&&"ODSA"===e.data.source)n=e.data.token,a=parseInt(e.data.expiresIn,10);else{if("string"!=typeof e.data)return;var i=e.data.split(" ");if(2===i.length)n=i[0],a=parseInt(i[1],10);else if(1===i.length){var r=i[0].split("&"),o="error";if(C&&"unknown"===(null===$Config||void 0===$Config?void 0:$Config.email)&&(o="missingEmail"),t.end({resultType:c.t.Failure,resultCode:o}),0===r[0].indexOf("error=access_denied")){var s=null===$Config||void 0===$Config?void 0:$Config.anonId;Object(p.E)(p.a)&&s&&"missingEmail"!==o&&window.open(this.getAuthUrl(this._silentAuthIframeTokenType,!0),"_self")}return}}if(n&&a>0){this._writeTokenToCache(this._silentAuthIframeTokenType,n,a),t.end({resultType:c.t.Success});var d=this._pendingSignals[this._silentAuthIframeTokenType];d&&d.complete({accessToken:n})}else t.end({resultType:c.t.Failure,resultCode:"invalidToken"});this._removeSilentAuthIframe(this._silentAuthIframeTokenType,!0)}},e.prototype._setupSilentAuthIframe=function(e){var t=this;if(!this._silentAuthIframe){this._authFrameAttempts[e]++,this._silentAuthIframeTokenType=e;var n=this._tokenRefreshCooldowns[e];o.t.resolve(n&&n.getPromise()).then(function(){var n=t._currentIFrameQosEvent=new c.e({name:"IdentityDataSource.getTokenViaIFrame",extraData:{authTokenType:e,attemptCount:t._authFrameAttempts[e]}});t._silentAuthIframe=document.createElement("iframe"),t._silentAuthIframe.style.display="none",t._silentAuthIframe.src=t.getAuthUrl(e),document.body.appendChild(t._silentAuthIframe),t._silentAuthIframeTimeoutId=t._async.setTimeout(function(){t._silentAuthIframeTimeoutId=void 0,n.end({resultType:c.t.Failure,resultCode:"timeout"}),t._authFrameAttempts[e]<5?(t._removeSilentAuthIframe(e,!1),t._setupSilentAuthIframe(e)):t._removeSilentAuthIframe(e,!0)},3e4)})}},e.prototype._removeSilentAuthIframe=function(e,t){this._silentAuthIframeTokenType=void 0,this._silentAuthIframe&&(document.body.removeChild(this._silentAuthIframe),this._silentAuthIframe=void 0),void 0!==this._silentAuthIframeTimeoutId&&(this._async.clearTimeout(this._silentAuthIframeTimeoutId),this._silentAuthIframeTimeoutId=void 0);var n=this._tokenRefreshCooldowns[e]=new s.e;if(this._async.setTimeout(function(){n.complete()},3e4),t){var a=this._pendingSignals[e];a&&a.error(new Error("Timed out acquiring OAuth token.")),this._pendingSignals[e]=void 0,this._authFrameAttempts[e]=0,this._pendingSignals["msa_auth:"]?this._setupSilentAuthIframe("msa_auth:"):this._pendingSignals["msa_strong_auth:"]?this._setupSilentAuthIframe("msa_strong_auth:"):this._pendingSignals["graph_auth:"]?this._setupSilentAuthIframe("graph_auth:"):this._pendingSignals["substrate_auth:"]&&this._setupSilentAuthIframe("substrate_auth:")}},e.dependencies={tokenFetcher:u.optional},e}(),w=Object(d.i)("IdentityDataSource",O)},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbtMainOperations=t.AuthType=t.SignOutSource=t.Environment=void 0;var a=n(196);Object.defineProperty(t,"AuthType",{enumerable:!0,get:function(){return a.AuthType}});var i=n(239);Object.defineProperty(t,"SignOutSource",{enumerable:!0,get:function(){return i.SignOutSource}});var r=n(141);Object.defineProperty(t,"Environment",{enumerable:!0,get:function(){return r.Environment}});var o,s=n(198),c=n(199),d=n(306),l=n(308),u=n(66),f=n(70),p=n(245),m=n(90),_=n(79),h=n(169);!function(e){var t="AbtMainOperations";function n(){u.Global.gAbtTrackEvents&&(f.LoggingUtils.log("Registering scroll event.",t,"RegisterScroll",u.Global.gAbtSkipAriaLog),d.RegisterUserActivity.update())}function a(){u.Global.gAbtTrackEvents&&(f.LoggingUtils.log("Registering mouse down event.",t,"RegisterMouseDown",u.Global.gAbtSkipAriaLog),d.RegisterUserActivity.update())}function i(){u.Global.gAbtTrackEvents&&(f.LoggingUtils.log("Registering key down event.",t,"RegisterKeyDown",u.Global.gAbtSkipAriaLog),d.RegisterUserActivity.update())}e.initializeAbt=function(e){var r=null==e?"":e.userId.toUpperCase();r&&""!=r&&(e.userId=e.userId.toUpperCase());var o,p=function(e){var r,o,s="InitializeAbt";f.LoggingUtils.log("Started initialization",t,s),u.Global.gAbtEnableLogging=!0,u.Global.gAbtSkipAriaLog=!m.LocalStorageUtils.findItemWithValue(_.AbtStorageId.enableAriaLogLogging,_.AbtStorageValue.enableAriaLogLogging,!0);var c=!0,p=!0;if(null==e)return o="configurations cannot be null or undefined.",f.LoggingUtils.error(o,t,s),{boolean:!1,string:o};var h=new l.AbtInitOptions(e),b=h.isValidTokenClaims();b.isPassed||(p=!1,r=b.errorMessage,f.LoggingUtils.error("Check for timeout value, sign in state or controls did not pass.",t,s));var g=h.isValid();return g.isPassed||(c=!1,o=g.errorMessage,f.LoggingUtils.error(o,t,s),f.LoggingUtils.error("Completed initialization with an error.",t,s)),u.Global.gAbtMarket=h.market,u.Global.gAbtWorkloadName=h.workloadName,u.Global.gAbtEnvironment=h.environment,u.Global.gAbtUserId=h.userId.toUpperCase(),u.Global.gAbtTenantId=h.tenantId,u.Global.gAbtTimeout=h.timeout,u.Global.gAbtTrackEvents=h.trackEvents,u.Global.gAbtEnableLogging=h.enableLogging,u.Global.gIsAbtInitialized=c&&p,u.Global.gIsAbtAriaLoggingInitialized=f.LoggingUtils.initializeAriaLogging(h.userId,h.authType,h.workloadName,h.sessionId,h.tenantId,h.environment,u.Global.envConfigs),p?c?(f.LoggingUtils.log("Finish initialization successfully.",t,s,void 0,void 0,void 0,u.Global.gAbtTimeout),d.RegisterUserActivity.signIn(),u.Global.gAbtTrackEvents&&(window.addEventListener("scroll",n),window.addEventListener("mousedown",a),window.addEventListener("keydown",i)),{boolean:!0,string:""}):(f.LoggingUtils.error(o,t,s),{boolean:!1,string:o}):(f.LoggingUtils.log(r,t,s),{boolean:!1,string:r})}(e),h=p.boolean,b=p.string,g='{ "'+c.AbtEventProperty.eventId+'": "'+s.AbtEvent.initializeResult+'", "'+c.AbtEventProperty.detail+'": { "'+c.AbtEventProperty.userId+'": "'+r+'", "'+c.AbtEventProperty.initializeResult+'": "'+h+'", "'+c.AbtEventProperty.initializeMessage+'": "'+b+'"} }';return o=JSON.parse(g),window.postMessage(JSON.stringify(o),window.location.origin),h},e.triggerPrompt=function(){return!!m.LocalStorageUtils.findItemWithValue(_.AbtStorageId.enableDebug,_.AbtStorageValue.enableDebug.toString(),!0,!0)&&(h.PromptUtils.showPrompt({result:!0,respectResult:!0,userId:u.Global.gAbtUserId,ui:{keepMeActiveButton:"Stay signed in",description:"Your organization's policy enforces automatic sign out after a period of inactivity on Microsoft 365 web applications.",question:"Do you want to stay signed in?",signOutButton:"Sign out now",title:"Your session is about to expire",divName:"abtPrompt"},timeout:5,timeSinceActivity:250,error:null,diagnostics:{buildVersion:"",correlationId:"",startTime:"",dataCenter:"",duration:"",machine:""}}),!0)}}(o=t.AbtMainOperations||(t.AbtMainOperations={})),window.AbtInteraction={AbtRegisterActivity:d.RegisterUserActivity.update,AbtRegisterSignIn:d.RegisterUserActivity.signIn,AbtRegisterSignOut:d.RegisterUserActivity.signOut,AbtInitialize:o.initializeAbt,AbtTriggerPrompt:o.triggerPrompt,AbtBroadcastSignout:p.SignOutUtils.broadcast,AbtShouldSignOutLocal:p.SignOutUtils.shouldSignOutLocal},window.AbtAuthType={Aad:a.AuthType.Aad,Msa:a.AuthType.Msa},window.AbtSignOutSource={UserGenerated:i.SignOutSource.userGenerated,AbtTimeout:i.SignOutSource.abtTimeout},window.AbtEnvironment={WorldWide:r.Environment.WorldWide,Trailblazer:r.Environment.Trailblazer,Pathfinder:r.Environment.Pathfinder}},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return u}),n.d(t,"t",function(){return p});var a,i=function(){return i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},i.apply(this,arguments)},r="undefined"==typeof window?self:window,o=r&&r.CSPSettings&&r.CSPSettings.nonce,s=((a=r.__themeState__||{theme:void 0,lastStyleElement:void 0,registeredStyles:[]}).runState||(a=i(i({},a),{perf:{count:0,duration:0},runState:{flushTimer:0,mode:0,buffer:[]}})),a.registeredThemableStyles||(a=i(i({},a),{registeredThemableStyles:[]})),r.__themeState__=a,a),c=/[\'\"]\[theme:\s*(\w+)\s*(?:\,\s*default:\s*([\\"\']?[\.\,\(\)\#\-\s\w]*[\.\,\(\)\#\-\w][\"\']?))?\s*\][\'\"]/g,d=function(){return"undefined"!=typeof performance&&performance.now?performance.now():Date.now()};function l(e){var t=d();e();var n=d();s.perf.duration+=n-t}function u(e,t){void 0===t&&(t=!1),l(function(){var n=Array.isArray(e)?e:function(e){var t=[];if(e){for(var n=0,a=void 0;a=c.exec(e);){var i=a.index;i>n&&t.push({rawString:e.substring(n,i)}),t.push({theme:a[1],defaultValue:a[2]}),n=c.lastIndex}t.push({rawString:e.substring(n)})}return t}(e),a=s.runState,i=a.mode,r=a.buffer,o=a.flushTimer;t||1===i?(r.push(n),o||(s.runState.flushTimer=setTimeout(function(){s.runState.flushTimer=0,l(function(){var e=s.runState.buffer.slice();s.runState.buffer=[];var t=[].concat.apply([],e);t.length>0&&f(t)})},0))):f(n)})}function f(e,t){s.loadStyles?s.loadStyles(_(e).styleString,e):function(e){if("undefined"!=typeof document){var t=document.getElementsByTagName("head")[0],n=document.createElement("style"),a=_(e),i=a.styleString,r=a.themable;n.setAttribute("data-load-themed-styles","true"),o&&n.setAttribute("nonce",o),n.appendChild(document.createTextNode(i)),s.perf.count++,t.appendChild(n);var c=document.createEvent("HTMLEvents");c.initEvent("styleinsert",!0,!1),c.args={newStyle:n},document.dispatchEvent(c);var d={styleElement:n,themableStyle:e};r?s.registeredThemableStyles.push(d):s.registeredStyles.push(d)}}(e)}function p(e){s.theme=e,function(){if(s.theme){for(var e=[],t=0,n=s.registeredThemableStyles;t<n.length;t++){var a=n[t];e.push(a.themableStyle)}e.length>0&&(void 0===(i=1)&&(i=3),3!==i&&2!==i||(m(s.registeredStyles),s.registeredStyles=[]),3!==i&&1!==i||(m(s.registeredThemableStyles),s.registeredThemableStyles=[]),f([].concat.apply([],e)))}var i}()}function m(e){e.forEach(function(e){var t=e&&e.styleElement;t&&t.parentElement&&t.parentElement.removeChild(t)})}function _(e){var t=s.theme,n=!1;return{styleString:(e||[]).map(function(e){var a=e.theme;if(a){n=!0;var i=t?t[a]:void 0,r=e.defaultValue||"inherit";return t&&!i&&console,i||r}return e.rawString}).join(""),themable:n}}},function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"a",function(){return s}),n.d(t,"n",function(){return c}),n.d(t,"i",function(){return d});var a,i,r=n(131),o=n(78);function s(){return{CorrelationId:o.e.generate(),MessageId:i.GrabFocus}}function c(){return{CorrelationId:o.e.generate(),MessageId:i.BlurFocus}}function d(e){var t;return function(n,a,i){return t?t(n,a,i):r.t.resolve(e()).then(function(e){return(t=e)(n,a,i)})}}!function(e){e.App_LoadingStatus="App_LoadingStatus",e.SetOverlayContent="SetOverlayContnet",e.UI_CheckUserAccessAndGrantPermissions="UI_CheckUserAccessAndGrantPermissions",e.GetAccessToken="GetAccessToken",e.App_GetCustomAuthConfig="App_GetCustomAuthConfig",e.App_RefreshSessionInfo="App_RefreshSessionInfo",e.File_Rename="File_Rename",e.UI_CopyAndEdit="UI_CopyAndEdit",e.App_WopiInfoFromUrl="App_WopiInfoFromUrl",e.Edit_Notification="Edit_Notification",e.UI_FileEmbed="UI_FileEmbed",e.UI_ShareForm="UI_ShareForm",e.UI_SignIn="UI_SignIn",e.User_Activity="User_Activity",e.App_WopiDavUrlFromIds="App_WopiDavUrlFromIds",e.UI_FileVersions="UI_FileVersions",e.UI_FileProperties="UI_FileProperties",e.App_PushState="App_PushState",e.App_SwitchMode="App_SwitchMode",e.UI_Sharing="UI_Sharing",e.App_MoveToFolder="App_MoveToFolder",e.App_FilePicker="App_FilePicker"}(a||(a={})),function(e){e.BlurFocus="BlurFocus",e.Host_AccessibilityLoopComplete="Host_AccessibilityLoopComplete",e.GrabFocus="GrabFocus",e.CanEmbed="CanEmbed",e.PostAccessToken="PostAccessToken",e.App_PopState="App_PopState",e.Host_RefreshSessionInfo="Host_RefreshSessionInfo",e.CheckUserAccessAndGrantPermissions_Result="CheckUserAccessAndGrantPermissions_Result",e.Host_WopiInfoFromUrl="Host_WopiInfoFromUrl",e.Host_DavUrlFromIds=" Host_DavUrlFromIds",e.Host_SetCustomAuthConfig="Host_SetCustomAuthConfig",e.SetOverlayContent="SetOverlayContent",e.Host_PerfTiming="Host_PerfTiming",e.Host_PostmessageReady="Host_PostmessageReady",e.Host_MoveToFolder="Host_MoveToFolder",e.Host_FilePicker="Host_FilePicker"}(i||(i={}))},,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a=n(69),i=function(){function e(){this._state={}}return e.prototype.getValue=function(e,t){var n=this._state[e];if(n&&t<n.expiration)return n;delete this._state[e]},e.prototype.setValue=function(e,t){t?this._state[e]=t:delete this._state[e]},e}(),r=function(){function e(e){var t=e.userId,n=e.cachingType;this._store=new a.e("Identity.OAuth.".concat(t),n)}return e.prototype.getValue=function(e,t){var n=this._store.getValue(e);if(n&&t<n.expiration)return n;this._store.remove(e)},e.prototype.setValue=function(e,t){t?this._store.setValue(e,t):this._store.remove(e)},e}()},function(e,t,n){"use strict";n.d(t,"e",function(){return G});var a,i=n(0),r=(n(194),n(25));!function(e){e[e.created=0]="created",e[e.started=1]="started",e[e.completed=2]="completed",e[e.failed=3]="failed",e[e.canceled=4]="canceled",e[e.expired=5]="expired"}(a||(a={}));var o,s=a,c=function(){function e(){this.id=++e._lastBatchId}return e._lastBatchId=0,e}();!function(e){e[e.multiple=0]="multiple",e[e.renameItems=1]="renameItems",e[e.deleteItems=2]="deleteItems",e[e.pointInTimeRestore=3]="pointInTimeRestore",e[e.restoreItems=4]="restoreItems",e[e.uploadItems=5]="uploadItems",e[e.moveItems=6]="moveItems",e[e.copyItems=7]="copyItems",e[e.rotateItems=8]="rotateItems",e[e.addItemsToAlbum=9]="addItemsToAlbum",e[e.addCoverPhotos=10]="addCoverPhotos",e[e.removeCoverPhotos=11]="removeCoverPhotos",e[e.createAlbumFromFolder=12]="createAlbumFromFolder",e[e.createColumn=13]="createColumn",e[e.editColumn=14]="editColumn",e[e.deleteColumn=15]="deleteColumn",e[e.checkInItem=16]="checkInItem",e[e.checkOutItem=17]="checkOutItem",e[e.undoCheckOutItem=18]="undoCheckOutItem",e[e.createFolder=19]="createFolder",e[e.updateBundle=20]="updateBundle",e[e.shareItem=21]="shareItem",e[e.reportAbuse=22]="reportAbuse",e[e.requestReview=23]="requestReview",e[e.setAlbumCoverPhoto=24]="setAlbumCoverPhoto",e[e.createAlbum=25]="createAlbum",e[e.uploadVideos=26]="uploadVideos",e[e.saveItem=27]="saveItem",e[e.createItem=28]="createItem",e[e.publishItem=29]="publishItem",e[e.unPublishItem=30]="unPublishItem",e[e.applyOfficeLens=31]="applyOfficeLens",e[e.removeOfficeLens=32]="removeOfficeLens",e[e.updateMetadata=33]="updateMetadata",e[e.makeHomepage=34]="makeHomepage",e[e.triggerFlow=35]="triggerFlow",e[e.downloadAsZip=36]="downloadAsZip",e[e.saveAutoAlbum=37]="saveAutoAlbum",e[e.discardAutoAlbum=38]="discardAutoAlbum",e[e.addToOneDrive=39]="addToOneDrive",e[e.removeFromSharedList=40]="removeFromSharedList",e[e.setupApprovalFlow=41]="setupApprovalFlow",e[e.setupReminderFlow=42]="setupReminderFlow",e[e.sharepointPointInTimeRestore=43]="sharepointPointInTimeRestore",e[e.sharingReport=44]="sharingReport",e[e.editViewColumns=45]="editViewColumns",e[e.runModelOnItems=46]="runModelOnItems",e[e.importModel=47]="importModel",e[e.downloadItem=48]="downloadItem",e[e.deleteSmartTemplate=49]="deleteSmartTemplate",e[e.publishSmartTemplate=50]="publishSmartTemplate",e[e.unpublishSmartTemplate=51]="unpublishSmartTemplate",e[e.universalAnnotationSync=52]="universalAnnotationSync"}(o||(o={}));var d=o,l=n(131);function u(){return l.t.wrap()}var f=function(e){function t(t){var n=e.call(this,t)||this;n.key=t.key;var a=n.observables,i=t.count,r=void 0===i?a.create(1):i,o=t.isAvailable,s=void 0===o?a.create(!0):o,c=t.onExecute,d=void 0===c?u:c;return n.count=r,n.isAvailable=s,n._onExecute=d.bind(t.operation),n}return Object(i.a)(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._onExecute=u},t.prototype.execute=function(){return this._onExecute()},t}(r.e),p=function(e){function t(t){var n=e.call(this,{})||this,a=n.observables;n.name=t.name,n.iconName=t.iconName,n.state=a.create(s.created),n.warning=a.create(""),n.error=a.create(),n.count=a.create(1);var r=Object(i.e)({minimum:0,maximum:0,current:0},t.progress||{});return n.progress={minimum:a.create(r.minimum),maximum:a.create(r.maximum),current:a.create(r.current)},n.type=a.create(t.type||d.multiple),n.batch=t.batch||new c,n._initializeActions(t.actions),n.payloads=a.create(t.payloads||{}),n.visibility=a.create(t.visibility||0),n}return Object(i.a)(t,e),t.prototype.dispose=function(){this.actions({}),this.payloads({}),e.prototype.dispose.call(this)},t.prototype._initializeActions=function(e){void 0===e&&(e={});var t={};for(var n in e){var a=e[n];t[n]=this.scope.attach(new f({key:n,operation:this,isAvailable:a.isAvailable,onExecute:a.execute}))}this.actions=this.observables.create(t)},t}(r.e),m=n(111),_=n(182),h=function(e){function t(t){var n=e.call(this,t)||this;return n.operations=t.operations,n.name="",n.iconName="",n.progress={minimum:n.createObservable(0),maximum:n.createObservable(0),current:n.createObservable(0)},n.batch=t.batch,n.error=n.createObservable(),n.count=n.createObservable(0),n._initializeType(),n.payloads=n.createPureComputed(n._computePayloads),n.actions=n.createObservable({}),n.states=n.createObservable({created:0,started:0,completed:0,failed:0,canceled:0,expired:0}),n._initializeOperations(),n.state=n.createPureComputed(n._computeState),n.visibility=n.createPureComputed(n._computeVisibility),n}return Object(i.a)(t,e),t.prototype._initializeType=function(){var e=this.addDisposable(_.e.group(this.operations,function(e){return e.type()}));this.type=this.createPureComputed(function(){return 1===e().length&&e()[0].key||d.multiple})},t.prototype._computePayloads=function(){var e=this.operations()[0];return e&&e.payloads()||{}},t.prototype._initializeOperations=function(){var e=this;this.addDisposable(this.operations.map({mappingWithDisposeCallback:function(t){var n=e.createPureComputed(function(){return s[t.state()]}),a=e.addDisposable(m.t(t.progress.minimum,e.progress.minimum)),i=e.addDisposable(m.t(t.progress.maximum,e.progress.maximum)),r=e.addDisposable(m.t(t.progress.current,e.progress.current)),o=e.addDisposable(m.e(n,e.states)),c=e.addDisposable(m.n(t.error,e.error)),d=e.addDisposable(m.t(t.count,e.count)),l=e.createComputed(function(){var n=!1,a=e.actions.peek();for(var i in t.actions())i in a||(a[i]=e._initializeAction(i),n=!0);n&&e.actions.valueHasMutated()});return{mappedValue:t,dispose:function(){n.dispose(),a.dispose(),i.dispose(),r.dispose(),o.dispose(),l.dispose(),c.dispose(),d.dispose()}}}}))},t.prototype._computeState=function(){var e=this.states();return e.started||e.created&&(e.failed||e.completed||e.canceled)?s.started:e.created?s.created:e.failed?s.failed:e.completed?s.completed:e.canceled?s.canceled:s.expired},t.prototype._computeVisibility=function(){return this.operations().reduce(function(e,t){var n=t.visibility.peek();return n<e?n:e},2)},t.prototype._initializeAction=function(e){var t=this.addDisposable(this.operations.filter(function(t){var n=t.actions()[e];return n&&n.isAvailable()}));return this.addDisposable(new f({count:this.createPureComputed(function(){return t().length}),key:e,operation:this,isAvailable:this.createPureComputed(function(){return!!t().length}),onExecute:function(){return l.t.all(t().slice().map(function(t){var n=t.actions.peek()[e];return n&&n.execute()||l.t.wrap()}))}}))},t}(r.e),b=n(56),g=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this,i=a.observables,r=new c;a._observers=i.createArray();var o=a.operations=i.createArray(),s=a.scope.attached(h),d=a.groups=a.addDisposable(_.e.group(o,function(e){return e.batch}).map({mappingWithDisposeCallback:function(e){var t=new s({batch:e.key,operations:e.values});return{mappedValue:t,dispose:function(){t.dispose()}}}}));return a.overall=new(a.managed(h))({batch:r,operations:d}),a.isLocked=a.createPureComputed(a._computeIsLocked),a.createBackgroundComputed(a._computeRemoveAllWhenUnlocked).extend({deferred:!0}),a}return Object(i.a)(t,e),t.prototype.lock=function(){var e=this,t={};return this._observers.push(t),{dispose:function(){e._observers.remove(t)}}},t.prototype.register=function(e){var t=new p(e);return 2!==t.visibility.peek()&&this.operations.push(t),t},t.prototype.deleteGroupOperation=function(e){var t=Object(i.o)([],e.operations.peek(),!0);this.operations.removeAll(t),t.forEach(function(e){e.dispose()})},t.prototype.cleanup=function(e){void 0===e&&(e=!1);for(var t=[],n=0,a=this.groups.peek();n<a.length;n++){var i=a[n],r=i.state.peek();if(r===s.completed||!e&&(r===s.expired||r===s.canceled||r===s.failed))for(var o=i.operations.peek(),c=void 0,d=0;d<o.length;d++){c=!0;var l=o[d];if(r===s.failed&&l.actions)for(var u=l.actions.peek(),f=Object.keys(u),p=0;p<f.length;p++)if("cancel"!==f[p]&&u[f[p]].isAvailable.peek()){c=!1;break}c&&t.push(o[d])}}this.operations.removeAll(t),t.forEach(function(e){e.dispose()})},t.prototype._computeRemoveAllWhenUnlocked=function(){this.isLocked()||this.cleanup()},t.prototype._computeIsLocked=function(){return this._observers().length>0},t}(r.e),v=Object(b.i)("OperationProvider",g),y=n(132),S=n(130),D=n(230),I=n(30),x=n(4),C=(new x.t("dataStore"),new x.t("userSettingsStore"),new x.t("userInfoStore"),new x.t("smartFiltersStore")),O=function(e){function t(t){var n=e.call(this,t)||this;return n.errorType=t.errorType||0,n.payloads=t.payloads||{},n}return Object(i.a)(t,e),t}(n(55).e),w=function(e){this.items=new Array(e||0),this.groupings=null,this.partialResultRequestCount=0,this.partialResultStatus=0},E=n(14),A=n(105),L=function(e,t,n){this.key=e||"",this.content=E.observable(new w(n)),this.content.equalityComparer=A.t,this.schema=E.observableArray([]),this.schema.equalityComparer=A.e,this.context=E.utils.extend({},t),this.contentTypes=E.observableArray([]),this.isPlaceholder=!0,this.version=0};function k(e,t){for(var n=t.start,a=Math.min(t.end,e.length),i=n;i<a;i++)if(!e[i])return!1;return!0}var M=n(263),P=function(){function e(e,t){!function(e){return!!e&&"object"==typeof e}(e)?(this.key=e,this.input=t,this.status=0):(this.key=e.key,this.input=e.input,this.output=e.output,this.status=e.status,this.error=e.error)}return e.prototype.succeed=function(t){var n=new e(this);return n.output=t,n.status=1,delete n.error,n},e.prototype.fail=function(t){var n=new e(this);return n.error=t,n.status=2,n},e.prototype.cancel=function(){var t=new e(this);return delete t.error,t.status=3,t},e.prototype.restart=function(){return new e(this.key,this.input)},e.prototype.changeInput=function(t){var n=t(this.input),a=new e(this.key,n);return a.output=this.output,a.status=this.status,a.error=this.error,a},e.prototype.changeOutput=function(t){var n=t(this.output),a=new e(this.key,this.input);return a.output=n,a.status=this.status,a.error=this.error,a},e.prototype.compare=function(e){return e&&this.input===e.input&&this.output===e.output&&this.error===e.error&&this.status===e.status?null:{previous:e,current:this}},e}(),T=n(371),U=new x.t({name:"".concat("UserStateProvider.key",".updateQuota"),factory:{dependencies:{observablesFactoryType:r.t},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}}),F="__next__",H=function(){function e(e,t,n,a){this._context=e,this._store=t,this._isTokenBaseApi=n,this._tokenBasedExtraItemCount=a}return e.prototype.initialize=function(e,t){if(this._skipDataFetch=!1,!this._context.group&&this._context.noIndexBasedDataFetch){var n=e&&e.content.peek().groupings,a=n&&n.length&&n[0].itemGroups;this._context.group=this._getGroupStartingOnIndex(t,a)}e&&e.isExpired&&(this._context.group=null),this._isExpandingGroup=this._context.noIndexBasedDataFetch&&this._context.group&&this._context.group.groupingId!==F&&!this._context.groupReplace,this._isFetchingNextGroup=this._context.group&&this._isTokenBaseApi&&this._context.group.groupingId===F;var i=e&&e.content.peek().groupings;this._isAllCollapsedQuery=i&&i.length>0&&i[0].isAllCollapsed&&i[0].isAllCollapsed.peek()&&!this._isExpandingGroup},e.prototype.isResultSetValid=function(e,t){var n=this._skipDataFetch;return n||(n=this._isAllCollapsedQuery?!this._isExpandingGroup&&!this._context.requestToken:(this._isTokenBaseApi||!this._context.skipInMemoryCache)&&k(e,t)&&!(this._isFetchingNextGroup&&this._context.endIndex>e.length)),n},e.prototype.computeNewChildren=function(e,t,n,a,i){var r,o=!1;if(this._context.groupReplace&&(this._isFetchingNextGroup=!!e.nextRequestToken),r=i&&!n.isExpired?n.content.peek().items:[],e.nextRequestToken?(!t.requestToken&&r.length>e.totalChildren&&(r[e.totalChildren]=null),e.totalChildren+=this._tokenBasedExtraItemCount,this._store.setNextRequestToken(t.parentKey,a,e.nextRequestToken),o=!0,n&&(n.isTokenBasedApi=o)):this._store.setNextRequestToken(t.parentKey,a,"end"),t.requestToken&&(t.startIndex=r.length-this._tokenBasedExtraItemCount,e.totalChildren+=r.length-this._tokenBasedExtraItemCount),this._isFetchingNextGroup||this._isAllCollapsedQuery){var s=e.children.length,c=e.startIndex+s;e.nextRequestToken&&(c+=this._tokenBasedExtraItemCount),e.totalChildren=Math.max(e.totalChildren,Math.max(r.length,c))}if(e.item&&e.totalChildren>=0){var d;this._isExpandingGroup||(r.length>0&&0===e.totalChildren?r=[]:r.length=e.totalChildren),d=t.groupReplace?t.startIndex:void 0!==e.startIndex?e.startIndex:this._isExpandingGroup?t.group.startIndex:t.startIndex;for(var l=0,u=0;l<r.length;l++)l>=d&&u<e.children.length&&(r[l]=this._store.getItem(e.children[u].key),(t.remoteItem||t.isMountPointFolder)&&(r[l].peek().isMountPointFolder=!0,r[l].peek().remoteWebUrl=t.isMountPointFolder?t.remoteWebUrl:t.remoteItem.SiteUrl),u++)}return{allChildren:r,hasNextRequestToken:o}},e.prototype.computeNewGroupings=function(e,t,n,a,i){var r=this._isExpandingGroup?a.group:null,o=a.itemsPerGroup,s=e&&e.length>0?e[0].itemGroups:null,c=null;s&&s.length>0&&s[s.length-1].isPlaceholder&&(c=s.pop());var d=this._mergeGroupings(e,t,i,n);if(r&&d&&(d[0].isAllCollapsed(!1),r.state({isCollapsed:!1})),n&&n.length>0&&!n[n.length-1]&&(s=d&&d.length>0?d[0].itemGroups:null)&&s.length>0){var l=s[s.length-1];this._context.groupReplace&&this._isFetchingNextGroup&&(l.hasMoreData=!0);var u=n[l.startIndex+(-1!==o?Math.min(l.count,o):l.count)-1]&&!(this._context.groupReplace&&l.count<o),f=d[0].isAllCollapsed.peek();if(u||this._isFetchingNextGroup||f){var p=l.startIndex+l.count;c?c.startIndex=p:c={groupingId:F,startIndex:p,count:1,isPlaceholder:!0,state:E.observable({isCollapsed:!1})},n.length<p&&(n.length=p+1),s.push(c)}}return d},e.prototype._mergeGroupings=function(e,t,n,a){var i=e;if(i&&i.length>0){if(t&&t.length>0)for(var r=0;r<t.length;r++){var o=i[r].isAllCollapsed.peek();i[r].itemGroups=n?this._retainItemGroupState(i[r].itemGroups,t[r].itemGroups):this._mergeItemGroups(i[r].itemGroups,t[r].itemGroups,o,null,a)}}else i=t;return i},e.prototype._mergeItemGroups=function(e,t,n,a,i){var r=e;if(e&&e.length>0){if(t&&t.length>0)for(var o=function(e){var t=!1;n&&e.state({isCollapsed:!0});for(var o=function(i){var o=r[i];if(e.groupingId===o.groupingId){if(s._context.noIndexBasedDataFetch||!s._context.isTokenBasedApi)if(s._context.groupReplace?(o.count+=e.count,o.hasMoreData&&i<r.length-1&&(o.hasMoreData=!1)):o.count=e.count,o.children=s._mergeItemGroups(o.children,e.children,n,o),0===i)o.startIndex=a?a.startIndex:0;else{var c=r[i-1],d=c.startIndex+c.count-o.startIndex;o.startIndex+=d,o.children&&o.children.forEach(function(e){e.startIndex+=d})}else{var l=e.startIndex+s._context.startIndex,u=e.startIndex+s._context.startIndex+e.count;o.startIndex=Math.min(o.startIndex,l),o.count=Math.max(u,o.startIndex+o.count)-o.startIndex}return t=!0,"break"}},c=0;c<r.length&&"break"!==o(c);c++);if(!t){var d=r[r.length-1],l=d.startIndex+d.count-e.startIndex;e.startIndex+=l,e.children&&e.children.forEach(function(e){e.startIndex+=l});var u=Math.min(e.count,30),f=0;if(i)for(var p=e.startIndex;p<e.startIndex+u;p++)i[p]||f++;f&&(e.emptyItemCount=f),r.push(e)}},s=this,c=0,d=t;c<d.length;c++)o(d[c])}else r=t;return r},e.prototype._retainItemGroupState=function(e,t,n){var a=t;if(t&&t.length>0&&e&&e.length>0){for(var i={},r=0,o=e;r<o.length;r++){var s=o[r];i[s.groupingId]=s}for(var c=0,d=a;c<d.length;c++){var l=d[c],u=i[l.groupingId];u&&(l.state(u.state.peek()),l.children=this._retainItemGroupState(u.children,l.children,u))}}return a},e.prototype._getGroupStartingOnIndex=function(e,t){if(t&&t.length>0)for(var n=0;n<t.length;n++){var a=t[n];if(!(a&&a.startIndex<=e))break;var i=a.startIndex+a.count-1;if(a.children){if(i>=e)return this._getGroupStartingOnIndex(e,a.children)}else{if(a.startIndex===e)return a.state.peek().isCollapsed?null:a;if(i>=e){var r=n<t.length-1?t[n+1]:null;if(r&&!r.state.peek().isCollapsed)return this._skipDataFetch=!0,null}}}return null},e}(),R=n(261),N=n(8),B=n(7),j=100,V=new x.t({name:"".concat("ItemProvider",".encodeItemSetParentKey"),factory:new x.e(Object(N.E)(N.I))}),z=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._registeredProjections={},a._pendingGetItemRequests={},a._store=n.itemsStore,a._operationProvider=n.operationProvider,a._schemaDataSource=n.schemaDataSource,a._updateQuota=n.updateQuota,a._groupThrottle=n.groupThrottle,a._encodeItemSetParentKey=n.encodeItemSetParentKey||!1,a._smartFiltersStore=n.smartFiltersStore,a}return Object(i.a)(t,e),t.prototype.getItem=function(e){return this._getItem(e)},t.prototype.getItemSetKey=function(e,t){var n="parentKey="+(this._encodeItemSetParentKey?encodeURIComponent(e.parentKey):e.parentKey);function a(e,t){t&&(n+="&".concat(e,"=").concat(t))}a("ownerId",e.ownerId),a("groupingType",e.groupingType),n+="&sortField="+(e.sortField||""),n+="&isAscending="+("boolean"==typeof e.isAscending?e.isAscending:"");var i=e.filters;if(i)for(var r in i)n+="&"+r+"="+i[r];a("groupBy",e.groupBy),a("viewId",e.baseViewId),a("viewXml",e.viewXml),a("additionalFiltersXml",e.additionalFiltersXml);var o=!t&&e.itemSetProjections;if(o){var s="";for(var c in o)s+=c+"_"+o[c];n+="&projection="+s}return e.supportsNestedGroups&&(n+="&ng=1"),n},t.prototype.getSpecifiedItems=function(e){return e&&e.needToClearParentSmartFiltersInfo&&e.parentKey&&this._smartFiltersStore&&this._smartFiltersStore.invalidate(e.parentKey),this._getItemDataSource().then(function(t){return t.getSpecifiedItems(e)})},t.prototype.getItemSync=function(e){var t=this.getItemSetKey(e),n=e.parentKey,a=this._store.getItem(n),i=this._getItemSet(t,e);if(!a){var r=new y.e(n),o=e.queryType,s=void 0===o?r.queryType:o;r.queryType=s,this._store.setItem(r),a=this._store.getItem(n)}if(!i){var c=a.peek(),d=c&&c.folder,l=d&&d.childCount||0;(i=new L(t,e,l)).item=a;var u=e.needSchema;if(void 0===u||u){var f=this._schemaDataSource,p=f&&f.getColumns(c);p&&p.length>0&&i.schema(p)}this._store.setItemSet(t,i)}return i},t.prototype.invalidateItem=function(e,t){var n=void 0===t?{}:t,a=n.triggerFetch,r=void 0!==a&&a,o=n.emptyAllOtherSets,s=void 0!==o&&o,c=n.refreshSchema,d=void 0!==c&&c,l=n.updateGrouping,u=void 0!==l&&l,f=n.purgeCache,p=void 0!==f&&f;if(s&&this._store.emptyAllOtherSets([e]),d&&(m=this._store.getItemSetFromItemKey(e))&&m.schema([]),u||this._store.invalidateItem(e,{purgeCache:p}),this._smartFiltersStore&&this._smartFiltersStore.invalidate(e),r){var m=this._store.getItemSetFromItemKey(e);this._getItem(Object(i.e)(Object(i.e)({parentKey:e},m&&m.context||{}),{skipCache:!0,updateGrouping:u}))}},t.prototype.removeFromRecent=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromRecent(e)}).then(function(n){return n&&t.invalidateItem(e.parentKey),n})},t.prototype.removeMountPoint=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeMountPoint(e)}).then(function(n){return n&&t.invalidateItem(e.parentKey),n})},t.prototype.createMountPoint=function(e){return this._getItemDataSource().then(function(t){return t.createMountPoint(e)}).then(function(e){return e},function(e){return l.t.wrapError(e)})},t.prototype.createDocument=function(e,t,n,a,i){var r=this;return this._getItemDataSource().then(function(o){return o.createDocument(e,t,n,a).then(function(t){if(i&&o.updateContentType){var n=t.match(/{(.*)}/),a=n&&n[1];return a?o.updateContentType(e,a,i).then(function(){return r.invalidateItem(e),r._updateQuota(!0),t}):t}return r.invalidateItem(e),r._updateQuota(!0),t})})},t.prototype.createCustomDocument=function(e,t,n){var a=this;return this._getItemDataSource().then(function(a){return a.createCustomDocument(e,t,n)}).then(function(t){return t?(a.invalidateItem(e),a._updateQuota(!0),a.getItem({parentKey:e}).then(function(e){return a.peekUnwrapObservable(a._store.getItem(t))})):l.t.wrapError()})},t.prototype.updateBundle=function(e,t){var n=this,a=[new P(e.item.key,e.item)];return t.update(a),this._getItemDataSource().then(function(t){return t.updateBundle(e)}).then(function(){n.invalidateItem(e.item.UNSAFE_parent?e.item.UNSAFE_parent.key:e.item.key),a=a.map(function(e){return e.succeed()}),t.update(a)},function(i){n.invalidateItem(e.item.UNSAFE_parent?e.item.UNSAFE_parent.key:e.item.key);var r=new Error(i);return a=a.map(function(e){return e.fail(r)}),t.update(a),l.t.wrapError(r)})},t.prototype.removeFromSharedList=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromSharedList(e)}).then(function(n){return Object(i.t)(t,void 0,void 0,function(){return Object(i.i)(this,function(t){switch(t.label){case 0:return this.invalidateItem(e.parentKey),[4,this.resources.consumeAsync(I.i)];case 1:return t.sent().invalidateItems(e.parentKey),[2,n]}})})})},t.prototype.updateViewCount=function(e){return this._getItemDataSource().then(function(t){return t.updateViewCount(e)})},t.prototype.reportAbuse=function(e){var t=new c,n=this._operationProvider.register({name:e.item.name||"",type:d.reportAbuse,payloads:{reportAbuse:{item:e.item}},iconName:e.item.iconName,batch:t}),a=this._getItemDataSource().then(function(t){return t.reportAbuse(e)});return n.state(s.started),n.progress.maximum(1),a.then(function(e){return n.state(s.completed),n.progress.current(1),e},function(e){return n.state(s.failed),n.error(new O({message:e})),l.t.wrapError(e)})},t.prototype.requestReview=function(e){for(var t=this,n=new c,a=e.items.map(function(e){var a=t._operationProvider.register({name:e.name||"",type:d.requestReview,payloads:{requestReview:{item:e}},iconName:e.iconName,batch:n});return a.progress.maximum(1),a.progress.current(0),a}),i=this._getItemDataSource().then(function(t){return t.requestReview(e)}),r=0,o=a;r<o.length;r++)o[r].state(s.started);return i.then(function(n){for(var i=0,r=a;i<r.length;i++){var o=r[i];o.progress.current(1),o.state(s.completed)}var c=e.items[0].UNSAFE_parent;return c&&t.invalidateItem(c.key),n},function(e){for(var t=0,n=a;t<n.length;t++){var i=n[t];i.error(new O({message:e})),i.state(s.failed)}return l.t.wrapError(e)})},t.prototype.saveSortOrder=function(e){return this._getItemDataSource().then(function(t){return t.saveSortOrder(e)}).then(function(e){return e},function(e){})},t.prototype.addCoverPhotos=function(e){return this._updateCoverPhotos(e,d.addCoverPhotos,this._addCoverPhotos)},t.prototype.removeCoverPhotos=function(e){return this._updateCoverPhotos(e,d.removeCoverPhotos,this._removeCoverPhotos)},t.prototype.changeFolderType=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.changeFolderType(e)}).then(function(n){return t.invalidateItem(e.item.key,{triggerFetch:!0}),n})},t.prototype.updateItemProperty=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.updateItemProperty(e)}).then(function(n){return t.invalidateItem(e.item.key,{triggerFetch:!0}),n})},t.prototype.getOpenInClientDetails=function(e){return this._getItemDataSource().then(function(t){return t.getOpenInClientDetails(e)}).then(function(e){return e},function(e){})},t.prototype.getWorkProgress=function(e){return this._getItemDataSource().then(function(t){return t.getWorkProgress(e)})},t.prototype.processReferral=function(e,t){return this._getItemDataSource().then(function(n){return n.processReferral(e,t)})},t.prototype.getItemOcrTextContent=function(e){return this._getItemDataSource().then(function(t){return t.getItemOcrTextContent(e)})},t.prototype.updateItemOcrInfo=function(e,t,n){var a=this;return this._getItemDataSource().then(function(a){return a.updateItemOcrInfo(e,t,n)}).then(function(t){return a.invalidateItem(e.key,{triggerFetch:!0}),t},function(e){return e})},t.prototype.rotateItems=function(e,t){var n=this,a={},i=e.items.map(function(e){return a[e.key]=new P(e.key,e)});return t.update(i),this._getItemDataSource().then(function(t){return t.rotateItems(e)}).then(function(){i=i.map(function(e){return e.succeed()}),t.update(i)},function(e){var r=e.data||[];i=[];for(var o=0,s=r;o<s.length;o++){var c=s[o],d=a[c.key];n._store.setItem(d.input),delete a[c.key],i.push(d.fail(c.error))}for(var l in a)d=a[l],delete a[l],i.push(d.succeed());t.update(i)})},t.prototype.registerProjection=function(e,t){this._registeredProjections[e]=t},t.prototype.computeProjectedItemSet=function(e,t,n,a){var i=n.itemSetProjections,r=a?null:this._store.getItemSet(e),o=!r||r.isPlaceholder||r.isExpired||r.version!==t.version;if(!r||o){for(var s in r||((r=new L(e,n)).item=t.item,r.isTokenBasedApi=t.isTokenBasedApi,r.isPlaceholder=t.isPlaceholder,r.isExpired=t.isExpired,r.version=t.version),i){var c=this._registeredProjections[s];c&&c.projectItemSet(r,t,i[s])}a||this._store.setItemSet(e,r)}return r},t.prototype.redeemPermissionToken=function(e){return this._getItemDataSource().then(function(t){return t.redeemPermissionToken(e)})},t.prototype._getItem=function(e){var n,a=this,r=M.e(e),o=this._store;e.keyAlias?(n=this.getItemSync({parentKey:e.keyAlias}).item,e.parentKey=n.peek().key):n=this.getItemSync(e).item;var s=e.skipCache,c=void 0!==s&&s,d=this.getItemSetKey(e),u=e.itemSetProjections?this.getItemSetKey(e,!0):d,f=this._getItemSet(d,e),p=f&&f.content.peek().items,m=e.isTokenBasedApi||!!f&&!!f.isTokenBasedApi,_=!c&&n&&!n.peek().revision&&f&&!f.isExpired&&!f.isPlaceholder&&(!e.requestAllChildren||k(p,{start:0,end:p.length})),h=e.startIndex,b=void 0===h?0:h,g=e.pageSize,v=void 0===g?j:g,y=e.endIndex||b+v;y=p&&p.length>0&&!m?Math.min(p.length,y):y,b=Math.max(0,Math.min(y,b));var S=B.e.isActivated("73b2b18a-27b0-433f-95cf-c7f77326ff37","11/09/2021","Not set requestToken if itemSet is expired")||f&&!f.isExpired?o.getNextRequestToken(u):void 0;e.requestToken="end"===S?"":S;var D=new H(e,o,m,t.TOKEN_BASED_API_EXTRA_ITEMS);D.initialize(f,b);var x=!1,C=f&&f.content.peek();if(!C||1!==C.partialResultStatus&&2!==C.partialResultStatus||(x=!0,1===C.partialResultStatus&&f.content({items:C.items,groupings:C.groupings,partialResultRequestCount:0,partialResultStatus:2})),_&&!x&&D.isResultSetValid(p,{start:b,end:y}))return l.t.wrap(f);if(n&&n.peek().isStub){var O=e.startKey;if(O&&o.getItem(O)){f.content.peek().items=[o.getItem(O)],f.isPlaceholder=!0,f.isExpired=!1;var w=this._schemaDataSource,E=w&&w.getColumns(n.peek());E&&E.length>0&&f.schema(E),f.content.valueHasMutated&&f.content.valueHasMutated()}return l.t.wrap(f)}var A=f&&!f.isExpired&&f.content.peek().groupings;A&&A.length>0&&(e.isGrouped=!0),this._normalizeContext(e,p,b,y,!_);var P=this._getRequestKey(e),U=this._pendingGetItemRequests[P];return U?e.itemSetProjections?U.getPromise().then(function(t){return a.computeProjectedItemSet(d,t,e)}):U.getPromise():(m&&!S&&(e.startIndex=0),this._pendingGetItemRequests[P]=U=new T.e,this.resources.consumeAsync(I.t.bypass).then(function(t){return t.getItem(Object(i.e)(Object(i.e)({},e),{itemSetKey:d}))}).then(function(t){r.updateContextBasedOnResult&&e.updateContextBasedOnResult&&(r.updateContextBasedOnResult(r,t),e.updateContextBasedOnResult(e,t),d=a.getItemSetKey(r));var i=e.itemSetProjections?a.getItemSetKey(e,!0):d;n=o.getItem(e.parentKey);var s=o.getItemSet(i);_=!(!n||!s);var c=D.computeNewChildren(t,e,s,i,!!_),l=c.allChildren,u=c.hasNextRequestToken;if(u&&(m=u),t.item&&!e.ignoreChildren&&!e.skipStoreResults){_||((s=new L(i,e)).item=o.getItem(e.parentKey),s.isTokenBasedApi=m,o.setItemSet(i,s));var f=!!s.isExpired;s.sortField=t.sortField,s.isAscending=t.isAscending,s.isPlaceholder=!1,s.isExpired=!1;var p=e.needSchema;if(void 0===p||p){var h=t.schema;s.schema(h&&h.length>0&&h||[]),t.customViewRenderer?s.customViewRenderer=a.observables.create(t.customViewRenderer):s.customViewRenderer=a.observables.create(void 0)}var b=t.groupings;m&&e.mergeGroupings&&(b=D.computeNewGroupings(s.content.peek().groupings,t.groupings,l,e,f)),t.contentTypes&&s.contentTypes&&s.contentTypes(t.contentTypes);var g=s.content.peek(),v=g.partialResultStatus,y=g.partialResultRequestCount,S=void 0===y?0:y;if(!(b&&b.length&&b[0]))if(u&&(t.children&&t.children.length<30||!t.children)){var I=S+1;I<=5?S=I:v=1}else void 0===v||0===v||u?2===v&&t.children&&30===t.children.length&&(v=0):v=3;s.content({items:l,groupings:b,partialResultRequestCount:S,partialResultStatus:v});var x=s.version,C=void 0===x?0:x;s.version=C+1}if(delete a._pendingGetItemRequests[P],e.requestAllChildren&&!k(l,{start:0,end:t.totalChildren})){var O=M.e(e),w=O.startIndex,E=void 0===w?0:w;return O.startIndex=E+j,a._getItem(O)}return t.isFromBrowserCache?(r.skipCache=!0,a._getItem(r)):(e.itemSetProjections&&(s=a.computeProjectedItemSet(d,s,e)),s)},function(e){return delete a._pendingGetItemRequests[P],l.t.wrapError(e)}).then(function(e){U.complete(e)},function(t){a._groupThrottle&&!a._groupThrottle()&&t&&t.errorCode===Number(R.e.queryThrottled)&&!e.noGroupReplace?a._groupThrottle(!0):U.error(t)}),U.getPromise())},t.prototype._normalizeContext=function(e,t,n,a,i){var r=e.pageSize||j;if(!e.avoidSeamSnapping){if(!i&&n-n%r!=a-a%r&&t)for(;n<a&&t[n];)n++;e.startIndex=n-n%r}"number"!=typeof e.pageSize&&(e.pageSize=j);for(var o=e.startIndex,s=void 0===o?0:o;a-s>e.pageSize;)e.pageSize+=j},t.prototype._getRequestKey=function(e){var t=this.getItemSetKey(e,!0);return e.requestToken?t+=e.requestToken:t+="&startIndex="+e.startIndex,t+"&pageSize="+e.pageSize},t.prototype._getItemSet=function(e,t){var n=this._store,a=n.getItemSet(e);if(t.itemSetProjections){var i=this.getItemSetKey(t,!0),r=n.getItemSet(i);r&&(a=this.computeProjectedItemSet(e,r,t))}return a},t.prototype._updateCoverPhotos=function(e,t,n){for(var a=this,i=new c,r=e.target,o=e.items.map(function(e){var n=a._operationProvider.register({name:e.name||"",type:t,payloads:{coverPhotos:{parent:r,item:e}},iconName:e.iconName,batch:i});return n.progress.maximum(1),n.progress.current(0),n}),d=n.call(this,e),l=0,u=o;l<u.length;l++)u[l].state(s.started);return d.then(function(t){a.invalidateItem(r.key),(null==e?void 0:e.itemsScopeInvalidate)&&a.resources.consumeAsync(I.i).then(function(e){e.invalidateItems(null==r?void 0:r.key)});for(var n=0,i=o;n<i.length;n++){var c=i[n];c.progress.current(1),c.state(s.completed)}return t},function(){for(var e=0,t=o;e<t.length;e++)t[e].state(s.failed)})},t.prototype._addCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.addCoverPhotos(e)})},t.prototype._removeCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.removeCoverPhotos(e)})},t.prototype._getItemDataSource=function(){return l.t.resolve(this.resources.consumeAsync(I.r))},t.dependencies=Object(i.e)(Object(i.e)({},r.e.dependencies),{groupThrottle:D.e.optional,schemaDataSource:I.o.optional,itemsStore:S.e,operationProvider:v,smartFiltersStore:C.optional,updateQuota:U,encodeItemSetParentKey:V.optional}),t.TOKEN_BASED_API_EXTRA_ITEMS=2,t}(r.e),G=Object(b.i)("ItemProvider",z)},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(4).t)("clientName")},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(4).t)("engagementHandlers")},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(4).t)("people")},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={ODB:!n(7).e.isActivated("96723D41-0476-4E60-A02D-199517143E81","11/10/2020","Allow ADAL as fallback for OAuth token requests")}},,function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(4),i=n(56),r=n(107),o=new a.t({name:"platformDetection",factory:new i.a(r.e)})},function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"t",function(){return o});var a=n(4),i=(new a.t("currentItem"),new a.t("currentItemSet"),new a.t("groupThrottle")),r=(new a.t("focusItem"),new a.t("focusItemSet"),new a.t("dataManagerMapper"),new a.t("viewParams")),o=(new a.t("originalViewParams"),new a.t("itemsSelection"));new a.t("selectionIndexResolver"),new a.t("autoFillParams"),new a.t("actionMap"),new a.t("slideshowState"),new a.t("isDebugWindowVisible"),new a.t("canUserSelect"),new a.t("promiseTracker"),new a.t("currentPage"),new a.t("currentSelectionModelGroup"),new a.t("useMobileList"),new a.t("disableDotDotDotHeroCommand"),new a.t("disableShareHeroCommand"),new a.t("uploadActionHandler"),new a.t("vaultTeachingBubble"),new a.t("currentView"),new a.t("currentLayout"),new a.t("backToClassicUrl"),new a.t("isItemSetRendered"),new a.t("isPremiumUpsellVisible"),new a.t("isFamiliesOrGroupsFreVisible"),new a.t("isVaultFreVisible"),new a.t("hasUpsellBeenShownAlready"),new a.t("canModifySchema"),new a.t("displayImageTileNames"),new a.t("isSharingSectionExpanded"),new a.t("hasSeenPositioningThisSession"),new a.t("mobileUpsellDismissedThisSession"),new a.t("mobileOfficeAppUpsellDismissedThisSession"),new a.t("didUserEnterPasswordForFile")},,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SignOutSource=void 0;var a=function(){function e(){}return e.userGenerated=1,e.abtTimeout=2,e}();t.SignOutSource=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EnvConfig=void 0,t.EnvConfig=function(e,t,n){this.abtSvcHost=e,this.isAriaEnabled=t,this.enabled=n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventLevel=void 0;var a=function(){function e(){}return e.info="Info",e.warning="Warning",e.error="Error",e}();t.EventLevel=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogAttributes=void 0;var a=function(){function e(){}return e.defaultLoggingNamespace="Office.WebAuth.Abt.",e.messageDataField="message",e.levelDataField="level",e.correlationIdDataField="correlationId",e.actionDataField="action",e.timeoutDataField="timeout",e}();t.LogAttributes=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UriSeparator=t.HttpMethod=t.UriScheme=t.UriFormats=void 0;var a=function(){function e(){}return e.abtSvc="/abt/userstate",e.abtSignOut="/odc/v1.0/abt/signout",e}();t.UriFormats=a;var i=function(){function e(){}return e.http="http",e.https="https",e}();t.UriScheme=i;var r=function(){function e(){}return e.get="GET",e.post="POST",e}();t.HttpMethod=r;var o=function(){function e(){}return e.separator="://",e}();t.UriSeparator=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbtRequestParams=void 0;var a=function(){function e(){}return e.userId="userid",e.market="rs",e.action="action",e.workload="workload",e.app="app",e.build="build",e.signInUrl="signInUrl",e}();t.AbtRequestParams=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SignOutUtils=void 0;var a=n(167),i=n(239),r=n(142),o=n(168),s=n(198),c=n(199),d=n(244),l=n(243),u=n(197),f=n(70),p=n(166),m=n(169),_=n(202),h=n(90),b=n(79),g=n(201),v=n(66);!function(e){var t="SignOutUtils";function n(e,n,p){var m="broadcast";f.LoggingUtils.log("Start broadcasting sign out",t,m,v.Global.gAbtSkipAriaLog),a.RequestUtils.sendPostRequest(e,0,n,r.AbtActions.signOut,o.InFlightUtils.deleteItem);var _,h,b=p===i.SignOutSource.abtTimeout?s.AbtEvent.hostSignOut:s.AbtEvent.hostSignOutUserGenerated,g='{ "'+c.AbtEventProperty.eventId+'": "'+b+'", "'+c.AbtEventProperty.detail+'": { "'+c.AbtEventProperty.userId+'": "'+e+'", "'+c.AbtEventProperty.signOutPageUrl+'": "'+(_=d.AbtRequestParams.market+"="+v.Global.gAbtMarket+"&"+d.AbtRequestParams.app+"={0}&"+d.AbtRequestParams.build+"={1}&"+d.AbtRequestParams.signInUrl+"={2}",(l.UriScheme.https+l.UriSeparator.separator+u.AbtHost.abtSignOut+l.UriFormats.abtSignOut).concat("?",_)+'"} }');h=JSON.parse(g);var y=JSON.stringify(h);window.postMessage(y,window.location.origin),f.LoggingUtils.log("Signout triggered with post message",t,m,void 0,void 0,void 0,n),f.LoggingUtils.log(""+y,t,m,!0)}function y(e){f.LoggingUtils.log("Check if user needs to be sign out.",t,"shouldSignOut",v.Global.gAbtSkipAriaLog),D(e)&&a.RequestUtils.sendGetRequest(e,r.AbtActions.shouldSignOut,S)}function S(e){var a="performSignOut";f.LoggingUtils.log("Start performing the sign out operation.",t,a,v.Global.gAbtSkipAriaLog),null!=e?null===e.error||void 0===e.error?(e.result||(p.ActivityUtils.isActivityRecent(e.userId,e.timeSinceActivity)?(f.LoggingUtils.log("Found activity reported on server. Updating local records.",t,a,v.Global.gAbtSkipAriaLog),p.ActivityUtils.extendLocalActivity(e.userId,e.timeSinceActivity),m.PromptUtils.startPromptChecks(e.userId),null!=window.AbtUI&&window.AbtUI.AbtHidePrompt()):f.LoggingUtils.error("Not signing out user based on server data. Activity is not recent either.",t,a)),e.respectResult?e.result&&(f.LoggingUtils.log("Signing out user.",t,a,v.Global.gAbtSkipAriaLog),I(),n(e.userId,e.timeout,i.SignOutSource.abtTimeout)):f.LoggingUtils.log("RespectResult is set to 'false'. Not signing out. The result of sign out from server was '"+e.result+".'",t,a,v.Global.gAbtSkipAriaLog)):f.LoggingUtils.error("Error found in the ABT service response. ErrorCode: '"+e.error.errorCode+"'. Not signing out.",t,a):f.LoggingUtils.warn("WebResponse provided was null or undefined. Not signing out.",t,a)}function D(e){var n="shouldSignOutLocal";f.LoggingUtils.log("Check if user needs to be sign out from the browser without reaching to the server.",t,n,v.Global.gAbtSkipAriaLog);var a=h.LocalStorageUtils.convertActivitiesToRecords(h.LocalStorageUtils.getItemValue(b.AbtStorageId.abtActivity));if(null==a||null==a.records||void 0===a.records||a.records.length<=0)return f.LoggingUtils.warn("Didn't get data from local activities item. No need to sign out the user: '"+e+"'.",t,n),!1;for(var i=0,r=a.records;i<r.length;i++){var o=r[i];if(null!==o.userId&&void 0!==o.userId&&o.userId===e){var s=g.TimeUtils.addMinutes(o.activityDateTime,o.timeout);return null!=s&&(s.getTime()<(new Date).getTime()?(f.LoggingUtils.log("Based on local data, we might need to sign out '"+e+"'.\n\t\t\t\t\t\t\tWe will call server before making that final. DateTime to sign out was '"+s.toUTCString()+" and Current time is '"+(new Date).toUTCString()+"'.\n\t\t\t\t\t\t\tTimeout value was: '"+o.timeout+"'.",t,n,v.Global.gAbtSkipAriaLog),!0):(f.LoggingUtils.log("No need to sign out '"+e+"'.\n\t\t\t\t\t\t\tDateTime to sign out was '"+s.toUTCString()+" and Current time is '"+(new Date).toUTCString()+"'.\n\t\t\t\t\t\t\tTimeout value was: '"+o.timeout+"'.",t,n,v.Global.gAbtSkipAriaLog),null!=window.AbtUI&&window.AbtUI.AbtHidePrompt(),!1))}}return!1}function I(){v.Global.gAbtStartedSignOutChecks=!1,clearInterval(v.Global.gAbtSignOutTimer)}e.broadcast=n,e.shouldSignOut=y,e.shouldSignOutLocal=D,e.startSignOutChecks=function(e){!0!==v.Global.gAbtStartedSignOutChecks&&(m.PromptUtils.stopPromptChecks(),I(),v.Global.gAbtStartedSignOutChecks=!0,v.Global.gAbtSignOutTimer=setInterval(y,_.AbtTimer.signOutInterval,e))},e.stopSignOutChecks=I}(t.SignOutUtils||(t.SignOutUtils={}))},function(e,t,n){"use strict";var a=n(172);n.d(t,"e",function(){return a.e})},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(7),i=n(4),r=n(56),o=n(317),s=n(91),c=a.e.isActivated("EEE100CF-4686-4365-A420-B78444ADC660","07/06/2023")||Object(s.e)({ODB:60362}),d=function(){function e(){}return e.prototype.onChange=function(){return function(){}},Object.defineProperty(e.prototype,"offline",{get:function(){return!1},enumerable:!1,configurable:!0}),e}(),l=new i.t({name:"offlineDetection",factory:c?new r.a(o.e):new r.a(d)})},,function(e,t,n){"use strict";var a=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function o(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var a={};return"abcdefghijklmnopqrst".split("").forEach(function(e){a[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},a)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,s,c=o(e),d=1;d<arguments.length;d++){for(var l in n=Object(arguments[d]))i.call(n,l)&&(c[l]=n[l]);if(a){s=a(n);for(var u=0;u<s.length;u++)r.call(n,s[u])&&(c[s[u]]=n[s[u]])}}return c}},,,,function(e,t,n){"use strict";n.d(t,"t",function(){return B}),n.d(t,"e",function(){return ce});var a,i=n(0),r=n(25),o=n(29),s=n(30),c=n(336),d=n(259),l=n(35),u=n(228),f=n(126),p=n(109),m=n(130),_=n(56),h=function(){function e(e,t){this._itemsStore=t.itemsStore}return e.prototype.getParent=function(e){if(e){var t=this._itemsStore.getItem(e.key),n=t&&t.peek(),a=n&&(n.parentKey||n.UNSAFE_parent&&n.UNSAFE_parent.key);return a?this._itemsStore.getItem(a):void 0}},e.prototype.getFacetedAncestorOrSelf=function(e,t,n){return void 0===n&&(n=""),this.getAncestorOrSelf(e,function(e){return n?e[t]&&e[t][n]:!!e[t]})},e.prototype.getAncestorOrSelf=function(e,t){for(var n,a=e&&e.key;a;){var i=this._itemsStore.getItem(a),r=i&&i.peek();if(!r)break;if(t(r)){n=i;break}a=r&&(r.parentKey||r.UNSAFE_parent&&r.UNSAFE_parent.key)}return n},e.dependencies={itemsStore:m.e},e}(),b=Object(_.i)("ItemParentHelper",h),g=n(4),v=n(377),y=n(271),S=new y.e("photosExperimentHelperKeyFacet",{}).serialize({}),D=n(181),I=new D.e("photosExperimentHelper"),x=n(24),C=(new y.e("odspNextApp",{}).serialize({}),new D.e("resourceScopeFacet"),n(80)),O=n(8),w=n(229),E=new g.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabled"),factory:{dependencies:{},create:function(e){return{instance:!O.L||Object(O.E)(O.b)||Object(O.E)(O.y)}}}}),A=(new g.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInFilesPivot"),factory:{dependencies:{},create:function(){return{instance:!O.L||Object(O.E)(O.b)}}}}),new g.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInCrossSitePivots"),factory:{dependencies:{},create:function(){return{instance:!!O.L&&Object(O.E)(O.y)}}}}),new g.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllPhotosPivot"),factory:{dependencies:{platformDetection:w.e},create:function(e){return{instance:Object(O.E)(O.u)&&(!e.platformDetection.isIE||Object(O.E)(O.f))&&(!e.platformDetection.isSafari||Object(O.E)(O._))&&(!e.platformDetection.isMobile||Object(O.E)(O.m))}}}})),L=(new g.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSingleAlbumView"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:A},create:function(e){return{instance:Object(O.E)(O.g)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),new g.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSingleTagView"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:A},create:function(e){return{instance:Object(O.E)(O.v)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),new g.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSinglePlace"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:A},create:function(e){return{instance:e.isItemsScopeEnabledInAllPhotosPivot}}}})),k=(new g.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllPhotosFilePicker"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:A},create:function(e){return{instance:Object(O.E)(O.p)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),new g.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllTagsPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:A},create:function(e){return{instance:Object(O.E)(O.h)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),new g.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllPlacesPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:A},create:function(e){return{instance:e.isItemsScopeEnabledInAllPhotosPivot}}}}),new g.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllAlbumsPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:A},create:function(e){return{instance:e.isItemsScopeEnabledInAllPhotosPivot}}}}),new g.t({name:"".concat("ItemsScopeFeature.key",".isVroomEnabledInAllPhotosPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:A},create:function(e){return{instance:function(e){var t=e(Object(v.e)(function(e){return e.demandItemFacet(I,S)}));return Object(x.E)(x.C)||Boolean(t&&t.isUseVroomInItemsScopeAllPhotosOtdExpOn())}&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),new g.t({name:"".concat("ItemsScopeFeature.key",".isVroomEnabledInSinglePlaceView"),factory:{dependencies:{isItemsScopeEnabledInSinglePlaceView:L},create:function(e){return{instance:e.isItemsScopeEnabledInSinglePlaceView}}}}),n(69));!function(e){e[e.NotCreated=-1]="NotCreated",e[e.Created=0]="Created",e[e.BubbleShown=1]="BubbleShown",e[e.FreShown=2]="FreShown"}(a||(a={}));var M="oneDriveVault",P="vaultdriveid",T=function(e){function t(t,n){void 0===t&&(t={});var i=e.call(this,t,n)||this;return i._identityDataSource=n.identityDataSource,i.isVaultDisabled=i.createObservable(void 0),i.vaultFreState=i.createObservable(a.NotCreated),i.vaultQuota=i.createObservable(void 0),i.isOverQuota=i.createPureComputed(i._computeIsOverQuota),i.showVaultLockNotification=i.createObservable(!1),i.showVaultFreMessage=i.createObservable(!1),i.storageKeyPrefix=M+i._identityDataSource.getIdentity().id,i.dataStore=new k.e(i.storageKeyPrefix,o.e.local),i.isVaultOpen=i.createObservable(!!i.dataStore.getValue("expirationtime",o.e.local)),i}return Object(i.a)(t,e),t.prototype.setDriveId=function(e){this.dataStore.setValue(P,e,o.e.local)},t.prototype.getDriveId=function(){return this.dataStore.getValue(P,o.e.local)},t.prototype._computeIsOverQuota=function(){var e=this.vaultQuota();return!!e&&e.remainingFiles<=0&&e.totalFiles>0},t}(r.e),U=Object(_.i)("VaultStore",T,Object(i.e)(Object(i.e)({},r.e.dependencies),{identityDataSource:s.a})),F=n(131),H=n(9),R=n(18);function N(e,t){var n;switch(e){case H.e.Files:n="Files";break;case H.e.Restore:n="Restore";break;case H.e.RansomwareDetection:n="RansomwareDetection";break;case H.e.ManageVault:n="ManageVault";break;default:n=""}return t?"".concat(n,"-").concat(R.e[t]):"".concat(n)}var B,j=n(119),V=n(223),z=n(258),G=n(260),K=function(e){function t(t){var n=e.call(this,t)||this;return n.html=t.html,n}return Object(i.a)(t,e),t}(n(158).e),W=n(159).e({tagName:"ms-html-container",template:'<div class="HTMLContainer" data-bind="html:html"></div>',viewModel:K}),q=n(113),Q=n(23),Y=n(257),J=n(224),X=n(154),Z=n(16),$=n(36),ee=n(34),te=n(273),ne=n(7),ae="expirationtime",ie="vaultMenuCalloutMessageShow",re=["ManageVault","Restore","RansomwareDetection"],oe=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._clientName=n.clientName,a._identityDataSource=n.identityDataSource,a._vroomDataRequestor=n.vroomDataRequestor,a._itemStore=n.itemStore,a._navigation=n.navigation,a._urlDataSource=n.urlDataSource,a._itemProvider=n.itemProvider,a._dialogProvider=n.dialogProvider,a._userInfoProvider=n.userInfoProvider,a._itemParentHelper=n.itemParentHelper,a._bundleLoader=n.bundleLoader,a._isItemsScopeEnabled=n.isItemsScopeEnabled,a._vaultStore=n.vaultStore,a._storageKeyPrefix=a._vaultStore.storageKeyPrefix,a._dataStore=a._vaultStore.dataStore,a._isVaultOpen=a._vaultStore.isVaultOpen,a._vaultFreState=a._vaultStore.vaultFreState,a._vaultSuggestCardState=a.createObservable(0),a._vaultQuota=a._vaultStore.vaultQuota,a._quotaLoaded=a.createComputed(a._computeQuotaLoaded),a._isVaultDisabled=a._vaultStore.isVaultDisabled,a._isLocking=!1,a._isOneDriveWinApp=Object(Y.e)(),a.isOverQuota=a._vaultStore.isOverQuota,a._showVaultLockNotification=a._vaultStore.showVaultLockNotification,a._showVaultFreMessage=a._vaultStore.showVaultFreMessage,a.createComputed(a._calculateFreMessage),a.events.on(window,"storage",a._onStorageChange),a.createBackgroundComputed(a._updateVaultQuota),a.fetchIsVaultDisabled(),a._isVaultOpen.peek()&&(a._getExpiration()<Date.now()?a.lockVault(void 0,!0):a._handleVaultUnlock()),a._customerPromiseEvent=u.e,a}return Object(i.a)(t,e),t.prototype.vaultLockMessageSubscribe=function(e){this.scope.attach(e.register(this._showVaultLockNotification))},t.prototype.vaultStateSubscribe=function(e){this.scope.attach(e.register(this._isVaultOpen))},t.prototype.vaultFreSubscribe=function(e){this.scope.attach(e.register(this._vaultFreState))},t.prototype.vaultQuotaSubscribe=function(e){this.scope.attach(e.register(this._vaultQuota))},t.prototype.vaultMenuCalloutSubscribe=function(e){this.scope.attach(e.register(this._showVaultFreMessage))},t.prototype.vaultDisabledSubscribe=function(e){this.scope.attach(e.register(this._isVaultDisabled))},t.prototype.getVaultItem=function(){return this._vaultItem},t.prototype.isVaultOpen=function(){return this._isVaultOpen},t.prototype.isVaultDisabled=function(){return this._isVaultDisabled},t.prototype.freState=function(){return this._vaultFreState},t.prototype.suggestCardState=function(){return this._vaultSuggestCardState},t.prototype.getShowVaultFreMessage=function(){return this._showVaultFreMessage()},t.prototype.setShowVaultFreMessage=function(e,t){void 0===t&&(t=!1),t||this._showVaultFreMessage(e),this._setVaultIconFre(e)},t.prototype.unlockVault=function(e,t){var n=this,a=new this._customerPromiseEvent({scenario:"UnlockVault",pillar:"Manage"});return this.getVault(!1,!0).then(function(r){if(!r||!r.vault||r.vault.isLocked||e){var o;o=e?n._identityDataSource.getSessionToken(!0):n._isOneDriveWinApp?F.t.resolve({wlidToken:t}):F.t.resolve({accessToken:t});var s={};return n._isOneDriveWinApp&&(s.Prefer="Include-Feature=Vault"),Object(O.E)(O.e)&&(s=Object(i.e)(Object(i.e)(Object(i.e)({},s),{Scenario:X.e.OpenVault,ScenarioType:X.t.ActiveUserOperation}),n._clientName?{Application:n._clientName}:{})),o.then(function(t){return n._vroomDataRequestor.send(Object(i.e)({apiName:"action.unlockVault",path:"/drive/special/vault/action.unlockVault",headers:s,requestType:"POST",postData:JSON.stringify({}),accessToken:t,postProcessQos:n._postProcessUnlockQos.bind(n),useAuthorizationHeaders:!0,qosExtraData:{isExtend:!!e}},Object(O.E)(O.l)&&Object($.e)(ee.t)?n.getUnlockVaultV2RequestData():{})).then(function(){if(n.setVaultLockState({root:void 0,isLocked:!1,expirationInSeconds:1200}),!e){var t=n._urlDataSource.getRootItemKey();n._invalidateItems(t)}return a.end({resultType:l.e.Success,extraData:{isExtend:e}}),F.t.resolve({})}).catch(function(t){return n._handleVaultLock(),a.end({resultType:l.e.Failure,errorCode:t.code,extraData:{isExtend:e}}),F.t.reject(t)})})}n.setVaultLockState(r.vault,!!t)})},t.prototype.setVaultLockState=function(e,t,n){if(void 0===t&&(t=!1),!this._isLocking){var a=this._isVaultOpen.peek(),i=e.isLocked;if(i||a)i&&a&&this._handleVaultLock(!1,n);else{var r=e.expirationInSeconds||1200,s=Date.now()+1e3*r;this._dataStore.setValue(ae,s,o.e.local),this._handleVaultUnlock(t)}}},t.prototype.lockVault=function(e,t){var n=this;this._isLocking=!0,this._navToRootIfInVault();var a=new this._customerPromiseEvent({scenario:"LockVault",pillar:"Manage"});if(e){var r=this._urlDataSource.getPageType(this._navigation.viewParams),o=this._urlDataSource.getQueryType(this._navigation.viewParams);c.e.logData({name:"Vault.Autolocked",extraData:{location:N(r,o)}})}var s=this._vaultItem?F.t.resolve(this._vaultItem):this.getVault(),d={};return this._isOneDriveWinApp&&(d.Prefer="Include-Feature=Vault"),Object(O.E)(O.e)&&(d=Object(i.e)(Object(i.e)(Object(i.e)({},d),{Scenario:X.e.CloseVault,ScenarioType:X.t.ActiveUserOperation}),this._clientName?{Application:this._clientName}:{})),s.then(function(r){return n._vroomDataRequestor.send(Object(i.e)({apiName:"action.lockVault",path:"/drive/special/vault/action.lockVault",headers:d,requestType:"POST",postData:JSON.stringify({}),postProcessQos:n._postProcessQos.bind(n),qosExtraData:{isAutoLock:!!e}},Object(O.E)(O.l)&&Object($.e)(ee.t)?n.getLockVaultV2RequestData():{})).then(function(){n._isLocking=!1,n._handleVaultLock(t),a.end({resultType:l.e.Success,extraData:{isAutoLock:e}})}).catch(function(i){return n._isLocking=!1,403===i.status?n._handleVaultLock(t):n._showLockFailed(),n._isExpectedError(i)?F.t.resolve():(a.end({resultType:l.e.Failure,errorCode:i.code,extraData:{isAutoLock:e}}),F.t.reject(i))})})},t.prototype.dismissLockNotification=function(){this._showVaultLockNotification(!1)},t.prototype.extendLock=function(){return this.unlockVault(!0)},t.prototype.getVault=function(e,t,n,a){var i=this,r={};return e&&(r.Prefer="auto-create-special-folder"),this._isOneDriveWinApp&&(r.Prefer=r.Prefer+",Include-Feature=Vault"),n=n||"GET",(Object($.e)(ee.t)?Object(O.E)(O.l)?i.getVaultV2(e,a):F.t.reject(new Error("vault is not supported")):this._vroomDataRequestor.send({apiName:a?"EnableVault":e?"CreateVault":"GetVault",path:"/drive/special/vault",headers:r,requestType:n,breakCache:!0,qosExtraData:{requestType:n},postProcessQos:this._postProcessQos.bind(this)})).then(function(e){var t,n;return e&&((null===(n=null===(t=null==e?void 0:e.createdBy)||void 0===t?void 0:t.user)||void 0===n?void 0:n.id)&&(e.createdBy.user.id=e.createdBy.user.id.toUpperCase()),i._vaultItem=e),e}).catch(function(e){return t?null:F.t.reject(e)})},t.prototype.getQuota=function(){var e=this,t={};this._isOneDriveWinApp&&(t.Prefer="Include-Feature=Vault");var n=Object(O.E)(O.l)&&Object($.e)(ee.t);return this._vroomDataRequestor.send(Object(i.e)({apiName:"drive",path:"/drive?select=quota/vault",headers:t,requestType:"GET"},n?this.getQuotaV2RequestData():{})).then(function(t){var a=t&&t.quota&&t.quota.vault;return a&&n&&(a.state=null==a?void 0:a.state.toLowerCase()),e._vaultQuota(a),a})},t.prototype.createVaultIfNotExist=function(){var e=this;return this._userInfoProvider.getUserFact(46).then(function(t){if(!t||e._vaultFreState.peek()===a.Created)return e.getVault(!0).then(function(t){e.setVaultState(a.Created),e._isVaultDisabled(!1);var n=e._urlDataSource.getRootItemKey();return e._invalidateItems(n,{triggerFetch:!0}),t});var n=JSON.parse(t.param||"{}");e._vaultFreState(n.s),e._vaultSuggestCardState(n.c)})},t.prototype.fetchIsVaultDisabled=function(){var e=this;return ne.e.isActivated("A156E5CD-240F-4D64-8556-D3C3FE1BDE6A","10/31/2023","Set Vault as disabled for migrated user if ramp is not enabled")||Object(O.E)(O.l)||!Object($.e)(ee.t)?(void 0!==this._isVaultDisabledPromise||(this._isVaultDisabledPromise=this._userInfoProvider.getUserFact(46).then(function(t){return t||Object(O.E)(O.l)&&Object($.e)(ee.t)?e.getVault(!1,!1,"HEAD").then(function(){return e._isVaultDisabled(!1),!1}).catch(function(t){var n=404===t.status;return e._isVaultDisabled(n),n}):(e._isVaultDisabled(!0),!0)})),this._isVaultDisabledPromise):(this._isVaultDisabled(!0),F.t.resolve(!0))},t.prototype.enableVault=function(){var e=this;return this.getVault(!0,!1,"GET",!0).then(function(t){ne.e.isActivated("B47EA874-F55F-46F4-ABD4-0F54605AC0A5","09/28/2023","Set user fact when enabling vault")||e.setVaultState(a.Created);var n=e._urlDataSource.getRootItemKey();return e._invalidateItems(n,{triggerFetch:!0}),e._isVaultDisabled(!1),t})},t.prototype.disableVault=function(e){var t=this;if(Object(O.E)(O.l)&&Object($.e)(ee.t))return e?this.disableVaultV2():F.t.resolve("confirmToken");var n={};return e&&(n.If="(<".concat(e,">)")),this._isOneDriveWinApp&&(n.Prefer="Include-Feature=Vault"),this._vroomDataRequestor.send({apiName:"deleteVault",headers:n,path:"/drive/special/vault",requestType:"DELETE",postData:JSON.stringify({}),postProcessQos:this._postProcessQos.bind(this)}).then(function(){t._cleanLocalLockInfo(),t._isVaultDisabled(!0)}).catch(function(e){var t=e.response;if(t&&t.error&&t.error.fixItUrl){var n=new Q.t(t.error.fixItUrl).getQueryParameter("confirmationToken");if(n)return n}return F.t.reject(e)})},t.prototype.setVaultState=function(e,t){var n=void 0;void 0!==e&&e>this._vaultFreState.peek()&&(this._vaultFreState(e),n=e),t&&this._vaultSuggestCardState(t);var a={s:n||this._vaultFreState.peek(),c:t||this._vaultSuggestCardState.peek()};return this._userInfoProvider.setUserInfo(46,3,JSON.stringify(a))},t.prototype.reset=function(){return F.t.resolve(!1)},t.prototype.toggleDebug=function(){},t.prototype._onNavigationChange=function(){var e=this._getCurrentItem(),t=this._navigation.viewParams,n=this._isVaultOpen.peek();e&&(n&&(!e.vault&&re.indexOf(t&&t.v)<=-1?this._detatchIdleEvents():this._attachIdleEvents()),e.vault&&e.vault.root?this._vaultRootLoadEventFiled||(c.e.logData({name:"Vault.Unlocked.Loaded"}),this._vaultRootLoadEventFiled=!0):this._vaultRootLoadEventFiled=!1)},t.prototype._computeQuotaLoaded=function(){return!!this._bundleLoader.getBundleInfo(2).isLoaded()&&(this._userStateProvider||(this._userStateProvider=this.resources.consume(j.i)),!0)},t.prototype._updateVaultQuota=function(){var e=this._userStateProvider&&this._userStateProvider.quotaNeedsUpdate();if(this._quotaLoaded()&&e&&this._isVaultOpen()&&(this.getQuota(),O.A)){var t=this._getCurrentItem();this.resources.consumeAsync(s.i).then(function(e){e.invalidateQuota(null==t?void 0:t.key)})}},t.prototype._isDebug=function(){return!1},t.prototype._getExpiration=function(){return this._isDebug()?Date.now()+12e4:this._dataStore.getValue(ae,o.e.local)},t.prototype._startExpirationTimers=function(){var e=this;this._expirationWarningTimerId=this.async.setTimeout(function(){e._verifyLockExpiration()},this._getExpiration()-Date.now()-6e4),this._expirationLockTimerId=this.async.setTimeout(function(){e.lockVault(!0)},this._getExpiration()-Date.now())},t.prototype._stopExpirationTimers=function(){this.async.clearTimeout(this._expirationWarningTimerId),this.async.clearTimeout(this._expirationLockTimerId)},t.prototype._resetExpirationTimers=function(){this._stopExpirationTimers(),this._startExpirationTimers()},t.prototype._attachIdleEvents=function(){this._idleEventsAttached||("ontouchstart"in document.documentElement&&this.events.on(document,"touchstart",this._resetLastActivity,!0),this.events.on(document,"mousemove",this._resetLastActivity,!0),this.events.on(document,"keypress",this._resetLastActivity,!0),this._idleEventsAttached=!0)},t.prototype._detatchIdleEvents=function(){this._idleEventsAttached&&("ontouchstart"in document.documentElement&&this.events.off(document,"touchstart",this._resetLastActivity,!0),this.events.off(document,"mousemove",this._resetLastActivity,!0),this.events.off(document,"keypress",this._resetLastActivity,!0),this._idleEventsAttached=!1)},t.prototype._resetLastActivity=function(){this._lastActivity=Date.now()},t.prototype._verifyLockExpiration=function(){var e=this;this._isDebug()?this._showLockWarning():Date.now()-this._lastActivity<9e5?this.extendLock().then(function(){e._resetExpirationTimers()}):this.getVault().then(function(t){var n=t.vault&&t.vault.expirationInSeconds||0;if(1e3*n>12e4){var a=Date.now()+1e3*n;e._dataStore.setValue(ae,a,o.e.local),e._resetExpirationTimers()}else e._showLockWarning()}).catch(function(t){return e.lockVault()})},t.prototype._showLockFailed=function(){var e=this,t=this._dialogProvider.requestDialog({title:q.r,component:{name:W.tagName,params:{html:'<span class="ms-fontColor-error">'.concat(q.a,"</span>")}},actions:[{name:q.i,execute:function(){return F.t.resolve(2)},isAvailable:this.observables.create(!0),icon:new f.e("CheckMark"),isDefault:!0}],isSoftDismissable:!1});t.wait().then(function(){2===t.state.peek()&&(e.async.clearTimeout(e._retryLockVault),e._retryLockVault=e.async.setTimeout(function(){e.lockVault()},500))})},t.prototype._showLockWarning=function(){var e=this;this._warningDialog=this._dialogProvider.requestDialog({title:q.n,component:{name:G.e.tagName,params:{text:q.e}},actions:[{name:q.t,execute:function(){return c.e.logData({name:"Vault.StillHere.Extend"}),e.extendLock().then(function(){return e._resetExpirationTimers(),F.t.resolve(2)})},isAvailable:this.observables.create(!0),icon:new f.e("Cancel"),isDefault:!0}],isSoftDismissable:!1}),c.e.logData({name:"Vault.StillHere.Shown"}),this._warningDialog.wait().catch(function(){3===e._warningDialog.state.peek()&&c.e.logData({name:"Vault.StillHere.Dismiss"})})},t.prototype._handleVaultLock=function(e,t){this._cleanLocalLockInfo(t),this._showVaultLockNotification(!e)},t.prototype._cleanLocalLockInfo=function(e){var t=this;this._isVaultOpen(!1),this._dataStore.remove(ae,o.e.local),this._stopExpirationTimers(),e||this._navToRootIfInVault(),this.events.off(this._navigation,"change",this._onNavigationChange),this._navEventAttached=!1,this._getVaultIconFre()||this._showVaultFreMessage(!1),this._detatchIdleEvents(),this._warningDialog&&this._warningDialog.dismiss(),Object.keys(R.e).map(function(e){var n=t._urlDataSource.getRootItemKey(R.e[e]);t._invalidateItems(n)});var n=this._getCurrentItem();if(this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(n,"vault"))){var a=this._urlDataSource.getRootItemKey();this._itemStore.emptyAllOtherSets([a])}else n&&this._invalidateItems(n.key,{emptyAllOtherSets:!0});this._itemStore.invalidateAllVault()},t.prototype._navToRootIfInVault=function(){var e,t,n,a=this._getCurrentItem(),i=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(a,"vault")),r=Object(O.E)(O.l)&&Object($.e)(ee.t)&&this._vaultItem&&(null===(e=null==a?void 0:a.graph)||void 0===e?void 0:e.driveId)===(null===(n=null===(t=this._vaultItem.remoteItem)||void 0===t?void 0:t.parentReference)||void 0===n?void 0:n.driveId);if(i||r){var o=this._urlDataSource.getRootItemKey(),s=this._urlDataSource.getItemUrl(o);this._navigation.navigateTo({url:s})}},t.prototype._invalidateItems=function(e,t){var n=this;this._isItemsScopeEnabled()?this.resources.consumeAsync(s.i).then(function(a){a.invalidateItems(e),Object(O.E)(O.l)&&Object($.e)(ee.t)&&a.invalidateCurrentItemSet(),O.A&&n._itemProvider.invalidateItem(e,t);var i=n._getCurrentItem();(null==i?void 0:i.vault)&&a.invalidateItems(i.key)}):this._itemProvider.invalidateItem(e,t)},t.prototype._handleVaultUnlock=function(e){var t=this;void 0===e&&(e=!1),this._isVaultOpen(!0),this._resetExpirationTimers();var n=this._urlDataSource.getRootItemKey();this._invalidateItems(n,{triggerFetch:!0}),this._navEventAttached||(this.events.on(this._navigation,"change",this._onNavigationChange),this._navEventAttached=!0,this._onNavigationChange()),this.getQuota(),this._warningDialog&&this._warningDialog.dismiss();var a=this._getCurrentItem();if(a&&(a.vault||a.isPlaceholder||a.error&&a.error.data&&161===a.error.data.errorCode||a.queryType===R.e.RecycleBin&&"root"===a.id)){this._invalidateItems(a.key,{triggerFetch:!0});var i=this._urlDataSource.getFocusItemKey(this._navigation.viewParams);i&&this._invalidateItems(i,{purgeCache:!0})}this._showVaultLockNotification(!1),c.e.logData({name:"Vault.Unlocked.Succeeded"}),this._getVaultIconFre()&&!e&&(this.async.setTimeout(function(){t._showVaultFreMessage(!0)},5e3),this._setVaultIconFre(!1))},t.prototype._onStorageChange=function(e){var t=e.key,n=e.oldValue,a=e.newValue;if(t===this._storageKeyPrefix+"canary"&&a)try{var i=JSON.parse(a);FilesConfig.canary!==i&&(FilesConfig.canary=FilesConfig.navCanary=i)}catch(e){}t===this._storageKeyPrefix+ae&&(a?(!n||a>n)&&(this._dataStore.getValue(ae,o.e.local)||this._dataStore.setValue(ae,parseInt(a,10),o.e.local),this._handleVaultUnlock()):this._isVaultOpen.peek()&&this._handleVaultLock())},t.prototype._calculateFreMessage=function(){var e=this;this._getVaultIconFre()&&this.async.setTimeout(function(){e._showVaultFreMessage(!0)},5e3)},t.prototype._getCurrentItem=function(){var e=this._urlDataSource.getCurrentItemKey(this._navigation.viewParams);return this.unwrapObservable(this._itemStore.getItem(e))},t.prototype._getVaultIconFre=function(){return this._dataStore.getValue(ie,o.e.local)},t.prototype._setVaultIconFre=function(e){e?this._dataStore.setValue(ie,e,o.e.local):this._dataStore.remove(ie,o.e.local)},t.prototype._postProcessQos=function(e,t){return this._isExpectedError(t)&&(e.resultType=l.e.ExpectedFailure),e},t.prototype._postProcessUnlockQos=function(e,t){return this._isExpectedUnlockError(t)&&(e.resultType=l.e.ExpectedFailure),e},t.prototype._isExpectedError=function(e){if(400===e.status||403===e.status){var t=Object(p.a)(e);if("memberdoesnotexist"===(t=t&&t.toLowerCase())||"unlockrequired"===t||"accessdenied"===t||"confirmationrequired"===t)return!0}else if(404===e.status)return!0;return!1},t.prototype._isExpectedUnlockError=function(e){var t=Object(p.a)(e);return"vaultunlockextensiontimeexceeded"===(t=t&&t.toLowerCase())&&(c.e.logData({name:"Vault.Unlock.MaxExtensionError"}),!0)},t.prototype.enableVaultV2=function(e){var t="POST",n="v2.1";return this._vroomDataRequestor.send({endpoint:Object(Z.o)({apiVersion:n,driveId:"me",includeViewerId:!0}),apiName:e?"CreateVault":"EnableVault",path:"/oneDrive.createVault",requestType:t,breakCache:!0,apiVersion:n,qosExtraData:{requestType:t},postProcessQos:this._postProcessQos.bind(this),useAuthorizationHeaders:!0})},t.prototype.disableVaultV2=function(){var e,t=this,n="POST",a="v2.1";return(null===(e=this._identityDataSource)||void 0===e?void 0:e.getSessionToken(!0)).then(function(e){return t._vroomDataRequestor.send({endpoint:Object(Z.o)({apiVersion:a,driveId:"me",includeViewerId:!0}),apiName:"deleteVault",path:"/oneDrive.disableVault",requestType:n,breakCache:!0,apiVersion:a,qosExtraData:{requestType:n},postProcessQos:t._postProcessQos.bind(t),useAuthorizationHeaders:!0,accessToken:e}).then(function(){t._cleanLocalLockInfo(),t._isVaultDisabled(!0)}).catch(function(e){return F.t.reject(e)})})},t.prototype.getUnlockVaultV2RequestData=function(){return{endpoint:Object(Z.o)({apiVersion:"v2.1",driveId:"me",includeViewerId:!0}),apiName:"action.unlockVaultV2",path:"/oneDrive.unlockVault"}},t.prototype.getLockVaultV2RequestData=function(){return{endpoint:Object(Z.o)({apiVersion:"v2.1",driveId:"me",includeViewerId:!0}),apiName:"action.lockVaultV2",path:"/oneDrive.lockVault"}},t.prototype.getVaultV2=function(e,t){var n=this,a="v2.1",r={Prefer:"Include-Feature=AddToOneDrive;Vault"};return(e||t?this.enableVaultV2(e):F.t.resolve()).then(function(){return n._vroomDataRequestor.send({endpoint:Object(Z.o)({apiVersion:a,driveId:"me",includeViewerId:!0}),apiName:"GetVault",path:"/drive/items/root/children?select=*,containingDrivePolicyScenarioViewpoint&filter=remoteItem/containingDrivePolicyScenarioViewpoint/PolicyScenarioId eq '".concat("fa0c6428-7a2e-4a42-a9cc-52f48021d0ba","'"),headers:r,breakCache:!0,apiVersion:a,useAuthorizationHeaders:!0})}).then(function(e){var t,a,r,o=(void 0===e?{value:[]}:e).value;if(0===o.length)return F.t.reject({status:404,message:"Vault not found"});var s=o[0];return n._vaultStore.setDriveId((null===(a=null===(t=s.remoteItem)||void 0===t?void 0:t.parentReference)||void 0===a?void 0:a.driveId)||""),Object(i.e)(Object(i.e)({},s),{vault:Object(te.e)(null===(r=s.remoteItem)||void 0===r?void 0:r.containingDrivePolicyScenarioViewpoint)})})},t.prototype.getQuotaV2RequestData=function(){return{endpoint:Object(Z.o)({apiVersion:"v2.1",driveId:"me"}),path:"/drives/".concat(this._vaultStore.getDriveId(),"?select=quota,vault")}},t}(r.e),se=(Object(_.i)("VaultDataSource",oe,Object(i.e)(Object(i.e)({},r.e.dependencies),{clientName:J.e.optional,identityDataSource:s.a,vroomDataRequestor:z.e,itemStore:m.e,vaultStore:U,urlDataSource:s.d,navigation:C.e,itemProvider:V.e,dialogProvider:d.e,userInfoProvider:j.o,itemParentHelper:b,bundleLoader:j.e,isItemsScopeEnabled:E.lazy})),12e4);!function(e){e[e.Valid=0]="Valid",e[e.Expiring=1]="Expiring",e[e.Locked=2]="Locked",e[e.Unlocked=3]="Unlocked",e[e.Extended=4]="Extended",e[e.Ended=5]="Ended"}(B||(B={}));var ce=function(){function e(e,t){var n=this;this.listeners=[],this.checkExpiration=function(){n.fetchExpirationTime().then(function(e){e?e-se<Date.now()?n.notifyExpiring():n.handleVaultExtended():n.notifyLocked()},function(){n.notifyExpiring()})},this.handleVaultLocked=function(){n.stopTimers(),n.notifyLocked()},this.handleVaultUnlocked=function(){n.notifyUnlocked()},this.handleVaultExtended=function(){n.stopTimers(),n.startTimers(),n.notifyExtended()},this.handleStorageEvent=function(e){if(e.key===n.expirationTimeStorageKey){var t=e.newValue,a=e.oldValue;t?a?t>a&&n.handleVaultExtended():n.handleVaultUnlocked():n.handleVaultLocked()}},this.wacDataSource=t,this.storagePrefix="".concat(M).concat(e),this.expirationTimeStorageKey="".concat(this.storagePrefix).concat(ae)}return e.prototype.setup=function(){var e=this;return this.addStorageEventListener(),this.syncExpirationTime().then(function(){e.startTimers()})},e.prototype.dispose=function(){this.removeStorageEventListener(),this.stopTimers()},e.prototype.addEventListener=function(e){-1===this.listeners.findIndex(function(t){return t===e})&&this.listeners.push(e)},e.prototype.removeEventListener=function(e){var t=this.listeners.findIndex(function(t){return t===e});-1!==t&&this.listeners.splice(t)},e.prototype.extendVault=function(){var e=this;return this.wacDataSource.request("/drive/special/vault/action.unlockVault","POST",!0).then(function(){return e.syncExpirationTime()}).then(function(){return e.handleVaultExtended()}).catch(function(){e.handleVaultLocked()})},e.prototype.onUserActivity=function(){this.extendVault()},e.prototype.notify=function(e){for(var t=0,n=this.listeners;t<n.length;t++)(0,n[t])(e)},e.prototype.notifyExpiring=function(){this.notify(B.Expiring)},e.prototype.notifyLocked=function(){this.notify(B.Locked)},e.prototype.notifyUnlocked=function(){this.notify(B.Unlocked)},e.prototype.notifyExtended=function(){this.notify(B.Extended)},e.prototype.syncExpirationTime=function(){var e=this;return this.fetchExpirationTime().then(function(t){t&&e.setExpirationTime(t)})},e.prototype.fetchExpirationTime=function(){return this.wacDataSource.request("/drive/special/vault","GET",!0).then(function(e){var t=e[0];if(t.vault.expirationInSeconds)return Date.now()+1e3*t.vault.expirationInSeconds})},e.prototype.getExpirationTime=function(){return Number(window.localStorage.getItem(this.expirationTimeStorageKey))},e.prototype.setExpirationTime=function(e){try{e&&window.localStorage.setItem(this.expirationTimeStorageKey,String(e))}catch(e){console.log(e)}},e.prototype.startTimers=function(){this.stopTimers();var e=this.getExpirationTime();if(e){var t=e-Date.now();this.expirationTimerId=window.setTimeout(this.checkExpiration,t-se),this.lockedTimerId=window.setTimeout(this.handleVaultLocked,t)}},e.prototype.stopTimers=function(){this.expirationTimerId&&(window.clearTimeout(this.expirationTimerId),this.expirationTimerId=void 0),this.lockedTimerId&&(window.clearTimeout(this.lockedTimerId),this.lockedTimerId=void 0)},e.prototype.addStorageEventListener=function(){window.addEventListener("storage",this.handleStorageEvent)},e.prototype.removeStorageEventListener=function(){window.removeEventListener("storage",this.handleStorageEvent)},e}()},function(e,t,n){"use strict";var a;n.d(t,"e",function(){return i.e}),n(209),n(7),function(){function e(){}e.DefaultLocale="en-US",e.TeamsListClientName="Teams.List",e.TeamsPagesClientName="Teams.Page",e.TeamsFileClientName="Teams.File",e.PageContextKey="_spPageContextInfo"}(),n(8),function(e){e[e.None=0]="None",e[e.List=1]="List",e[e.Page=2]="Page",e[e.Portal=3]="Portal",e[e.File=4]="File"}(a||(a={})),a.None,new function(){},a.None,location.search,n(340),n(212),n(91),location.search;var i=n(143)},function(e,t,n){"use strict";n.d(t,"e",function(){return A});var a=n(4),i=n(56),r=n(170),o=n(100),s=new a.t("".concat("MicroServiceDataSource.key",".microServiceDataSource")),c=n(131),d=n(124),l=n(55),u=n(64),f=n(91),p=n(7),m=new a.t({name:"alwaysUseTokenFetcherForVroom",factory:new a.e(!1)}),_=p.e.isActivated("8FBE5803-0F7D-47D4-9BBB-2BF40847050D","09/06/2022","Always use IdentityDataSource for tokens"),h=Object(f.e)({ODB:-671}),b=function(){function e(e,t){this._identityDataSource=t.identityDataSource,this._microServiceDataSource=t.microServiceDataSource,this._alwaysUseTokenFetcherForVroom=t.alwaysUseTokenFetcherForVroom}return e.prototype.getToken=function(e,t){var n,a,i=this._identityDataSource.getIdentity().type;if(i===o.e.aad){if(t&&(h||this._alwaysUseTokenFetcherForVroom)){var r=new u.e(t).authority;return null===(a=(n=this._identityDataSource).getSharePointToken)||void 0===a?void 0:a.call(n,r)}if(this._microServiceDataSource)return this._microServiceDataSource.getAuthData().then(function(t){if(t)return e&&"v2.1"===e?{accessToken:t.authTokenV21,proofToken:t.proofTokenV21,tokenUrl:t.tokenUrlV21}:{accessToken:t.authToken,proofToken:t.proofToken,tokenUrl:t.tokenUrl}},function(e){return c.t.resolve()})}else if(!_||i===o.e.msa)return this._identityDataSource.getSessionToken();return c.t.reject(new l.e({code:"unauthUser",isExpected:!0,message:"Cannot request a token for an unauthenticated user."}))},e.prototype.getFormDigest=function(e){var t,n;return null===(n=(t=this._identityDataSource).getFormDigest)||void 0===n?void 0:n.call(t,e)},e.dependencies={identityDataSource:d.e,microServiceDataSource:s.optional,alwaysUseTokenFetcherForVroom:m},e}(),g=Object(i.i)("SessionManagementProvider",b),v=n(148),y=n(250),S=n(0),D=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(S.a)(t,e),t.prototype.trackPromise=function(e){var t=!1,n=this.attach({dispose:function(){!t&&e.cancel&&e.cancel()}}),a=function(){t=!0,n.dispose()};return e.done(a,a),e},t.prototype.trackSignal=function(e){return this.attach({dispose:function(){e.cancel()}}),e},t}(n(71).e),I=D,x=n(172),C=new a.t({name:"".concat("isOfflineStateObservable.key",".isOfflineStateObservable"),factory:{dependencies:{offlineDetection:y.e},create:function(e){var t=new I,n=new x.e(e.offlineDetection.offline);return t.attach(e.offlineDetection.onChange(function(e){n.set(e)})),{instance:n,disposable:t}}}}),O=new a.t({name:"cookieOrigin",factory:new a.e(window.location.origin)}),w="VroomDataRequestor",E=new a.t({name:"".concat(w,".isOfflineStatePromise"),factory:{dependencies:{isOfflineStateObservable:C},create:function(e){return{instance:function(){return c.t.resolve(e.isOfflineStateObservable.get())}}}}}),A=Object(i.i)(w,v.e,{sessionManagementProvider:g.optional,urlDataSource:r.e.optional,cookieOrigin:O,isOffline:E})},function(e,t,n){"use strict";n.d(t,"e",function(){return g});var a,i=n(0),r=n(25),o=n(56),s=n(14),c=n(131),d=n(371),l=n(321);!function(e){e[e.normal=0]="normal",e[e.blocker=1]="blocker",e[e.vaultBlocker=2]="vaultBlocker"}(a||(a={}));var u=a,f=function(){this.icon=null,this.isAvailable=s.observable(!0),this.isVisible=s.observable(!0),this.isDefault=!1,this.automationId="",this.instrumentationId="",this.isExecuting=s.observable(!1),this.isLink=!1,this.execute=function(){return c.t.wrap(1)}},p=function(e){function t(t){var n=e.call(this,t)||this;n.state=s.observable(1);var a=t.title,i=t.titleAction,r=t.titleIcon,o=t.titleIconAriaLabel,c=t.customCssClasses,l=t.actions,p=void 0===l?[]:l,m=t.component,_=t.control,h=t.isDismissable,b=void 0===h||h,g=t.isSoftDismissable,v=void 0===g||g,y=t.isDismissableOnResize,S=void 0!==y&&y,D=t.isDismissableOnScroll,I=void 0!==D&&D,x=t.size,C=void 0===x?"Small":x,O=t.automationId,w=t.executeDefaultAction,E=void 0===w||w,A=t.isCallout,L=t.isOverlayHidden,k=void 0!==L&&L,M=t.overlayColor,P=void 0===M?"rgba(255,255,255,.4)":M,T=t.invokerEvent,U=t.calloutHeight,F=t.instrumentationId,H=void 0===F?"":F,R=t.shouldPreserveFocus,N=void 0===R||R,B=t.stayAsPopup,j=void 0!==B&&B,V=t.template,z=void 0===V?1:V,G=t.style,K=void 0===G?u.normal:G,W=t.focusOnPrimaryAction,q=void 0!==W&&W,Q=t.dismissOnEsc,Y=void 0!==Q&&Q;n.title=s.isObservable(a)?a:s.observable(a),n.titleAction=i,n.titleIcon=r,n.titleIconAriaLabel=o,n.customCssClasses=c,n.actions=p,n.component=m,n.control=_,n.isDismissable=b,n.isSoftDismissable=v,n.isDismissableOnResize=S,n.isDismissableOnScroll=I,n.size=C,n.automationId=O||"",n.executeDefaultAction=E,n.isCallout=!!A&&!!T,n.isOverlayHidden=k,n.overlayColor=P,n.invokerEvent=T,n.calloutHeight=U,n.instrumentationId=H,n.shouldPreserveFocus=s.isObservable(N)?N:s.observable(N),n.stayAsPopup=j,n.template=z,n.style=K,n.focusOnPrimaryAction=q,n.dismissOnEsc=Y,n.actions=n.actions.map(function(e){return s.utils.extend(new f,e)}),n.actionsVisible=n.createComputed(function(){for(var e=!1,t=0,a=n.actions;t<a.length;t++)a[t].isVisible()&&(e=!0);return e},{disposeWhen:function(){return 1!==n.state()}});var J=new d.e;return n.createComputed(function(){var e=n.state();1!==e&&(2===e?J.complete():J.cancel())}),n._promise=J.getPromise(),n.events.on(document,"keydown",n._keyDownEvent),n}return Object(i.a)(t,e),t.prototype.complete=function(){this.state(2)},t.prototype.dismiss=function(){this.state(3)},t.prototype.wait=function(){return this._promise},t.prototype._keyDownEvent=function(e){e.keyCode===l.e.escape&&this.dismissOnEsc&&this.state(3)},t}(r.e),m=n(4),_=n(246),h=new m.t({name:"NeedsOverlayContent.key",factory:{dependencies:{},create:function(){return{instance:{needsOverlayContent:new _.e(!1)}}}}}),b=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._dialogs=[],a.currentDialog=a.observables.create(),a._needsOverlayContent=n.needsOverlayContent,a}return Object(i.a)(t,e),t.prototype.requestDialog=function(e){this._needsOverlayContent.needsOverlayContent.set(!0);var t=this._dialogs;if(e.maxOneDialog&&t.length>0)return t[0];var n=this.currentDialog,a=new p(e);e.queueDialog?(t.push(a),1===t.length&&n(a)):(t.unshift(a),n(a));var i=function(){var e=t.indexOf(a);e>=0&&(t.splice(e,1),n(t[0])),a.dispose()};return a.wait().then(i,i),a},t.dependencies=Object(i.e)(Object(i.e)({},r.e.dependencies),{needsOverlayContent:h}),t}(r.e),g=Object(o.i)("DialogProvider",b)},function(e,t,n){"use strict";var a=n(0),i=function(e){function t(t){var n=e.call(this,t)||this;return n.text=t.text,n}return Object(a.a)(t,e),t}(n(158).e),r=n(159).e({tagName:"ms-text-container",template:'<div class="TextContainer" data-bind="text:text"></div>',viewModel:i});t.e=r},,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a=function(e,t){return{name:e,value:void 0===t?-1:t,delta:0,entries:[],id:"v2-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12)}},i=function(e,t){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){if("first-input"===e&&!("PerformanceEventTiming"in self))return;var n=new PerformanceObserver(function(e){return e.getEntries().map(t)});return n.observe({type:e,buffered:!0}),n}}catch(e){}},r=function(e,t){var n=function n(a){"pagehide"!==a.type&&"hidden"!==document.visibilityState||(e(a),t&&(removeEventListener("visibilitychange",n,!0),removeEventListener("pagehide",n,!0)))};addEventListener("visibilitychange",n,!0),addEventListener("pagehide",n,!0)},o=function(e){addEventListener("pageshow",function(t){t.persisted&&e(t)},!0)},s=function(e,t,n){var a;return function(i){t.value>=0&&(i||n)&&(t.delta=t.value-(a||0),(t.delta||void 0===a)&&(a=t.value,e(t)))}},c=-1,d=function(){return"hidden"===document.visibilityState?0:1/0},l=function(){r(function(e){var t=e.timeStamp;c=t},!0)},u=function(){return c<0&&(c=d(),l(),o(function(){setTimeout(function(){c=d(),l()},0)})),{get firstHiddenTime(){return c}}},f=function(e,t){var n,r=u(),c=a("FCP"),d=function(e){"first-contentful-paint"===e.name&&(f&&f.disconnect(),e.startTime<r.firstHiddenTime&&(c.value=e.startTime,c.entries.push(e),n(!0)))},l=window.performance&&performance.getEntriesByName&&performance.getEntriesByName("first-contentful-paint")[0],f=l?null:i("paint",d);(l||f)&&(n=s(e,c,t),l&&d(l),o(function(i){c=a("FCP"),n=s(e,c,t),requestAnimationFrame(function(){requestAnimationFrame(function(){c.value=performance.now()-i.timeStamp,n(!0)})})}))},p=!1,m=-1,_=function(e,t){p||(f(function(e){m=e.value}),p=!0);var n,c=function(t){m>-1&&e(t)},d=a("CLS",0),l=0,u=[],_=function(e){if(!e.hadRecentInput){var t=u[0],a=u[u.length-1];l&&e.startTime-a.startTime<1e3&&e.startTime-t.startTime<5e3?(l+=e.value,u.push(e)):(l=e.value,u=[e]),l>d.value&&(d.value=l,d.entries=u,n())}},h=i("layout-shift",_);h&&(n=s(c,d,t),r(function(){h.takeRecords().map(_),n(!0)}),o(function(){l=0,m=-1,d=a("CLS",0),n=s(c,d,t)}))};new Date},function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r});var a=n(1);function i(e){var t={};return Object(a.O)(e,function(e,n){t[e]=n,t[n]=e}),Object(a.r)(t)}function r(e){var t={};return Object(a.O)(e,function(e,n){t[e]=n[1],t[n[0]]=n[1]}),Object(a.r)(t)}},function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n(31),i=n(44),r=n(1),o=n(152),s=n(180),c=n(2),d=function e(){var t,n,d,l,u,f=this;function p(e){void 0===e&&(e=null);var t=e;if(!t){var a=n||Object(i.t)(null,{},f.core);t=d&&d.getPlugin?a.createNew(null,d.getPlugin):a.createNew(null,d)}return t}function m(e,t,a){e&&Object(r.M)(e,o.e,[],null,r.h),!a&&t&&(a=t.getProcessTelContext().getNext());var s=d;d&&d.getPlugin&&(s=d.getPlugin()),f.core=t,n=Object(i.t)(a,e,t,s)}function _(){t=!1,f.core=null,n=null,d=null,u=[],l=Object(s.e)()}_(),Object(a.e)(e,f,function(e){e.initialize=function(e,n,a,i){m(e,n,i),t=!0},e.teardown=function(t,n){var a=e.core;if(a&&(!t||a===t.core())){var o,s=!1,f=t||Object(i.n)(null,a,d&&d.getPlugin?d.getPlugin():d),p=n||{reason:0,isAsync:!1};return e[c.a]&&!0===e[c.a](f,p,m)?o=!0:m(),o}function m(){s||(s=!0,l.run(f,n),Object(r.e)(u,function(e){e.rm()}),u=[],!0===o&&f.processNext(p),_())}},e.update=function(t,n){var a=e.core;if(a&&(!t||a===t.core())){var r,o=!1,s=t||Object(i.a)(null,a,d&&d.getPlugin?d.getPlugin():d),c=n||{reason:0};return e._doUpdate&&!0===e._doUpdate(s,c,l)?r=!0:l(),r}function l(){o||(o=!0,m(s.getCfg(),s.core(),s.getNext()))}},e._addHook=function(e){e&&(Object(r.d)(e)?u=u.concat(e):u.push(e))},Object(r.L)(e,"_addUnloadCb",function(){return l},"add")}),f.diagLog=function(e){return p(e).diagLog()},f[c.c]=function(){return t},f.setInitialized=function(e){t=e},f[c.h]=function(e){d=e},f.processNext=function(e,t){t?t.processNext(e):d&&Object(r.p)(d.processTelemetry)&&d.processTelemetry(e,null)},f._getTelCtx=p}}].concat(Array(35),[function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RegisterUserActivity=void 0;var a=n(200),i=n(79),r=n(142),o=n(166),s=n(70),c=n(168),d=n(90),l=n(167),u=n(169),f=n(66);!function(e){var t="RegisterUserActivity";function n(e,n,a,i){void 0===i&&(i=!1);var d="processActivity "+a;s.LoggingUtils.log("Start processing a sign in/update activity.",t,d,f.Global.gAbtSkipAriaLog);var p=(new Date).toUTCString(),m={userId:e.toUpperCase(),timeout:n,activityDateTime:p,broadcastedActivityDateTime:void 0};o.ActivityUtils.updateUserLocalRecords(m),(a==r.AbtActions.signIn||i)&&l.RequestUtils.sendPostRequest(e,0,m.timeout,r.AbtActions.signIn,c.InFlightUtils.deleteItem,m),u.PromptUtils.startPromptChecks(e),s.LoggingUtils.log("Finish processing a sign in/update activity.",t,d,f.Global.gAbtSkipAriaLog)}e.update=function(e){void 0===e&&(e=!1);var a="update";s.LoggingUtils.log("Start registering an update activity.",t,a,f.Global.gAbtSkipAriaLog),f.Global.gIsAbtInitialized?(n(f.Global.gAbtUserId,f.Global.gAbtTimeout,r.AbtActions.update,e),o.ActivityUtils.startActivityChecks(f.Global.gAbtUserId),s.LoggingUtils.log("Finish registering an update activity.",t,a,f.Global.gAbtSkipAriaLog)):s.LoggingUtils.warn("Received update activity event but ABT is not initialized.",t,a)},e.signIn=function(){var e="SignIn";s.LoggingUtils.log("Start registering a sign in activity.",t,e,f.Global.gAbtSkipAriaLog),f.Global.gIsAbtInitialized?(n(f.Global.gAbtUserId,f.Global.gAbtTimeout,r.AbtActions.signIn,!0),o.ActivityUtils.startActivityChecks(f.Global.gAbtUserId),s.LoggingUtils.log("Finish registering a sign in activity.",t,e,f.Global.gAbtSkipAriaLog)):s.LoggingUtils.warn("Received sign in event even when ABT is not initialized.",t,e)},e.signOut=function(){var e="signOut";s.LoggingUtils.log("Start registering a sign out activity.",t,e,f.Global.gAbtSkipAriaLog),f.Global.gIsAbtInitialized?(function(){var e="processSignOut";s.LoggingUtils.log("Start processing a sign out activity.",t,e,f.Global.gAbtSkipAriaLog);var n=d.LocalStorageUtils.convertActivitiesToRecords(d.LocalStorageUtils.getItemValue(i.AbtStorageId.abtActivity)),o={records:new Array};if(null==n||null==n.records||void 0===n.records||n.records.length<=0)s.LoggingUtils.warn("Didn't get data from local activities item.",t,e),d.LocalStorageUtils.tryDeleteItem(i.AbtStorageId.inFlight)||s.LoggingUtils.error("Failed to delete in-flight item.",t,e);else for(var u=0,p=n.records;u<p.length;u++){var m=p[u];null!==m.userId&&void 0!==m.userId&&m.userId!==f.Global.gAbtUserId&&o.records.push(m)}o.records.length>0?d.LocalStorageUtils.tryCreateItem(i.AbtStorageId.abtActivity,JSON.stringify(o))||s.LoggingUtils.error("Failed to create item for activities.",t,e):d.LocalStorageUtils.tryDeleteItem(i.AbtStorageId.abtActivity)||s.LoggingUtils.error("Failed to delete item for activities.",t,e),c.InFlightUtils.isPresent()&&s.LoggingUtils.warn("In-flight item are still present even after waiting for "+a.AbtRegistration.timeToSleepInMsecs+" * "+a.AbtRegistration.maxAttempts+", override them",t,e),d.LocalStorageUtils.tryCreateItem(i.AbtStorageId.inFlight,i.AbtStorageValue.inFlight.toString())||s.LoggingUtils.warn("Failed to write in-Flight item.",t,e),l.RequestUtils.sendPostRequest(f.Global.gAbtUserId,0,f.Global.gAbtTimeout,r.AbtActions.signOut,c.InFlightUtils.deleteItem),s.LoggingUtils.log("Finish processing a sign out activity.",t,e,f.Global.gAbtSkipAriaLog)}(),s.LoggingUtils.log("Finish registering a sign out activity.",t,e,f.Global.gAbtSkipAriaLog)):s.LoggingUtils.warn("Received sign out event even when ABT is not initialized.",t,e)}}(t.RegisterUserActivity||(t.RegisterUserActivity={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbtPromptValue=void 0;var a=function(){function e(){}return e.minPromptWindow=1,e.maxPromptWindow=10,e.percentageTimeout=10,e}();t.AbtPromptValue=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbtInitOptions=void 0;var a=n(141),i=n(196),r=n(70),o=n(66),s=function(){function e(e){this.market=e.market,this.workloadName=e.workloadName,this.environment=e.environment,this.userId=e.userId,this.authType=e.authType,this.timeout=Math.floor(e.timeout/60),this.trackEvents=null==e.trackEvents||void 0===e.trackEvents||e.trackEvents,this.enableLogging=null==e.enableLogging||void 0===e.enableLogging||e.enableLogging,this.sessionId=null==e.sessionId||void 0===e.sessionId?"":e.sessionId,this.tenantId=null==e.tenantId||void 0===e.tenantId?"":e.tenantId,this.signInState=e.signInState,this.controls=e.controls}return e.prototype.isValidTokenClaims=function(){var t,n="isValidTokenClaims",a=!1;r.LoggingUtils.log("Starting validation of token values.",e.eventName,n,o.Global.gAbtSkipAriaLog);try{var i=this.signInState;if(Array.isArray(this.signInState)&&i.length>0&&"string"!=typeof i[0])return t="ABT did not receive 'signInState' information in expected format",r.LoggingUtils.error(t,e.eventName,n),{isPassed:!1,errorMessage:t}}catch(a){return t="ABT did not receive 'signInState' information in expected format",r.LoggingUtils.error(t,e.eventName,n),{isPassed:!1,errorMessage:t}}if(null!=this.signInState&&void 0!==this.signInState&&i.length>0)for(var s=0,c=i;s<c.length;s++){if("kmsi"==(f=c[s]))return t="User has opted for 'keep-me-signed-in'",r.LoggingUtils.error(t,e.eventName,n),{isPassed:!1,errorMessage:t};"dvc_cmp"!=f&&"dvc_dmjd"!=f||(a=!0)}try{var d=this.controls;if(Array.isArray(this.controls)&&d.length>0&&"string"!=typeof d[0])return t="ABT did not receive 'controls' information in expected format",r.LoggingUtils.error(t,e.eventName,n),{isPassed:!1,errorMessage:t}}catch(a){return t="ABT did not receive 'controls' information in expected format",r.LoggingUtils.error(t,e.eventName,n),{isPassed:!1,errorMessage:t}}if(null!=this.controls&&void 0!==this.controls&&d.length>0)for(var l=0,u=d;l<u.length;l++){var f;if("app_res"==(f=u[l])&&a)return t="User has opted for 'app enforced restrictions'",r.LoggingUtils.error(t,e.eventName,n),{isPassed:!1,errorMessage:t}}return r.LoggingUtils.log("Finishing validation of token values successfully.",e.eventName,n,o.Global.gAbtSkipAriaLog),{isPassed:!0,errorMessage:null}},e.prototype.isValid=function(){var t,n="isValid";return r.LoggingUtils.log("Starting validation of abt init options values.",e.eventName,n,o.Global.gAbtSkipAriaLog),null!=this.sessionId&&void 0!==this.sessionId&&""!==this.sessionId||(t="Null, undefined or empty SessionId.",r.LoggingUtils.warn(t,e.eventName,n)),null!=this.tenantId&&void 0!==this.tenantId&&""!==this.tenantId||(t="Null, undefined or empty TenantId.",r.LoggingUtils.warn(t,e.eventName,n)),null==this.market||void 0===this.market||""===this.market?(t="market is a required parameter. It cannot be null, undefined or empty.",r.LoggingUtils.error(t,e.eventName,n),{isPassed:!1,errorMessage:t}):null==this.workloadName||void 0===this.workloadName||""===this.workloadName?(t="workloadName is a required parameter. It cannot be null, undefined or empty.",r.LoggingUtils.error(t,e.eventName,n),{isPassed:!1,errorMessage:t}):null==this.environment||void 0===this.environment?(t="environment is a required parameter. It cannot be null or undefined.",r.LoggingUtils.error(t,e.eventName,n),{isPassed:!1,errorMessage:t}):this.isValidEnvironment(this.environment)?null==this.userId||void 0===this.userId||""===this.userId?(t="userId is a required parameter. It cannot be null, undefined or empty.",r.LoggingUtils.error(t,e.eventName,n),{isPassed:!1,errorMessage:t}):null==this.authType||void 0===this.authType?(t="authType is a required parameter. It cannot be null or undefined.",r.LoggingUtils.error(t,e.eventName,n),{isPassed:!1,errorMessage:t}):this.isValidAuthType(this.authType)?null==this.timeout||void 0===this.timeout||this.timeout<5||this.timeout>1440?(t="timeout is a required parameter. It cannot be null, undefined or either less than 5 minutes (300 seconds) or more than 24 hours (86400 seconds or 1440 minutes).",r.LoggingUtils.error(t,e.eventName,n),{isPassed:!1,errorMessage:t}):(r.LoggingUtils.log("Validation of base configuration options finished successfully.",e.eventName,n,o.Global.gAbtSkipAriaLog),{isPassed:!0,errorMessage:null}):(t="authType doesn't have allowed values from AuthType. Current value: "+this.authType,r.LoggingUtils.error(t,e.eventName,n),{isPassed:!1,errorMessage:t}):(t="environment doesn't have allowed values from Environment. Current value: "+this.environment,r.LoggingUtils.error(t,e.eventName,n),{isPassed:!1,errorMessage:t})},e.prototype.isValidEnvironment=function(e){return a.Environment[e]===a.Environment[a.Environment.Pathfinder]||a.Environment[e]===a.Environment[a.Environment.Trailblazer]||a.Environment[e]===a.Environment[a.Environment.WorldWide]},e.prototype.isValidAuthType=function(e){return i.AuthType[e]===i.AuthType[i.AuthType.Aad]||i.AuthType[e]===i.AuthType[i.AuthType.Msa]},e.eventName="AbtInitOptions",e}();t.AbtInitOptions=s},function(e,t,n){var a,i,r;!function(o){"use strict";function s(e,t,n,a,i,r,o){this.inputItem=t,this.stateArrayIndex=n,this.mappingOptions=i,this.arrayOfState=r,this.outputObservableArray=o,this.outputArray=this.outputObservableArray.peek(),this.isIncluded=null,this.suppressNotification=!1,this.outputArrayIndex=e.observable(a),this.disposeFuncFromMostRecentMapping=null,this.mappedValueComputed=e.computed(this.mappingEvaluator,this),this.mappedValueComputed.subscribe(this.onMappingResultChanged,this),this.previousMappedValue=this.mappedValueComputed.peek()}function c(e,t){if(!e)return null;switch(e.status){case"added":return e.index;case"deleted":return e.index+t;default:throw new Error("Unknown diff status: "+e.status)}}function d(e,t,n,a,i,r,o,c,d){var l="number"==typeof t.moved,u=l?n[t.moved]:new s(e,t.value,a,i,r,o,c);return o.splice(a,0,u),u.isIncluded&&d.splice(i,0,u.mappedValueComputed.peek()),l&&(u.stateArrayIndex=a,u.setOutputArrayIndexSilently(i)),u}function l(e,t,n,a,i){var r=t.splice(n,1)[0];r.isIncluded&&i.splice(a,1),"number"!=typeof e.moved&&r.dispose()}function u(e,t,n){return e.stateArrayIndex=t,e.setOutputArrayIndexSilently(n),n+(e.isIncluded?1:0)}function f(e,t,n,a,i,r){return t.subscribe(function(t){if(t.length){for(var o=function(e,t){for(var n={},a=0;a<e.length;a++){var i=e[a];"added"===i.status&&"number"==typeof i.moved&&(n[i.moved]=t[i.moved])}return n}(t,n),s=0,f=t[0],p=0,m=f&&function(e,t,n){return n.length&&t[e.index]?t[e.index].outputArrayIndex.peek():n.length}(f,n,a),_=f.index;f||_<n.length;_++)if(c(f,p)===_){switch(f.status){case"added":d(e,f,o,_,m,r,n,i,a).isIncluded&&m++,p++;break;case"deleted":l(f,n,_,m,a),p--,_--;break;default:throw new Error("Unknown diff status: "+f.status)}f=t[++s]}else _<n.length&&(m=u(n[_],_,m));i.valueHasMutated()}},null,"arrayChange")}function p(e,t){var n=[],a=[],i=e.observableArray(a),r=this.peek();if("function"==typeof t&&(t={mapping:t}),t.mappingWithDisposeCallback){if(t.mapping||t.disposeItem)throw new Error("'mappingWithDisposeCallback' cannot be used in conjunction with 'mapping' or 'disposeItem'.")}else if(!t.mapping)throw new Error("Specify either 'mapping' or 'mappingWithDisposeCallback'.");for(var o=0;o<r.length;o++){var c=r[o],d=new s(e,c,o,a.length,t,n,i),l=d.mappedValueComputed.peek();n.push(d),d.isIncluded&&a.push(l)}var u=f(e,this,n,a,i,t),p=e.computed(i).extend({trackArrayChanges:!0}),m=p.dispose;return p.dispose=function(){u.dispose(),e.utils.arrayForEach(n,function(e){e.dispose()}),m.call(this,arguments)},_(e,p),p}function m(e,t){return p.call(this,e,function(e){return t(e)?e:b})}function _(e,t){return e.utils.extend(t,e[g]),t}function h(e){e.projections={_exclusionMarker:b},function(e){function t(e,t){return function(){return t.apply(this,[e].concat(Array.prototype.slice.call(arguments,0)))}}e[g]={map:t(e,p),filter:t(e,m)}}(e),_(e,e.observableArray.fn)}var b={};s.prototype.dispose=function(){this.mappedValueComputed.dispose(),this.disposeResultFromMostRecentEvaluation()},s.prototype.disposeResultFromMostRecentEvaluation=function(){if(this.disposeFuncFromMostRecentMapping&&(this.disposeFuncFromMostRecentMapping(),this.disposeFuncFromMostRecentMapping=null),this.mappingOptions.disposeItem){var e=this.mappedValueComputed();this.mappingOptions.disposeItem(e)}},s.prototype.mappingEvaluator=function(){var e;if(null!==this.isIncluded&&this.disposeResultFromMostRecentEvaluation(),this.mappingOptions.mapping)e=this.mappingOptions.mapping(this.inputItem,this.outputArrayIndex);else{if(!this.mappingOptions.mappingWithDisposeCallback)throw new Error("No mapping callback given.");var t=this.mappingOptions.mappingWithDisposeCallback(this.inputItem,this.outputArrayIndex);if(!("mappedValue"in t))throw new Error("Return value from mappingWithDisposeCallback should have a 'mappedItem' property.");e=t.mappedValue,this.disposeFuncFromMostRecentMapping=t.dispose}var n=e!==b;return this.isIncluded!==n&&(null!==this.isIncluded&&this.moveSubsequentItemsBecauseInclusionStateChanged(n),this.isIncluded=n),e},s.prototype.onMappingResultChanged=function(e){e!==this.previousMappedValue&&(this.isIncluded&&this.outputArray.splice(this.outputArrayIndex.peek(),1,e),this.suppressNotification||this.outputObservableArray.valueHasMutated(),this.previousMappedValue=e)},s.prototype.moveSubsequentItemsBecauseInclusionStateChanged=function(e){var t,n,a=this.outputArrayIndex.peek();if(e)for(this.outputArray.splice(a,0,null),t=this.stateArrayIndex+1;t<this.arrayOfState.length;t++)(n=this.arrayOfState[t]).setOutputArrayIndexSilently(n.outputArrayIndex.peek()+1);else for(this.outputArray.splice(a,1),t=this.stateArrayIndex+1;t<this.arrayOfState.length;t++)(n=this.arrayOfState[t]).setOutputArrayIndexSilently(n.outputArrayIndex.peek()-1)},s.prototype.setOutputArrayIndexSilently=function(e){this.suppressNotification=!0,this.outputArrayIndex(e),this.suppressNotification=!1};var g="_ko.projections.cache";!function(){if(void 0!==e.exports){var o=n(14);h(o),e.exports=o}else i=[n(14)],void 0===(r="function"==typeof(a=h)?a.apply(t,i):a)||(e.exports=r)}()}()},,,function(e,t,n){"use strict";e.exports=n(313)},function(e,t,n){"use strict";var a,i,r,o;if("object"==typeof performance&&"function"==typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var c=Date,d=c.now();t.unstable_now=function(){return c.now()-d}}if("undefined"==typeof window||"function"!=typeof MessageChannel){var l=null,u=null,f=function(){if(null!==l)try{var e=t.unstable_now();l(!0,e),l=null}catch(e){throw setTimeout(f,0),e}};a=function(e){null!==l?setTimeout(a,0,e):(l=e,setTimeout(f,0))},i=function(e,t){u=setTimeout(e,t)},r=function(){clearTimeout(u)},t.unstable_shouldYield=function(){return!1},o=t.unstable_forceFrameRate=function(){}}else{var p=window.setTimeout,m=window.clearTimeout;if("undefined"!=typeof console){var _=window.cancelAnimationFrame;"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!=typeof _&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var h=!1,b=null,g=-1,v=5,y=0;t.unstable_shouldYield=function(){return t.unstable_now()>=y},o=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):v=0<e?Math.floor(1e3/e):5};var S=new MessageChannel,D=S.port2;S.port1.onmessage=function(){if(null!==b){var e=t.unstable_now();y=e+v;try{b(!0,e)?D.postMessage(null):(h=!1,b=null)}catch(e){throw D.postMessage(null),e}}else h=!1},a=function(e){b=e,h||(h=!0,D.postMessage(null))},i=function(e,n){g=p(function(){e(t.unstable_now())},n)},r=function(){m(g),g=-1}}function I(e,t){var n=e.length;e.push(t);e:for(;;){var a=n-1>>>1,i=e[a];if(!(void 0!==i&&0<O(i,t)))break e;e[a]=t,e[n]=i,n=a}}function x(e){return void 0===(e=e[0])?null:e}function C(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var a=0,i=e.length;a<i;){var r=2*(a+1)-1,o=e[r],s=r+1,c=e[s];if(void 0!==o&&0>O(o,n))void 0!==c&&0>O(c,o)?(e[a]=c,e[s]=n,a=s):(e[a]=o,e[r]=n,a=r);else{if(!(void 0!==c&&0>O(c,n)))break e;e[a]=c,e[s]=n,a=s}}}return t}return null}function O(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var w=[],E=[],A=1,L=null,k=3,M=!1,P=!1,T=!1;function U(e){for(var t=x(E);null!==t;){if(null===t.callback)C(E);else{if(!(t.startTime<=e))break;C(E),t.sortIndex=t.expirationTime,I(w,t)}t=x(E)}}function F(e){if(T=!1,U(e),!P)if(null!==x(w))P=!0,a(H);else{var t=x(E);null!==t&&i(F,t.startTime-e)}}function H(e,n){P=!1,T&&(T=!1,r()),M=!0;var a=k;try{for(U(n),L=x(w);null!==L&&(!(L.expirationTime>n)||e&&!t.unstable_shouldYield());){var o=L.callback;if("function"==typeof o){L.callback=null,k=L.priorityLevel;var s=o(L.expirationTime<=n);n=t.unstable_now(),"function"==typeof s?L.callback=s:L===x(w)&&C(w),U(n)}else C(w);L=x(w)}if(null!==L)var c=!0;else{var d=x(E);null!==d&&i(F,d.startTime-n),c=!1}return c}finally{L=null,k=a,M=!1}}var R=o;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){P||M||(P=!0,a(H))},t.unstable_getCurrentPriorityLevel=function(){return k},t.unstable_getFirstCallbackNode=function(){return x(w)},t.unstable_next=function(e){switch(k){case 1:case 2:case 3:var t=3;break;default:t=k}var n=k;k=t;try{return e()}finally{k=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=R,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=k;k=e;try{return t()}finally{k=n}},t.unstable_scheduleCallback=function(e,n,o){var s=t.unstable_now();switch(o="object"==typeof o&&null!==o&&"number"==typeof(o=o.delay)&&0<o?s+o:s,e){case 1:var c=-1;break;case 2:c=250;break;case 5:c=1073741823;break;case 4:c=1e4;break;default:c=5e3}return e={id:A++,callback:n,priorityLevel:e,startTime:o,expirationTime:c=o+c,sortIndex:-1},o>s?(e.sortIndex=o,I(E,e),null===x(w)&&e===x(E)&&(T?r():T=!0,i(F,o-s))):(e.sortIndex=c,I(w,e),P||M||(P=!0,a(H))),e},t.unstable_wrapCallback=function(e){var t=k;return function(){var n=k;k=t;try{return e.apply(this,arguments)}finally{k=n}}}},function(e,t,n){"use strict";n.r(t);var a,i=n(0),r=n(49);!function(e){e.Excel="Excel",e.OneNote="OneNote",e.PowerPoint="PowerPoint",e.Visio="Visio",e.Word="Word"}(a||(a={}));var o=["id","openWith","officebundle","currentUserRole","eTag","name","size","content.downloadUrl","file","sharepointIds","sensitivityLabel","webUrl","webDavUrl","parentReference"],s=n(57),c=n.n(s),d=n(12),l=n(23),u=n(41),f=n(275),p=n(30),m=n(100),_=n(131),h=n(52),b=n(15),g=n(174);function v(e){if(e){var t=new Date(Date.now()+6048e5);s.set("BadgerAuth",e,{secure:!0,expires:t.toUTCString(),domain:g.e.getCookieDomain()})}}var y=new(function(){function e(){}return e.prototype.getItem=function(e,t){try{var n=null,a=window.opener;return a&&"onedrive.live.com"===a.location.host&&a.WacItemConfig&&"2cd39a29-83d8-4bf9-8ae7-33cdaeb38be8"===a.WacItemConfig.UniqueId&&(n=a.WacItemConfig.getWacItem(e,t)),_.t.resolve(n)}catch(e){return _.t.resolve(null)}},e}());function S(){return"".concat("$select="+o.join(","))}var D,I=function(){function e(e,t,n){this._apiUrlBase=e,this._identityDataSource=t,this._badgerToken=n}return e.prototype.getItem=function(e,t,n,a,r,o){return void 0===r&&(r=!0),void 0===o&&(o=!1),Object(i.t)(this,void 0,_.t,function(){var s,c,d,l=this;return Object(i.i)(this,function(u){switch(u.label){case 0:return s=new b.e({name:"WacOwl.OpenWith",startTimeOverride:Date.now()}),o?[4,this.getItemFromCache(e,t)]:[3,2];case 1:if(c=u.sent())return this.logGetItemQos(s,t,b.t.Success,"Success",{},void 0),[2,_.t.resolve(c)];u.label=2;case 2:return d=a?"/drives/"+encodeURIComponent(e)+"/items/root:/".concat(a):"/drives/"+encodeURIComponent(e)+"/items/".concat(t),d+="?action=".concat(n,"&").concat(S()),[2,this.request(d,"GET",r).then(function(e){var n=e[0],a=e[1];return l.logGetItemQos(s,t,b.t.Success,"Success",{},a),n},function(e){var n=e[0],r=e[1];throw l.logGetItemQos(s,t,b.t.Failure,(null==n?void 0:n.code)||"GetItem OpenWith Failed",n,r),Object(h.e)("Error: cannot get item info from vroom call: ",n),Object(i.e)(Object(i.e)({},n),{itemId:t,httpStatus:r.status,httpStatusText:r.statusText,usesRelativePath:!!a})})]}})})},e.prototype.redeemAndGetItem=function(e,t,n,a){return void 0===n&&(n=!1),void 0===a&&(a=!1),Object(i.t)(this,void 0,void 0,function(){var r,o,s,c,d,l,f,p=this;return Object(i.i)(this,function(i){switch(i.label){case 0:return r=new b.e({name:"WacOwl.Shares.Redeem",startTimeOverride:Date.now()}),o="".concat(Object(u.e)(),"/shares/u!").concat(e),s=o,n&&(s+="/driveItem?action=".concat(t,"&").concat(S())),d=fetch,l=[s],f={method:"POST"},[4,this.createHeaders(!1,!0)];case 1:return[4,d.apply(void 0,l.concat([(f.headers=i.sent(),f)]))];case 2:return[2,(c=i.sent()).json().then(function(t){var n,i;return t&&t.error?(p.logRedeemAndGetItemQos(r,e,b.t.Failure,(null===(n=t.error)||void 0===n?void 0:n.code)||"Failure","Redeem call failed: ".concat(JSON.stringify(t.error)),c),Promise.resolve(t)):t&&t.id&&t.openWith?(p.logRedeemAndGetItemQos(r,e,b.t.Success,"Success",{},c),a&&v(null===(i=p._badgerToken)||void 0===i?void 0:i.token),Promise.resolve(t)):(p.logRedeemAndGetItemQos(r,e,b.t.Failure,"Failure","Redeem called failed to return valid data",c),Promise.resolve(null))})]}})})},e.prototype.fetchItemFromNetwork=function(e,t,n){return e.shareUrl?this.getWopiInfoWithUrl(e.shareUrl,t,n):e.driveId&&e.docId?this.getWopiInfoWithDriveIdItemId(e.driveId,e.docId,t,n):e.docUrl?this.getWopiInfoWithUrl(e.docUrl,t,n):Promise.reject("No available bootDocumentInfo can be used")},e.prototype.getWopiInfoWithDriveIdItemId=function(e,t,n,a){var i="/drives/".concat(e,"/items/").concat(t,"?action=").concat(a,"&").concat(S());return this.request(i,"GET",n).then(function(e){var t=e[0];return t.openWith&&t.openWith.wac?t:_.t.reject({item:t,error:{Id:"MissingProperty",Details:"No wac property was found in the response"}})},function(e){var t,n=e[0],a=(null===(t=e[1].status)||void 0===t?void 0:t.toString())||"Unknown",i=JSON.stringify({error:n});return _.t.reject({error:{Id:a,Details:i}})})},e.prototype.getWopiInfoWithUrl=function(e,t,n){var a="/shares/".concat(this.encodeUrl(e),"/driveItem?action=").concat(n,"&").concat(S());return this.request(a,"GET",t).then(function(e){var t=e[0];return t.openWith&&t.openWith.wac?t:_.t.reject({item:t,error:{Id:"MissingProperty",Details:"No wac property was found in the response"}})},function(e){var t,n=e[0],a=(null===(t=e[1].status)||void 0===t?void 0:t.toString())||"Unknown",i=JSON.stringify({error:n});return _.t.reject({error:{Id:a,Details:i}})})},e.prototype.request=function(e,t,n,a){var r=this;return void 0===t&&(t="POST"),void 0===a&&(a=!1),this.createHeaders(n,a).then(function(n){return new _.t(function(a,o){return Object(i.t)(r,void 0,void 0,function(){var r,s;return Object(i.i)(this,function(i){switch(i.label){case 0:return[4,fetch("".concat(this._apiUrlBase).concat(e),{method:t,headers:n})];case 1:return[4,(r=i.sent()).json()];case 2:return s=i.sent(),r.ok?a([s,r]):o([null==s?void 0:s.error,r]),[2]}})})})})},e.prototype.createHeaders=function(e,t){void 0===t&&(t=!1);var n={Accept:"application/json"};return e&&(n.Prefer="Include-Feature=Vault"),t&&(n.Prefer=n.Prefer?n.Prefer+",autoredeem":"autoredeem"),this._badgerToken?(n.Authorization="Badger ".concat(this._badgerToken.token),_.t.resolve(n)):this._identityDataSource.getSessionToken().then(function(e){return n.Authorization="Bearer ".concat(e.accessToken),n})},e.prototype.logGetItemQos=function(e,t,n,a,i,r){var o,s;try{e.end({resultType:n,resultCode:a,error:JSON.stringify(i),extraData:{itemId:t,SPRequestGuid:null===(o=null==r?void 0:r.headers)||void 0===o?void 0:o.get("SPRequestGuid"),requestid:null===(s=null==r?void 0:r.headers)||void 0===s?void 0:s.get("request-id")}})}catch(i){Object(h.e)("Error: cannot log qos event: ",i)}},e.prototype.logRedeemAndGetItemQos=function(e,t,n,a,i,r){var o,s;try{e.end({resultType:n,resultCode:a,error:"string"==typeof i?i:JSON.stringify(i),extraData:{redeem:t,SPRequestGuid:null===(o=null==r?void 0:r.headers)||void 0===o?void 0:o.get("SPRequestGuid"),requestid:null===(s=null==r?void 0:r.headers)||void 0===s?void 0:s.get("request-id")}})}catch(i){Object(h.e)("Error: cannot log qos event: ",i)}},e.prototype.encodeUrl=function(e){return"u!".concat(window.btoa(unescape(encodeURIComponent(e))).replace(/=/g,"").replace(/[+]/g,"-").replace(/\//g,"_"))},e.prototype.getItemFromCache=function(e,t){var n=new b.e({name:"WacOwl.Item.Cache",startTimeOverride:Date.now()});return y.getItem(e,t).then(function(e){return e?(n.end({resultType:b.t.Success,resultCode:"Success",error:""}),e):null}).catch(function(e){return n.end({resultType:b.t.Failure,resultCode:"Failure",error:JSON.stringify(e)}),null})},e}(),x=n(4),C=n(56),O=n(205),w=n(21),E=n(24);!function(e){e[e.JSApiBootNotStart=0]="JSApiBootNotStart",e[e.JSApiBootStarted=1]="JSApiBootStarted",e[e.JSApiBootPendingComplete=2]="JSApiBootPendingComplete",e[e.JSApiBootSuccess=3]="JSApiBootSuccess",e[e.JSApiBootFailed=4]="JSApiBootFailed"}(D||(D={}));var A,L,k,M,P="Unknown",T=function(){function e(e,t,n){void 0===e&&(e=P),void 0===n&&(n=D.JSApiBootNotStart),this.reset(e,t,n)}return e.prototype.update=function(e){if(this.data&&e)for(var t in e)this.data[t]=e[t]},e.prototype.reset=function(e,t,n){void 0===e&&(e=P),void 0===n&&(n=D.JSApiBootNotStart),this.data={bootState:n,entryPoint:e,userClickTime:t}},e}(),U=n(228),F=n(331),H=n(267),R=n(129),N=n(283),B=n(43),j=function(){function e(e,t,n){this._apiUrlBase=e,this._identityDataSource=t,this._badgerToken=n}return e.prototype.getItem=function(e,t,n,a,r,o){return void 0===r&&(r=!0),void 0===o&&(o=!1),Object(i.t)(this,void 0,_.t,function(){var s,c,d=this;return Object(i.i)(this,function(i){switch(i.label){case 0:return o?[4,this._getItemFromCache(e,t)]:[3,2];case 1:if(s=i.sent())return[2,_.t.resolve(s)];i.label=2;case 2:return c=a?"/drives/"+encodeURIComponent(e)+"/items/root:/".concat(a):"/drives/"+encodeURIComponent(e)+"/items/".concat(t),c+="?".concat(this._getItemParams(n)),[2,this.request(c,"GET",r).then(function(e){var t=e[0];return d.buildOneDriveItemFromResponse(t)},function(e){var t=e[0];return Object(h.e)("Error: cannot get item info from vroom call: ",t),null})]}})})},e.prototype.redeemAndGetItem=function(e,t,n,a){return void 0===n&&(n=!1),void 0===a&&(a=!1),Object(i.t)(this,void 0,void 0,function(){var r,o,s,c,d,l,f=this;return Object(i.i)(this,function(i){switch(i.label){case 0:return r=new b.e({name:"Wac.Shares.Redeem",startTimeOverride:Date.now()}),o="".concat(Object(u.e)(),"/shares/u!").concat(e),s=o,n&&(s+="/driveItem?".concat(this._getItemParams(t))),c=fetch,d=[s],l={method:"POST"},[4,this._createHeaders(!1,!0)];case 1:return[4,c.apply(void 0,d.concat([(l.headers=i.sent(),l)]))];case 2:return[2,i.sent().json().then(function(e){var t;return r.end({resultType:b.t.Success,resultCode:"Success",error:""}),e&&e.error?Promise.resolve(e):e&&e.id&&e.openWith?(a&&v(null===(t=f._badgerToken)||void 0===t?void 0:t.token),Promise.resolve(f.buildOneDriveItemFromResponse(e))):Promise.resolve(null)})]}})})},e.prototype.getWopiInfoWithItemId=function(e,t){var n="/items/".concat(e,"/driveItem?$select=openWith");return this.request(n,"GET",t).then(function(e){var t=e[0],n=t.openWith,a=t.webDavUrl,i=t.id,r=t.parentReference;return n&&n.wac?{driveId:r.driveId,itemId:i,webDavUrl:a,accessToken:n.wac.accessToken,accessTokenExpiry:n.wac.accessTokenExpiry,wopiSrc:n.wac.wopiSrc}:_.t.reject({driveId:null==r?void 0:r.driveId,itemId:i,error:{Id:"MissingProperty",Details:"No wac property was found in the response"}})},function(e){var t,n=e[0],a=(null===(t=e[1].status)||void 0===t?void 0:t.toString())||"Unknown",i=JSON.stringify({error:n});return _.t.reject({error:{Id:a,Details:i}})})},e.prototype.getWopiInfoWithUrl=function(e,t){var n="/shares/".concat(e,"/driveItem?$select=openWith,parentReference,id");return this.request(n,"GET",t).then(function(e){var t=e[0],n=t.openWith,a=t.webDavUrl,i=t.id,r=t.parentReference;return n&&n.wac?{driveId:r.driveId,itemId:i,webDavUrl:a,accessToken:n.wac.accessToken,accessTokenExpiry:n.wac.accessTokenExpiry,wopiSrc:n.wac.wopiSrc}:_.t.reject({driveId:null==r?void 0:r.driveId,itemId:i,webDavUrl:a,error:{Id:"MissingProperty",Details:"No wac property was found in the response"}})},function(e){var t,n=e[0],a=(null===(t=e[1].status)||void 0===t?void 0:t.toString())||"Unknown",i=JSON.stringify({error:n});return _.t.reject({error:{Id:a,Details:i}})})},e.prototype.getWopiDavURLWithDriveIdItemId=function(e,t,n){var a="/drives/".concat(e,"/items/").concat(t,"?$select=openWith,webDavUrl");return this.request(a,"GET",n).then(function(n){var a=n[0],i=a.openWith,r=a.webDavUrl;return i&&i.wac?{driveId:e,itemId:t,webDavUrl:r,accessToken:i.wac.accessToken,accessTokenExpiry:i.wac.accessTokenExpiry,wopiSrc:i.wac.wopiSrc}:_.t.reject({driveId:e,itemId:t,webDavUrl:r,error:{Id:"MissingProperty",Details:"No wac property was found in the response"}})},function(e){var t,n=e[0],a=(null===(t=e[1].status)||void 0===t?void 0:t.toString())||"Unknown",i=JSON.stringify({error:n});return _.t.reject({error:{Id:a,Details:i}})})},e.prototype.request=function(e,t,n,a){var r=this;return void 0===t&&(t="POST"),void 0===n&&(n=!1),void 0===a&&(a=!1),this._createHeaders(n,a).then(function(n){return new _.t(function(a,o){return Object(i.t)(r,void 0,void 0,function(){var r,s;return Object(i.i)(this,function(i){switch(i.label){case 0:return[4,fetch("".concat(this._apiUrlBase).concat(e),{method:t,headers:n})];case 1:return[4,(r=i.sent()).json()];case 2:return s=i.sent(),r.ok?a([s,r]):o([null==s?void 0:s.error,r]),[2]}})})})})},e.prototype.buildOneDriveItemFromResponse=function(e){var t,n;if(!e)return Object(h.e)("Error: the item info is null"),null;var a=e.id,i=e.name,r=e.folder,o=e.thumbnails,s=e.size,c=e.description,d=e.root,l=e.eTag,u=e.parentReference,f=u&&u.driveId,p={key:Object(B.e)((t={},t.id=a,t.driveId=f,t))},m=u.id?Object(B.e)(((n={}).id=u.id,n.driveId=f,n)):void 0;p.parentKey=m,p.sharingRole=this._getSharingRole(e);var _=(r?{extension:""}:F.t(i)).extension;p.id=a,p.itemId=a;var b=u&&u.driveType;p.graph={itemId:a,driveId:f,driveType:b};var g=d?H.e:i;if(p.name=i,p.displayName=g,p.extension=_,p.size=s,p.caption=c||"",p.ownerId=f,p.isRootFolder=!!d,p.eTag=l,r){var v=r.childCount;if(p.folder={childCount:v},o&&o.length>0){p.folder.covers=[];for(var y=0,S=o;y<S.length;y++){var D=S[y];p.folder.covers.push(D.large)}}p.childCount=v}return p.vault=e.vault,p.itemFromServer=e,p},e.prototype._createHeaders=function(e,t){void 0===t&&(t=!1);var n={Accept:"application/json"};return e&&(n.Prefer="Include-Feature=Vault"),t&&(n.Prefer=n.Prefer?n.Prefer+",autoredeem":"autoredeem"),this._badgerToken?(n.Authorization="Badger ".concat(this._badgerToken.token),_.t.resolve(n)):this._identityDataSource.getSessionToken().then(function(e){return n.Authorization="Bearer ".concat(e.accessToken),n})},e.prototype._getSharingRole=function(e){var t=e.shared;if(t&&t.effectiveRoles&&t.owner){var n=t.effectiveRoles,a=Object(N.e)(n||[],function(){return!0});return a.owner?R.e.Owner:a.write?R.e.Edit:a.read?R.e.View:R.e.None}return R.e.Owner},e.prototype._getItemFromCache=function(e,t){var n=this,a=new b.e({name:"Wac.Item.Cache",startTimeOverride:Date.now()});return y.getItem(e,t).then(function(e){return e?(a.end({resultType:b.t.Success,resultCode:"Success",error:""}),n.buildOneDriveItemFromResponse(e)):null}).catch(function(e){return null})},e.prototype._getItemParams=function(e){return"action=".concat(e,"&$select=*,openWith,webDavUrl,sharepointIds")},e}(),V=n(38),z=n(36),G=n(188);function K(e,t,n,a,i){void 0===a&&(a=A.none);var r=e+"="+t,o="",s=new Date;s.setTime(s.getTime()+31536e6);var c=new Date;c.setTime(c.getTime()+864e5*n),c>s&&(c=s),c&&(o=";expires="+c.toUTCString());var d=r+o+";SameSite="+A[a];return document.cookie=i?d+"; Secure":d,!(!document.cookie||-1===document.cookie.indexOf(r))||a===A.none&&K(e,t,n,A.doNotSet,i)}function W(e){window.performance&&window.performance.mark&&(Array.isArray(e)?e.forEach(function(e){window.performance.mark(e)}):window.performance.mark(e))}function q(){var e,t,n;return(null===(t=null===(e=window.performance)||void 0===e?void 0:e.now)||void 0===t?void 0:t.call(e))+(null===(n=window.performance)||void 0===n?void 0:n.timeOrigin)||Date.now()}(L=A||(A={}))[L.doNotSet=0]="doNotSet",L[L.none=1]="none",L[L.lax=2]="lax",L[L.strict=3]="strict",(M=k||(k={})).Excel="Excel",M.None="None",M.OneNote="OneNote",M.PowerPoint="PowerPoint",M.Visio="Visio",M.Word="Word";const Q={FASTFOOD:"wise-m.sdf.cdn.office.net",MSIT:"wise-m.public.cdn.office.net",PRODUCTION:"wise-m.public.cdn.office.net",GALLATIN:"wise-m.cdn.partner.office365.cn",PATHFINDER:"wise-m.dod.cdn.office.net",USGOV:"wise-m.gcc.cdn.office.net",TRAILBLAZER:"wise-m.gcch.cdn.office.net",AIRGAP08:"res-1-cdn.azureedge.eaglex.ic.gov",AIRGAP09:"res-1-cdn.azureedge.microsoft.scloud"};function Y(e,t){const n=null!=t?t:function(e,t){const n=Math.ceil(1),a=Math.floor(100);return Math.floor(function(){const e=new Uint32Array(1);return window.crypto.getRandomValues(e),e[0]/4294967296}()*(a-n+1))+n}();return e.sort((e,t)=>e-t).find(e=>n<=e)||100}async function J(e,t,n,a,i){var r,o;if(!(e in Q))throw new Error(`Unknown environment ${e}`);let s=function(e,t){switch(e){case"AIRGAP08":case"AIRGAP09":return Y([100],t);case"MSIT":case"FASTFOOD":case"GALLATIN":case"PATHFINDER":case"USGOV":case"TRAILBLAZER":return Y([10,100],t);case"PRODUCTION":return Y([1,10,50,100],t)}}(e,n);const c=t.toLowerCase();let d;if(a){const t=function(e){var t,n,a;const i=null===(t=new RegExp("^(build:(?<buildid>\\d+)(:(?<buildflavor>ship|debug))?|pr:(?<prid>\\d+)(:(?<prflavor>ship|debug))?|localhost:(?<localhostport>\\d+)|environment:(?<environment>[A-Za-z]+?):exposure:(?<exposure>\\d+))$","g").exec(e))||void 0===t?void 0:t.groups;if(!i)return{sideLoadingSubpath:void 0,environment:void 0,exposure:void 0};const r=i.buildid,o=i.buildflavor,s=i.prid,c=i.prflavor,d=i.localhostport,l=null!==(a=o||c)&&void 0!==a?a:"debug";let u;return d?u="localhost:"+d:r?u=`build/${r}/wise/${l}`:s&&(u=`pr/${s}/wise/${l}`),{sideLoadingSubpath:u,environment:null===(n=i.environment)||void 0===n?void 0:n.toUpperCase(),exposure:i.exposure?parseInt(i.exposure,10):void 0}}(a);e=null!==(r=t.environment)&&void 0!==r?r:e,s=null!==(o=t.exposure)&&void 0!==o?o:s,d=t.sideLoadingSubpath}!function(e){let t=document.createElement("link");t.rel="preconnect",t.href=`https://${e}`,t.crossOrigin="anonymous",document.head.appendChild(t),t=document.createElement("link"),t.rel="dns-prefetch",t.href=`https://${e}`,document.head.appendChild(t)}(function(e){return Q[e].replace(/^wise-m\./,"wise.")}(e));const l=function(e,t,n,a){const i=Q[e];return a?(null==a?void 0:a.includes("localhost"))?`https://${a}/manifest/manifest.js`:`https://res-2-dev.cdn.officeppe.net/1js/${a}/manifest.js`:`https://${i}/wise-m/${n}/5mttl/${e.toLocaleLowerCase("en-US")}/${t}/manifest.js`}(e,s,c,d);return await function(e,t){return new Promise((n,a)=>{const i=document.createElement("script");i.src=e,i.crossOrigin="anonymous";const r=t?"low":"high";i.setAttribute("fetchpriority",r),i.onload=()=>n(),i.onerror=()=>a(new Error(`${e} failed to load`)),document.documentElement.appendChild(i)})}(l,i),{exposure:s,manifest:window[`${c}ManifestFactory`](e,d),environment:e}}const X="owlOrigin",Z="jsApiOrigin";let $,ee,te,ne,ae,ie,re,oe;async function se(e,t,n,a,i){const r=le("overrideManifestOrigin"),o=n&&i;let s=new Map,c=new Map;if(a&&([s,c]=function(e){const t=le(X),n=t.length>0?t.split("&"):[],a=le(Z+e),i=a.length>0?a.split("&"):[],r=new Map;for(let e=0;e<n.length;e++)r.set(n[e].split("=")[0],n[e].split("=")[1]);const o=new Map;for(let e=0;e<i.length;e++)o.set(i[e].split("=")[0],i[e].split("=")[1]);return K(X,"",-1,void 0,!0),K(Z+e,"",-1,void 0,!0),[r,o]}(n)),a&&s.size>0)te=q(),W("loadOWLStartTime"),await ue(o?`owl.${n.toLowerCase()}.js`:"owl.js",s.get("URL"),s.get("SRI"),!1,!1),ne=q(),W("loadOWLEndTime"),ie=String(s.get("VERSION")),re=Number(s.get("EXPOSER")),oe=s.get("ENV"),ae=de(void 0,n,c.get("URL"),c.get("SRI"),o),J(e,"owl",t,r,!0).then(e=>{fe(e,n)}).catch(e=>{console.error("Error during loading manifest:"+e)});else{$=q(),W("loadManifestStartTime");const i=await J(e,"owl",t,r,!1);ee=q(),W("loadManifestEndTime");const{manifest:s}=i;re=i.exposure,oe=i.environment,te=q(),W("loadOWLStartTime"),await s.addScriptElementToDocument(o?`owl.${n.toLowerCase()}.js`:"owl.js",!1,!1),ne=q(),W("loadOWLEndTime"),ie=s.getClientVersion(),a&&fe(i,n,o),ae=de(s,n,void 0,void 0,o)}const d={clientVersion:ie,exposure:re,wiseEnvironment:oe,owlBootstrapperDiagnostics:{loadManifestStartTime:$,loadManifestEndTime:ee,loadOwlStartTime:te,loadOwlEndTime:ne},jsApiUrlInfos:ae};window.Microsoft.Office.OWL.initPackage(d)}const ce={[k.Excel]:"excel-boot.js",[k.PowerPoint]:"powerpoint.app.boot.js",[k.Word]:"word.boot.js",[k.OneNote]:"onenote-boot.js",[k.Visio]:"visio.boot.js",[k.None]:""};function de(e,t,n,a,i){const r=new Map;if(t&&ce[t]&&!i){const i=e?e.getFileUrl(ce[t]).url:n,o=e?e.getFileUrl(ce[t]).sri:a;i&&(function(e){new Promise((t,n)=>{const a=document.createElement("link");a.href=e,a.rel="preload",a.as="script",a.onload=()=>t(),a.onerror=()=>n(new Error(`jsapi ${e} failed to preload`)),document.documentElement.appendChild(a)})}(i),r.set(t,{jsApiUrl:i,jsApiSri:o,PreloadedInBootStrapper:!0}))}return r}function le(e){if(!e)return"";if(e.indexOf("=")>=0)throw new Error(`Out of range: ${e}`);const t=""+document.cookie,n=new RegExp("(?:^|; )"+e+"=([^;]*)"),a=t.match(n);return!a||a.length<2?"":a[1]}function ue(e,t,n,a=!1,i=!1,r=0){return new Promise((o,s)=>{if(!t||!n)throw new Error("OWL metadata cookie does not contains URL or SRI");const c=document.createElement("script");c.async=a,c.defer=i,c.setAttribute("fetchpriority","high"),c.src=t,n&&(c.integrity=n,c.crossOrigin="anonymous"),c.onload=async()=>{try{void 0===window.Microsoft||void 0===window.Microsoft.Office||void 0===window.Microsoft.Office.OWL?s(new Error(`addOWLScriptElementToDocument onLoad ${e} ${t} failed to load... ${n} its SRI ${r} retryCount`)):o()}catch(a){s(new Error(`addOWLScriptElementToDocument onLoadCatch ${e} ${t} failed to load... ${n} its SRI ${r} retryCount`))}},c.onerror=async()=>{try{r<1?(await function(e,t,n,a=!1,i=!1,r=0){return ue(e,t,n,a,i,r+1)}(e,t,n,a,i,r),o()):s(new Error(`addOWLScriptElementToDocument onError ${e} ${t} failed to load... ${n} its SRI ${r} retryCount`))}catch(a){s(new Error(`addOWLScriptElementToDocument onErrorCatch ${e} ${t} failed to load... ${n} its SRI ${r} retryCount`))}},document.documentElement.appendChild(c)})}function fe(e,t,n){const a=e.manifest,{url:i,sri:r}=a.getFileUrl(t&&n?`owl.${t.toLowerCase()}.js`:"owl.js"),o=[];o.push("EXPOSER="+e.exposure),o.push("ENV="+e.environment),o.push("VERSION="+a.getClientVersion()),o.push("URL="+i),o.push("SRI="+r);const s=o.join("&");if(K(X,s,.083,void 0,!0),t&&ce[t]){const e=[],{url:n,sri:i}=a.getFileUrl(ce[t]);e.push("URL="+n),e.push("SRI="+i);const r=e.join("&");K(Z+t,r,.083,void 0,!0)}}var pe=n(7),me=(n(40),n(51),n(118)),_e=n(62),he="Doc",be="One",ge="Ppt",ve="Xls",ye="Vsd",Se="Lib",De="Drive",Ie={WinDocuments:Se,WinLibrary:Se,WinMusic:Se,WinPictures:Se,WinPodcastLibrary:Se,WinVideos:Se,WinDrive:De,CDDrive:"CDDrive",GenericDrive:De,UsbDrive:"USBDrive",ExternalDrive:"ExtDrive",NetworkStorage:"NetDrive",Accdb:"Mdb",Doc:he,Docm:he,Docx:he,Dot:he,Dotm:he,Dotx:he,Exe:"Exe",Html:"Html",Mdb:"Mdb",Mpp:"Mpp",Mpt:"Mpp",Odp:ge,Ods:ve,Odt:he,One:be,Onepkg:be,Onetoc2:be,Notebook:"OneNotebook",Pot:ge,Potm:ge,Potx:ge,Ppa:ge,Ppam:ge,Pps:ge,Ppsm:ge,Ppsx:ge,Ppt:ge,Pptm:ge,Pptx:ge,Pub:"Pub",Rtf:"Rtf",Txt:"Txt",Vdw:ye,Vsd:ye,Vsdm:ye,Vsdx:ye,Vsl:ye,Vss:ye,Vssm:ye,Vssx:ye,Vst:ye,Vstm:ye,Vstx:ye,Xaml:"Xaml",Xla:ve,Xlam:ve,Xll:ve,Xls:ve,Xlsb:ve,Xlsm:ve,Xlsx:ve,Xlt:ve,Xltm:ve,Xltx:ve,Xml:"Xml",Xps:"Xps",Xsn:"Xsn",Zip:"Zip"},xe=n(82),Ce="MissingProperty",Oe="ParsingResponseFailed",we=n(97),Ee=function(){function e(e){this._hostUrl=e.concat("?wacreauth=1")}return e.prototype.tryLogin=function(){return this.popupCenter(this._hostUrl,"",700,525)},e.prototype.popupCenter=function(e,t,n,a){var i=void 0!==window.screenLeft?window.screenLeft:screen.left,r=void 0!==window.screenTop?window.screenTop:screen.top,o=(window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width)/2-n/2+i,s=(window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height)/2-a/2+r,c=window.open(e,t,"scrollbars=yes, width="+n+", height="+a+", top="+s+", left="+o);if(window.focus)try{c.focus()}catch(e){return null}return c},e}(),Ae="AccessToken",Le="FileGetUrl",ke=[Ae,Le],Me=function(){function e(e,t,n,a,i,r){this._retry=0,this._wacIFrame=e,this._wacIFrameOrigin=t,this._wacDataSource=a,this._itemId=n,this._hostSessionId=i,this._quota=2,this._hostUrl=r}return e.prototype.processMessage=function(e,t){var n=this,a=new b.e({name:"RefreshAccessToken"}),i=e.Tokens;try{if(!this.hasQuota())return this.sendFailedMessageToWac(i,[{Id:"202",Details:"Call in progress"}],null),void a.end({resultType:b.t.ExpectedFailure,resultCode:"Call in progress",extraData:{requestedTokens:i.toString(),wacCorrelationId:t,HostSessionId:this._hostSessionId}});var r=this.getUnknownTokenNames(i);return r.length>0?(this.handleUnknownTokenNames(r,null),void a.end({resultType:b.t.ExpectedFailure,resultCode:"UnknownTokenRequest",extraData:{requestedTokens:i.toString(),wacCorrelationId:t,HostSessionId:this._hostSessionId}})):(this.acquireQuota(),this._wacDataSource.getWopiTargetInfoWithItemId(this._itemId.toString()).then(function(e){n.releaseQuota(),n.sendSuccessMessageToWac(i,e),a.end({resultType:b.t.Success,resultCode:"Success",extraData:{wacCorrelationId:t,HostSessionId:n._hostSessionId,CorrelationId:e.requestId}})},function(e){if(n.releaseQuota(),we.e.isFeatureEnabled({ODB:1688})&&401===e.httpStatus&&n._retry<2)if(n.wacAuthProvider=new Ee(n._hostUrl),n._loginPopup=n.wacAuthProvider.tryLogin(),n._loginPopup)n._retry++,setTimeout(function(){n._loginPopup.close()},2e4),n.sendFailedMessageToWac(i,[{Id:"202",Details:"AAD Interaction Required"}],null),a.end({resultType:b.t.ExpectedFailure,resultCode:"AAD Interaction Required",extraData:{requestedTokens:i.toString(),wacCorrelationId:t,HostSessionId:n._hostSessionId}});else{var r=n.getTokenRefreshErrors(e);n.sendFailedMessageToWac(i,r,e.requestId),a.end({resultType:n.getQosResultType(e),resultCode:"401-Popup blocked",extraData:{CorrelationId:e.requestId,vroomItemUrl:e.requestUri,requestedTokens:i.toString(),wacCorrelationId:t,HostSessionId:n._hostSessionId}})}else r=n.getTokenRefreshErrors(e),n.sendFailedMessageToWac(i,r,e.requestId),a.end({resultType:n.getQosResultType(e),resultCode:n.getQosResultCode(e),extraData:{CorrelationId:e.requestId,vroomItemUrl:e.requestUri,requestedTokens:i.toString(),wacCorrelationId:t,HostSessionId:n._hostSessionId}})}).catch(function(e){a.end({resultType:b.t.Failure,resultCode:"UnknownFailure",extraData:{requestedTokens:i.toString(),wacCorrelationId:t,HostSessionId:n._hostSessionId,message:e?e.message:""}})}))}catch(e){a.end({resultType:b.t.Failure,resultCode:"UnknownFailure",extraData:{requestedTokens:i.toString(),wacCorrelationId:t,HostSessionId:this._hostSessionId,message:e.message}})}},e.prototype.hasQuota=function(){return this._quota>0},e.prototype.acquireQuota=function(){this._quota--,this._quota=Math.max(this._quota,0)},e.prototype.releaseQuota=function(){this._quota++,this._quota=Math.min(this._quota,2)},e.prototype.getQosResultType=function(e){var t=e.httpStatus;return 0===t||401===t||403===t||404===t||423===t||e.error===Ce||e.error===Oe?b.t.ExpectedFailure:b.t.Failure},e.prototype.getQosResultCode=function(e){return e.error?e.error===Ce||e.error===Oe?"NoToken":e.error:"UnknownFailure"},e.prototype.getUnknownTokenNames=function(e){var t=[];return e.forEach(function(e){ke.indexOf(e)<0&&t.push(e)}),t},e.prototype.handleUnknownTokenNames=function(e,t){var n=[{Id:"Unknown token",Details:"Unknown token"}],a=[];e.forEach(function(e){a.push({Name:e,Errors:n,SPCorrelationId:t})}),this.postMessageToWac(a)},e.prototype.sendSuccessMessageToWac=function(e,t){var n=this,a=[],i=[];e.forEach(function(e){if(a.indexOf(e)<0){a.push(e);var r=n.getSessionToken(e,t);r&&i.push(r)}}),this.postMessageToWac(i)},e.prototype.getSessionToken=function(e,t){var n={Name:e,SPCorrelationId:t.requestId};switch(e){case Ae:n.Value=t.accessToken,n.Expiry=t.accessTokenExpiry;break;case Le:n.Value=t.fileGetUrl,n.Expiry=t.fileGetUrlExpiry||t.accessTokenExpiry;break;default:return null}return n},e.prototype.sendFailedMessageToWac=function(e,t,n){var a=[],i=[];e.forEach(function(e){a.indexOf(e)<0&&(a.push(e),i.push({Name:e,Errors:t,SPCorrelationId:n}))}),this.postMessageToWac(i)},e.prototype.getTokenRefreshErrors=function(e){var t=[],n=e.httpStatus;switch(n){case 200:var a=e.error,i=e.details;e.error&&(e.error===Ce?t.push({Id:"500",Details:"No tokens retrieved"}):e.error===Oe?t.push({Id:"500",Details:i}):t.push({Id:a||"500",Details:i}));break;case 0:t.push({Id:"503",Details:"Unable to connect to Service"});break;case 503:t.push({Id:"503",Details:"Service Unavailable"});break;default:t.push({Id:n.toString(),Details:e.details})}return t},e.prototype.postMessageToWac=function(e){var t={MessageId:"Host_RefreshSessionInfo",SendTime:Date.now(),Values:{Tokens:e}};this._wacIFrame.postMessage(JSON.stringify(t),this._wacIFrameOrigin)},e}(),Pe="Host_DavUrlFromIds",Te="Host_WopiInfoFromUrl",Ue=function(){function e(e,t,n,a,i){this._wacIFrame=e,this._wacIFrameOrigin=t,this._parentFolderFullUrl=a,this._hostUrl=n,this._wacDataSource=i,this._inProgress=!1,this._queuedMessages=[]}return e.prototype.processMessage=function(e){var t=new b.e({name:"GetWopiSrc"});return e.Url?this._queuedMessages.length>=100?(this.sendWopiSrcFailedMessageToWac(e.Url,{Id:"429",Details:"Too many requests"},e.CorrelationId),void t.end({resultType:b.t.ExpectedFailure,resultCode:"Too many requests",extraData:{Id:this.hostSessionId}})):(this._queuedMessages.push(e),void(this._inProgress||this.processQueue())):(this.sendWopiSrcFailedMessageToWac(e.Url,{Id:"Url is null",Details:"Url is null"},e.CorrelationId),void t.end({resultType:b.t.ExpectedFailure,resultCode:"Url is null.",extraData:{Id:this.hostSessionId}}))},e.prototype.processDavURLMessage=function(e){var t=new b.e({name:"DavURLFromIds"});return e.ItemId&&e.DriveId?this._queuedMessages.length>=100?(this.sendDavURlFailedMessageToWac(e,{Id:"429",Details:"Too many requests"}),void t.end({resultType:b.t.ExpectedFailure,resultCode:"Too many requests",extraData:{hostSessionId:this.hostSessionId,wacCorrelationId:e.CorrelationId}})):(this._queuedMessages.push(e),void(this._inProgress||this.processQueue())):(this.sendDavURlFailedMessageToWac(e,{Id:"ItemId or DriveId is null",Details:"ItemId or DriveId is null"}),void t.end({resultType:b.t.ExpectedFailure,resultCode:"ItemId or DriveId is null",extraData:{hostSessionId:this.hostSessionId,wacCorrelationId:e.CorrelationId}}))},e.prototype.constructFullUrl=function(e){return 0===e.indexOf("https://")||0===e.indexOf("http://")?e:"/"===e.charAt(0)?"".concat(this._hostUrl).concat(e):"".concat(this._parentFolderFullUrl,"/").concat(e)},e.prototype.processQueue=function(){var e=this._queuedMessages.shift();e&&(this.isWopiMsgDavURLFromIdsRequest(e)?this.executeDavURLFromIdsRequest(e):this.executeGetFileWopiSrcRequest(e))},e.prototype.isWopiMsgDavURLFromIdsRequest=function(e){return!!e.ItemId&&!!e.DriveId},e.prototype.executeGetFileWopiSrcRequest=function(e){var t=this,n=new b.e({name:"GetWopiSrc"}),a=e.Url;try{var i=this.constructFullUrl(a),r=this.encodeUrl(i);this._inProgress=!0,e.CorrelationId+=" tProcessQueue:"+Date.now(),this._wacDataSource.getWopiTargetInfoWithUrl(r).then(function(i){e.CorrelationId+=" tVroomResponse:"+Date.now(),t.sendWopiSrcSuccessMessageToWac(a,i,e.CorrelationId),t._inProgress=!1,n.end({resultType:b.t.Success,resultCode:"Success",extraData:{url:a,Id:t.hostSessionId,correlationInfo:e.CorrelationId,wopiSrc:i.wopiSrc}}),t._queuedMessages.length>0&&t.processQueue()},function(i){e.CorrelationId+=" tVroomResponse:"+Date.now(),t.sendWopiSrcFailedMessageToWac(a,t.getErrors(i),e.CorrelationId),t._inProgress=!1,n.end({resultType:t.getQosResultType(i),resultCode:t.getQosResultCode(i),extraData:{Id:t.hostSessionId,CorrelationId:i.requestId,vroomItemUrl:i.requestUri,correlationInfo:e.CorrelationId}}),t._queuedMessages.length>0&&t.processQueue()})}catch(t){var o={Id:t.name,Details:t.message};e.CorrelationId+=" tException:"+Date.now(),this.sendWopiSrcFailedMessageToWac(a,o,e.CorrelationId),n.end({resultType:b.t.Failure,resultCode:t.name,extraData:{Id:this.hostSessionId,correlationInfo:e.CorrelationId}})}},e.prototype.executeDavURLFromIdsRequest=function(e){var t=this,n=new b.e({name:"DavURLFromIds"});try{this._inProgress=!0,e.CorrelationId+=" tProcessQueue:"+Date.now(),this._wacDataSource.getWopiDavURLWithDriveIdItemId(e.DriveId,e.ItemId).then(function(a){e.CorrelationId+=" tVroomResponse:"+Date.now(),t.sendDavUrlSuccessMessageToWac(e,a),t._inProgress=!1,n.end({resultType:b.t.Success,resultCode:"Success",extraData:{url:a.webDavUrl,hostSessionId:t.hostSessionId,wacSessionId:e.CorrelationId,wopiSrc:a.wopiSrc}}),t._queuedMessages.length>0&&t.processQueue()},function(a){e.CorrelationId+=" tVroomResponse:"+Date.now(),t.sendDavURlFailedMessageToWac(e,t.getErrors(a)),t._inProgress=!1,n.end({resultType:t.getQosResultType(a),resultCode:t.getQosResultCode(a),extraData:{hostSessionId:t.hostSessionId,wacSessionId:e.CorrelationId,CorrelationId:a.requestId,vroomItemUrl:a.requestUri}}),t._queuedMessages.length>0&&t.processQueue()})}catch(t){var a={Id:t.name,Details:t.message};e.CorrelationId+=" tException:"+Date.now(),this.sendDavURlFailedMessageToWac(e,a),n.end({resultType:b.t.Failure,resultCode:t.name,extraData:{hostSessionId:this.hostSessionId,wacSessionId:e.CorrelationId}})}},e.prototype.getQosResultType=function(e){var t=e.httpStatus;return 0===t||401===t||403===t||404===t||423===t||400===t||e.error===Oe||e.error===Ce?b.t.ExpectedFailure:b.t.Failure},e.prototype.getQosResultCode=function(e){return e.error?e.error===Ce||e.error===Oe?"NoToken":e.error:"UnknownFailure"},e.prototype.sendWopiSrcSuccessMessageToWac=function(e,t,n){var a=we.e.isFeatureEnabled({ODB:60332}),i={MessageId:Te,SendTime:Date.now(),Values:{WopiSrc:t.wopiSrc,Url:e,AccessToken:t.accessToken,AccessTokenExpiry:t.accessTokenExpiry,ItemId:a?t.itemId:void 0,DriveId:a?t.driveId:void 0},CorrelationId:n};this._wacIFrame.postMessage(JSON.stringify(i),this._wacIFrameOrigin)},e.prototype.sendWopiSrcFailedMessageToWac=function(e,t,n){var a={MessageId:Te,SendTime:Date.now(),Values:{Url:e,Error:t},CorrelationId:n};this._wacIFrame.postMessage(JSON.stringify(a),this._wacIFrameOrigin)},e.prototype.sendDavUrlSuccessMessageToWac=function(e,t){var n={MessageId:Pe,SendTime:Date.now(),Values:{ItemId:e.ItemId,DriveId:e.DriveId,Url:t.webDavUrl,WopiSrc:t.wopiSrc,AccessToken:t.accessToken,AccessTokenExpiry:t.accessTokenExpiry},CorrelationId:e.CorrelationId};this._wacIFrame.postMessage(JSON.stringify(n),this._wacIFrameOrigin)},e.prototype.sendDavURlFailedMessageToWac=function(e,t){var n={MessageId:Pe,SendTime:Date.now(),Values:{ItemId:e.ItemId,DriveId:e.DriveId,Error:t},CorrelationId:e.CorrelationId};this._wacIFrame.postMessage(JSON.stringify(n),this._wacIFrameOrigin)},e.prototype.getErrors=function(e){var t=e.httpStatus,n={Id:t.toString(),Details:e.details};switch(t){case 200:var a=e.error,i=e.details;e.error&&(n=e.error===Ce?{Id:"500",Details:"No data retrieved"}:e.error===Oe?{Id:"500",Details:i}:{Id:a||"500",Details:i});break;case 0:n={Id:"503",Details:"Unable to connect to Service"};break;case 503:n={Id:"503",Details:"Service Unavailable"};break;default:n={Id:t.toString(),Details:e.details}}return n},e.prototype.encodeUrl=function(e){return"u!".concat(window.btoa(unescape(encodeURIComponent(e))).replace(/=/g,"").replace(/[+]/g,"-").replace(/\//g,"_"))},e}(),Fe=n(210),He=n(217),Re=new b.e({name:"Abt"}),Ne=function(){function e(e,t,n){try{var a=this.getAbtCookieValue(n);if(""===a||null===a)return void Re.end({resultType:b.t.Failure,resultCode:"NullCookieValue"});var i,r=a.split(",");r.length<3&&Re.end({resultType:b.t.Failure,resultCode:"Missing token claims"}),4===r.length&&(i={market:He.e.language,hostName:"SPO",environment:Fe.Environment.WorldWide,userId:t,authType:Fe.AuthType.Aad,timeout:r[0],trackEvents:!0,enableLogging:!0,sessionId:r[3],signInState:JSON.stringify(r[1]),workloadName:"SPO",controls:JSON.stringify(r[2]),tenantId:window._spPageContextInfo.siteSubscriptionId}),window.AbtInteraction.AbtInitialize(i),this.attachSharedABTPromptCallback(),Re.end({resultType:b.t.Success,resultCode:"Success"})}catch(e){Re.end({resultType:b.t.Failure,resultCode:"Error",extraData:{Exception:e}})}}return e.prototype.processMessage=function(){window.AbtInteraction.AbtRegisterActivity()},e.prototype.handleSignOut=function(e){var t=window.location.origin+"/_layouts/15/SignOut.aspx?isso=true&returnUri="+encodeURIComponent(window.top.location.href);window.top.location.href=t},e.prototype.getAbtCookieValue=function(e){for(var t=document.cookie.split(";"),n=0;n<t.length;n++){var a=t[n].split("=");if(e===a[0].trim())return atob(a[1])}return""},e.prototype.loadSharedABTPrompt=function(e){n.ee([25],748,7).then(function(){return e()})},e.prototype.attachSharedABTPromptCallback=function(){window.LoadAbtPromptJs={Download:this.loadSharedABTPrompt}},e}(),Be=function(){function e(e,t,n,a){this._wacIFrame=e,this._wacIFrameOrigin=t,this._loginHint=n,this._hostSessionId=a}return e.prototype.processMessage=function(e){this.sendAuthConfigToWac(e)},e.prototype.sendAuthConfigToWac=function(e){var t=new b.e({name:"CustomAuthConfig"}),n={type:"webMsaWithAadProxy",login_Hint:this._loginHint,appSignOutUrl:window.location.origin+"/_layouts/15/SignOut.aspx?isso=true&returnUri="+encodeURIComponent(window.top.location.href),aad:{appId:"00000003-0000-0ff1-ce00-000000000000",wreply:this._wacIFrameOrigin},msa:{siteId:250206,wreply:this._wacIFrameOrigin}},a={MessageId:"Host_SetCustomAuthConfig",SendTime:Date.now(),Values:{AuthConfig:JSON.stringify(n)},CorrelationId:e};this._wacIFrame.postMessage(JSON.stringify(a),this._wacIFrameOrigin),t.end({resultType:b.t.Success,resultCode:"Success",extraData:{wacCorrelationId:e,HostSessionId:this._hostSessionId,Message:a}})},e}(),je=n(279),Ve="CAAEMessage";function ze(){return pe.t.isActivated("f7ae0253-dbad-4c8d-93ad-ba43d929157f","03/31/2023","Notify payload for the message to get placeholder CC details.")}var Ge=function(){function e(e,t,n){this._target=e,this._targetOrigin=t,this._webAbsoluteUrl=n}return e.prototype.sendCAAEMessage=function(e){var t={MessageId:Ve,SendTime:Date.now(),Values:e.Values};this._target.postMessage(JSON.stringify(t),this._targetOrigin)},e.prototype.receiveCAAEMessage=function(e){var t=e.Values.Action;e.MessageId===Ve&&(ze()&&"GetCAAEPlaceholders"===t?this._notifyWacForCaaePlaceholders():this.handleCommunicationFromWacToTaskPane(e))},e.prototype.receiveCAAEMessageOwl=function(e){var t=e.Action;ze()&&"GetCAAEPlaceholders"===t?this._notifyWacForCaaePlaceholders():this.handleCommunicationFromWacToTaskPaneOwl(e)},e.prototype.handleCommunicationFromWacToTaskPane=function(e){var t={MessageId:Ve,MessageContent:e.Values.payload,Action:e.Values.Action,Type:e.Values.type};window.parent.postMessage(JSON.stringify(t),this._webAbsoluteUrl)},e.prototype.handleCommunicationFromWacToTaskPaneOwl=function(e){var t={MessageId:Ve,MessageContent:e.payload,Action:e.Action,Type:e.type};window.parent.postMessage(JSON.stringify(t),this._webAbsoluteUrl)},e.prototype._notifyWacForCaaePlaceholders=function(){var e={MessageId:Ve,MessageContent:"",Action:"GetPlaceholderCCDetails"};window.parent.postMessage(JSON.stringify(e),this._webAbsoluteUrl)},e}(),Ke="https://onedrive.live.com",We=u.i,qe=n(78),Qe=n(371),Ye=function(){function e(e){var t=this;this.handleMessage=function(e){if(e.origin===Ke&&e.source===window.parent)try{var n="object"==typeof e.data?e.data:JSON.parse(e.data);if(n.CorrelationId){var a=t.signals[n.CorrelationId];if(a)return delete t.signals[n.CorrelationId],void(n.MessageId?a.resolve(n):a.resolve(void 0));t.target.postMessage(e.data,t.targetOrigin)}}catch(e){return}},this.isRunning=!1,this.target=e.target,this.targetOrigin=e.targetOrigin,this.signals={}}return e.prototype.start=function(){this.isRunning=!0,window.addEventListener("message",this.handleMessage)},e.prototype.dispose=function(){for(var e in this.isRunning=!1,window.removeEventListener("message",this.handleMessage),this.signals)this.signals[e].cancel();this.signals={}},e.prototype.proxy=function(e){if(this.isRunning){e.CorrelationId||(e.CorrelationId=qe.e.generate());var t=new Qe.e;return this.signals[e.CorrelationId]=t,window.parent.postMessage(JSON.stringify(e),Ke),t.getPromise()}},e}(),Je=n(215),Xe=!pe.e.isActivated("B87FF972-769D-44E6-8727-EBE5742BBA30","13/09/2022","move tab test mode checking to seperate block"),Ze=!pe.e.isActivated("280922F7-C604-460E-9428-4FE6E4CFF173","12/9/2022","Handle addtional data for sharing dialog"),$e=!pe.e.isActivated("c6ba1d59-4adb-41c3-8234-b3207cfb590d","25/03/2023","send message for caae for tab test"),et=!pe.e.isActivated("db5af12c-e0c6-4a33-bd20-12577797f471","08/02/2023","add scenarioId and contextualInformation to queryParams"),tt="Blur_Focus",nt="User_Activity",at="abtSignOutEventForHostUserGenerated",it="abtSignOutEventForHost",rt="spo_abt",ot="CAAEMessage",st=(function(){function e(e,t){this._wacIFrame=e,this._wacIFrameOrigin=t}e.prototype.onShareReady=function(e){var t={ShareCorrelation:e},n={MessageId:tt,SendTime:Date.now(),Values:t};this.postMessageToWac(n)},e.prototype.onGrantPermissionCompleted=function(e,t,n){var a={Id:e,DialogCanceled:n,Persons:t},i={MessageId:"CheckUserAccessAndGrantPermissions_Result",SendTime:Date.now(),Values:a};this.postMessageToWac(i)},e.prototype.postMessageToWac=function(e){this._wacIFrame.postMessage(JSON.stringify(e),this._wacIFrameOrigin)}}(),function(){function e(e,t){this._wacIFrame=e,this._wacIFrameOrigin=t}return e.prototype.onPickerReady=function(e){var t={ShareCorrelation:e.wdUserSession},n={MessageId:tt,SendTime:Date.now(),Values:t};this.postMessageToWac(n)},e.prototype.onItemMoved=function(e){var t={isMoveSuccessful:e.isMoveSuccessful,wdUserSession:e.wdUserSession,isCrossSiteMove:e.isCrossSiteMove,updatedDocumentUrl:e.updatedDocumentUrl},n={MessageId:"Host_MoveToFolder",SendTime:Date.now(),Values:t};this.postMessageToWac(n)},e.prototype.onItemsPicked=function(e){var t,n={wdUserSession:e.wdUserSession,selectedItems:null!==(t=e.selectedItems)&&void 0!==t?t:null,error:e.error},a={MessageId:"Host_FilePicker",SendTime:Date.now(),Values:n};this.postMessageToWac(a)},e.prototype.postMessageToWac=function(e){this._wacIFrame.postMessage(JSON.stringify(e),this._wacIFrameOrigin)},e}()),ct=function(){function e(e,t){this._wacIFrame=e,this._wacIFrameOrigin=t}return e.prototype.onCanEmbed=function(e){var t={MessageId:Je.t.CanEmbed,SendTime:Date.now(),Values:{HostEmbeddedViewUrl:e},CorrelationId:qe.e.generate()};this.postMessageToWac(t)},e.prototype.postMessageToWac=function(e){this._wacIFrame.postMessage(JSON.stringify(e),this._wacIFrameOrigin)},e}(),dt=(function(){function e(e){var t=e.allowedOrigins,n=e.target,a=e.targetOrigin,r=e.listItemId,o=e.isShareByLinkGuestUser,s=e.supportSingleSignOn,c=e.wacDataSource,d=e.shareDialogHelper,u=e.pickerDialogHelper,f=e.hostUrl,p=e.parentFolderFullUrl,m=e.wacHostWindow,_=e.sharingLinkTokenProvider,h=e.hostSessionId,g=e.userId,v=e.postCAAEMessageTargetOrigin,y=e.loginHint,S=e.handleFileNameChange,D=this;this._eventHandler=function(e){var t=Date.now(),n=e.origin,a=void 0;try{if(a="object"==typeof e.data?e.data:JSON.parse(e.data),!Xe&&window.sessionStorage.getItem("_isRunningTABTest"))return $e&&e.origin===D._hostUrl&&D._caaeMessageHandler&&a.MessageId===ot&&D._caaeMessageHandler.sendCAAEMessage(a),void D.processMessage(a,t)}catch(e){return void D.createQos(t).end({resultType:b.t.ExpectedFailure,resultCode:"invalid message",extraData:{HostSessionId:D._hostSessionId,message:e.message}})}if(Xe)try{if(window.sessionStorage.getItem("_isRunningTABTest"))return $e&&e.origin===D._hostUrl&&D._caaeMessageHandler&&a.MessageId===ot&&D._caaeMessageHandler.sendCAAEMessage(a),void D.processMessage(a,t)}catch(e){}a?(e.origin===D._hostUrl&&(a.eventId!==it&&a.eventId!==at||D.handleAbtSignout(a.detail),D._caaeMessageHandler&&a.MessageId===ot&&D._caaeMessageHandler.sendCAAEMessage(a)),a.MessageId?D._target===e.source?!n||D._allowedOrigins.indexOf(n)<0?D.createQos(t).end({resultType:b.t.ExpectedFailure,resultCode:"invalid event origin",extraData:{HostSessionId:D._hostSessionId,wacCorrelationId:a.CorrelationId,origin:e.origin,MessageId:a.MessageId}}):D.processMessage(a,t):D.createQos(t).end({resultType:b.t.ExpectedFailure,resultCode:"invalid event source",extraData:{HostSessionId:D._hostSessionId,wacCorrelationId:a.CorrelationId,MessageId:a.MessageId}}):D.createQos(t).end({resultType:b.t.ExpectedFailure,resultCode:"message id is empty",extraData:{HostSessionId:D._hostSessionId}})):D.createQos(t).end({resultType:b.t.ExpectedFailure,resultCode:"message is null",extraData:{HostSessionId:D._hostSessionId}})},this._onPopState=function(e,t){var n=new b.e({name:"AppPopState"});try{var a={MessageId:"App_PopState",SendTime:Date.now(),Values:{State:e,Url:t}};D._target.postMessage(JSON.stringify(a),D._targetOrigin),n.end({resultType:b.t.Success})}catch(e){n.end({resultType:b.t.Failure,resultCode:"failed to sent pop state message",extraData:{details:e}})}},this.handleAppPushState=function(e){var t=new b.e({name:"AppPushState"});D._sharingLinkTokenProvider&&D._sharingLinkTokenProvider.TokenPromise?D._sharingLinkTokenProvider.TokenPromise.then(function(n){if(n){var a=new l.t(e.Url);a.setQueryParameter(n.Key,n.Value),e.Url=a.toString()}D.handleAppPushStateCore(e,t)}):D.handleAppPushStateCore(e,t)},this.handleAppPushStateCore=function(e,t){try{D._browserHistoryHelper.onAppPushStateMessage(e),t.end({resultType:b.t.Success})}catch(e){t.end({resultType:b.t.Failure,resultCode:"failed to push state",extraData:{details:e}})}},this._handleMessageForCOB=function(e){return Object(i.t)(D,void 0,void 0,function(){var t,n,a;return Object(i.i)(this,function(i){switch(i.label){case 0:return e.origin!==this._hostUrl?[3,1]:(n=e.data).eventId===it||n.eventId===at?(this.handleAbtSignout(n.detail),[2]):(this._caaeMessageHandler&&n.MessageId===ot&&this._caaeMessageHandler.sendCAAEMessage(n),[3,3]);case 1:if(e.source!==this._target)return[3,3];t=Date.now(),n=void 0;try{if(n="object"==typeof e.data?e.data:JSON.parse(e.data),!Xe&&window.sessionStorage.getItem("_isRunningTABTest"))return this.processMessage(n,t),[2]}catch(e){return[2]}if(Xe)try{if(window.sessionStorage.getItem("_isRunningTABTest"))return this.processMessage(n,t),[2]}catch(e){}if(!n)return[2];if(this._allowedOrigins.indexOf(e.origin)<0)return[2];switch(n.MessageId){case nt:this.handleAbt();break;case ot:this._caaeMessageHandler&&this._caaeMessageHandler.receiveCAAEMessage(n)}return[4,this._cobMessageProxy.proxy(n)];case 2:(a=i.sent())&&this._target.postMessage(JSON.stringify(a),this._targetOrigin),i.label=3;case 3:return[2]}})})},this._allowedOrigins=t,this._target=n,this._targetOrigin=a,this._isShareByLinkGuestUser=o,this._hostUrl=f,this._hostSessionId=h,this._refreshSessionMessageHandler=new Me(n,a,r,c,h,f),this._wopiSrcMessageHandler=new Ue(n,a,f,p,c),we.e.isFeatureEnabled({ODB:60332})&&(this._wopiCustomAuthConfigHandler=new Be(n,a,y,h)),document.cookie.indexOf(rt)>-1&&(this._abtMessageHandler=new Ne(h,g,rt)),this._wopiSrcMessageHandler.hostSessionId=h,this._shareDialogHelper=d,this._pickerDialogHelper=u,this._supportSingleSignOn=s,this._wacHostWindow=m,this._sharingLinkTokenProvider=_,this._browserHistoryHelper=new dt(this._wacHostWindow,this._onPopState),this._postCAAEMessageTargetOrigin=v,this._postCAAEMessageTargetOrigin&&(this._caaeMessageHandler=new Ge(n,a,this._postCAAEMessageTargetOrigin)),this._isCOBScenario=function(){if(!pe.t.isActivated("22599339-36f9-4861-b71c-b6dfa76a2a3f","06/20/2022","Killswitch to enable COB support for Wac Host")){var e=window!==window.top,t=document.referrer===Ke+"/",n=-1!==window.location.host.indexOf(We);return t&&e&&n}return!1}(),this._isCOBScenario?(this._cobMessageProxy=new Ye({target:n,targetOrigin:a}),this._cobMessageProxy.start(),this._wacHostWindow.addEventListener("message",this._handleMessageForCOB,!1)):(this._wacHostWindow.addEventListener("message",this._eventHandler,!1),this.notifyReadyForPostMessage()),this._handleFileNameChange=S}e.prototype.processMessage=function(e,t){var n=Date.now(),a=e.CorrelationId+" tSent:"+e.SendTime+" tHostReceived:"+n;if(n-e.SendTime>6e4)this.createQos(t).end({resultType:b.t.ExpectedFailure,resultCode:"invalid send time",extraData:{MessageId:e.MessageId,HostSessionId:this._hostSessionId,wacCorrelationId:e.CorrelationId,sendTime:e.SendTime,receiveTime:n}});else if(e.SendTime>n)this.createQos(t).end({resultType:b.t.ExpectedFailure,resultCode:"invalid send time",extraData:{MessageId:e.MessageId,HostSessionId:this._hostSessionId,wacCorrelationId:e.CorrelationId,sendTime:e.SendTime,receiveTime:n}});else switch(e.MessageId){case"UI_Sharing":this._isShareByLinkGuestUser||this.showShareDialog(Object(i.e)(Object(i.e)({},e.Values),{clickTime:e.SendTime}));break;case"UI_CheckUserAccessAndGrantPermissions":this._isShareByLinkGuestUser||this.handleAtMention(Object(i.e)(Object(i.e)({},e.Values),{clickTime:e.SendTime}));break;case"App_MoveToFolder":this.showMoveDialog(e.Values);break;case"App_FilePicker":this.showFilePickerDialog(e.Values);break;case"File_Rename":this.handleRename(e.Values);break;case"App_RefreshSessionInfo":this.handleRefreshSessionInfo(e.Values,e.CorrelationId);break;case"GetAccessToken":this._supportSingleSignOn&&this.handleGetAccessToken(e.Values);break;case"App_PushState":this.handleAppPushState(e.Values);break;case"App_WopiInfoFromUrl":this.handleGetWopiFromUrl(e.Values,a);break;case"App_GetCustomAuthConfig":this.handleGetCustomAuthConfig(e.CorrelationId);break;case"App_DavUrlFromIds":this.handleDavURLFromIds(e.Values,a);break;case nt:this.handleAbt();break;case ot:this._caaeMessageHandler&&this._caaeMessageHandler.receiveCAAEMessage(e);break;default:this.log("Unknown message: "+e.MessageId)}},e.prototype.handleGetAccessToken=function(e){var t=new b.e({name:"SSO.GetAccessToken"});try{var n={MessageId:"PostAccessToken",SendTime:Date.now(),Values:{AccessToken:null,AddinSSOError:"access_denied",AddinControlId:e.AddinControlId,HostApplicationType:"SharePointOnline"}};this._target.postMessage(JSON.stringify(n),this._targetOrigin),t.end({resultType:b.t.Success,resultCode:"Delivered expected error"})}catch(e){t.end({resultType:b.t.Failure,resultCode:"Failed to send message.",extraData:{details:e}})}},e.prototype.handleRefreshSessionInfo=function(e,t){this._refreshSessionMessageHandler.processMessage(e,t)},e.prototype.handleGetWopiFromUrl=function(e,t){e.CorrelationId=t+" tProcessMessage:"+Date.now(),this._wopiSrcMessageHandler.processMessage(e)},e.prototype.handleGetCustomAuthConfig=function(e){we.e.isFeatureEnabled({ODB:60332})&&this._wopiCustomAuthConfigHandler&&this._wopiCustomAuthConfigHandler.processMessage(e)},e.prototype.handleDavURLFromIds=function(e,t){we.e.isFeatureEnabled({ODB:60396})&&this._wopiSrcMessageHandler.processDavURLMessage(e)},e.prototype.handleAbt=function(){document.cookie.indexOf(rt)>-1&&this._abtMessageHandler&&this._abtMessageHandler.processMessage()},e.prototype.handleAbtSignout=function(e){this._abtMessageHandler.handleSignOut(e.detail)},e.prototype.showShareDialog=function(e){var t={shareCorrelation:e.ShareCorrelation,nav:e.nav,mode:e.mode,clickTime:e.clickTime,overrideDefaultPermission:e.overrideDefaultPermission},n=e.additionalData;Ze&&n&&je.n.isFeatureEnabled({ODB:1785})&&(console.log("addtionalData in post message for share from WAC: "+JSON.stringify(n)),n.documentSummary&&(t=Object(i.e)(Object(i.e)({},t),{documentInformation:n}))),et&&(e.scenarioId&&(t=Object(i.e)(Object(i.e)({},t),{scenarioId:e.scenarioId})),e.contextualSharingContext&&(t=Object(i.e)(Object(i.e)({},t),{contextualSharingContext:e.contextualSharingContext})),e.contextualSharingLocation&&(t=Object(i.e)(Object(i.e)({},t),{contextualSharingLocation:e.contextualSharingLocation}))),this._shareDialogHelper.showShareDialog(t)},e.prototype.handleAtMention=function(e){this._shareDialogHelper.showAtMentionDialog({atMentionMessageId:e.Id,recipients:e.Persons,accessChecked:e.UserPermissionsVerified,shareCorrelation:e.ShareCorrelation,clickTime:e.clickTime})},e.prototype.showMoveDialog=function(e){this._pickerDialogHelper.showMoveDialog({supportsCrossSiteMove:!!e.supportsCrossSiteMove,wdUserSession:e.wdUserSession,pickerCustomization:e.pickerCustomization})},e.prototype.showFilePickerDialog=function(e){this._pickerDialogHelper.showFilePickerDialog({pickerCustomization:e.pickerCustomization,wdUserSession:e.wdUserSession})},e.prototype.handleRename=function(e){this._wacHostWindow.document.title=e.NewName,this._handleFileNameChange(e.NewName)},e.prototype.notifyReadyForPostMessage=function(){var e={MessageId:"Host_PostmessageReady",SendTime:Date.now()};this._target.postMessage(JSON.stringify(e),this._targetOrigin)},e.prototype.createQos=function(e){return new b.e({name:"WopiMessageHandler",startTimeOverride:e})},e.prototype.log=function(e){}}(),function(){function e(e,t){var n=this;this.onHistoryPopState=function(e){n._onPopState&&n._onPopState(e.state,n._wacHostWindow.location.href)},this._wacHostWindow=e,this._onPopState=t,e.addEventListener("popstate",this.onHistoryPopState)}return e.prototype.onAppPushStateMessage=function(e){this._wacHostWindow.history.pushState(e.State,this._wacHostWindow.document.title,e.Url)},e}()),lt=n(256),ut=n(116),ft=n(28),pt=n.n(ft),mt=n(92),_t=n(184),ht=n(213),bt=n(101),gt=n(98),vt=n(8),yt=n(76),St=n(133),Dt=n(146),It=n(119),xt=n(25),Ct=function(e){function t(t){var n=e.call(this,t)||this;return n._embedDataSource=n.resources.consume(p.e),n}return Object(i.a)(t,e),t.prototype.getEmbedInfo=function(e){return this._embedDataSource.getEmbedInfo(e)},t.prototype.createEmbedLink=function(e){return this._embedDataSource.createEmbedLink(e)},t.prototype.generateConfiguratorUrl=function(e){return this._embedDataSource.generateConfiguratorUrl(e)},t}(xt.e),Ot=n(80),wt=n(183),Et=n(121),At=n(124),Lt=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._identityDataSource=n.identityDataSource,a}return Object(i.a)(t,e),t.prototype.getToken=function(){return this._identityDataSource.getGraphToken({})},t.dependencies=Object(i.e)(Object(i.e)({},Et.e.dependencies),{identityDataSource:At.e}),t}(Et.e),kt=Object(C.i)("GraphTokenProvider",Lt),Mt=function(){function e(){}return e.prototype.getApiName=function(){return"Graph"},e.prototype.getApiBaseUrl=function(){return"https://graph.microsoft.com/beta"},e}(),Pt=new x.t({name:"GraphUrlDataSource",factory:new C.a(Mt)}),Tt=n(148),Ut=Object(C.i)("GraphDataRequestor",Tt.e,{sessionManagementProvider:kt,urlDataSource:Pt}),Ft=(Tt.e,n(254)),Ht=function(e){function t(){var t=e.call(this)||this;return t._dataRequestor=t.resources.consume(Ut),t._urlDataSource=t.resources.consume(Dt.e),t}return Object(i.a)(t,e),t.prototype.getEmbedInfo=function(e){return Object(i.t)(this,void 0,_.t,function(){var t,n,a,r,o=this;return Object(i.i)(this,function(s){switch(s.label){case 0:return Object(E.E)(E.n)?[4,this.resources.consumeAsync(p.a)]:[3,3];case 1:return t=s.sent(),this._dataRequestor=new Tt.t({},{urlDataSource:{getApiBaseUrl:function(){return"https://graph.microsoft.com/beta"}},sessionManagementProvider:{getToken:function(){return Object(i.t)(o,void 0,_.t,function(){return Object(i.i)(this,function(e){switch(e.label){case 0:return t?[4,t.getGraphToken({})]:[3,2];case 1:return[2,e.sent()];case 2:return[2,_.t.reject("Could not retrieve identity data source")]}})})}}}),[4,new Ft.e({},{dataRequestor:this._dataRequestor}).getPermissions(e.id||"")];case 2:return n=s.sent(),[2,this._parsePermissions(n)];case 3:return a=new wt.e,r=this._urlDataSource.getEmbedInfoUrl(e),[2,a.send({apiName:"GetEmbedInfo",url:r,useDefaultHeaders:!0,isErrorExpectedCallback:this._isExpected}).then(function(e){return{embedCode:e.embedCode,embedUrl:e.embedUrl,configuratorUrl:e.embedConfiguratorUrl}},function(e){return o._isExpected(e)?null:_.t.wrapError(e)})]}})})},t.prototype.createEmbedLink=function(e){var t=this,n={type:"embed"};return this._getItemUrl(e).then(function(e){var a="".concat(e,"/createLink");return t._dataRequestor.send({path:a,apiName:"createLink",requestType:"POST",useAuthorizationHeaders:!0,postData:JSON.stringify(n||{}),getErrorAsMessage:!0}).then(function(e){if(Object(E.E)(E.d)){var t=e.link,n=void 0===t?{}:t,a=n.webHtml,i=void 0===a?"":a,r=n.webUrl,o=void 0===r?"":r,s=n.configuratorUrl;return{embedCode:i,embedUrl:o,configuratorUrl:void 0===s?"":s}}var c=e.link,d=void 0===c?{}:c,l=d.webHtml,u=(i=void 0===l?"":l,d.webUrl);return{embedCode:i,embedUrl:o=void 0===u?"":u}})})},t.prototype.generateConfiguratorUrl=function(e){var t=this;return this._getItemUrl(e,!0).then(function(e){var n="".concat(e,"?action=xlembedconfigurator&$select=openWith");return t.request(n).then(function(e){var t=e[0],n=t.openWith,a=t.id,i=t.parentReference;if(n&&n.wac&&n.wac.applicationUrl){var r=n.wac,o=r.applicationUrl,s=r.accessToken,c=void 0===s?"":s,d=r.accessTokenExpiry,l=void 0===d?"":d;return o.replace("xlviewerinternal.aspx","xlembedconfigurator.aspx")+"&access_token=".concat(c,"&access_token_ttl=").concat(l)}return _.t.reject({driveId:null==i?void 0:i.driveId,itemId:a,error:{Id:"MissingProperty",Details:"No wac property was found in the response when generating configuratorUrl"}})},function(e){var t,n=e[0],a=(null===(t=e[1].status)||void 0===t?void 0:t.toString())||"FailToGenerateConfiguratorUrl",i=JSON.stringify({error:n});return _.t.reject({error:{Id:a,Details:i}})})})},t.prototype.request=function(e,t){var n=this;return void 0===t&&(t="GET"),this._createHeaders().then(function(a){return new _.t(function(r,o){return Object(i.t)(n,void 0,void 0,function(){var n,s;return Object(i.i)(this,function(i){switch(i.label){case 0:return[4,fetch(e,{method:t,headers:a})];case 1:return[4,(n=i.sent()).json()];case 2:return s=i.sent(),n.ok?r([s,n]):o([null==s?void 0:s.error,n]),[2]}})})})})},t.prototype._createHeaders=function(){return Object(i.t)(this,void 0,_.t,function(){var e;return Object(i.i)(this,function(t){return e={Accept:"application/json"},[2,this.resources.consume(p.a).getSessionToken().then(function(t){return e.Authorization="Bearer ".concat(t.accessToken),e})]})})},t.prototype._parsePermissions=function(e){for(var t,n=0,a=e;n<a.length;n++){var i=a[n];if("embed"===(null===(t=i.link)||void 0===t?void 0:t.type)){if(Object(E.E)(E.d)){var r=i.link,o=r.webHtml,s=void 0===o?"":o,c=r.webUrl,d=void 0===c?"":c,l=r.configuratorUrl;return{embedCode:s,embedUrl:d,configuratorUrl:void 0===l?"":l}}return{embedCode:i.link.webHtml,embedUrl:i.link.webUrl}}}},t.prototype._isExpected=function(e){return e&&e.data&&3017===e.data.code},t.prototype._getItemUrl=function(e,t){return void 0===t&&(t=!1),_.t.resolve(this.resources.consumeAsync(p.n).then(function(n){return n.getItemUrl(e,{useDirectEndpoint:t,useGraphBeta:!0})}))},t}(xt.e),Rt=n(34),Nt=new Set(["WacFailed.DocumentIsIRMProtected","DocumentIsIRMProtected","5373959","WacFailed.5243086","5243086","WacFailed.5243055","5243055","5374037","5373972","5373968","5373967","5373965","5373961","5243101","29"]);function Bt(e){return Nt.has(e)}Array.from(Nt);var jt,Vt=n(274),zt=Object(St.e)(function(){return Object(i.t)(void 0,void 0,void 0,function(){return Object(i.i)(this,function(e){switch(e.label){case 0:return[4,n.ee([8,"ondemand.resx-ondemand"],742)];case 1:return[2,e.sent().WacOwlShareDialog]}})})}),Gt=Object(St.e)(function(){return Object(i.t)(void 0,void 0,void 0,function(){return Object(i.i)(this,function(e){switch(e.label){case 0:return[4,n.ee([5,"ondemand.resx-ondemand"],743)];case 1:return[2,e.sent().WacOwlEmbedDialog]}})})}),Kt=Object(St.e)(function(){return Object(i.t)(void 0,void 0,void 0,function(){return Object(i.i)(this,function(e){switch(e.label){case 0:return[4,n.ee([7,"ondemand.resx-ondemand"],744)];case 1:return[2,e.sent().WacOwlMoveToFolderPickerDialog]}})})}),Wt=Object(St.e)(function(){return Object(i.t)(void 0,void 0,void 0,function(){return Object(i.i)(this,function(e){switch(e.label){case 0:return[4,n.ee([6,"ondemand.resx-ondemand"],745)];case 1:return[2,e.sent().WacOwlFilePickerDialog]}})})}),qt=Object(St.e)(function(){return Object(i.t)(void 0,void 0,void 0,function(){return Object(i.i)(this,function(e){switch(e.label){case 0:return[4,n.ee([4,"ondemand.resx-ondemand"],786)];case 1:return[2,e.sent().WacOwlLegacyHost]}})})}),Qt=new l.t(window.location.href),Yt="https://onedrive.live.com";!function(e){e.View="View",e.Edit="Edit",e.EditNew="EditNew",e.BinaryConvert="BinaryConvert"}(jt||(jt={}));var Jt=function(){function e(){var e,t,n;this._qosLogSent=!1,this._bootstrapQosLogSent=!1,this._shouldRedirectToOneUp=!1,this._diagnostics=this.collectDiagnostics(),this._dialogContainer=document.createElement("div"),this._dialogContainer.id="owl-dialog-container",document.body.append(this._dialogContainer),window.addEventListener("beforeunload",this.handleUserNavAway.bind(this)),this._bootstrapQos=new b.e({name:"WacODCOwlHost.Bootstrap"}),n=this.isFileMigrated()?"".concat(this.openInDocAspx()?"COBDOC":"COB",".WacOwl.Init"):"ODC.WacOwl.Init",this._qos=new b.e({name:n,startTimeOverride:null===(t=null===(e=this._diagnostics)||void 0===e?void 0:e.data)||void 0===t?void 0:t.hostInitializeCallTime})}return e.prototype.showShareDialog=function(e){var t=this.getShareDialogConfig(e);ut.render(pt.a.createElement(zt,{shareDialogProps:t,resourceScope:this._resourceScope}),this._dialogContainer)},e.prototype.showAtMentionDialog=function(e){throw new Error("Method not implemented.")},e.prototype.showMoveToFolderDialog=function(e){this._pickerEventHandler||this.initializePickerEventHandler();var t={item:this._wacDataSource.buildOneDriveItemFromResponse(this._item),isOwlRampEnabled:!0,message:e,pickerEventHandler:this._pickerEventHandler};ut.render(pt.a.createElement(Kt,{filePickerProps:t,resourceScope:this._resourceScope}),this._dialogContainer)},e.prototype.showSharedFilePickerDialog=function(e){this._pickerEventHandler||this.initializePickerEventHandler();var t={item:this._wacDataSource.buildOneDriveItemFromResponse(this._item),isOwlRampEnabled:!0,message:e,pickerEventHandler:this._pickerEventHandler};ut.render(pt.a.createElement(Wt,{filePickerProps:t,resourceScope:this._resourceScope}),this._dialogContainer)},e.prototype.onRename=function(e){return Object(i.t)(this,void 0,void 0,function(){var e,t,n,a,r,o;return Object(i.i)(this,function(i){switch(i.label){case 0:e=window.WacConfig,t=this.getDriveId(),n=this.getDocId(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this._wacOwlDataSource.getItem(t,n,e.OriginalMode.toLowerCase(),e.RelativePath,!0,w.r)];case 2:return a=i.sent(),[3,4];case 3:return r=i.sent(),o={wacErrorName:"VroomFailedToReturnItem",errorMessage:"Vroom failed to return an item on initial boot",error:r},this.onBootFailure(o),[2];case 4:return this.updateItemAndWacConfig(a,e.OriginalMode.toLowerCase()),document.title=e.PageTitleType.replace("{0}",this._item.name),[2]}})})},e.prototype.onFileEmbed=function(){return Object(i.t)(this,void 0,void 0,function(){var e;return Object(i.i)(this,function(t){return this._embedEventHandler||this.initializeEmbedEventHandler(),e={item:this._wacDataSource.buildOneDriveItemFromResponse(this._item),isOwlRampEnabled:!0,embedEventHandler:this._embedEventHandler},ut.render(pt.a.createElement(Gt,{embedDialogProps:e,resourceScope:this._resourceScope}),this._dialogContainer),[2]})})},e.prototype.getCustomAuthConfig=function(){var e=this.getTargetOrigin(),t={type:"webMsaWithAadProxy",login_Hint:window.$Config.email,appSignOutUrl:window.FilesConfig.autoRedeemSignOut,aad:{appId:"00000003-0000-0ff1-ce00-000000000000",wreply:e},msa:{siteId:250206,wreply:e}};return JSON.stringify(t)},e.prototype.fetchItemFromNetwork=function(e,t,n){return Object(i.t)(this,void 0,void 0,function(){var a,r,o=this;return Object(i.i)(this,function(i){switch(i.label){case 0:return t||!(e.docUrl&&e.docUrl===this._docUrl||e.driveId&&e.docId&&e.driveId===this.getDriveId()&&e.docId===this.getDocId())?[3,2]:[4,this.getItemInitialBoot()];case 1:return i.sent(),[2,this._item];case 2:return a=!!this._item.vault,r=n||"editnew"===e.intent?"editnew":"view"===e.intent?"view":(e.intent,"edit"),[2,new Promise(function(t,n){o._wacOwlDataSource.fetchItemFromNetwork(e,a,r).then(function(e){o.updateItemAndWacConfig(e,r),t(o._item)}).catch(function(e){var t="".concat("Failed to fetch").concat(e?": "+e.message:"");n({failure:"FetchItemFromNetworkFailed",message:t,retry:!0})})})]}})})},e.prototype.onUserActivity=function(){this._item.vault&&(this._vault||(this._vault=new lt.e(window.$Config.unid,this._wacDataSource)),this._vault.onUserActivity())},e.prototype.sendPerfTelemetry=function(){var e,t,n,a,i;if(Object(w.s)(w.f.WacSendPerformanceLog)&&(null===(e=this._diagnostics)||void 0===e?void 0:e.data)){var r,o,s=this._diagnostics.data;if(s.userClickTime)r=s.userClickTime;else{if(!s.hostPageNavigationStartTime)return;r=s.hostPageNavigationStartTime}o=this.isFileMigrated()?"".concat(this.openInDocAspx()?"COBDOC":"COB",".WacOwl.Perf"):"ODC.WacOwl.Perf";var c=function(e,t){new b.e({name:"".concat(o,".").concat(e),startTimeOverride:Date.now()-(t-r)}).end({resultType:b.t.Success,resultCode:"Success",extraData:{userClickTime:s.userClickTime,hostPageNavigationStartTime:s.hostPageNavigationStartTime,ServerStartTime:window.WacConfig.ServerStartTime?Number(window.WacConfig.ServerStartTime):void 0,name:e,time:t}})};s.userClickTime&&c("userClickTime",s.userClickTime),s.hostPageNavigationStartTime&&c("hostPageNavigationStartTime",s.hostPageNavigationStartTime),s.hostPageFirstFlushTime&&c("hostPageFirstFlushTime",s.hostPageFirstFlushTime),s.officeBootstrapperStartTime&&c("officeBootstrapperStartTime",s.officeBootstrapperStartTime),s.officeBootstrapperEndTime&&c("officeBootstrapperEndTime",s.officeBootstrapperEndTime),s.officeInitializationTime&&c("officeInitializationTime",s.officeInitializationTime),(null===(t=s.wacAppDiagnostics)||void 0===t?void 0:t.documentLoadedTime)&&c("documentLoadedTime",null===(n=s.wacAppDiagnostics)||void 0===n?void 0:n.documentLoadedTime),(null===(a=s.wacAppDiagnostics)||void 0===a?void 0:a.appCompletedTime)&&c("appCompletedTime",null===(i=s.wacAppDiagnostics)||void 0===i?void 0:i.appCompletedTime),s.wacHostCompleteTime&&c("wacHostCompleteTime",s.wacHostCompleteTime),s.serverStartTime&&(r=s.serverStartTime,s.serverStartTime&&c("serverStartTime",s.serverStartTime),s.pageTaskCompleteTime&&c("pageTaskCompleteTime",s.pageTaskCompleteTime),s.responseCompleteTime&&c("responseCompleteTime",s.responseCompleteTime))}},e.prototype.setWacDataCenterCookie=function(e){if(e&&e.hasOwnProperty("officeAppEndpoint")){var t=new Date;t.setTime(t.getTime()+15552e6);var n="; expires="+t.toUTCString(),a="WacDataCenter="+e.officeAppEndpoint+n+"; path=/";document.cookie=window.WacConfig.Unified.WacApplication+a,document.cookie=a}},e.prototype.logWacInitializationQoS=function(e,t,n,a){this.logWacInitQosEvent(e,t,n,a)},e.prototype.loadOwl=function(e){return void 0===e&&(e=!0),Object(i.t)(this,void 0,void 0,function(){var t=this;return Object(i.i)(this,function(n){return[2,new Promise(function(n,a){return Object(i.t)(t,void 0,void 0,function(){var t,r,o,s,c,d,l,u=this;return Object(i.i)(this,function(f){switch(f.label){case 0:t="OWL bootstrapper failed to load OWL",this._diagnostics.update({officeBootstrapperStartTime:Date.now()}),r=setTimeout(function(){return Object(i.t)(u,void 0,void 0,function(){return Object(i.i)(this,function(t){switch(t.label){case 0:if(!e||!w.t)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.loadOwl(!1)];case 2:return t.sent(),[3,4];case 3:return t.sent(),a("OWL bootstrapper retry timed out"),[3,4];case 4:return[3,6];case 5:a("OWL bootstrapper timed out"),t.label=6;case 6:return[2]}})})},1e4),f.label=1;case 1:return f.trys.push([1,3,,10]),[4,se(this.getWiseEnvironment(),null,null===(c=window.WacConfig.Unified)||void 0===c?void 0:c.WacApplication,Object(w.s)(w.f.EnableOWLManifestCaching),Object(w.s)(w.f.EnableOWLJsApiUnifiedBundle))];case 2:return f.sent(),clearTimeout(r),this._diagnostics.update({officeBootstrapperEndTime:Date.now()}),n(),[3,10];case 3:if(o=f.sent(),clearTimeout(r),!e||!w.t)return[3,8];f.label=4;case 4:return f.trys.push([4,6,,7]),[4,this.loadOwl(!1)];case 5:return f.sent(),[3,7];case 6:return s=f.sent(),a(s&&s.message?"".concat(s.message,": load OWL retry error, CDN Path: ").concat(null===(d=window.WacConfig.Unified)||void 0===d?void 0:d.WacBootstrapperUrl):"".concat(t," on retry")),[3,7];case 7:return[3,9];case 8:a(o&&o.message?"".concat(o.message,": load OWL error, CDN Path: ").concat(null===(l=window.WacConfig.Unified)||void 0===l?void 0:l.WacBootstrapperUrl):t),f.label=9;case 9:return[3,10];case 10:return[2]}})})})]})})},e.prototype.initializeDocumentBoot=function(){return Object(i.t)(this,void 0,void 0,function(){var e,t,n=this;return Object(i.i)(this,function(a){return e=this.loadOwl(),t=this.init(),Promise.all([e,t]).then(function(){n.bootDocument()}).catch(function(e){var t={wacErrorName:"ResourceInitializationFailed",errorMessage:"".concat(e||"Failed during initialization process"),error:e};n.onBootFailure(t)}),[2]})})},e.prototype.getBootParams=function(){return Object(i.t)(this,void 0,void 0,function(){var e;return Object(i.i)(this,function(t){switch(t.label){case 0:return e={},[4,this.getDocumentBootInfo()];case 1:return[2,(e.documentBootInfo=t.sent(),e.fetchItemFromNetwork=this.fetchItemFromNetwork.bind(this),e.fetchAccessToken=null,e.openShareControl=this.showShareDialog.bind(this),e.sessionConfig=this.getSessionConfig(),e.container=this.getOWLContainer(),e.createItem=null,e.setTitle=null,e.onBootComplete=this.onBootComplete.bind(this),e.onBootFailure=this.onBootFailure.bind(this),e.onReturnFocus=null,e.onDocumentClose=null,e.onSuccessNotification=null,e.onUserActivity=this.onUserActivity.bind(this),e.onCAAEMessage=null,e.onUserAccess=null,e.onMoveToFolder=this.showMoveToFolderDialog.bind(this),e.onSharedFilePicker=this.showSharedFilePickerDialog.bind(this),e.onRename=this.onRename.bind(this),e.uiHostConfig=this.getUiHostConfig(),e.fetchSharingLink=null,e.additionalApplicationParameters=null,e.sharingLinkTokenProvider=null,e.onFileEmbed=this.onFileEmbed.bind(this),e)]}})})},e.prototype.getWiseEnvironment=function(){var e=Object(r.t)();switch(e){case 4:case 3:case 2:case 1:return"FASTFOOD";case 0:return"PRODUCTION";default:throw new Error("Unexpected ODCEnvironment ".concat(e,"."))}},e.prototype.logErrorAndRedirectToErrorPage=function(e){var t=this;this.logError(e).then(function(){t.redirectToErrorPage()})},e.prototype.bootDocument=function(){this._item?this.isLegacyBootRequired()?this.bootDocumentLegacy():this.bootDocumentOwl():this.onBootFailure({wacErrorName:"FailedToFetchItem",errorMessage:"Failed to fetch item"})},e.prototype.bootDocumentOwl=function(){return Object(i.t)(this,void 0,void 0,function(){var e,t;return Object(i.i)(this,function(n){switch(n.label){case 0:return this._diagnostics.update({officeInitializationTime:Date.now()}),t=(e=window.Microsoft.Office.OWL).bootDocumentWithCustomFunctions,[4,this.getBootParams()];case 1:return t.apply(e,[n.sent()]),[2]}})})},e.prototype.bootDocumentLegacy=function(){var e,t,n=window.WacConfig,a=this._wacDataSource.buildOneDriveItemFromResponse(this._item),i=null===(t=null===(e=a.itemFromServer)||void 0===e?void 0:e.openWith)||void 0===t?void 0:t.wac;if(this.isFileMigrated()&&this.openInDocAspx()){var r=n.Unified.ApplicationUrl;(o={}).access_token=n.Unified.AccessToken,o.access_token_ttl=n.Unified.AccessTokenExpiry,o.owner_id=n.Unified.OwnerId,o.user_id=$Config.hcid,n.Legacy={Url:r,Params:o}}else if(this.isFileMigrated()&&a&&i){var o,s=this.getRedeem();r=this.addRequiredParamsToApplicationUrl(i.applicationUrl,a.size,s),(o={}).access_token=i.accessToken,o.access_token_ttl=i.accessTokenExpiry,o.owner_id=a.ownerId,o.user_id=$Config.hcid,n.Legacy={Url:r,Params:o}}else if(!n.Legacy||!i){var c=JSON.parse(n.GetItemsResponse).items[0],d="Edit"===n.OriginalMode,l=(r=d?c.urls.wacIframeEdit:c.urls.wacIframeView,{}),u=d?c.urls.wacIframeEditPostParameters:c.urls.wacIframeViewPostParameters;null==u||u.split("&").forEach(function(e){var t=e.split("=");l[decodeURIComponent(t[0])]=decodeURIComponent(t[1])}),n.Legacy={Url:r,Params:l}}var f=n.Legacy.Url,p=n.Legacy.Params,m=document.createElement("div");m.id="app",document.body.append(m),ut.render(pt.a.createElement(qt,{item:a,vault:this._vault,viewParams:this._viewParams,wacDataSource:this._wacDataSource,diagnostics:this._diagnostics,resources:this._resourceScope,applicationUrl:f,applicationParams:p,migrationState:this.isFileMigrated(),shareConfig:this.getShareDialogConfig()}),m)},e.prototype.getUiHostConfig=function(){return{hideHeader:!1,hideAppLauncherInHeader:!1,hideSearchInHeader:!1,hideMeInHeader:!1,hideChatInHeader:!0,hideWorkflowInHeader:!0,hideSettingsInHeader:!1,showAppIconInHeader:!1,useNeutralColorInHeader:!1,supportsAuthToken:!1,supportsAtMentions:!1,supportsAccessibilityLoop:!1,supportsExcelExternalLinks:!0,supportsCreateNewDocument:!1,showCloseButton:!1,openInBrowserEnabled:!1,supportsExplicitUnload:!0,supportsMoveToFolder:Object(w.s)(E.w)&&!Object(z.e)(Rt.t),supportsShare:!0,uiHostName:"onedrivecom",sessionOriginPrefix:"EDITASPX.UNIFIEDUIHOST.",uiHostIntegrationType:"editaspx",uiEmbed:!1,ellipsisDownloadACopyButtonEnabled:!1,openLinksInNewWindow:!1,copyLinkEnabled:!0,supportsPopAndPushState:!0,supportsCustomAuthConfig:!0,supportsCommonFilePicker:!0,supportsContentAssembly:!1,contentAssemblyMode:"",supportsHostUiControls:!0,supportsRefreshTokenReauthPopUp:!1,featureGates:new Map([["EcsHootGate",Object(w.s)(w.f.EnableModernAuthWebLoader)],["EnableOwlFrameBootTreatment",Object(w.s)(w.f.EnableModernAuthWebLoader)]])}},e.prototype.onBootComplete=function(e,t){this.setWacDataCenterCookie(t),this._diagnostics.update({wacAppDiagnostics:{appCompletedTime:t.appCompletedTime,documentLoadedTime:t.documentLoadedTime},wacHostCompleteTime:Date.now()}),this.logWacInitializationQoS(0,"Success"),window.g_WACOwlDone=!0,this.sendPerfTelemetry(),this.logWacBootstrapQosEvent(b.t.Success,"WacApplication bootstrap succeeds"),window.removeEventListener("beforeunload",this.handleUserNavAway.bind(this))},e.prototype.onBootFailure=function(e){window.g_WACOwlDone=!1,window.removeEventListener("beforeunload",this.handleUserNavAway.bind(this)),this._shouldRedirectToOneUp||(this.wacFrameExists()?this.logError(e):this.logErrorAndRedirectToErrorPage(e))},e.prototype.init=function(){var e=this;return new Promise(function(t){return Object(i.t)(e,void 0,void 0,function(){return Object(i.i)(this,function(e){switch(e.label){case 0:return Object(G.e)(),this.initResources(),[4,this.initWacOwlDataSources()];case 1:return e.sent(),[4,this.getItemInitialBoot()];case 2:return e.sent(),this.initTelemetry(),t(),[2]}})})})},e.prototype.initResources=function(){this._resourceScope=new x.n({owner:"WacODCOwlHost",useFactoriesOnKeys:!0}),this._resourceScope.exposeFactory(p.a,new C.e(O.e)),this._navigation=new f.e,this._viewParams=this._navigation.viewParams,this._resourceScope.expose(Ot.e,this._navigation),this._resourceScope.exposeFactory(p.a,new C.e(O.e)),this._resourceScope.expose(Dt.e,new(this._resourceScope.injected(g.e))),this._resourceScope.exposeFactory(p.d,new C.e(Dt.e)),this._resourceScope.exposeAsync(p.n,new C.t(function(){return n.ee([38],746).then(function(e){return e.resourceKey})})),this._resourceScope.expose(p.e,new(this._resourceScope.injected(Ht))),this._resourceScope.expose(It.t,new(this._resourceScope.injected(Ct)))},e.prototype.initTelemetry=function(){var e,t,a,i,r,o,s,c=this._resourceScope.consume(p.a).getIdentity().type===m.e.anonymous,d=window.WacConfig;if(s=c?V.e.ConsumerAnonymous:Object(z.e)($Config.hcid)?V.e.ConsumerOnSPO:V.e.Consumer,Object(G.n)({ClientName:"WacHost.".concat(null===(e=d.Unified)||void 0===e?void 0:e.WacApplication),Application:d.Application,Mode:d.Mode||d.OriginalMode,OriginalMode:d.OriginalMode,AccountType:V.e[s]}),Object(yt.t)()){var l=function(e){var t,n=Object(gt.n)(),a=n.ariaEnvironment,i=n.version,r=n.ariaContext,o=e.clientName,s="prod"===a?bt.e.prod:bt.e.ppe;return pe.e.isActivated("38C8B829-7622-44FB-B9DD-84B42DD7BCA4")?a&&"dev"!==i||Object(vt.E)(vt.s)?((t=Object(ht.e)({clientName:o,ariaEnvironment:a,ariaContext:r,tenantToken:s})).attach(Object(mt.e)()),t):null:a&&Object(yt.n)(r)?((t=Object(ht.e)({clientName:o,ariaEnvironment:a,ariaContext:r,tenantToken:s})).attach(Object(mt.e)()),t):null}({clientName:null===(t=d.Unified)||void 0===t?void 0:t.WacApplication});l&&l.updateContext({context:{customerPromiseSessionId:null===(a=d.Unified)||void 0===a?void 0:a.HostSessionId,accountType:V.e[s]}})}else{var u=function(e){var t=Object(gt.n)(),a=t.ariaEnvironment,i=t.version,r=t.ariaContext,o=e.clientName,s="prod"===a?bt.e.prod:bt.e.ppe;if(a&&"dev"!==i||Object(vt.E)(vt.s)){var c=Object(_t.t)({clientName:o,ariaEnvironment:a,ariaContext:r,ariaLoader:function(){return n.ee(1,747,7)},disableCookies:r.disableCookies,tenantToken:s});return c.attach(Object(mt.e)()),c}return null}({clientName:null===(i=d.Unified)||void 0===i?void 0:i.WacApplication});(null===(r=d.Unified)||void 0===r?void 0:r.HostSessionId)&&u&&u.updateContext({customerPromiseSessionId:null===(o=d.Unified)||void 0===o?void 0:o.HostSessionId,accountType:V.e[s]})}},e.prototype.initWacOwlDataSources=function(){return Object(i.t)(this,void 0,void 0,function(){var e,t,n,a,r,o,s,c;return Object(i.i)(this,function(d){switch(d.label){case 0:if(e=this.getDriveId(),this._wacDataSourceUrl=Object(u.n)({apiVersion:this.isFileMigrated()?"v2.0":"v1.0",driveId:e,includeViewerId:!1,migrationState:this.isFileMigrated()}),t=this._resourceScope.consume(p.a),n=t.getIdentity().type,a=n===m.e.anonymous,!this.getRedeem()||!this.isFileMigrated())return[3,5];d.label=1;case 1:return d.trys.push([1,4,,5]),a?[4,this.acquireBadgerToken()]:[3,3];case 2:r=d.sent(),d.label=3;case 3:return[3,5];case 4:return o=d.sent(),s={identityType:n},c={wacErrorName:"TokenAcquisitionFailed",errorMessage:"Failed to acquire badger or session token",error:o?Object(i.e)(Object(i.e)({},o),s):s},this.onBootFailure(c),[2];case 5:return this._wacOwlDataSource=new I(this._wacDataSourceUrl,t,r),this._wacDataSource=new j(this._wacDataSourceUrl,t,r),[2]}})})},e.prototype.getDocumentBootInfo=function(){var e,t,n;return Object(i.t)(this,void 0,void 0,function(){var r,o,s,c;return Object(i.i)(this,function(i){return r=window.WacConfig,o=this.getDriveId(),s=this.getDocId(),c=(window.WacConfig.Mode||window.WacConfig.OriginalMode).toLowerCase(),[2,{docId:s,driveId:o,docUrl:this._docUrl,fileName:null===(e=r.Unified)||void 0===e?void 0:e.FileName,shareId:"",shareUrl:"",baseUrl:this._wacDataSourceUrl,fileId:null,fileType:a[null===(t=r.Unified)||void 0===t?void 0:t.WacApplication],wdOrigin:this._diagnostics.data.entryPoint,market:window.$Config.mkt,puid:Object(w.s)(w.a)?r.Unified.UserId:void 0,clickTime:this._diagnostics.data.userClickTime,navId:null,wdValue:null,isNewFile:"EditNew"===r.OriginalMode||0===this._item.size,bootstrapperUrl:null===(n=r.Unified)||void 0===n?void 0:n.WacBootstrapperUrl,rebootOverrideData:null,newFileId:null,templateId:"",templateDriveId:null,intent:c}]})})},e.prototype.getItemInitialBoot=function(){var e,t,n,a;return Object(i.t)(this,void 0,void 0,function(){var r,o,s,c,d,u,f,p,m,_,h,b,g,v,y;return Object(i.i)(this,function(i){switch(i.label){case 0:return this._item?[2]:(r=window.WacConfig,o=this.getDriveId(),s=this.getDocId(),this.isFileMigrated()?this.openInDocAspx()?(b=r.Unified,this._docUrl=r.DavUrl,v=r.Vault,y={id:r.ParentId,driveId:o,path:""},this._item={id:b.ResourceId,eTag:b.ETag,name:b.FileName,parentReference:y,openWith:{wac:{accessToken:b.AccessToken,accessTokenExpiry:b.AccessTokenExpiry,applicationUrl:b.ApplicationUrl,appName:b.WacApplication,bootstrapperUrl:b.WacBootstrapperUrl,fileGetUrl:b.FileGetUrl,userId:b.UserId,wopiSrc:b.WopiSrc,driveId:o}},size:b.FileSize,vault:v},window.WacConfig.LegacyBoot=this.CheckBootWithJsApi(b.WacBootstrapperUrl,b.WacApplication,r.OriginalMode,b.ApplicationUrl)?0:1,r.UpdatedPageTitle&&(document.title=r.UpdatedPageTitle),window.history&&window.history.replaceState&&r.NewFilePath&&(c=new l.t(r.NewFilePath),d=c.getHost(),window.history.replaceState(null,document.title,c.toString().replace(d,window.location.host))),[3,10]):[3,1]:[3,11]);case 1:if(!(u=this.getRedeem()))return[3,5];i.label=2;case 2:return i.trys.push([2,4,,5]),[4,this._wacOwlDataSource.redeemAndGetItem(u,r.OriginalMode,w.n,Object(w.s)(w.e))];case 3:return(null==(f=i.sent())?void 0:f.error)?this.redirectToValidatePermissions(f.error,this._viewParams):f&&!f.error&&(this._item=f),[3,5];case 4:return p=i.sent(),h={wacErrorName:"RedeemCallFailed",errorMessage:"Redeem called failed",error:p},this.onBootFailure(h),[2];case 5:if(this._item)return[3,9];i.label=6;case 6:return i.trys.push([6,8,,9]),m=this,[4,this._wacOwlDataSource.getItem(o,s,r.OriginalMode.toLowerCase(),r.RelativePath,!0,w.r)];case 7:return m._item=i.sent(),[3,9];case 8:return _=i.sent(),h={wacErrorName:"VroomFailedToReturnItem",errorMessage:"Vroom failed to return an item on initial boot",error:_},this.onBootFailure(h),[2];case 9:this.redirectToOneUpPage(this._item),this._item.size&&0===this._item.size&&(r.OriginalMode="EditNew"),this.updateItemAndWacConfig(this._item,r.OriginalMode.toLowerCase()),this._docUrl=this._item.openWith.wac.webDavUrl||this._item.webDavUrl,this.updateUIForCOB(this._item),i.label=10;case 10:return[3,12];case 11:b=window.WacConfig.Unified,g=JSON.parse(r.GetItemsResponse).items[0],this._docUrl=g.davUrl,v=g.vault,o=(null===(e=g.parentReference)||void 0===e?void 0:e.driveId)||Object(xe.e)(o),y={id:g.parentId,driveId:o,path:""},this.isLegacyBootRequired()?this._item={id:g.id,eTag:g.etag,name:g.name,parentReference:y,openWith:{wac:{accessToken:null===(t=r.Legacy)||void 0===t?void 0:t.Params.access_token,accessTokenExpiry:null===(n=r.Legacy)||void 0===n?void 0:n.Params.access_token_ttl,applicationUrl:null===(a=r.Legacy)||void 0===a?void 0:a.Url,appName:r.Application,driveId:o}},size:g.size,vault:v}:this._item={id:b.ResourceId,eTag:b.ETag,name:b.FileName,parentReference:y,openWith:{wac:{accessToken:b.AccessToken,accessTokenExpiry:b.AccessTokenExpiry,applicationUrl:b.ApplicationUrl,appName:b.WacApplication,bootstrapperUrl:b.WacBootstrapperUrl,fileGetUrl:b.FileGetUrl,userId:b.UserId,wopiSrc:b.WopiSrc,driveId:o}},size:b.FileSize,vault:v},i.label=12;case 12:return[2]}})})},e.prototype.updateUIForCOB=function(e){var t,n=window.WacConfig;document.title=n.PageTitleType.replace("{0}",null==e?void 0:e.name);var a=void 0,i=JSON.parse(n.IconPathList);for(var r in i)if(-1!==i[r].key.indexOf(n.Application)){a=i[r].value;break}if(a){var o=document.head.querySelector('link[rel="icon"]');null!==o?o.href=a:((o=document.createElement("link")).rel="icon",o.href=a,o.type="image/x-icon",document.head.appendChild(o))}if(window.history&&window.history.replaceState){var s=new l.t(window.location.href);s.getQueryParameter("resid")&&(null===(t=n.viewParams)||void 0===t?void 0:t.id)&&s.setQueryParameter("resid",n.viewParams.id,!0),window.history.replaceState(null,document.title,s.toString())}},e.prototype.getSessionConfig=function(){var e,t=this._resourceScope.consume(p.a);return{hostCorrelationId:null===(e=window.WacConfig.Unified)||void 0===e?void 0:e.HostSessionId,isMsa:!0,tenantId:null,shareApiEndpoint:null,organizationName:null,metaUiHostVersion:"1",logger:null,health:null,sessionId:window.Flight.session,activityBasedTimeoutEnabled:!1,wacExcelJsApiV2Enabled:!0,wacWordJsApiV2Enabled:!0,wacPptJsApiV2Enabled:!0,experiments:null,highContrastMode:null,additionalApplicationParameters:null,bootDiagnostics:{isTestMode:!1,isOdcMigrated:this.isFileMigrated()},customAuthConfigValue:this.getCustomAuthConfig(),wiseEnvironment:this.getWiseEnvironment(),isSynthetic:!Object(yt.n)(Object(G.t)()),isAnonymous:Object(w.s)(w.a)?t.getIdentity().type===m.e.anonymous:null,upn:Object(w.s)(w.a)?$Config.email:null,origin:window.location.origin.toLowerCase()}},e.prototype.getOWLContainer=function(){var e=document.createElement("div");return e.id="WacContainer",document.body.appendChild(e),e},e.prototype.isFileMigrated=function(){return!!window.WacConfig.MigrationState||!!window.WacConfig.Migration},e.prototype.openInDocAspx=function(){return w.o&&window.WacConfig.UseDocAspx},e.prototype.isLegacyBootRequired=function(){var e=window.WacConfig;return!e.UseUnifiedApps||!e.Unified||e.LegacyBoot},e.prototype.acquireBadgerToken=function(){return Object(i.t)(this,void 0,void 0,function(){var e,t,n,a;return Object(i.i)(this,function(i){switch(i.label){case 0:return Object(w.s)(w.e)&&(e=s.get("BadgerAuth"))?[2,{authScheme:"badger",token:e,expiryTimeUtc:""}]:(t=2===Object(r.t)(),a=!pe.e.isActivated("60E6CDEB-32BC-448E-BC40-7FA1511C4147","10/19/2023","KillSwitch to use badger urls that are behind AFD"),n=a?"https://api-badger".concat(t?"d":"p",".svc.ms/v1.0/token"):"https://api.badger".concat(t?"d":"p",".svc.ms/v1.0/token"),[4,fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({appid:"00000000-0000-0000-0000-0000481710a4"})})]);case 1:return[4,i.sent().json()];case 2:return[2,i.sent()]}})})},e.prototype.redirectToValidatePermissions=function(e,t){var n;if(e&&e.innerError&&"sharingPasswordRequired"===e.innerError.code)if(new b.e({name:"WacOwl.RedirectToValidatePermissions",startTimeOverride:Date.now()}).end({resultType:b.t.Success,resultCode:"Success",error:""}),0===(null===(n=e["@error.fixItUrl"])||void 0===n?void 0:n.indexOf(Yt)))this._navigation.navigateTo(e["@error.fixItUrl"]);else{var a=new l.t(Yt);a.setQueryParameter("v","validatepermission",!0),a.setQueryParameter("redeem",this.getRedeem(),!0),a.setQueryParameter("migratedtospo","true",!0),a.setQueryParameter("cid",null==t?void 0:t.cid,!0),a.setQueryParameter("id",null==t?void 0:t.resid,!0),a.setQueryParameter("ithint",null==t?void 0:t.ithint,!0),this._navigation.navigateTo(a.toString())}},e.prototype.updateWacConfig=function(e){var t,n=window.WacConfig,a=e.openWith.wac;if(!a)return Object(h.e)("Error: the wopiInfo is ".concat(a,", can not get necessary info from it.")),!1;var r=this.CheckBootWithJsApi(a.bootstrapperUrl,a.appName,n.OriginalMode,a.applicationUrl);n.UseUnifiedApps=r?1:0,n.Application=a.appName;var o=e.id;if(n.RelativePath){var s=new l.t(n.CloseUrl);s.setQueryParameter("id",o),n.CloseUrl=s.toString(),(s=new l.t(n.FilePropertiesUrl)).setQueryParameter("id",o),n.FilePropertiesUrl=s.toString(),(s=new l.t(n.FileVersionUrl)).setQueryParameter("resid",o),n.FileVersionUrl=s.toString(),(s=new l.t(n.EditUrl)).setQueryParameter("resid",o),n.EditUrl=s.toString(),(s=new l.t(n.ViewUrl)).setQueryParameter("resid",o),n.ViewUrl=s.toString(),n.viewParams.id=o}try{var c="{0}",d=JSON.parse(n.PageTitleTypeList);for(var u in d){if("string"==typeof d[u]&&-1!==d[u].indexOf(a.appName)){c=d[u];break}if("object"==typeof d[u]&&-1!==d[u].key.indexOf(a.appName)){c=d[u].value;break}}n.PageTitleType=c}catch(e){Object(h.e)("json parse failed: ",e)}return n.Unified=r?Object(i.e)(Object(i.e)({},n.Unified),{WacApplication:a.appName,WacBootstrapperUrl:a.bootstrapperUrl,UserId:a.userId||$Config.hcid,OwnerId:a.ownerId,ApplicationUrl:a.applicationUrl,ETag:e.eTag,FileName:e.name,FileGetUrl:a.fileGetUrl,FileGetUrlExpiry:null===(t=a.fileGetUrlExpiry)||void 0===t?void 0:t.toString(),FileSize:e.size,WopiSrc:a.wopiSrc,AccessToken:a.accessToken,AccessTokenExpiry:a.accessTokenExpiry,ResourceId:o}):void 0,!0},e.prototype.CheckBootWithJsApi=function(e,t,n,a){var i=!1;return Object(w.s)(w.f.EnableWacUnifiedApps)&&e&&Object(w.u)(w.c,t,n)&&(i=!0,n===jt.Edit&&Object(w.s)(Object(w.l)(w.d,t))&&(a||(i=!1))),i},e.prototype.updateWacItem=function(e,t){var n=e.openWith.wac.applicationUrl;if(n||(n="view"===t?e.openWith.wac.viewUrl:e.openWith.wac.editUrl),n){var a=this.getRedeem();e.openWith.wac.applicationUrl=this.addRequiredParamsToApplicationUrl(n,e.size,a),e.openWith.wac.appName=e.openWith.wac.appName||e.name&&this.getAppNameFromDocumentType(function(e){if(!e)return _e.e.Word;var t,n=(t=me.e(e.split(".").pop()),Ie[t]);return n===be?_e.e.OneNote:n===ge?_e.e.PowerPoint:n===ve?_e.e.Excel:n===ye?_e.e.Visio:_e.e.Word}(e.name))}return e},e.prototype.addRequiredParamsToApplicationUrl=function(e,t,n){if(!this.isFileMigrated()||!e)return e;var a=new l.t(e);0===t&&a.setQueryParameter("new","1",!0);try{var r=void 0;try{r=(r=JSON.parse(a.getQueryParameter("sc")))?Object(i.e)(Object(i.e)({},r),{pmo:r.pmo||Yt}):{pmo:Yt},n&&(r.redeem=n)}catch(e){r={pmo:Yt}}finally{a.setQueryParameter("sc",encodeURIComponent(JSON.stringify(r)),!0)}}catch(e){Object(h.e)("can not add sessionContext: ",e)}!pe.e.isActivated("F1ECDFC1-79AA-4298-BF16-D19171FA771C","3/8/2023","KillSwitch to Update Language Param from mkt")&&$Config.mkt&&(a.setQueryParameter("ui",$Config.mkt,!0),a.setQueryParameter("rs",$Config.mkt,!0));var o=Qt.getQueryAsObject();for(var s in o)s.startsWith("wd")&&Qt.getQueryParameter(s)&&!a.getQueryParameter(s)&&a.setQueryParameter(s,Qt.getQueryParameter(s),!0);return a.toString()},e.prototype.getAppNameFromDocumentType=function(e){switch(e){case _e.e.Word:return"Word";case _e.e.Excel:return"Excel";case _e.e.PowerPoint:return"PowerPoint";case _e.e.Visio:return"Visio";default:return""}},e.prototype.collectDiagnostics=function(){var e,t=this.collectWacEntry(),n=window.WacConfig;if((e=t?new T(t.entryPoint,t.clickTime):new T).update({serverStartTime:(null==n?void 0:n.ServerStartTime)?Number(null==n?void 0:n.ServerStartTime):void 0,pageTaskCompleteTime:(null==n?void 0:n.WacPageTaskCompleteTime)?Number(null==n?void 0:n.WacPageTaskCompleteTime):void 0,responseStartTime:$Config.pageResponseStartTime?Number($Config.pageResponseStartTime):void 0,responseCompleteTime:$Config.pageResponseCompleteTime?Number($Config.pageResponseCompleteTime):void 0,hostPageFirstFlushTime:Date.now()}),window.performance&&window.performance.timing){var a=window.performance.timing;e.update({hostPageFetchStartTime:a.fetchStart,hostPageNavigationStartTime:a.navigationStart})}return e},e.prototype.collectWacEntry=function(){var e,t,n="SDX.Skydrive*Root";try{var a="ODCWac_ST",i=localStorage.getItem(a);if(i)return localStorage.removeItem(a),{entryPoint:n,clickTime:Number(i)};var r=c.a.get("BP"),o=d.e(r),s=o.ST,u=o.FR;if(s&&u&&(u.indexOf("WC.Hotmail*WACCopy")>-1||u.indexOf(n)>-1))return{clickTime:Number(s),entryPoint:u};if(null===(t=null===(e=window.WacConfig)||void 0===e?void 0:e.Unified)||void 0===t?void 0:t.ApplicationUrl){var f,p=new l.t(window.WacConfig.Unified.ApplicationUrl);if(f=p.getQueryParameter("wdorigin")||p.getQueryParameter("wdOrigin"))return{entryPoint:f}}return Qt&&this.isFileMigrated()&&(f=(null==Qt?void 0:Qt.getQueryParameter("wdorigin"))||(null==Qt?void 0:Qt.getQueryParameter("wdOrigin")))?{entryPoint:f}:{entryPoint:"Other"}}catch(e){return{entryPoint:"Other"}}},e.prototype.logWacBootstrapQosEvent=function(e,t){this._bootstrapQosLogSent||(this._bootstrapQosLogSent=!0,this._bootstrapQos.end({resultType:e,resultCode:t,extraData:{diagnostics:this._diagnostics.data}}))},e.prototype.logWacInitQosEvent=function(e,t,n,a){var i,r,o,s=window.WacConfig,c=this.convertResultType(e);this._qosLogSent||(this._qosLogSent=!0,this._qos.end({resultType:c,resultCode:t,error:JSON.stringify({errorMessage:n,errorObject:a})}),new U.e({scenario:"DocOpenODC",extraData:{clientId:null===(i=window.WacConfig.Unified)||void 0===i?void 0:i.WacApplication}}).end({resultType:c,errorCode:t,extraData:{HostSessionId:null===(r=s.Unified)||void 0===r?void 0:r.HostSessionId,FileSize:null===(o=s.Unified)||void 0===o?void 0:o.FileSize,errorInfo:n,error:a?JSON.stringify(a):"",action:s.Mode||s.OriginalMode,session:window.Flight.session,xid:window.Flight.xid}}))},e.prototype.convertResultType=function(e){switch(e){case 0:return b.t.Success;case 2:return b.t.ExpectedFailure;default:return b.t.Failure}},e.prototype.getDriveId=function(){var e,t;return this.isFileMigrated()&&((null===(e=window.WacConfig.viewParams)||void 0===e?void 0:e.driveid)||(null===(t=this._viewParams)||void 0===t?void 0:t.driveid))||this.getCid()},e.prototype.getCid=function(){var e,t;return(null===(e=window.WacConfig.viewParams)||void 0===e?void 0:e.cid)||(null===(t=this._viewParams)||void 0===t?void 0:t.cid)},e.prototype.getDocId=function(){var e,t;return(null===(e=window.WacConfig.viewParams)||void 0===e?void 0:e.id)||(null===(t=this._viewParams)||void 0===t?void 0:t.resid)},e.prototype.getRedeem=function(){var e,t;return(null===(e=this._viewParams)||void 0===e?void 0:e.redeem)||(null===(t=window.WacConfig)||void 0===t?void 0:t.Redeem)},e.prototype.initializePickerEventHandler=function(){var e=this.getWacFrame();if(e){var t=e.contentWindow,n=this.getTargetOrigin();this._pickerEventHandler=new st(t,n)}else Object(h.e)("Cannot find the iframe for WAC. Skip.")},e.prototype.initializeEmbedEventHandler=function(){var e=this.getWacFrame();if(e){var t=e.contentWindow,n=this.getTargetOrigin();this._embedEventHandler=new ct(t,n)}else Object(h.e)("Cannot find the iframe for WAC. Skip.")},e.prototype.getWacFrame=function(){var e=document.getElementById("owl-container");if(!e)throw Error();for(var t=0;t<e.children.length;t++)if("IFRAME"===e.children[t].tagName)return e.children[t]},e.prototype.getTargetOrigin=function(){var e;return new URL(null===(e=window.WacConfig.Unified)||void 0===e?void 0:e.ApplicationUrl).origin},e.prototype.updateItemAndWacConfig=function(e,t){if(e.openWith)e.openWith.wac?(this._item=this.updateWacItem(e,t),this._docUrl=e.openWith.wac.webDavUrl||e.webDavUrl,this.updateWacConfig(e)):(n={wacErrorName:"VroomFailedToReturnOpenWithWac",errorMessage:"Vroom response failed to return openWith.wac object required to boot"},this.onBootFailure(n));else{var n={wacErrorName:"VroomFailedToReturnOpenWith",errorMessage:"Vroom response failed to return openWith object required to boot"};this.onBootFailure(n)}},e.prototype.getShareDialogConfig=function(e){var t,n,a,i,r,o,s,c=this._viewParams.sharedevhost,d="https://www.onedrive.com";return(c||1===(null===(t=window.Flight.Ramps)||void 0===t?void 0:t.WacUseShareTestEndpoint))&&(d="https://www.onedrive-tst.com"),{origin:d,devHost:c,itemName:(null===(n=window.WacConfig.Unified)||void 0===n?void 0:n.FileName)||this._item.name,listItemId:(null===(a=window.WacConfig.Unified)||void 0===a?void 0:a.ResourceId)||this._item.id,correlationId:null==e?void 0:e.shareCorrelationId,mode:null==e?void 0:e.mode,navId:null==e?void 0:e.navId,contextualSharingContext:null==e?void 0:e.contextualSharingContext,contextualSharingLocation:null==e?void 0:e.contextualSharingLocation,clickTime:null==e?void 0:e.clickTime,isOwlRampEnabled:!!e,listId:null===(i=null==e?void 0:e.item)||void 0===i?void 0:i.listId,itemId:null===(r=null==e?void 0:e.item)||void 0===r?void 0:r.listItemId,uniqueId:null===(o=null==e?void 0:e.item)||void 0===o?void 0:o.listItemUniqueId,siteUrl:null===(s=null==e?void 0:e.item)||void 0===s?void 0:s.siteUrl,migrationState:this.isFileMigrated()}},e.prototype.handleUserNavAway=function(){window.g_WACOwlDone||this.logWacInitializationQoS(2,"UserNavAway","User navigate away")},e.prototype.wacFrameExists=function(e){var t=document.getElementById("WacContainer");if(!t)return!1;e||(e=t.children.namedItem("owl-container")||t);for(var n=0;n<e.children.length;n++)if("IFRAME"===e.children[n].tagName&&e.children[n])return!0;for(var a=0;a<e.children.length;a++)if("DIV"===e.children[a].tagName&&this.wacFrameExists(e.children[a]))return!0;return!1},e.prototype.logError=function(e){var t=this;return new Promise(function(n){return Object(i.t)(t,void 0,void 0,function(){var t,a,r,o;return Object(i.i)(this,function(i){return t="".concat(e.errorMessage),a=e.wacErrorName?e.wacErrorName:"UnknownFailure",r=1,((null===(o=e.error)||void 0===o?void 0:o.httpStatus)&&this.isExpectedVroomError(e.error.httpStatus)||this.isExpectedWacError(e))&&(r=2),this.logWacInitializationQoS(r,a,t,e.error),this.logWacBootstrapQosEvent(this.convertResultType(r),"WacApplication bootstrap failed"),n(),[2]})})})},e.prototype.redirectToErrorPage=function(){this._navigation.navigateTo("https://onedrive.live.com/error.html")},e.prototype.redirectToOneUpPage=function(e){var t;if(w.i&&e&&e.name&&!(null===(t=e.openWith)||void 0===t?void 0:t.wac)){var n=e.name.lastIndexOf(".");(n<0||n>=0&&!Object(Vt.e)(e.name.substring(n)))&&(this._shouldRedirectToOneUp=!0)}if(this._shouldRedirectToOneUp){new b.e({name:"WacOwl.RedirectToOneUp",startTimeOverride:Date.now()}).end({resultType:b.t.Success,resultCode:"Success",error:""});var a=new l.t("https://onedrive.live.com");a.setQueryParameter("cid",this.getCid()),a.setQueryParameter("id",this.getDocId()),this._navigation.navigateTo(a.toString())}},e.prototype.isExpectedVroomError=function(e){switch(e){case 401:case 403:case 404:case 429:return!0;default:return!1}},e.prototype.isExpectedWacError=function(e){return!!(e.error.errorCode&&Bt(e.error.errorCode)||e.error.errorType&&Bt(e.error.errorType))},e}();function Xt(){return Object(i.t)(this,void 0,void 0,function(){var e,t;return Object(i.i)(this,function(n){try{return(e=new Jt).initializeDocumentBoot(),[2]}catch(n){if(!e)return console.log("Failed to initialize WacODCOwlHost object"),[2];t={wacErrorName:"FailedToLoadOwl",errorMessage:"Failed to load OWL",error:n},e.logErrorAndRedirectToErrorPage(t)}return[2]})})}w.o&&window._spPageContextInfo&&window.isCreateNew?self.initWacHost?Xt():self.initWacHost=Xt:Xt()},function(e,t,n){"use strict";var a;n.r(t),n.d(t,"OneDSEndpoint",function(){return a}),n.d(t,"EventThrottler",function(){return T}),n.d(t,"getCorrespondingCCCOEndpoint",function(){return H}),n.d(t,"OneDSHelper",function(){return R}),n.d(t,"OneDSSink",function(){return Y}),n.d(t,"Sampler",function(){return X}),n.d(t,"OsPlugin",function(){return ee}),n.d(t,"DNMHandler",function(){return ne}),n.d(t,"CustomerContentHandler",function(){return ae}),function(e){e.USGOV_DOD="https://pf.events.data.microsoft.com/OneCollector/1.0/",e.USGOV_DOJ="https://tb.events.data.microsoft.com/OneCollector/1.0/",e.PUBLIC="https://browser.events.data.microsoft.com/OneCollector/1.0/",e.CUSTOMER_CONTENT="",e.EUDB="https://eu-office.events.data.microsoft.com/OneCollector/1.0/"}(a||(a={}));var i=n(13),r=n(48),o=n(1),s=n(74),c="Release.AudienceGroup",d="App.Name",l="App.Platform",u="App.Version",f="User.PrimaryIdentityHash",p="User.PrimaryIdentitySpace",m="User.TenantId",_="User.IsAnonymous",h="User.IsSignedIn",b="f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",g="b22a201c3f1d41d28ccc399ba6cc9ca2-1972c77f-1f79-4283-a0f9-b4ddc4646f55-7121",v=void 0;function y(e,t,n,a){var i=!0;if(t)for(var o=function(t){var o,s=t.classification,c=t.dataType,d=t.name;if(s&&!(4===s||1===s||2===a&&32===s||3===a&&2048===s))return i=!1,"break";if(3===a&&n&&3!==c&&1!==c&&2!==c&&"OTelJS.Version"!==d&&"OTelJS.Sink"!==d)return Object(r.t)(0,1,function(){return"DNM: Invalid field type "+d}),i=!1,"break";o=n?"zC."===d.substr(0,3)?"zC.Data."+d.substr(3):"Data."+d:d;var l=void 0;switch(c){case 3:l=6;break;case 2:l=4;break;case 4:l=8;break;case 0:return e[o]="string"==typeof t.value?t.value.substr(0,25e3):t.value,"continue";default:return e[o]=t.value,"continue"}var u={value:t.value,propertyType:l};e[o]=u},s=0,c=t;s<c.length&&"break"!==o(c[s]);s++);return i}function S(e,t){try{return e()}catch(e){return Object(r.e)(1,"1DS Sink",e),t}}function D(e){return e.timestamp?new Date(e.timestamp):new Date}function I(e,t){for(var n=function(n){var a=t[n];if(!a.processEvent(e))return Object(r.t)(2,1,function(){return"".concat(e.eventName," suppressed by ").concat(a.name)}),{value:!1}},a=0;a<t.length;a++){var i=n(a);if("object"==typeof i)return i.value}return!0}function x(e){Object(r.t)(0,1,function(){return"Invalid "+e})}function C(e){return Object(o.v)(e)&&""!=e}function O(e,t){return Object.values(t).includes(e)}function w(e){return O(e,s.s)}function E(e){return O(e,s.a)}function A(e){return["MSACID","MSAPUID","OrgIdCID","OrgIdPUID","UserObjectId","Other"].includes(e)}function L(e){return!e||"Other"==e}function k(e,t){var n=!0;function a(t,a){a(e[t])||(x(t),n=!1)}function i(e){return new RegExp("^[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}$",t?"":"i").test(e)}return a(d,C),a(l,t?w:C),a(u,C),a("Session.Id",i),t?(a(c,E),a(h,o.l),e[h]?(a(f,C),a(p,A),["OrgIdCID","OrgIdPUID","UserObjectId"].includes(e[p])?a(m,i):a(m,o.h)):(a(p,L),a(m,o.h))):e[_]||!1===e[h]||(a(f,C),a(p,C),e[m]&&a(m,i)),Object(o.h)(e[_])||e[h]!==e[_]||(x(_),n=!1),n}var M="Office.Telemetry.OTelJS.EventThrottled";function P(e){return"number"==typeof e}var T=function(){function e(e,t){this._sinkName=e,this._telemetrySink=t,this.name="EventThrottler",this._totalEventsInLastInterval=0,this._singleEventInLastInterval={},this._eventThrottleReported={},this._lastIntervalStart=Date.now(),this._maxNamedEventsPerSecond={}}return e.prototype.setSingleEventThrottle=function(e){this._maxSingleEventPerSecond=e},e.prototype.setTotalEventThrottle=function(e){this._maxTotalEventsPerSecond=e},e.prototype.setNamedEventThrottle=function(e,t){this._maxNamedEventsPerSecond[e]=t},e.prototype.processEvent=function(e){var t=e.eventName;if(t===M)return!0;var n=!0;return Date.now()-this._lastIntervalStart>1e3&&(this._lastIntervalStart=Date.now(),this._totalEventsInLastInterval=0,this._singleEventInLastInterval={}),this._singleEventInLastInterval[t]=this._singleEventInLastInterval[t]+1||1,t in this._maxNamedEventsPerSecond?n=this.applyThrottle(this._singleEventInLastInterval[t],this._maxNamedEventsPerSecond[t],"MaxNamedEventsPerSecond",t):P(this._maxSingleEventPerSecond)&&(n=this.applyThrottle(this._singleEventInLastInterval[t],this._maxSingleEventPerSecond,"MaxSingleEventsPerSecond",t)),P(this._maxTotalEventsPerSecond)&&(this._totalEventsInLastInterval++,n&&(n=this.applyThrottle(this._totalEventsInLastInterval,this._maxTotalEventsPerSecond,"MaxTotalEventsPerSecond",t))),n},e.prototype.applyThrottle=function(e,t,n,a){return!(e>t&&(e===t+1&&this._telemetrySink&&!this._eventThrottleReported[a]&&(this._eventThrottleReported[a]=!0,this._telemetrySink.sendTelemetryEvent({eventName:M,telemetryProperties:{ariaTenantToken:b,nexusTenantToken:1723},eventFlags:{diagnosticLevel:110},dataFields:[Object(i.i)("SinkName",this._sinkName||""),Object(i.i)("ThrottledEvent.Name",a),Object(i.a)(n,t)]})),Object(r.t)(2,1,function(){return"1DS Sink Event Throttle: Exceeded ".concat(t," ").concat(n,": ").concat(a)}),1))},e}(),U=n(93),F=n(155);function H(e){switch(e){case a.PUBLIC:return"https://office-c.events.data.microsoft.com/OneCollector/1.0/";case a.EUDB:return"https://eu-office-c.events.data.microsoft.com/OneCollector/1.0/";default:return}}var R=function(e,t){var n=this;this.eventsProcessed=0,this.eventsSent=0,this.eventsDiscarded=0;var a=[],i=!1,o=!0,c={name:"DiagnosticLevel",processEvent:function(e){var t=e.eventFlags.diagnosticLevel;return i||10===t||110===t||120===t}},d={},l=Object(F.t)();this.init=function(e){return k(d,!1)},this.begin=function(){return o=o&&k(d,!0)},this.getOneDSTelemetryEvent=function(e){return u(e,{eventType:1})},this.getOneDSCustomerContent=function(e){var t=e.telemetryProperties.customerContentVersion;if(t&&Math.floor(t)<=2&&1===e.telemetryProperties.customerContentType)return u(e,{eventType:2})};var u=function(e,t){if(o){var i=Object(U.n)(e);if(I(i,a)){var s=D(i).toISOString(),c={"Event.Name":i.eventName,"Event.Source":"OTelJS","Event.Time":{value:s,propertyType:9}};for(var u in n.eventsProcessed++,c["Event.Sequence"]={value:n.eventsProcessed,propertyType:4},c["Event.Id"]=l+"."+n.eventsProcessed,d)c[u]=d[u];if(!y(c,i.dataFields,!0,t.eventType))return void Object(r.t)(0,1,function(){return"Dropping Event: "+i.eventName});var f="custom";i.eventContract&&(i.eventContract.name&&(c["Event.Contract"]=i.eventContract.name,f+="."+i.eventContract.name.toLowerCase().replace(/\./g,"_")),y(c,i.eventContract.dataFields,!1,t.eventType));var p=function(e,t){return 2===t?g:e.telemetryProperties&&(1!==t||e.telemetryProperties.ariaTenantToken)?1===t?e.telemetryProperties.ariaTenantToken:void 0:void Object(r.t)(0,1,function(){return"Missing Aria Token"})}(i,t.eventType);if(!p)return;return{iKey:p,name:i.eventName,data:c,time:s,baseType:f,ext:{sdk:{seq:n.eventsProcessed}}}}}};this.addPreprocessor=function(e){a.push(e)},this.getOneDSPersistentDataFields=function(){return d},this.getPreprocessors=function(){return a};var f=function(e){y(d,e,!1,1)};this.addPersistentDataFields=f,this.setOptionalEventsEnabled=function(e){i=e},this.setFullEventsEnabled=this.setOptionalEventsEnabled,t.enableOptionalEvents&&(i=!0),f(e);var p=t.coreFields;if(p){f(s.t.getFields(p.app)),f(s.u.getFields(p.user)),f(s.l.getFields(p.session));var m=p.release;m&&f(s.c.getFields(m))}this.addPreprocessor(c)},N=n(0),B=n(375),j=n(374),V="HttpManager:_sendBatches",z="PrivacyGuard:_processTelemetry",G=function(){function e(e,t,n){this.start=Date.now(),this.name=e,this.isAsync=!0===n,this.payload=t}return e.prototype.isChildEvt=function(){return!1},e.prototype.complete=function(){this.time=Date.now()-this.start,this.exTime=this.time},e}(),K=function(){function e(e){this._callbacks=e}return e.prototype.create=function(e,t,n){return e===V||e===z?new G(e,t,n):null},e.prototype.fire=function(e){if(e&&e.complete(),this._callbacks)switch(e.name){case V:this.handleSendBatches(e);break;case z:this.handlePrivacyGuardNotification(e)}},e.prototype.setCtx=function(e,t){},e.prototype.getCtx=function(e){},e.prototype.handleSendBatches=function(e){if(this._callbacks.requestProcessingStats){var t=0;if(e.payload){var n=e.payload();if(n.batches)for(var a in n.batches)t+=n.batches[a].evts.length}this._callbacks.requestProcessingStats(e.time||0,t)}},e.prototype.handlePrivacyGuardNotification=function(e){this._callbacks.privacyGuardStats&&e.time&&e.time>0&&this._callbacks.privacyGuardStats(e.time)},e}();function W(e,t){var n=e.httpXHROverride,a={instrumentationKey:t,endpointUrl:e.endpointUrl,channelConfiguration:{eventsLimitInMem:e.eventsLimitInMem,httpXHROverride:n,setTimeoutOverride:e.setTimeoutOverride,clearTimeoutOverride:e.clearTimeoutOverride,ignoreMc1Ms0CookieProcessing:!0,disableOptimizeObj:!0},enableWParam:!n,disableCookiesUsage:!0,extensionConfig:Object(N.e)({},e.extensionConfig)};e.stats&&e.stats.networkStats&&a.channelConfiguration&&(a.channelConfiguration.payloadListener=function(t,n){var a,i=n||t;i.data&&(null===(a=e.stats)||void 0===a||a.networkStats(i.data.length))});var i=new Q;return i.initialize(a,e.plugins),i.setUploadFrequency(e.uploadFrequency),e.notificationListener&&i.addNotificationListener(e.notificationListener),e.stats&&i.setPerfMgr(new K(e.stats)),i}var q=function(e,t){t&&t.addNotificationListener({eventsSent:function(t){Object(r.t)(2,2,function(){return"Successfully sent ".concat(t.length," event(s)")}),Object(r.t)(3,2,function(){return"Sent event(s) details : ".concat(JSON.stringify(t,null,2))}),e.eventsSent+=t.length},eventsDiscarded:function(t,n){Object(r.t)(0,2,function(){return"Discarded ".concat(t.length," event(s) because ").concat(n)}),Object(r.t)(3,2,function(){return"Discarded event(s) details : ".concat(JSON.stringify(t,null,2))}),e.eventsDiscarded+=t.length}})},Q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(N.a)(t,e),t.prototype.initialize=function(t,n){this._postChannel=new j.e;var a=null!=n?n:[];t.channels=[[this._postChannel]],t.extensionConfig=t.extensionConfig||[],t.extensionConfig[this._postChannel.identifier]=Object(N.e)(Object(N.e)({},t.channelConfiguration),t.extensionConfig[this._postChannel.identifier]);try{e.prototype.initialize.call(this,t,a)}catch(e){this.logger.warnToConsole("Failed to initialize SDK."+e)}},t.prototype.setUploadFrequency=function(e){if(this._postChannel&&e){var t=e/1e3,n=t/2,a={};a.OTelCustomTransmissionProfile=[t,n],this._postChannel._loadTransmitProfiles(a),this._postChannel._setTransmitProfile("OTelCustomTransmissionProfile")}},t.prototype.flush=function(e){this._postChannel&&this._postChannel.flush(e)},t.prototype.shutdown=function(){this._postChannel&&this._postChannel.teardown()},t}(B.e),Y=function(e){function t(t,n){var a,i=e.call(this,t,n)||this;i.sendTelemetryEvent=function(e){return S(function(){var t=i.getOneDSTelemetryEvent(e);t&&a&&a.track(t)},v)},i.sendCustomerContent=function(e){},i.sendNonStandardEvent=function(e,t){var n=!1;o.forEach(function(a){a.canHandle(t)&&(a.processEvent(e),n=!0)}),n||Object(r.t)(0,1,function(){return"Missing Handler for "+t+"to process"+e.eventName})},i.flush=function(e){null==a||a.flush(e),o.forEach(function(t){t.flush(e)})},i.shutdown=function(){try{null==a||a.shutdown(),o.forEach(function(e){e.shutdown()})}catch(e){Object(r.t)(0,2,function(){return"An error occurred on shutdown"})}};var o=n.nonStandardEventHandlers||[];if(a=W(n,b),o.forEach(function(e){e.initialize(i,n)}),!n.endpointUrl)throw new Error("Missing Endpoint Url");return n.disableStatsTracking||q(i,a),i}return Object(N.a)(t,e),t}(R),J=1e3,X=function(){function e(){this.name="Sampler",this.sampleRate=.02}return e.prototype.enableWithIdentifier=function(e,t){return!("string"!=typeof t||t.length<4||(this.samplingValue=function(e){return function(e){for(var t=5381,n=0;n<e.length;n++)t=(t<<5)+t+e.charCodeAt(n);return t>>>0}(e)%J/J}(t),this.samplingKey=e,0))},e.prototype.enableWithSamplingValue=function(e,t){return!(isNaN(t)||t<0||t>=1||(this.samplingValue=t,this.samplingKey=e,0))},e.prototype.enableWithRandomValue=function(){var e=new Uint32Array(1);return!("object"!=typeof window||!window.crypto||(window.crypto.getRandomValues(e),this.samplingValue=e[0]%J/J,this.samplingKey="Random",0))},e.prototype.setSampleRate=function(e){return e>=0&&e<=1&&(this.sampleRate=e,!0)},e.prototype.getSamplingValue=function(){return this.samplingValue},e.prototype.isMeasuresEnabled=function(){return void 0===this.samplingValue||this.samplingValue<this.sampleRate},e.prototype.processEvent=function(e){var t=e.eventFlags.samplingPolicy;return void 0===this.samplingValue||void 0===t||(1===t?!!this.isMeasuresEnabled()&&(this.addSampleRateField(e,this.sampleRate,this.samplingValue),!0):2!==t&&(this.addSampleRateField(e,1,this.samplingValue),!0))},e.prototype.addSampleRateField=function(e,t,n){e.eventContract||(e.eventContract={name:"",dataFields:[]});var a=e.eventContract.dataFields;a.push(Object(i.t)("Event.SampleRate",t)),a.push(Object(i.t)("Session.SamplingValue",n)),this.samplingKey&&a.push(Object(i.i)("Session.SamplingKey",this.samplingKey)),a.push(Object(i.e)("Session.MeasuresEnabled",this.isMeasuresEnabled()))},e}();function Z(){var e;return Object(N.t)(this,void 0,void 0,function(){return Object(N.i)(this,function(t){switch(t.label){case 0:return navigator.userAgent&&navigator.userAgent.indexOf("Windows")>0&&(null===(e=navigator.userAgentData)||void 0===e?void 0:e.getHighEntropyValues)?[4,navigator.userAgentData.getHighEntropyValues(["platformVersion"]).then(function(e){return parseInt(e.platformVersion.split(".")[0],10)>=13}).catch(function(e){return!1})]:[3,2];case 1:return[2,t.sent()];case 2:return[2,!1]}})})}var $,ee=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.identifier="Windows11",t.priority=449,t._isWindows11=!1,t}return Object(N.a)(t,e),t.prototype.processTelemetry=function(e,t){this._isWindows11&&(e.ext=e.ext||{},e.ext.os=e.ext.os||{},e.ext.os.name="Windows 11");var n=this._getTelCtx(t);this.processNext(e,n)},t.prototype.detectOs=function(){return Object(N.t)(this,void 0,void 0,function(){var e;return Object(N.i)(this,function(t){switch(t.label){case 0:return e=this,[4,Z()];case 1:return e._isWindows11=t.sent(),[2]}})})},t}(n(270).e),te=(($={})[3]=d,$[4]=l,$[5]=u,$[2]="WAC.Ring",$[1]=c,$),ne=function(){function e(t){var n,a,i=this;this.eventsProcessed=0,this.initialize=function(e,i){var r=Object(N.e)(Object(N.e)({},i),{endpointUrl:t.endpointUrl,extensionConfig:Object(N.e)(Object(N.e)({},i.extensionConfig),{PrivacyGuardPlugin:{}}),plugins:[],nonStandardEventHandlers:[]});n=W(r,"67074e509c164bcaaf85b53c0ad0cde2-13c1c869-7901-4e72-b536-9e754e3b7413-6518"),r.disableStatsTracking||q(e,n),a=e},this.shutdown=function(){null==n||n.shutdown()},this.flush=function(e){null==n||n.flush(e)},this.canHandle=function(e){return 3===e},this.processEvent=function(t){return i.eventsProcessed++,S(function(){var i=function(t){var n,i=Object(U.n)(t),o=[];if(a.getPreprocessors().forEach(function(e){"EventThrottler"===e.name&&o.push(e)}),I(i,o)){var s=e.getDnmTimestamp(i),c={"Event.Name":i.eventName,"Event.Source":"OTelJS","Event.Time":{value:s.toISOString(),propertyType:9}},d=function(e,t){var n={};return t&&t.forEach(function(t){var a=te[t];n[a]=e[a]}),n}(a.getOneDSPersistentDataFields(),null===(n=null==t?void 0:t.telemetryProperties)||void 0===n?void 0:n.dnmAllowedPartA);for(var l in d)c[l]=d[l];if(!y(c,i.dataFields,!0,3))return void Object(r.t)(0,1,function(){return"Dropping Event: "+i.eventName});var u=function(e){if(e.telemetryProperties&&e.telemetryProperties.dnmToken)return e.telemetryProperties.dnmToken;Object(r.t)(0,1,function(){return"Missing DNM Token"})}(i);if(!u)return;return{iKey:u,name:i.eventName,data:c,time:s.toISOString(),baseType:"custom",ext:{sdk:{seq:0},utc:{eventFlags:2097152}}}}}(t);i&&n&&(null==n||n.track(i))},v)}}return e.getDnmTimestamp=function(e){var t=D(e);return t.setMilliseconds(0),t.setSeconds(0),t.setMinutes(0),2===e.telemetryProperties.dnmInterval&&t.setHours(0),t},e}(),ae=function(){var e,t,n=this;this.eventsProcessed=0,this.initialize=function(n,a){var i=H(a.endpointUrl);if(i){var o=Object(N.e)(Object(N.e)({},a),{endpointUrl:i,extensionConfig:Object(N.e)(Object(N.e)({},a.extensionConfig),{PrivacyGuardPlugin:{}}),nonStandardEventHandlers:[],plugins:[]});e=W(o,g),a.disableStatsTracking||q(n,e),t=n}else Object(r.t)(0,1,function(){return"Missing 1DS CCCO Endpoint"})},this.shutdown=function(){null==e||e.shutdown()},this.flush=function(t){null==e||e.flush(t)},this.canHandle=function(e){return t&&2===e},this.processEvent=function(a){return n.eventsProcessed++,S(function(){var n=t.getOneDSCustomerContent(a);n&&e&&(null==e||e.track(n))},v)}}}],Array(56),[function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(19),i=n(110),r=((Object(i.e)()||{}).Symbol,(Object(i.e)()||{}).Reflect,a.e,function(e,t){return r=a.t.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t[a.c](n)&&(e[n]=t[n])},r(e,t)});function o(e,t){function n(){this.constructor=e}typeof t!==a.s&&null!==t&&Object(i.n)("Class extends value "+String(t)+" is not a constructor or null"),r(e,t),e[a.l]=null===t?Object(i.t)(t):(n[a.l]=t[a.l],new n)}},function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"t",function(){return s});var a=n(6),i=n(87),r=((Object(i.e)()||{}).Symbol,(Object(i.e)()||{}).Reflect,a.e,function(e,t){return r=a.t.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t[a.c](n)&&(e[n]=t[n])},r(e,t)});function o(e,t){function n(){this.constructor=e}typeof t!==a.s&&null!==t&&Object(i.n)("Class extends value "+String(t)+" is not a constructor or null"),r(e,t),e[a.l]=null===t?Object(i.t)(t):(n[a.l]=t[a.l],new n)}function s(e,t){for(var n=0,a=t.length,i=e.length;n<a;n++,i++)e[i]=t[n];return e}},function(e,t,n){"use strict";var a=n(372),i=n(31),r=n(108),o=n(88),s=n(99),c=n(186),d=n(1),l=n(17),u=n(269),f=Object(u.e)({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5}),p=n(42),m=n(270),_="REAL_TIME",h="POST",b="drop",g="requeue",v="application/x-json-stream",y="cache-control",S="content-type",D="time-delta-millis",I="client-version",x="client-id",C="time-delta-to-apply-millis",O="upload-time",w="apikey",E="AuthMsaDeviceTicket",A="AuthXToken";function L(e){var t=(e.ext||{}).intweb;return t&&Object(c.d)(t.msfpc)?t.msfpc:null}function k(e){for(var t=null,n=0;null===t&&n<e.length;n++)t=L(e[n]);return t}var M=function(){function e(t,n){var a=n?[].concat(n):[],i=this,r=k(a);i.iKey=function(){return t},i.Msfpc=function(){return r||""},i.count=function(){return a.length},i.events=function(){return a},i.addEvent=function(e){return!!e&&(a.push(e),r||(r=L(e)),!0)},i.split=function(n,i){var o;if(n<a.length){var s=a.length-n;Object(d.h)(i)||(s=i<s?i:s),o=a.splice(n,s),r=k(a)}return new e(t,o)}}return e.create=function(t,n){return new e(t,n)},e}(),P=n(6),T=2e6,U=Math.min(T,65e3),F=/\./,H=function e(t,n,a,o){var s="baseData",l=!!o,u=n,f={};Object(i.e)(e,this,function(e){function n(e,t,i,r,o,s,p){Object(d.O)(e,function(e,m){var _=null;if(m||Object(c.d)(m)){var h=i,b=e,g=o,v=t;if(l&&!r&&F.test(e)){var y=e.split("."),S=y.length;if(S>1){g&&(g=g.slice());for(var D=0;D<S-1;D++){var I=y[D];v=v[I]=v[I]||{},h+="."+I,g&&g.push(I)}b=y[S-1]}}var x=r&&function(e,t){var n=f[e];return void 0===n&&(e.length>=7&&(n=Object(d.U)(e,"ext.metadata")||Object(d.U)(e,"ext.web")),f[e]=n),n}(h);if(_=!x&&u&&u.handleField(h,b)?u.value(h,b,m,a):Object(c.u)(b,m,a)){var C=_.value;if(v[b]=C,s&&s(g,b,_),p&&"object"==typeof C&&!Object(d.d)(C)){var O=g;O&&(O=O.slice()).push(b),n(m,C,h+"."+b,r,O,s,p)}}}})}e.createPayload=function(e,t,n,a,i,r){return{apiKeys:[],payloadBlob:"",overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:e,isTeardown:t,isSync:n,isBeacon:a,sendType:r,sendReason:i}},e.appendPayload=function(n,a,i){var o=n&&a&&!n.overflow;return o&&Object(r.t)(t,function(){return"Serializer:appendPayload"},function(){for(var t=a.events(),r=n.payloadBlob,o=n.numEvents,s=!1,c=[],l=[],u=n.isBeacon,f=u?65e3:3984588,p=u?U:T,m=0,_=0;m<t.length;){var h=t[m];if(h){if(o>=i){n.overflow=a.split(m);break}var b=e.getEventBlob(h);if(b&&b.length<=p){var g=b.length;if(r.length+g>f){n.overflow=a.split(m);break}r&&(r+="\n"),r+=b,++_>20&&(r.substr(0,1),_=0),s=!0,o++}else b?c.push(h):l.push(h),t.splice(m,1),m--}m++}if(c&&c.length>0&&n.sizeExceed.push(M.create(a.iKey(),c)),l&&l.length>0&&n.failedEvts.push(M.create(a.iKey(),l)),s){n.batches.push(a),n.payloadBlob=r,n.numEvents=o;var v=a.iKey();-1===Object(d.t)(n.apiKeys,v)&&n.apiKeys.push(v)}},function(){return{payload:n,theBatch:{iKey:a.iKey(),evts:a.events()},max:i}}),o},e.getEventBlob=function(e){try{return Object(r.t)(t,function(){return"Serializer.getEventBlob"},function(){var t={};t.name=e.name,t.time=e.time,t.ver=e.ver,t.iKey="o:"+Object(c.r)(e.iKey);var a={},i=e.ext;i&&(t.ext=a,Object(d.O)(i,function(e,t){n(t,a[e]={},"ext."+e,!0,null,null,!0)}));var r=t.data={};r.baseType=e.baseType;var o=r.baseData={};return n(e.baseData,o,s,!1,[s],function(e,t,n){R(a,e,t,n)},!0),n(e.data,r,"data",!1,[],function(e,t,n){R(a,e,t,n)},!0),JSON.stringify(t)},function(){return{item:e}})}catch(e){return null}}})};function R(e,t,n,a){if(a&&e){var i=Object(c.a)(a.value,a.kind,a.propertyType);if(i>-1){var r=e.metadata;r||(r=e.metadata={f:{}});var o=r.f;if(o||(o=r.f={}),t)for(var s=0;s<t.length;s++){var l=t[s];o[l]||(o[l]={f:{}});var u=o[l].f;u||(u=o[l].f={}),o=u}o=o[n]={},Object(d.d)(a.value)?o.a={t:i}:o.t=i}}}function N(e){var t,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(2,e)*n,Math.min(t,6e5)}var B,j=function e(){var t={};Object(i.e)(e,this,function(e){e.setKillSwitchTenants=function(e,n){if(e&&n)try{var a=(o=e.split(","),s=[],o&&Object(d.e)(o,function(e){s.push(Object(d.F)(e))}),s);if("this-request-only"===n)return a;for(var i=1e3*parseInt(n,10),r=0;r<a.length;++r)t[a[r]]=Object(d.i)()+i}catch(e){return[]}var o,s;return[]},e.isTenantKilled=function(e){var n=t,a=Object(d.F)(e);return void 0!==n[a]&&n[a]>Object(d.i)()||(delete n[a],!1)}})},V=function e(){var t=!0,n=!0,a=!0,r="use-collector-delta",o=!1;Object(i.e)(e,this,function(e){e.allowRequestSending=function(){return t},e.firstRequestSent=function(){a&&(a=!1,o||(t=!1))},e.shouldAddClockSkewHeaders=function(){return n},e.getClockSkewHeaderValue=function(){return r},e.setClockSkew=function(e){o||(e?(r=e,n=!0,o=!0):n=!1,t=!0)}})},z="&NoResponseBody=true",G=((B={})[1]=g,B[100]=g,B[200]="sent",B[8004]=b,B[8003]=b,B),K={},W={};function q(e,t,n){K[e]=t,!1!==n&&(W[t]=e)}function Q(e){try{return e.responseText}catch(e){}return""}function Y(e,t){var n=!1;if(e&&t){var a=Object(d.E)(e);if(a&&a.length>0)for(var i=t.toLowerCase(),r=0;r<a.length;r++){var o=a[r];if(o&&Object(d.c)(t,o)&&o.toLowerCase()===i){n=!0;break}}}return n}function J(e,t,n,a){t&&n&&n.length>0&&(a&&K[t]?(e.hdrs[K[t]]=n,e.useHdrs=!0):e.url+="&"+t+"="+n)}q(E,E,!1),q(I,I),q(x,"Client-Id"),q(w,w),q(C,C),q(O,O),q(A,A);var X=function e(t,n,a,o,s){this._responseHandlers=[];var u,f,m,_,g,E,A="?cors=true&"+S.toLowerCase()+"="+v,L=new j,k=!1,M=new V,T=!1,U=0,F=!0,R=[],B={},K=[],q=null,X=!1,Z=!1,$=!1;Object(i.e)(e,this,function(e){var i=!0;function j(e,t){for(var n=0,a=null,i=0;null==a&&i<e.length;)1===(n=e[i])?Object(l.g)()?a=V:Object(l.b)()&&(a=te):2===n&&Object(l.m)(t)?a=ee:T&&3===n&&Object(l.p)()&&(a=ae),i++;return a?{_transport:n,_isSync:t,sendPOST:a}:null}function V(e,t,n){var a=new XDomainRequest;a.open(h,e.urlString),e.timeout&&(a.timeout=e.timeout),a.onload=function(){var e=Q(a);ne(t,200,{},e),me(e)},a.onerror=function(){ne(t,400,{})},a.ontimeout=function(){ne(t,500,{})},a.onprogress=function(){},n?a.send(e.data):s.set(function(){a.send(e.data)},0)}function ee(e,t,n){var a,r=e.urlString,o=!1,c=!1,l=((a={body:e.data,method:h}).Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,a);n&&(l.keepalive=!0,2===e._sendReason&&(o=!0,r+=z)),i&&(l.credentials="include"),e.headers&&Object(d.E)(e.headers).length>0&&(l.headers=e.headers),fetch(r,l).then(function(e){var n={},a="";e.headers&&e.headers.forEach(function(e,t){n[t]=e}),e.body&&e.text().then(function(e){a=e}),c||(c=!0,ne(t,e.status,n,a),me(a))}).catch(function(e){c||(c=!0,ne(t,0,{}))}),o&&!c&&(c=!0,ne(t,200,{})),!c&&e.timeout>0&&s.set(function(){c||(c=!0,ne(t,500,{}))},e.timeout)}function te(e,t,n){var a=e.urlString;function r(e,t,n){if(!e[n]&&t&&t.getResponseHeader){var a=t.getResponseHeader(n);a&&(e[n]=Object(d.F)(a))}return e}function o(e,n){ne(t,e.status,function(e){var t={};return e.getAllResponseHeaders?t=function(e){var t={};if(Object(d.v)(e)){var n=Object(d.F)(e).split(/[\r\n]+/);Object(d.e)(n,function(e){if(e){var n=e.indexOf(": ");if(-1!==n){var a=Object(d.F)(e.substring(0,n)).toLowerCase(),i=Object(d.F)(e.substring(n+1));t[a]=i}else t[Object(d.F)(e)]=1}})}return t}(e.getAllResponseHeaders()):(t=r(t,e,D),t=r(t,e,"kill-duration"),t=r(t,e,"kill-duration-seconds")),t}(e),n)}n&&e.disableXhrSync&&(n=!1);var s=Object(c.l)(h,a,i,!0,n,e.timeout);Object(d.O)(e.headers,function(e,t){s.setRequestHeader(e,t)}),s.onload=function(){var e=Q(s);o(s,e),me(e)},s.onerror=function(){o(s)},s.ontimeout=function(){o(s)},s.send(e.data)}function ne(e,t,n,a){try{e(t,n,a)}catch(e){Object(p.n)(u.diagLog(),2,518,Object(l.e)(e))}}function ae(e,t,n){var a=200,i=e._thePayload,r=e.urlString+z;try{var o=Object(l.c)();if(!o.sendBeacon(r,e.data))if(i){var s=[];Object(d.e)(i.batches,function(e){if(s&&e&&e.count()>0){for(var t=e.events(),n=0;n<t.length;n++)if(!o.sendBeacon(r,q.getEventBlob(t[n]))){s.push(e.split(n));break}}else s.push(e.split(0))}),_e(s,8003,i.sendType,!0)}else a=0}catch(e){u.diagLog().warnToConsole("Failed to send telemetry using sendBeacon API. Ex:"+Object(l.e)(e)),a=0}finally{ne(t,a,{},"")}}function ie(e){return 2===e||3===e}function re(e){return Z&&ie(e)&&(e=2),e}function oe(){return!k&&U<n}function se(){var e=K;return K=[],e}function ce(e,t,n){var a=!1;return e&&e.length>0&&!k&&f[t]&&q&&(a=0!==t||oe()&&(n>0||M.allowRequestSending())),a}function de(e){var t={};return e&&Object(d.e)(e,function(e,n){t[n]={iKey:e.iKey(),evts:e.events()}}),t}function le(e,n,a,i,o){if(e&&0!==e.length)if(k)_e(e,1,i);else{i=re(i);try{var s=e,d=0!==i;Object(r.t)(m,function(){return"HttpManager:_sendBatches"},function(r){r&&(e=e.slice(0));for(var s=[],u=null,p=Object(c.o)(),m=f[i]||(d?f[1]:f[0]),_=(Z||ie(i)||m&&3===m._transport)&&!F&&T&&Object(l.p)();ce(e,i,n);){var h=e.shift();h&&h.count()>0&&(L.isTenantKilled(h.iKey())?s.push(h):(u=u||q.createPayload(n,a,d,_,o,i),q.appendPayload(u,h,t)?null!==u.overflow&&(e=[u.overflow].concat(e),u.overflow=null,fe(u,p,Object(c.o)(),o),p=Object(c.o)(),u=null):(fe(u,p,Object(c.o)(),o),p=Object(c.o)(),e=[h].concat(e),u=null)))}u&&fe(u,p,Object(c.o)(),o),e.length>0&&(K=e.concat(K)),_e(s,8004,i)},function(){return{batches:de(s),retryCount:n,isTeardown:a,isSynchronous:d,sendReason:o,useSendBeacon:ie(i),sendType:i}},!d)}catch(e){Object(p.n)(u.diagLog(),2,48,"Unexpected Exception sending batch: "+Object(l.e)(e))}}}function ue(e,t,n){e[t]=e[t]||{},e[t][u.identifier]=n}function fe(t,n,i,o){if(t&&t.payloadBlob&&t.payloadBlob.length>0){var s=!!e.sendHook,p=f[t.sendType];!ie(t.sendType)&&t.isBeacon&&2===t.sendReason&&(p=f[2]||f[3]||p);var _=$;(t.isBeacon||3===p._transport)&&(_=!1);var h=function(e,t){var n={url:A,hdrs:{},useHdrs:!1};t?(n.hdrs=Object(c.n)(n.hdrs,B),n.useHdrs=Object(d.E)(n.hdrs).length>0):Object(d.O)(B,function(e,t){W[e]?J(n,W[e],t,!1):(n.hdrs[e]=t,n.useHdrs=!0)}),J(n,x,"NO_AUTH",t),J(n,I,c.e,t);var a="";Object(d.e)(e.apiKeys,function(e){a.length>0&&(a+=","),a+=e}),J(n,w,a,t),J(n,O,Object(d.i)().toString(),t);var i=function(e){for(var t=0;t<e.batches.length;t++){var n=e.batches[t].Msfpc();if(n)return encodeURIComponent(n)}return""}(e);if(Object(c.d)(i)&&(n.url+="&ext.intweb.msfpc="+i),M.shouldAddClockSkewHeaders()&&J(n,C,M.getClockSkewHeaderValue(),t),m.getWParam){var r=m.getWParam();r>=0&&(n.url+="&w="+r)}for(var o=0;o<R.length;o++)n.url+="&"+R[o].name+"="+R[o].value;return n}(t,_);_=_||h.useHdrs;var b=Object(c.o)();Object(r.t)(m,function(){return"HttpManager:_doPayloadSend"},function(){for(var f=0;f<t.batches.length;f++)for(var I=t.batches[f].events(),x=0;x<I.length;x++){var C=I[x];if(X){var O=C.timings=C.timings||{};ue(O,"sendEventStart",b),ue(O,"serializationStart",n),ue(O,"serializationCompleted",i)}C.sendAttempt>0?C.sendAttempt++:C.sendAttempt=1}_e(t.batches,1e3+(o||0),t.sendType,!0);var w={data:t.payloadBlob,urlString:h.url,headers:h.hdrs,_thePayload:t,_sendReason:o,timeout:g};Object(d.D)(E)||(w.disableXhrSync=!!E),_&&(Y(w.headers,y)||(w.headers[y]="no-cache, no-store"),Y(w.headers,S)||(w.headers["content-type"]=v));var A=null;p&&(A=function(n){M.firstRequestSent();var i=function(n,i){!function(t,n,i,r){var o,s=9e3,l=null,f=!1,p=!1;try{var m=!0;if(typeof t!==P.u){if(n){M.setClockSkew(n[D]);var _=n["kill-duration"]||n["kill-duration-seconds"];Object(d.e)(L.setKillSwitchTenants(n["kill-tokens"],_),function(e){Object(d.e)(i.batches,function(t){if(t.iKey()===e){l=l||[];var n=t.split(0);i.numEvents-=n.count(),l.push(n)}})})}if(200==t||204==t)return void(s=200);((o=t)>=300&&o<500&&408!=o&&429!=o||501==o||505==o||i.numEvents<=0)&&(m=!1),s=9e3+t%1e3}if(m){s=100;var h=i.retryCnt;0===i.sendType&&(h<a?(f=!0,pe(function(){0===i.sendType&&U--,le(i.batches,h+1,i.isTeardown,Z?2:i.sendType,5)},Z,N(h))):(p=!0,Z&&(s=8001)))}}finally{f||(M.setClockSkew(),function(t,n,a,i){try{i&&u._backOffTransmission(),200===n&&(i||t.isSync||u._clearBackOff(),function(e){if(X){var t=Object(c.o)();Object(d.e)(e,function(e){e&&e.count()>0&&function(e,t){X&&Object(d.e)(e,function(e){ue(e.timings=e.timings||{},"sendEventCompleted",t)})}(e.events(),t)})}}(t.batches)),_e(t.batches,n,t.sendType,!0)}finally{0===t.sendType&&(U--,5!==a&&e.sendQueuedRequests(t.sendType,a))}}(i,s,r,p)),_e(l,8004,i.sendType)}}(n,i,t,o)},r=t.isTeardown||t.isSync;try{p.sendPOST(n,i,r),e.sendListener&&e.sendListener(w,n,r,t.isBeacon)}catch(e){u.diagLog().warnToConsole("Unexpected exception sending payload. Ex:"+Object(l.e)(e)),ne(i,0,{})}}),Object(r.t)(m,function(){return"HttpManager:_doPayloadSend.sender"},function(){if(A)if(0===t.sendType&&U++,s&&!t.isBeacon&&3!==p._transport){var n={data:w.data,urlString:w.urlString,headers:Object(c.n)({},w.headers),timeout:w.timeout,disableXhrSync:w.disableXhrSync},a=!1;Object(r.t)(m,function(){return"HttpManager:_doPayloadSend.sendHook"},function(){try{e.sendHook(n,function(e){a=!0,F||e._thePayload||(e._thePayload=e._thePayload||w._thePayload,e._sendReason=e._sendReason||w._sendReason),A(e)},t.isSync||t.isTeardown)}catch(e){a||A(w)}})}else A(w)})},function(){return{thePayload:t,serializationStart:n,serializationCompleted:i,sendReason:o}},t.isSync)}t.sizeExceed&&t.sizeExceed.length>0&&_e(t.sizeExceed,8003,t.sendType),t.failedEvts&&t.failedEvts.length>0&&_e(t.failedEvts,8002,t.sendType)}function pe(e,t,n){t?e():s.set(e,n)}function me(t){var n=e._responseHandlers;try{for(var a=0;a<n.length;a++)try{n[a](t)}catch(e){Object(p.n)(u.diagLog(),1,519,"Response handler failed: "+e)}if(t){var i=JSON.parse(t);Object(c.d)(i.webResult)&&Object(c.d)(i.webResult.msfpc)&&_.set("MSFPC",i.webResult.msfpc,31536e3)}}catch(e){}}function _e(e,t,n,a){if(e&&e.length>0&&o){var i=o[(d=t,l=G[d],Object(c.d)(l)||(l="oth",d>=9e3&&d<=9999?l="rspFail":d>=8e3&&d<=8999?l=b:d>=1e3&&d<=1999&&(l="send")),l)];if(i){var s=0!==n;Object(r.t)(m,function(){return"HttpManager:_sendBatchesNotification"},function(){pe(function(){try{i.call(o,e,t,s,n)}catch(e){Object(p.n)(u.diagLog(),1,74,"send request notification failed: "+e)}},a||s,0)},function(){return{batches:de(e),reason:t,isSync:s,sendSync:a,sendType:n}},!s)}}var d,l}e.initialize=function(e,t,n,a,r){var o;r||(r={}),A=e+A,$=!!Object(d.D)(r.avoidOptions)||!r.avoidOptions,m=t,_=t.getCookieMgr(),X=!m.config.disableEventTimings;var s=!!m.config.enableCompoundKey;u=n;var c=r.valueSanitizer,p=r.stringifyObjects;Object(d.D)(r.enableCompoundKey)||(s=!!r.enableCompoundKey),g=r.xhrTimeout,E=r.disableXhrSync,T=!Object(l.h)(),q=new H(m,c,p,s);var h=a,b=r.alwaysUseXhrOverride?a:null,v=r.alwaysUseXhrOverride?a:null;if(!a){F=!1;var y=Object(l.o)();y&&y.protocol&&"file:"===y.protocol.toLowerCase()&&(i=!1);var S=[];S=Object(l.h)()?[2,1]:[1,2,3];var D=r.transports;D&&(Object(d.b)(D)?S=[D].concat(S):Object(d.d)(D)&&(S=D.concat(S))),a=j(S,!1),h=j(S,!0),a||u.diagLog().warnToConsole("No available transport to send events")}(o={})[0]=a,o[1]=h||j([1,2,3],!0),o[2]=b||j([3,2],!0)||h||j([1],!0),o[3]=v||j([2,3],!0)||h||j([1],!0),f=o},e._getDbgPlgTargets=function(){return[f[0],L,q,f]},e.addQueryStringParameter=function(e,t){for(var n=0;n<R.length;n++)if(R[n].name===e)return void(R[n].value=t);R.push({name:e,value:t})},e.addHeader=function(e,t){B[e]=t},e.canSendRequest=function(){return oe()&&M.allowRequestSending()},e.sendQueuedRequests=function(e,t){Object(d.D)(e)&&(e=0),Z&&(e=re(e),t=2),ce(K,e,0)&&le(se(),0,!1,e,t||0)},e.isCompletelyIdle=function(){return!k&&0===U&&0===K.length},e.setUnloading=function(e){Z=e},e.addBatch=function(e){if(e&&e.count()>0){if(L.isTenantKilled(e.iKey()))return!1;K.push(e)}return!0},e.teardown=function(){K.length>0&&le(se(),0,!0,2,2)},e.pause=function(){k=!0},e.resume=function(){k=!1,e.sendQueuedRequests(0,4)},e.sendSynchronousBatch=function(e,t,n){e&&e.count()>0&&(Object(d.h)(t)&&(t=1),Z&&(t=re(t),n=2),le([e],0,!1,t,n||0))}})};function Z(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];return setTimeout(e,t,n)}function $(e){clearTimeout(e)}function ee(e,t){return{set:e||Z,clear:t||$}}var te="eventsDiscarded",ne=function(e){function t(){var n,a=e.call(this)||this;a.identifier="PostChannel",a.priority=1011,a.version="3.2.2";var u,m,h,b,g,v,y,S=!1,D=[],I=null,x=!1,C=0,O=500,w=0,A=1e4,L={},k=_,P=null,T=null,U=0,F=0,H={},R=-1,B=!0,j=!1,V=6,z=2;return Object(i.e)(t,a,function(e,t){function a(e){"beforeunload"!==(e||Object(l.l)().event).type&&(j=!0,m.setUnloading(j)),Z(2,2)}function i(e){j=!1,m.setUnloading(j)}function G(e,t){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=1),e.ext&&e.ext.trace&&delete e.ext.trace,e.ext&&e.ext.user&&e.ext.user.id&&delete e.ext.user.id,B&&(e.ext=Object(d.A)(e.ext),e.baseData&&(e.baseData=Object(d.A)(e.baseData)),e.data&&(e.data=Object(d.A)(e.data))),e.sync)if(U||x)e.latency=3,e.sync=!1;else if(m)return B&&(e=Object(d.A)(e)),void m.sendSynchronousBatch(M.create(e.iKey,[e]),!0===e.sync?1:e.sync,3);var n=e.latency,a=w,i=A;4===n&&(a=C,i=O);var r=!1;if(a<i)r=!ae(e,t);else{var o=1,s=20;4===n&&(o=4,s=1),r=!0,function(e,t,n,a){for(;n<=t;){var i=$(e,t,!0);if(i&&i.count()>0){var r=i.split(0,a),o=r.count();if(o>0)return 4===n?C-=o:w-=o,fe(te,[r],f.QueueFull),!0}n++}return ie(),!1}(e.iKey,e.latency,o,s)&&(r=!ae(e,t))}r&&ue(te,[e],f.QueueFull)}function K(e,t,n){var a=re(e,t,n);return m.sendQueuedRequests(t,n),a}function W(){return w>0}function q(){if(R>=0&&re(R,0,g)&&m.sendQueuedRequests(0,g),C>0&&!T&&!x){var e=L[k][2];e>=0&&(T=Y(function(){T=null,K(4,0,1),q()},e))}var t=L[k][1];!P&&!I&&t>=0&&!x&&(W()?P=Y(function(){P=null,K(0===F?3:1,0,1),F++,F%=2,q()},t):F=0)}function Q(){n=null,S=!1,D=[],I=null,x=!1,C=0,O=500,w=0,A=1e4,L={},k=_,P=null,T=null,U=0,F=0,u=null,H={},h=void 0,b=0,R=-1,g=null,B=!0,j=!1,V=6,z=2,v=null,y=ee(),m=new X(500,2,1,{requeue:de,send:pe,sent:me,drop:_e,rspFail:he,oth:be},y),ce(),H[4]={batches:[],iKeyMap:{}},H[3]={batches:[],iKeyMap:{}},H[2]={batches:[],iKeyMap:{}},H[1]={batches:[],iKeyMap:{}},ge()}function Y(e,t){0===t&&U&&(t=1);var n=1e3;return U&&(n=N(U-1)),y.set(e,t*n)}function J(){null!==P&&(y.clear(P),P=null,F=0)}function Z(e,t){J(),I&&(y.clear(I),I=null),x||K(1,e,t)}function $(e,t,n){var a=H[t];a||(a=H[t=1]);var i=a.iKeyMap[e];return!i&&n&&(i=M.create(e),a.batches.push(i),a.iKeyMap[e]=i),i}function ne(t,n){m.canSendRequest()&&!U&&(h>0&&w>h&&(n=!0),n&&null==I&&e.flush(t,null,20))}function ae(e,t){B&&(e=Object(d.A)(e));var n=e.latency,a=$(e.iKey,n,!0);return!!a.addEvent(e)&&(4!==n?(w++,t&&0===e.sendAttempt&&ne(!e.sync,b>0&&a.count()>=b)):C++,!0)}function ie(){for(var e=0,t=0,n=function(n){var a=H[n];a&&a.batches&&Object(d.e)(a.batches,function(a){4===n?e+=a.count():t+=a.count()})},a=1;a<=4;a++)n(a);w=t,C=e}function re(t,n,a){var i=!1,o=0===n;return!o||m.canSendRequest()?Object(r.t)(e.core,function(){return"PostChannel._queueBatches"},function(){for(var e=[],n=4;n>=t;){var a=H[n];a&&a.batches&&a.batches.length>0&&(Object(d.e)(a.batches,function(t){m.addBatch(t)?i=i||t&&t.count()>0:e=e.concat(t.events()),4===n?C-=t.count():w-=t.count()}),a.batches=[],a.iKeyMap={}),n--}e.length>0&&ue(te,e,f.KillSwitch),i&&R>=t&&(R=-1,g=0)},function(){return{latency:t,sendType:n,sendReason:a}},!o):(R=R>=0?Math.min(R,t):t,g=Math.max(g,a)),i}function oe(e,t){K(1,0,t),se(function(){e&&e(),D.length>0?I=Y(function(){return oe(D.shift(),t)},0):(I=null,W()&&q())})}function se(e){m.isCompletelyIdle()?e():I=Y(function(){se(e)},.25)}function ce(){(L={}).REAL_TIME=[2,1,0],L.NEAR_REAL_TIME=[6,3,0],L.BEST_EFFORT=[18,9,0]}function de(t,n){var a=[],i=V;j&&(i=z),Object(d.e)(t,function(t){t&&t.count()>0&&Object(d.e)(t.events(),function(t){t&&(t.sync&&(t.latency=4,t.sync=!1),t.sendAttempt<i?(Object(c.f)(t,e.identifier),G(t,!1)):a.push(t))})}),a.length>0&&ue(te,a,f.NonRetryableStatus),j&&Z(2,2)}function le(t,n){var a=e._notificationManager||{},i=a[t];if(i)try{i.apply(a,n)}catch(n){Object(p.n)(e.diagLog(),1,74,t+" notification failed: "+n)}}function ue(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];t&&t.length>0&&le(e,[t].concat(n))}function fe(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];t&&t.length>0&&Object(d.e)(t,function(t){t&&t.count()>0&&le(e,[t.events()].concat(n))})}function pe(e,t,n){e&&e.length>0&&le("eventsSendRequest",[t>=1e3&&t<=1999?t-1e3:0,!0!==n])}function me(e,t){fe("eventsSent",e,t),q()}function _e(e,t){fe(te,e,t>=8e3&&t<=8999?t-8e3:f.Unknown)}function he(e){fe(te,e,f.NonRetryableStatus),q()}function be(e,t){fe(te,e,f.Unknown),q()}function ge(){b=n&&n.disableAutoBatchFlushLimit?0:Math.max(1500,A/6)}Q(),e._getDbgPlgTargets=function(){return[m]},e.initialize=function(l,f,p){Object(r.t)(f,function(){return"PostChannel:initialize"},function(){var r=f;t.initialize(l,f,p);try{f.addUnloadCb,v=Object(o.o)(Object(s.t)(e.identifier),f.evtNamespace&&f.evtNamespace());var _=e._getTelCtx();l.extensionConfig[e.identifier]=l.extensionConfig[e.identifier]||{},n=_.getExtCfg(e.identifier),y=ee(n.setTimeoutOverride,n.clearTimeoutOverride),B=!n.disableOptimizeObj&&Object(c.s)(),function(e){var t=e.getWParam;e.getWParam=function(){var e=0;return n.ignoreMc1Ms0CookieProcessing&&(e|=2),e|t()}}(r),n.eventsLimitInMem>0&&(A=n.eventsLimitInMem),n.immediateEventLimit>0&&(O=n.immediateEventLimit),n.autoFlushEventsLimit>0&&(h=n.autoFlushEventsLimit),n.disableXhrSync,Object(d.b)(n.maxEventRetryAttempts)&&(V=n.maxEventRetryAttempts),Object(d.b)(n.maxUnloadEventRetryAttempts)&&(z=n.maxUnloadEventRetryAttempts),ge(),n.httpXHROverride&&n.httpXHROverride.sendPOST&&(u=n.httpXHROverride),Object(c.d)(l.anonCookieName)&&m.addQueryStringParameter("anoncknm",l.anonCookieName),m.sendHook=n.payloadPreprocessor,m.sendListener=n.payloadListener;var b=n.overrideEndpointUrl?n.overrideEndpointUrl:l.endpointUrl;e._notificationManager=l.extensionConfig.NotificationManager,m.initialize(b,e.core,e,u,n);var g=l.disablePageUnloadEvents||[];Object(o.a)(a,g,v),Object(o.t)(a,g,v),Object(o.n)(i,l.disablePageShowEvents,v)}catch(t){throw e.setInitialized(!1),t}},function(){return{coreConfig:l,core:f,extensions:p}})},e.processTelemetry=function(t,a){Object(c.f)(t,e.identifier);var i=(a=e._getTelCtx(a)).getExtCfg(e.identifier),r=!!n.disableTelemetry;i&&(r=r||!!i.disableTelemetry);var o=t;r||S||(n.overrideInstrumentationKey&&(o.iKey=n.overrideInstrumentationKey),i&&i.overrideInstrumentationKey&&(o.iKey=i.overrideInstrumentationKey),G(o,!0),j?Z(2,2):q()),e.processNext(o,a)},e._doTeardown=function(e,t){Z(2,2),S=!0,m.teardown(),Object(o.d)(null,v),Object(o.s)(null,v),Object(o.c)(null,v),Q()},e.setEventQueueLimits=function(e,t){A=e>0?e:1e4,h=t>0?t:0,ge();var n=w>e;if(!n&&b>0)for(var a=1;!n&&a<=3;a++){var i=H[a];i&&i.batches&&Object(d.e)(i.batches,function(e){e&&e.count()>=b&&(n=!0)})}ne(!0,n)},e.pause=function(){J(),x=!0,m.pause()},e.resume=function(){x=!1,m.resume(),q()},e.addResponseHandler=function(e){m._responseHandlers.push(e)},e._loadTransmitProfiles=function(e){J(),ce(),k=_,q(),Object(d.O)(e,function(e,t){var n=t.length;if(n>=2){var a=n>2?t[2]:0;if(t.splice(0,n-2),t[1]<0&&(t[0]=-1),t[1]>0&&t[0]>0){var i=t[0]/t[1];t[0]=Math.ceil(i)*t[1]}a>=0&&t[1]>=0&&a>t[1]&&(a=t[1]),t.push(a),L[e]=t}})},e.flush=function(e,t,n){void 0===e&&(e=!0),x||(J(),n=n||1,e?(re(1,0,n),ie(),null==I?I=Y(function(){oe(t,n)},0):D.push(t)):(K(1,1,n),null!=t&&t()))},e.setMsaAuthTicket=function(e){m.addHeader(E,e)},e.hasEvents=W,e._setTransmitProfile=function(e){k!==e&&void 0!==L[e]&&(J(),k=e,q())},e._backOffTransmission=function(){U<4&&(U++,J(),q())},e._clearBackOff=function(){U&&(U=0,J(),q())},Object(d.x)(e,"_setTimeoutOverride",function(){return y.set},function(e){y=ee(e,y.clear)}),Object(d.x)(e,"_clearTimeoutOverride",function(){return y.clear},function(e){y=ee(y.set,e)})}),a}return Object(a.e)(t,e),t}(m.e);t.e=ne},function(e,t,n){"use strict";var a=n(372),i=n(42),r=n(108),o=n(1),s=n(17),c=n(373),d=n(87),l=n(31),u=n(44),f=n(53),p=n(54),m=n(152),_=n(179),h=n(2);function b(e,t,n,a){t&&Object(o.d)(t)&&t.length>0&&(t=t.sort(function(e,t){return e.priority-t.priority}),Object(o.e)(t,function(e){e.priority<500&&Object(o.H)("Channel has invalid priority - "+e.identifier)}),e.push({queue:Object(o.w)(t),chain:Object(u.i)(t,n,a)}))}var g=function(e){function t(){var n,a,r=e.call(this)||this;function c(){n=0,a=[]}return r.identifier="TelemetryInitializerPlugin",r.priority=199,c(),Object(l.e)(t,r,function(e,t){e.addTelemetryInitializer=function(e){var t={id:n++,fn:e};return a.push(t),{remove:function(){Object(o.e)(a,function(e,n){if(e.id===t.id)return a.splice(n,1),-1})}}},e.processTelemetry=function(t,n){for(var r=!1,c=a.length,d=0;d<c;++d){var l=a[d];if(l)try{if(!1===l.fn.apply(null,[t])){r=!0;break}}catch(e){Object(i.n)(n.diagLog(),1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+Object(o.o)(e),{exception:Object(s.e)(e)},!0)}}r||e.processNext(t,n)},e[h.a]=function(){c()}}),r}return Object(c.e)(t,e),t}(n(270).e),v=n(99),y=n(180),S="Plugins must provide initialize method",D="SDK is still unloading...",I={loggingLevelConsole:1};function x(e,t){return new r.e(t)}function C(e,t){var n=!1;return Object(o.e)(t,function(t){if(t===e)return n=!0,-1}),n}function O(e,t,n,a){Object(o.e)(e,function(e){if(e&&e[t])if(n)setTimeout(function(){return a(e)},0);else try{a(e)}catch(e){}})}var w=function e(t){this.listeners=[];var n=!!(t||{}).perfEvtsSendAll;Object(l.e)(e,this,function(e){e[h.e]=function(t){e.listeners.push(t)},e[h.m]=function(t){for(var n=Object(o.t)(e.listeners,t);n>-1;)e.listeners.splice(n,1),n=Object(o.t)(e.listeners,t)},e[h.s]=function(t){O(e.listeners,h.s,!0,function(e){e[h.s](t)})},e[h.r]=function(t,n){O(e.listeners,h.r,!0,function(e){e[h.r](t,n)})},e[h.o]=function(t,n){O(e.listeners,h.o,n,function(e){e[h.o](t,n)})},e[h.l]=function(t){t&&(!n&&t.isChildEvt()||O(e.listeners,h.l,!1,function(e){t.isAsync?setTimeout(function(){return e[h.l](t)},0):e[h.l](t)}))}})},E=function(e){function t(){var n=e.call(this)||this;return Object(l.e)(t,n,function(e,t){function n(t){var n=e.getNotifyMgr();n&&n.eventsDiscarded([t],2)}e.initialize=function(e,n,a,r){t.initialize(e,n,a||new i.e(e),r||new w(e))},e.track=function(a){Object(r.t)(e.getPerfMgr(),function(){return"AppInsightsCore:track"},function(){null===a&&(n(a),Object(o.H)("Invalid telemetry item")),function(e){Object(o.h)(e.name)&&(n(e),Object(o.H)("telemetry name required"))}(a),t.track(a)},function(){return{item:a}},!a.sync)}}),n}return Object(c.e)(t,e),t}(function e(){var t,n,a,s,O,w,E,A,L,k,M,P,T,U,F,H,R,N,B=0;Object(l.e)(e,this,function(e){function l(){t=!1,e.config=Object(o.C)(!0,{},I),e.logger=new i.e(e.config),e._extensions=[],U=new g,n=[],a=null,s=null,O=null,w=null,E=null,L=null,A=[],k=null,M=null,P=null,T=!1,F=null,H=Object(v.t)("AIBaseCore",!0),R=Object(y.e)()}function j(){return Object(u.t)(G(),e.config,e)}function V(t,n){var a=function(e,t,n){var a=[],r={};return Object(o.e)(n,function(t){(Object(o.h)(t)||Object(o.h)(t.initialize))&&Object(o.H)(S);var n=t.priority,s=t.identifier;t&&n&&(Object(o.h)(r[n])?r[n]=s:Object(i.a)(e,"Two extensions have same priority #"+n+" - "+r[n]+", "+s)),(!n||n<500)&&a.push(t)}),{all:n,core:a}}(e.logger,0,A);L=a.core,E=null;var r=a.all;if(P=Object(o.w)(function(e,t,n,a){var i=[];if(e&&Object(o.e)(e,function(e){return b(i,e,n,a)}),t){var r=[];Object(o.e)(t,function(e){e.priority>500&&r.push(e)}),b(i,r,n,a)}return i}(M,r,t,e)),k){var s=Object(o.t)(r,k);-1!==s&&r.splice(s,1),-1!==(s=Object(o.t)(L,k))&&L.splice(s,1),k._setQueue(P)}else k=function(e,t){var n;function a(){return Object(u.t)(null,t.config,t,null)}function i(e,t,n,a){var i=e?e.length+1:1;function r(){0==--i&&(a&&a(),a=null)}i>0&&Object(o.e)(e,function(e){if(e&&e.queue.length>0){var a=e.chain,o=t.createNew(a);o.onComplete(r),n(o)}else i--}),r()}var r=!1,s=(n={identifier:"ChannelControllerPlugin",priority:500,initialize:function(t,n,a,i){r=!0,Object(o.e)(e,function(e){e&&e.queue.length>0&&Object(f.t)(Object(u.t)(e.chain,t,n),a)})},isInitialized:function(){return r},processTelemetry:function(t,n){i(e,n||a(),function(e){e[h.f](t)},function(){n[h.f](t)})},update:function(t,n){var a=n||{reason:0};return i(e,t,function(e){e[h.f](a)},function(){t[h.f](a)}),!0}},n[h.d]=function(){i(e,a(),function(e){e.iterate(function(e){e[h.d]&&e[h.d]()})},null)},n[h._]=function(){i(e,a(),function(e){e.iterate(function(e){e[h._]&&e[h._]()})},null)},n[h.b]=function(t,n){var a=n||{reason:0,isAsync:!1};return i(e,t,function(e){e[h.f](a)},function(){t[h.f](a),r=!1}),!0},n.getChannel=function(t){var n=null;return e&&e.length>0&&Object(o.e)(e,function(e){if(e&&e.queue.length>0&&(Object(o.e)(e.queue,function(e){if(e.identifier===t)return n=e,-1}),n))return-1}),n},n.flush=function(t,n,r,o){var s=1,c=!1,d=null;function l(){s--,c&&0===s&&(d&&(clearTimeout(d),d=null),n&&n(c),n=null)}return o=o||5e3,i(e,a(),function(e){e.iterate(function(e){if(e.flush){s++;var n=!1;e.flush(t,function(){n=!0,l()},r)||n||(t&&null==d?d=setTimeout(function(){d=null,l()},o):l())}})},function(){c=!0,l()}),!0},n._setQueue=function(t){e=t},n);return s}(P,e);r.push(k),L.push(k),e._extensions=Object(f.n)(r),k.initialize(t,e,r),Object(f.t)(j(),r),e._extensions=Object(o.w)(Object(f.n)(L||[])).slice(),n&&function(t){var n=Object(u.a)(G(),e);e._updateHook&&!0===e._updateHook(n,t)||n.processNext(t)}(n)}function z(t){var n=null,a=null;return Object(o.e)(e._extensions,function(e){if(e.identifier===t&&e!==k&&e!==U)return a=e,-1}),!a&&k&&(a=k.getChannel(t)),a&&(n={plugin:a,setEnabled:function(e){Object(f.e)(a)[h.n]=!e},isEnabled:function(){var e=Object(f.e)(a);return!e[h.b]&&!e[h.n]},remove:function(t,n){void 0===t&&(t=!0);var i=[a];K(i,{reason:1,isAsync:t},function(t){t&&V(e.config,{reason:32,removed:i}),n&&n(t)})}}),n}function G(){if(!E){var t=(L||[]).slice();-1===Object(o.t)(t,U)&&t.push(U),E=Object(u.i)(Object(f.n)(t),e.config,e)}return E}function K(t,n,a){if(t&&t.length>0){var i=Object(u.i)(t,e.config,e),r=Object(u.n)(i,e);r.onComplete(function(){var e=!1,n=[];Object(o.e)(A,function(a,i){C(a,t)?e=!0:n.push(a)}),A=n;var i=[];M&&(Object(o.e)(M,function(n,a){var r=[];Object(o.e)(n,function(n){C(n,t)?e=!0:r.push(n)}),i.push(r)}),M=i),a&&a(e)}),r.processNext(n)}else a(!1)}function W(){var t=e.logger?e.logger.queue:[];t&&(Object(o.e)(t,function(t){var n={name:F||"InternalMessageId: "+t.messageId,iKey:e.config.instrumentationKey,time:Object(o.R)(new Date),baseType:i.t.dataType,baseData:{message:t.message}};e.track(n)}),t.length=0)}function q(e,t,n,a){return k?k.flush(e,t,n||6,a):(t&&t(!1),!0)}function Q(t){var n=e.logger;n?Object(i.n)(n,2,73,t):Object(o.H)(t)}l(),e.isInitialized=function(){return t},e.initialize=function(n,i,r,s){T&&Object(o.H)(D),e.isInitialized()&&Object(o.H)("Core should not be initialized more than once"),n&&!Object(o.h)(n.instrumentationKey)||Object(o.H)("Please provide instrumentation key"),a=s,e._notificationManager=s,e.config=n||{},function(e){!0===e.disableDbgExt&&N&&(a[h.m](N),N=null),a&&!N&&!0!==e.disableDbgExt&&(N=Object(_.t)(e),a[h.e](N))}(n),function(t){!t.enablePerfMgr&&O&&(O=null),t.enablePerfMgr&&Object(o.M)(e.config,"createPerfMgr",x)}(n),n.extensions=Object(o.h)(n.extensions)?[]:n.extensions,function(e){Object(o.s)(e,m.e).NotificationManager=a}(n),r&&(e.logger=r),(A=[]).push.apply(A,Object(c.t)(Object(c.t)([],i,!1),n.extensions,!1)),M=(n||{}).channels,V(n,null),P&&0!==P.length||Object(o.H)("No channels available"),t=!0,e.releaseQueue()},e.getTransmissionControls=function(){var e=[];return P&&Object(o.e)(P,function(t){e.push(t.queue)}),Object(o.w)(e)},e.track=function(t){Object(o.M)(t,m.t,e.config.instrumentationKey,null,o._),Object(o.M)(t,"time",Object(o.R)(new Date),null,o._),Object(o.M)(t,"ver","4.0",null,o.h),!T&&e.isInitialized()?j().processNext(t):n.push(t)},e.getProcessTelContext=j,e.getNotifyMgr=function(){var t;return a||(a=Object(d.t)(((t={})[h.e]=function(e){},t[h.m]=function(e){},t[h.s]=function(e){},t[h.r]=function(e,t){},t[h.o]=function(e,t){},t)),e._notificationManager=a),a},e[h.e]=function(e){a&&a[h.e](e)},e[h.m]=function(e){a&&a[h.m](e)},e.getCookieMgr=function(){return w||(w=Object(p.n)(e.config,e.logger)),w},e.setCookieMgr=function(e){w=e},e.getPerfMgr=function(){return s||O||e.config&&e.config.enablePerfMgr&&Object(o.p)(e.config.createPerfMgr)&&(O=e.config.createPerfMgr(e,e.getNotifyMgr())),s||O||Object(r.n)()},e.setPerfMgr=function(e){s=e},e.eventCnt=function(){return n.length},e.releaseQueue=function(){if(t&&n.length>0){var e=n;n=[],Object(o.e)(e,function(e){j().processNext(e)})}},e.pollInternalLogs=function(t){F=t||null;var n=e.config.diagnosticLogInterval;return n&&n>0||(n=1e4),B&&clearInterval(B),B=setInterval(function(){W()},n)},e.stopPollingInternalLogs=function(){B&&(clearInterval(B),B=0,W())},Object(o.k)(e,function(){return U},["addTelemetryInitializer"]),e.unload=function(n,a,i){void 0===n&&(n=!0),t||Object(o.H)("SDK is not initialized"),T&&Object(o.H)(D);var r={reason:50,isAsync:n,flushComplete:!1},s=Object(u.n)(G(),e);function c(t){r.flushComplete=t,T=!0,R.run(s,r),e.stopPollingInternalLogs(),s.processNext(r)}s.onComplete(function(){l(),a&&a(r)},e),q(n,c,6,i)||c(!1)},e.getPlugin=z,e.addPlugin=function(t,n,a,i){if(!t)return i&&i(!1),void Q(S);var r=z(t.identifier);if(r&&!n)return i&&i(!1),void Q("Plugin ["+t.identifier+"] is already loaded!");var o={reason:16};function s(n){A.push(t),o.added=[t],V(e.config,o),i&&i(!0)}if(r){var c=[r.plugin];K(c,{reason:2,isAsync:!!a},function(e){e?(o.removed=c,o.reason|=32,s()):i&&i(!1)})}else s()},e.evtNamespace=function(){return H},e.flush=q,Object(o.L)(e,"addUnloadCb",function(){return R},"add")})}),A=n(186),L=function(e){function t(){var n=e.call(this)||this;return n.pluginVersionStringArr=[],n.pluginVersionString="",Object(l.e)(t,n,function(e,t){e.logger&&e.logger.queue||(e.logger=new i.e({loggingLevelConsole:1})),e.initialize=function(n,a,i,c){Object(r.t)(e,function(){return"AppInsightsCore.initialize"},function(){if(n){n.endpointUrl||(n.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/");var r=n.propertyStorageOverride;if(r&&(!r.getProperty||!r.setProperty))throw new Error("Invalid property storage override passed.");n.channels&&Object(o.e)(n.channels,function(t){t&&Object(o.e)(t,function(t){if(t.identifier&&t.version){var n=t.identifier+"="+t.version;e.pluginVersionStringArr.push(n)}})})}e.getWParam=function(){return"undefined"!=typeof document?0:-1},a&&Object(o.e)(a,function(t){if(t&&t.identifier&&t.version){var n=t.identifier+"="+t.version;e.pluginVersionStringArr.push(n)}}),e.pluginVersionString=e.pluginVersionStringArr.join(";");try{t.initialize(n,a,i,c),e.pollInternalLogs("InternalLog")}catch(t){var d=e.logger,l=Object(s.e)(t);-1!==l.indexOf("channels")&&(l+="\n - Channels must be provided through config.channels only!"),d.throwInternal(1,514,"SDK Initialization Failed - no telemetry will be sent: "+l)}},function(){return{config:n,extensions:a,logger:i,notificationManager:c}})},e.track=function(n){Object(r.t)(e,function(){return"AppInsightsCore.track"},function(){var a=n;if(a){a.timings=a.timings||{},a.timings.trackStart=Object(A.o)(),Object(A.c)(a.latency)||(a.latency=1);var i=a.ext=a.ext||{};i.sdk=i.sdk||{},i.sdk.ver=A.e;var r=a.baseData=a.baseData||{};r.properties||(r.properties={});var o=r.properties;o.version||(o.version=""),""!==e.pluginVersionString&&(o.version=e.pluginVersionString)}t.track(a)},function(){return{item:n}},!n.sync)}}),n}return Object(a.e)(t,e),t}(E);t.e=L}])),define("WacODCOwlHostWebPack",[],{});