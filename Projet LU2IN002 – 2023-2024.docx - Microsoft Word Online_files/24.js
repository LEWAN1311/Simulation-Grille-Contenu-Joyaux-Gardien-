(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[24],{432:function(e,t,n){"use strict";n.d(t,"e",function(){return f});var a=n(135),i=function(){function e(e){this._scope=new a.e,this._targetMap=new WeakMap,this._disposableMap=new WeakMap}return e.prototype.on=function(e,t,n){var a;if(r(e))a=e;else{var i=this._targetMap.get(e);i?a=i:(a=new EventTarget,this._targetMap.set(e,a))}a.addEventListener(t,n);var o=this._disposableMap.get(e);o||(o=new Map,this._disposableMap.set(e,o));var s=this._scope.attach({dispose:function(){a.removeEventListener(t,n)}});o.set(t,s)},e.prototype.off=function(e,t,n){var a;if(r(e))a=e;else{var i=this._targetMap.get(e);i&&(a=i)}var o=this._disposableMap.get(e);if(o){var s=o.get(t);s&&(s.dispose(),o.delete(t)),0===o.size&&this._disposableMap.delete(e)}a&&a.removeEventListener(t,n)},e.prototype.dispose=function(){this._scope.dispose()},e}();function r(e){return!!e.addEventListener}var o=function(){function e(e){this._scope=new a.e,this._timeoutMap=new Map}return e.prototype.setTimeout=function(e,t){var n=this,a=setTimeout(function(){n._timeoutMap.delete(a),e()},t),i=this._scope.attach({dispose:function(){clearTimeout(a)}});return this._timeoutMap.set(a,i),a},e.prototype.clearTimeout=function(e){var t=this._timeoutMap.get(e);t&&(this._timeoutMap.delete(e),t.dispose())},e.prototype.dispose=function(){this._scope.dispose()},e}(),s="handlerRejection",c="canceled",d=0,l=function(){function e(e,t){void 0===t&&(t={});var n=this,r=new Map,d={onCommand:e.onCommand,onNotification:e.onNotification},l=e.initResources,u=e.initTimeoutMs,f=void 0===u?1e4:u,p=e.ackTimeoutMs,m=void 0===p?1e3:p,_=e.resultTimeoutMs,h=void 0===_?1e4:_,b=t.asyncType,g=void 0===b?o:b,v=t.eventGroupType,y=void 0===v?i:v,S=this._scope=new a.e;S.attach(l);var D,I=this._async=S.attach(new g(this)),x=S.attach(new y(this));this._ackTimeoutMs=m,this._resultTimeoutMs=h,this._invokeCommandHandler=function(e){try{var t=d.onCommand&&d.onCommand(e);return t?Promise.resolve(t).catch(function(e){return{result:"error",error:{code:(e=e||{name:s,isExpected:!1,message:"Unknown error"}).code||e.name||s,message:e.message||"".concat(e)},isExpected:!!e.isExpected}}):Promise.resolve({result:"error",error:{code:"unsupportedCommand",message:e.command},isExpected:!0})}catch(e){return Promise.resolve({result:"error",isExpected:!1,error:{code:"handlerError",message:e&&"Name: ".concat(e.name,"; Message: ").concat(e.message||e)}})}},this._invokeNotificationHandler=function(e){try{d.onNotification&&d.onNotification(e)}catch(e){}};var C=this._port=new Promise(function(t,a){S.attach({dispose:function(){var e=new Error("Initialization canceled.");e.code=c,a(e)}}),D=I.setTimeout(function(){var e=new Error("Initialization timed out after ".concat(f,"ms"));e.code="setupTimeout",a(e)},f),e.init(function(e){I.clearTimeout(D),S.attach({dispose:function(){e.close()}}),x.on(e,"message",function(t){var a=t.data;if(a&&"object"==typeof a)return"acknowledge"===a.type?n._onAcknowledge(a):"command"===a.type?n._onCommand(e,a):"notification"===a.type?n._onNotification(a):"result"===a.type?n._onResult(a):void 0}),e.start(),t(e)},a)});this.ready=C.then(function(){},function(e){return n.dispose(),Promise.reject(e)}),this._signals=r}return e.prototype.dispose=function(){this._scope.dispose(),this._signals.forEach(function(e){e.resolve({result:"error",isExpected:!0,error:{code:c,message:"Messenger disposed"}})}),this._signals.clear()},e.prototype.sendCommand=function(e,t){var n=this;if(void 0===t&&(t={}),this._scope.isDisposed)return Promise.resolve({result:"error",isExpected:!1,error:{code:"disposed",message:"disposed"}});var a=++d,i=t.timeoutDelayMs,r=void 0===i?this._resultTimeoutMs:i,o=t.acknowledgeTimeoutMs,s=void 0===o?this._ackTimeoutMs:o,c=t.transfer;return this._port.then(function(t){var i=n._async,o=new Promise(function(e){n._signals.set(a,{acknowledgeTimeout:i.setTimeout(function(){n._onResult(u(a,"acknowledgeTimeout"))},s),resultTimeout:i.setTimeout(function(){n._onResult(u(a,"resultTimeout"))},r),resolve:e})});return t.postMessage({type:"command",id:a,data:e},c||[]),o})},e.prototype.sendNotification=function(e){this._scope.isDisposed||this._port.then(function(t){t.postMessage({type:"notification",data:e})})},e.prototype._onAcknowledge=function(e){var t=this._signals.get(e.id);t&&this._async.clearTimeout(t.acknowledgeTimeout)},e.prototype._onCommand=function(e,t){var n=t.id;e.postMessage({type:"acknowledge",id:n}),this._invokeCommandHandler(t.data).then(function(t){e.postMessage({type:"result",data:t,id:n})}).catch(function(e){})},e.prototype._onNotification=function(e){this._invokeNotificationHandler(e.data)},e.prototype._onResult=function(e){var t=e.id,n=this._async,a=this._signals,i=a.get(t);i&&(n.clearTimeout(i.acknowledgeTimeout),n.clearTimeout(i.resultTimeout),i.resolve(e.data)),a.delete(t)},e}();function u(e,t){return{id:e,data:{result:"error",error:{code:t,message:"Timed out"},isExpected:!1}}}function f(e,t){void 0===t&&(t={});var n=e.channelId,r=e.onReinitialize,o=e.origin,s=e.receiver,c=void 0===s?window:s,d=e.source,u=e.identifyParent,f=t.eventGroupType,p=void 0===f?i:f,m=t.messengerType,_=void 0===m?l:m,h=new a.e,b=h.attach(new p(null));return new _({onCommand:e.onCommand,onNotification:e.onNotification,init:function(e,t){var a;if(u&&d){var i=setInterval(function(){var e={type:"identify-parent",channelId:n};d.postMessage(e,o)},100);a=h.attach({dispose:function(){clearInterval(i)}})}var s=!1;b.on(c,"message",function(t){var i=t.data;if(t.origin===o&&(!d||t.source===d)&&i&&"object"==typeof i&&"initialize"===i.type&&i.channelId===n){if(a&&a.dispose(),r){if(s)return r(),void b.dispose();s=!0}else b.dispose();var c=i.replyTo;c.postMessage({type:"activate"}),e(c)}})},initResources:h,initTimeoutMs:e.initTimeoutMs,ackTimeoutMs:e.ackTimeoutMs,resultTimeoutMs:e.resultTimeoutMs})}},585:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(0),i=n(432),r=n(15),o=function(e){function t(t){var n=this,r=t.initTimeoutMs,o=void 0===r?4e4:r,s=Object(a.r)(t,["initTimeoutMs"]);return(n=e.call(this)||this)._customerPromiseLogger=s.customerPromiseLogger,n._messenger=Object(i.e)(Object(a.e)(Object(a.e)({},s),{initTimeoutMs:o,identifyParent:!0,onCommand:n._onCommand.bind(n),onNotification:n._onNotificiation.bind(n)})),n}return Object(a.a)(t,e),t.prototype.sendShareDestruct=function(){return this._send({command:"shareCommand",name:"share_destruct"})},t.prototype.sendShareRevisible=function(e){return e.command="shareCommand",this._send(e)},t.prototype.sendSharingContextInformation=function(e){var t={command:"shareCommand",name:"share_postContextInformation",data:e};return this._send(t)},t.prototype.sendNewToken=function(e,t,n){var a={command:"shareCommand",name:"share_newToken"};return e?a.token=e:t&&(a.error=t,a.errorDetails=n),this._send(a)},t.prototype.sendDocumentInformation=function(e){var t={command:"shareCommand",name:"share_documentInformation",data:{documentInformation:e}};return this._send(t)},t.prototype.sendSharingInfoBarInformation=function(e){var t={command:"shareCommand",name:"share_sharingInfoBarInformation",data:{sharingInfoBarInformation:e}};return this._send(t)},t.prototype._send=function(e){var t=this;return this._messenger.sendCommand(e).then(function(e){return!!e}).catch(function(n){var a;return null===(a=t._customerPromiseLogger)||void 0===a||a.end({resultType:r.t.Failure,errorCode:"SharingHostMessenger - send ".concat(e.name," failed"),extraData:{errorMessage:n.toString()}}),!1})},t}(function(){function e(){this._commandHandlers=[],this._notificationHandlers=[]}return Object.defineProperty(e.prototype,"ready",{get:function(){return this._messenger.ready},enumerable:!1,configurable:!0}),e.prototype.sendCommand=function(e,t){return this._messenger.sendCommand(e,t)},e.prototype.sendNotification=function(e){return this._messenger.sendNotification(e)},e.prototype.addCommandHandler=function(e){var t=this;return this._commandHandlers.push(e),{dispose:function(){var n=t._commandHandlers.indexOf(e);n>-1&&t._commandHandlers.splice(n,1)}}},e.prototype.addNotificationHandler=function(e){var t=this;return this._notificationHandlers.push(e),{dispose:function(){var n=t._notificationHandlers.indexOf(e);n>-1&&t._notificationHandlers.splice(n,1)}}},e.prototype.dispose=function(){this._messenger.dispose()},e.prototype._onCommand=function(e){for(var t=0,n=this._commandHandlers;t<n.length;t++){var a=(0,n[t])(e);if(a)return a}},e.prototype._onNotificiation=function(e){for(var t=0,n=this._notificationHandlers;t<n.length;t++)(0,n[t])(e)},e}())},789:function(e,t,n){"use strict";n.r(t),n.d(t,"ShareDialog",function(){return M});var a=n(0),i=n(28),r=n(534),o=n(582),s=n(420),c=n(117),d=n(465),l=n(214);Object(l.e)([{rawString:".sharingContents_15e9006e{display:flex;min-height:130px;min-width:320px;justify-content:center;align-items:center}.sharingContents_15e9006e.fullScreen_15e9006e{width:100%!important;height:100%!important}.sharingContents_15e9006e iframe{border:none;width:0}.errorContainer_15e9006e{padding:20px;max-width:280px;font-size:14px}.errorCode_15e9006e{margin-top:30px;font-size:12px;color:#605e5c;display:block}.spinner_15e9006e{position:absolute;top:50%;left:50%}"}]);var u=n(677),f=n(139),p=n(78),m=n(585),_=n(97),h=n(7),b=n(228),g=n(15),v=h.t.isActivated("45a2c5f9-21b8-4775-9e30-4e61d1f67106","02/02/2022","use new share Messenger for cross window communication")||_.e.isFeatureEnabled({ECS:1000619}),y=h.e.isActivated("FBB80417-B626-42B0-9DF6-872E93DD94F6","11/11/2022","ODC Share Fullscreen"),S=h.t.isActivated("c955a4da-3903-4543-b013-65983fc9c20c","02/02/2022","add share_destruct callback, so oneUp can integrate"),D=!h.t.isActivated("a184532b-d640-4bf5-84ad-f7daf50cac5f","07/03/2023","Enable referral telemtry to be use in share link in SWA"),I={sharingInformation:void 0,isSharingDialogLoaded:!1,didSharingHappen:!1,iframeSource:"#",iframeHeight:0,error:void 0,isWindowEventReceived:!1},x=function(e){function t(t){var n=e.call(this,t)||this;return n._channelId=p.e.generate(),n._setElementRef=function(e){n._iframeRef=e,v||!(null==e?void 0:e.contentWindow)||n._sharingHostMessenger||n.state.isWindowEventReceived||(n._sharingHostMessenger=n._createSharingHostMessenger(e.contentWindow),n.props.setSharingHostMessenger&&n.props.setSharingHostMessenger(n._sharingHostMessenger)),n.props.setElementRef&&n.props.setElementRef(e)},n._onClose=function(){var e=n.state.error;n.state.didSharingHappen?n.props.resolve():e?n.props.reject(e):n.props.reject(new c.e),n.setState({error:void 0,isSharingDialogLoaded:!1})},n._listenForMessages=function(e){var t;try{t=JSON.parse(e.data)}catch(e){return}var a=t.name;if(a===d.e.ScriptLoaded)n.setState({isWindowEventReceived:!0});else if(a===d.e.Resize&&t.height)n.setState({iframeHeight:t.height});else if(a===d.e.Ready)n.setState({isSharingDialogLoaded:!0}),n.props.onShareReady();else if(a===d.e.Error)t.error?n.setState({error:t.error}):n.setState({error:{name:"ShareError",message:u.n}});else if(a===d.e.ShareCompleted)n.setState({didSharingHappen:!0});else if(a===d.e.Dismiss)n._sharePrefetchRef&&n._sharePrefetchRef.current&&(n._sharePrefetchRef.current.tabIndex=1,n._sharePrefetchRef.current.focus()),n._onClose(),n.props.onModalClose();else if(a===d.e.ManageAccessClicked){var i=n.props.openManageAccess;i&&(i(),n._onClose())}else a===d.e.GrantAccessCompleted?n.props.onGrantAccessCompleted(t):a===d.e.ReadyForRecipients?n.props.onReadyForRecipients():a===d.e.InstantLoadReady?(n.setState({isSharingDialogLoaded:!0}),n.props.onShareReady()):a===d.e.Destruct&&(S||n.props.onModalDestruct&&n.props.onModalDestruct())},n._getSharingInformation=function(){return Object(a.t)(n,void 0,void 0,function(){var e,t;return Object(a.i)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.props.getSharingInformation()];case 1:if(!(e=n.sent()))throw new Error("Failed to get sharing information");return this.setState({sharingInformation:e}),[3,3];case 2:return t=n.sent(),this.props.reject(t),[3,3];case 3:return[2]}})})},n._update=function(e){var t,a,i,r,o=n.state.sharingInformation;if(o&&!e.sharingInformation){var s=o.authToken,c=o.webAbsoluteUrl,d=o.serverRelativeItemUrl,l=o.listUrl,u=o.cookieAuthIframeUrl,p=o.uniqueId,m=o.isFolder,_=o.listId,h=o.cookieAuthIframeUrlForCrossDomain,b=n.props,g=b.initializeShareFrame,v=b.defaultRecipients,S=b.openManageAccess,I=void 0;switch(n.props.mode){case 2:I="&mode=copy";break;case 5:I="&mode=manageAccess";break;case 7:I="&mode=addPeople";break;case 3:I="&mode=atMention";break;default:I=""}var x="";n.props.fullScreenMode&&(x+="&fullScreenMode=true"),n.props.itemName&&(x+="&itemName=".concat(encodeURIComponent(n.props.itemName)));var C=null===(a=(t=n.props).getNav)||void 0===a?void 0:a.call(t);C&&(x+="&nav=".concat(encodeURIComponent(C)));var O=null===(r=(i=n.props).navIdSendLinkOverride)||void 0===r?void 0:r.call(i);O&&(x+="&navIdSendLinkOverride=".concat(encodeURIComponent(O))),D&&n.props.optInSendNavIdInShareLink&&(x+="&optInSendNavIdInShareLink=".concat(n.props.optInSendNavIdInShareLink));var w=y?c&&d&&l||p&&_:c&&d&&l||p&&_||o.itemId||c&&p&&!!m;if(s&&w&&g){h&&(o.cookieAuthIframeUrlForCrossDomain="".concat(h).concat(I).concat(x));var E=n.props;g({parentElement:n._sharePrefetchRef.current,sharingInformation:o,calloutProps:E,onReady:function(){n.setState({isSharingDialogLoaded:!0})},onDismiss:n.props.onModalClose,onError:function(e){n.setState({error:e})}})}else if(u){var A="".concat(u).concat(I).concat(v&&v.length>0?"&defaultRecipients=".concat(encodeURI(v.join(","))):"","&ma=").concat(S?1:0).concat(x,"&channelId=").concat(n._channelId,"&origin=").concat(encodeURIComponent(new f.e(u).authority));n.setState({iframeSource:A})}else n.props.reject(new Error("Missing sharing information"))}},n.state=Object(a.e)(Object(a.e)({},I),{iframeHeight:n.props.iframeInitialHeight||0}),n._sharePrefetchRef=i.createRef(),n._shareCustomerPromiseLogger=new b.e({scenario:"SharingIframe.load",perfGoalInMs:3e4}),n}return Object(a.a)(t,e),t.prototype.UNSAFE_componentWillMount=function(){this._getSharingInformation()},t.prototype.componentDidMount=function(){window.addEventListener("message",this._listenForMessages,!1);try{this._update(I)}catch(e){this._shareCustomerPromiseLogger.end({resultType:g.t.Failure,errorCode:"sharingIframeUpdateError",extraData:{clientId:this.props.getClientId(),mode:this.props.mode,errorDetail:e.toString()}})}},t.prototype.componentDidCatch=function(e,t){this._shareCustomerPromiseLogger.end({resultType:g.t.Failure,errorCode:"sharingIframeUpdateError",extraData:{clientId:this.props.getClientId(),mode:this.props.mode,errorInfo:t,errorDetail:e.toString()}})},t.prototype.componentWillUnmount=function(){this._onClose(),window.removeEventListener("message",this._listenForMessages,!1)},t.prototype.componentDidUpdate=function(e,t){this._update(t)},t.prototype.render=function(){var e,t,n,a=this.state,r=a.isSharingDialogLoaded,c=a.iframeSource,d=a.iframeHeight,l=a.error,f=l,p=f&&f.resultCode&&f.resultCode.indexOf("ShareDomainNotReachable")>=0?i.createElement("div",{className:"".concat("errorContainer_15e9006e")},i.createElement("span",null,u.n),i.createElement("span",{className:"".concat("errorCode_15e9006e")},"(",f.resultCode,")")):null,m=2===this.props.mode?120:475,_=null===(t=null===(e=this._sharePrefetchRef.current)||void 0===e?void 0:e.parentElement)||void 0===t?void 0:t.style.maxHeight,h=_?parseInt(_,10):0;return n=d?h?h>d?d:h:d:m,i.createElement("div",{className:"".concat("sharingContents_15e9006e","\n        ").concat(this.props.fullScreenMode?"fullScreen_15e9006e":""),ref:this._sharePrefetchRef,style:{height:"".concat(n,"px")}},!r&&!l&&i.createElement(o.e,{className:"spinner_15e9006e",tabIndex:0,"aria-live":"assertive","aria-label":u.e,size:s.e.large}),p,"#"===c?null:i.createElement("iframe",{id:"shareFrame",name:"shareFrame",title:u.t,src:c,style:{visibility:r?"visible":"hidden",width:"100%",height:"100%"},ref:this._setElementRef}))},t.prototype._createSharingHostMessenger=function(e){var t=this;this._clientOrigin=new f.e(this.state.iframeSource).authority;var n=new m.e({origin:this._clientOrigin,channelId:this._channelId,source:e,customerPromiseLogger:this._shareCustomerPromiseLogger});return n.addCommandHandler(function(e){try{switch(e.name){case d.e.ScriptLoaded:break;case d.e.Ready:t.setState({isSharingDialogLoaded:!0}),t._shareCustomerPromiseLogger.end({resultType:g.t.Success}),t.props.onShareReady();break;case d.e.Error:e.error?t.setState({error:e.error}):t.setState({error:{name:"ShareError",message:u.n}});break;case d.e.ShareCompleted:t.setState({didSharingHappen:!0});break;case d.e.Dismiss:t._sharePrefetchRef&&t._sharePrefetchRef.current&&(t._sharePrefetchRef.current.tabIndex=1,t._sharePrefetchRef.current.focus()),t._onClose(),t.props.onModalClose();break;case d.e.ManageAccessClicked:t.props.openManageAccess&&(t.props.openManageAccess(),t._onClose());break;case d.e.GrantAccessCompleted:t.props.onGrantAccessCompleted(e);break;case d.e.ReadyForRecipients:t.props.onReadyForRecipients();break;case d.e.InstantLoadReady:t.setState({isSharingDialogLoaded:!0}),t.props.onShareReady()}return{result:"success"}}catch(e){t._shareCustomerPromiseLogger.end({resultType:g.t.Failure,errorCode:"sharingIframeUpdateError",extraData:{clientId:t.props.getClientId(),mode:t.props.mode,error:e.toString()}})}}),n},t}(i.PureComponent),C=n(279),O=(n(450),C.n.isFeatureEnabled({ODB:60149})),w=null;function E(){w=null}var A={isOpen:!0,isVisible:!0},L=_.e.isFeatureEnabled({ODB:60577}),k="LoadShareDialog",M=function(e){function t(t){var n=e.call(this,t)||this;return n.makeVisibleAgain=function(e){n.setState({isVisible:!0}),e?n._sharingHostMessenger?n._sharingHostMessenger.sendShareRevisible(e):n._target&&n._target.postMessage(JSON.stringify(e),"*"):E()},n._setSharingHostMessenger=function(e){n._sharingHostMessenger=e||null,n.props.setSharingHostMessenger&&n.props.setSharingHostMessenger(e)},n._setTopElementRef=function(e){e?(n._iframe=e,n._target=n._iframe.contentWindow):(n._target=null,n._iframe=e),n.props.setElementRef&&n.props.setElementRef(e)},n._onClose=function(){if(O){n.setState({isVisible:!1});var e={name:d.e.Destruct};n._sharingHostMessenger?n._sharingHostMessenger.sendShareDestruct():n._target&&n._target.postMessage(JSON.stringify(e),"*")}else n.setState({isOpen:!1});n._setQosResult(g.t.ExpectedFailure,"Dialog Canceled")},n._onShareReady=function(){n.props.onShareReady&&n.props.onShareReady(),n._setQosResult(g.t.Success,"ShareDialogLoaded")},n._renderFullScreenShareIframe=function(){var e=n.props,t=e.sharingIFrameAs,o=void 0===t?x:t,s=Object(a.r)(e,["sharingIFrameAs"]);return s.fullScreenMode=!0,i.createElement(r.e,{className:"sharingModal",onDismiss:n._onClose,isOpen:!!n.state.isOpen,styles:{root:{display:O&&!n.state.isVisible?"none":"unset"},main:{backgroundColor:"transparent",boxShadow:"none",position:"absolute",top:0,left:0,height:"100% !important",width:"100% !important",maxHeight:"unset",maxWidth:"unset",overflow:"hidden"},scrollableContent:{width:"100% !important",height:"100% !important",maxHeight:"unset",maxWidth:"unset",overflow:"hidden"}}},i.createElement(o,Object(a.e)({},s,{onModalClose:n._onClose.bind(n),onShareReady:n._onShareReady.bind(n),setElementRef:n._setTopElementRef,setSharingHostMessenger:n._setSharingHostMessenger})))},n.state=A,n._initQos(),n}return Object(a.a)(t,e),t.prototype.componentDidMount=function(){var e;e=this.makeVisibleAgain,O&&!w&&(w=e)},t.prototype.componentWillUnmount=function(){E()},t.prototype.render=function(){var e;if(L||this.props.iFrameFullScreenOverride)return this._renderFullScreenShareIframe();if(null===(e=this.state)||void 0===e?void 0:e.isOpen){var t=this.props,n=t.sharingIFrameAs,o=void 0===n?x:n,s=Object(a.r)(t,["sharingIFrameAs"]);return i.createElement(r.e,{onDismiss:this._onClose,isOpen:!!this.state.isOpen,styles:{main:{maxWidth:"unset",maxHeight:"unset",minHeight:"unset"},scrollableContent:{overflow:"hidden"}}},i.createElement(o,Object(a.e)({},s,{onModalClose:this._onClose.bind(this),onShareReady:this._onShareReady.bind(this),setElementRef:this._setTopElementRef,setSharingHostMessenger:this._setSharingHostMessenger})))}return null},t.prototype._initQos=function(){this._qos=new g.e({name:k,extraData:{clientId:this.props.getClientId()}});var e={name:k,resultType:g.t.Failure,resultCode:"Dialog not loaded in time"};this._qos.setTimeout(1e4,e)},t.prototype._setQosResult=function(e,t,n){this._qos&&(this._qos.end({resultType:e,resultCode:t,error:n}),this._qos=null)},t}(i.PureComponent)}}]);