var Microsoft="object"==typeof Microsoft?Microsoft:{};Microsoft.Office=Microsoft.Office||{},Microsoft.Office.SharedAuthClient=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=12)}([,function(e,t,r){"use strict";(function(e){
/*!
 * Microsoft Dynamic Proto Utility, 1.1.9
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
var n;r.d(t,"a",(function(){return _}));var o=Object,i=o.getPrototypeOf,a=o.getOwnPropertyNames;var s,c=("undefined"!=typeof globalThis&&(s=globalThis),s||"undefined"==typeof self||(s=self),s||"undefined"==typeof window||(s=window),s||void 0===e||(s=e),s||{}),u=c.__dynProto$Gbl||(c.__dynProto$Gbl={o:(n={},n.setInstFuncs=!0,n.useBaseInst=!0,n),n:1e3});function l(e,t){return e&&o.prototype.hasOwnProperty.call(e,t)}function d(e){return e&&(e===o.prototype||e===Array.prototype)}function h(e){return d(e)||e===Function.prototype}function p(e){var t;if(e){if(i)return i(e);var r=e.__proto__||e.prototype||(e.constructor?e.constructor.prototype:null);t=e._dyn__proto__||r,l(e,"_dyn__proto__")||(delete e._dynInstProto,t=e._dyn__proto__=e._dynInstProto||e._dyn__proto__,e._dynInstProto=r)}return t}function f(e,t){var r=[];if(a)r=a(e);else for(var n in e)"string"==typeof n&&l(e,n)&&r.push(n);if(r&&r.length>0)for(var o=0;o<r.length;o++)t(r[o])}function g(e,t,r){return"constructor"!==t&&"function"==typeof e[t]&&(r||l(e,t))}function m(e){throw new TypeError("DynamicProto: "+e)}function v(e,t){for(var r=e.length-1;r>=0;r--)if(e[r]===t)return!0;return!1}function y(e,t,r,n){var o=null;if(e&&l(r,"_dynClass")){var i=e._dynInstFuncs||{};if((o=(i[r._dynClass]||{})[t])||m("Missing ["+t+"] function"),!o._dynInstChk&&!1!==i._dynInstChk){for(var a=!l(e,t),s=p(e),c=[];a&&s&&!h(s)&&!v(c,s);){var u=s[t];if(u){a=u===n;break}c.push(s),s=p(s)}try{a&&(e[t]=o),o._dynInstChk=1}catch(e){i._dynInstChk=!1}}}return o}function C(e,t,r){var n=t[e];return n===r&&(n=p(t)[e]),"function"!=typeof n&&m("["+e+"] is not a function"),n}function T(e,t,r,n,o){if(!d(e)){var i=r._dynInstFuncs=r._dynInstFuncs||{},a=i[t]=i[t]||{};!1!==i._dynInstChk&&(i._dynInstChk=!!o),f(r,(function(t){g(r,t,!1)&&r[t]!==n[t]&&(a[t]=r[t],delete r[t],(!l(e,t)||e[t]&&!e[t]._isDynProxy)&&(e[t]=function(e,t){var r=function(){var n=y(this,t,e,r)||C(t,e,r);return n.apply(this,arguments)};return r._isDynProxy=1,r}(e,t)))}))}}function E(e,t){return l(e,"prototype")?e.name||t||"_unknown_":((e||{}).constructor||{}).name||t||"_unknown_"}function _(e,t,r,n){l(e,"prototype")||m("theClass is an invalid class definition.");var o=e.prototype;(function(e,t){if(i){for(var r=[],n=p(t);n&&!h(n)&&!v(r,n);){if(n===e)return!0;r.push(n),n=p(n)}return!1}return!0})(o,t)||m("["+E(e)+"] not in hierarchy of ["+E(t)+"]");var a=null;l(o,"_dynClass")?a=o._dynClass:(a="_dynCls$"+E(e,"_")+"$"+u.n,u.n++,o._dynClass=a);var s=_._dfOpts,c=!!s.useBaseInst;c&&n&&void 0!==n.useBaseInst&&(c=!!n.useBaseInst);var d=function(e){var t={};return f(e,(function(r){!t[r]&&g(e,r,!1)&&(t[r]=e[r])})),t}(t);r(t,function(e,t,r,n){function o(e,t,r){var o=t[r];if(o._isDynProxy&&n){var i=e._dynInstFuncs||{};!1!==i._dynInstChk&&(o=(i[t._dynClass]||{})[r]||o)}return function(){return o.apply(e,arguments)}}var a={};f(r,(function(e){a[e]=o(t,r,e)}));for(var s=p(e),c=[];s&&!h(s)&&!v(c,s);)f(s,(function(e){!a[e]&&g(s,e,!i)&&(a[e]=o(t,s,e))})),c.push(s),s=p(s);return a}(o,t,d,c));var y=!!i&&!!s.setInstFuncs;y&&n&&(y=!!n.setInstFuncs),T(o,a,t,d,!1!==y)}_._dfOpts=u.o}).call(this,r(9))},function(e,t,r){"use strict";r.d(t,"h",(function(){return n})),r.d(t,"j",(function(){return o})),r.d(t,"l",(function(){return i})),r.d(t,"k",(function(){return a})),r.d(t,"i",(function(){return s})),r.d(t,"g",(function(){return c})),r.d(t,"b",(function(){return u})),r.d(t,"f",(function(){return l})),r.d(t,"a",(function(){return d})),r.d(t,"c",(function(){return h})),r.d(t,"d",(function(){return p})),r.d(t,"e",(function(){return f}));var n="function",o="object",i="undefined",a="prototype",s="hasOwnProperty",c="default",u=Object,l=u[a],d=u.assign,h=u.create,p=u.defineProperty,f=l[s]},,,function(e,t,r){window,e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}({"./packages/Microsoft.Office.WebAuth.BrowserAuth/lib/api.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logUserAction=function(e,t,r,n,o,i,a){void 0===t&&(t=!0),void 0===r&&(r="Unknown"),void 0===n&&(n="Unknown"),void 0===o&&(o="Unknown"),void 0===i&&(i=0),void 0===a&&(a=[]),c({name:null,actionName:e,commandSurface:o,parentName:r,triggerMethod:n,durationMs:i,succeeded:t,dataFields:a})},t.logActivity=function(e,t,r,n){void 0===t&&(t=!0),void 0===r&&(r=0),void 0===n&&(n=[]),s({name:e,succeeded:t,durationMs:r,dataFields:n})},t.sendTelemetryEvent=function(e){u({kind:"event",event:e,timestamp:(new Date).getTime()})},t.sendActivityEvent=s,t.sendOtelEvent=function(e){u({kind:"otel",event:e})},t.sendUserActionEvent=c,t.addNamespaceMapping=function(e,t){u({kind:"addNamespaceMapping",namespace:e,ariaTenantToken:t})},t.setEnabledState=function(e){(o=e)||(i=[])},t.shutdown=function(){return u({kind:"shutdown"}),i.length+a},t.registerEventHandler=function(e){n=e,i.forEach((function(e){return u(e)})),i=[]};var n,o=!1,i=[],a=0;function s(e){u({kind:"activity",event:e,timestamp:(new Date).getTime()})}function c(e){u({kind:"action",event:e,timestamp:(new Date).getTime()})}function u(e){o&&(n?n(e):i.length<=2e4?i.push(e):a+=1)}},"./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/BrowserAuth.ts":function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.CheckUpnMatchIdToken=t.GetApplication=t.GetTokenOnce=t.GetToken=t.Load=void 0;var i,a,s=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/Constants.ts"),c=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/LoggingUtils.ts"),u=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/ValidateUtils.ts"),l=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/TimerUtils.ts"),d=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/lib/api.js");function h(e,t){var r=l.TimerUtils.timer();return(a=e).enableConsoleLogging&&(c.LoggingUtils.enableConsoleLogging=a.enableConsoleLogging),a.enableUpnCheck&&(u.ValidateUtils.enableUserInfoCheck=a.enableUpnCheck),a.authority&&(a.authority=a.authority.replace(s.Constants.Authority.ProdLegacy,s.Constants.Authority.Prod)),a.idp.toLowerCase()===s.Constants.IdentityProvider.Msa.toLowerCase()?a.authority=s.Constants.Authority.Prod+s.Constants.Authority.MsaSuffix:(a.authority||(a.authority=s.Constants.Authority.Prod+s.Constants.Authority.AadSuffix),a.authority.indexOf(s.Constants.Authority.AadSuffix)<0&&("/"==a.authority.charAt(a.authority.length-1)?a.authority+=s.Constants.Authority.AadSuffix:a.authority+="/"+s.Constants.Authority.AadSuffix)),function(e){return void 0===e&&(e=2e3),new Promise((function(t,r){var n=0,o=setInterval((function(){return n+=500,function(){try{return void 0!==msal&&!!msal}catch(e){return!1}}()?(clearInterval(o),t(msal)):n>e?(clearInterval(o),r(null)):void 0}),500)}))}(a.timeoutToLoad?a.timeoutToLoad:2e3).then((function(e){var n;i=new Array;for(var o=0,l=a.appIds;o<l.length;o++){var d=l[o];if(c.LoggingUtils.log("[Load->MsalWrapper->MsalInit] "+d+": "+a.idp),d&&u.ValidateUtils.isGuid(d)){var h={applicationId:d,application:new e.PublicClientApplication({auth:{clientId:d,authority:a.authority,redirectUri:a.redirectUri?a.redirectUri.split("?")[0]:location.href.split("?")[0],navigateToLoginRequestUrl:!a.navigateToLoginRequestUrl||a.navigateToLoginRequestUrl},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!1},system:{loadFrameTimeout:a.timeout?a.timeout:6e3}})};i.push(h),n||(n=d)}}return n?(c.LoggingUtils.log("[Load->SsoSilentWrapper] "+n+": idp["+a.idp+"], target:["+a.prefetch+"]"),Promise.all(function(e,t,r){var n=e.idp.toLowerCase()===s.Constants.IdentityProvider.Msa.toLowerCase(),o=[];if(console.log("configuration.prefetch:"+e.prefetch),e.prefetch&&e.prefetch.length>0&&e.prefetch.forEach((function(i){if(i){var a=f(t,e.upn,n?s.Constants.Authority.MsaSuffix:s.Constants.Authority.AadSuffix,[u.ValidateUtils.getScope(i)],r);o.push(a)}})),0==o.length){var i=f(t,e.upn,n?s.Constants.Authority.MsaSuffix:s.Constants.Authority.AadSuffix,[],r);o.push(i)}return o}(a,n,t)).then((function(e){return e.forEach((function(e){c.LoggingUtils.log("[Load->SsoSilentWrapper] "+n+": success: "+e.idTokenClaims.aud)})),e.length>0&&g(n).setActiveAccount(e[0].account),m(!0,t,i,r)})).catch((function(e){return c.LoggingUtils.log("[Load->SsoSilentWrapper] "+n+": error: ["+e.errorCode+"]"+e.errorMessage),m(!0,t,i,r,e.errorCode,e.errorMessage)}))):Promise.reject(m(!1,t,i,r))})).catch((function(){return c.LoggingUtils.log("[Load->MsalWrapper] msal is not loaded"),Promise.reject(m(!1,t,i,r))}))}function p(e,t,r,i,d,h,p){var m=this;void 0===h&&(h=!1);var y=l.TimerUtils.timer(),C=i||d,T=!1,E=g(t),_={},I=a.idp.toLowerCase()===s.Constants.IdentityProvider.Msa.toLowerCase();if(r&&u.ValidateUtils.isGuid(r)||(r=void 0),!e)return _.ErrorCode="missing_target",_.ErrorMessage="The provided target for BrowserAuth.GetToken is null, blank or empty",Promise.reject(v(_,r,t,h,y,void 0));if(!t||!u.ValidateUtils.isGuid(t))return _.ErrorCode="invalid_application_ID",_.ErrorMessage="The provided application ID for BrowserAuth.GetToken is null, blank, empty or with invalid format",Promise.reject(v(_,r,t,h,y,[e]));if(void 0===E||!E)return _.ErrorCode="missing_msal",_.ErrorMessage="BrowserAuth can't find msal instance",Promise.reject(v(_,r,t,h,y,[e]));var w=function(e){return new Promise((function(r,i){return n(m,void 0,void 0,(function(){return o(this,(function(n){switch(n.label){case 0:return c.LoggingUtils.log("[GetToken->acquireToken] "+t+": popup:["+C+"]"),_={},[4,(C?E.acquireTokenPopup(e):E.acquireTokenSilent(e)).then((function(e){return _.MsalResult=e,e.accessToken?u.ValidateUtils.matchUserInfoFromIdToken(e.idToken,a)&&(h||I||u.ValidateUtils.matchUserInfoFromAccessToken(e.accessToken,a))?(_.Token=e.accessToken,c.LoggingUtils.log("[GetToken->acquireToken] "+t+": success: "+_.Token),r(_)):(_.ErrorCode="upn_mismatch",_.ErrorMessage="upn doesn't match with given upn in config",c.LoggingUtils.log("[GetToken->acquireToken] "+t+": error: ["+_.ErrorCode+"]"+_.ErrorMessage),i(_)):(_.ErrorCode="no_tokens_found",_.ErrorMessage="Access token doesn't exist in auth response",c.LoggingUtils.log("[GetToken->acquireToken] "+t+": error: ["+_.ErrorCode+"]"+_.ErrorMessage),i(_))})).catch((function(n){if(_.MsalResult=n,_.ErrorCode=n.errorCode,_.ErrorMessage=n.errorMessage,c.LoggingUtils.log("[GetToken->acquireToken] "+t+": error: ["+_.ErrorCode+"]"+_.ErrorMessage),C||!T)return i(_);C=!0,c.LoggingUtils.log("[GetToken->acquireToken] "+t+": retry: popup:["+C+"]"),w(e).then((function(e){return r(e)})).catch((function(e){return i(e)}))}))];case 1:return n.sent(),[2]}}))}))}))},S={scopes:[u.ValidateUtils.getScope(e)],account:{username:a.upn},loginHint:a.upn,extraQueryParameters:{domain_hint:I?s.Constants.Authority.MsaSuffix:s.Constants.Authority.AadSuffix},correlationId:r,claims:p};return w(S).catch((function(e){return n(m,void 0,void 0,(function(){var i,u=this;return o(this,(function(l){switch(l.label){case 0:return i=!1,"no_tokens_found"!==e.ErrorCode?[3,2]:(c.LoggingUtils.log("[GetToken->acquireToken] "+t+": no_tokens_found"),[4,f(t,a.upn,I?s.Constants.Authority.MsaSuffix:s.Constants.Authority.AadSuffix,S.scopes,r).then((function(e){return n(u,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return c.LoggingUtils.log("[GetToken->acquireToken->SsoSilentWrapper] "+t+": success"),g(t).setActiveAccount(e.account),[4,w(S).then((function(e){i=!0,_=e})).catch((function(e){_=e}))];case 1:return r.sent(),[2]}}))}))})).catch((function(e){return n(u,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return _.ErrorCode=e.errorCode,_.ErrorMessage=e.errorMessage,c.LoggingUtils.log("[GetToken->acquireToken->SsoSilentWrapper] "+t+": error: ["+_.ErrorCode+"]"+_.ErrorMessage),"login_required"===e.errorCode&&(e.errorMessage.startsWith("AADSTS50058")||e.errorMessage.startsWith("Silent authentication was denied"))&&a.autoPopup?(T=!0,[4,w(S).then((function(e){i=!0,_=e})).catch((function(e){c.LoggingUtils.log("[GetToken->acquireToken->SsoSilentWrapper->Popup] "+t+": error: ["+_.ErrorCode+"]"+_.ErrorMessage),_=e}))]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))}))]);case 1:l.sent(),l.label=2;case 2:return c.LoggingUtils.log("[GetToken->acquireToken->isSuccess] "+t+": ["+i+"]"),_=v(_,r,t,h,y,S.scopes),[2,i?Promise.resolve(_):Promise.reject(_)]}}))}))})).then((function(e){return c.LoggingUtils.log("[GetToken->acquireToken] "+t+": success"),Promise.resolve(v(e,r,t,h,y,S.scopes))}))}function f(e,t,r,n,o){return g(e).ssoSilent({scopes:n,loginHint:t,extraQueryParameters:{domain_hint:r},correlationId:o})}function g(e){var t;return i&&i.some((function(r){return e&&r.applicationId&&e.toUpperCase()===r.applicationId.toUpperCase()?(t=r.application,c.LoggingUtils.log("[GetApplication] "+e+": Found"),!0):(c.LoggingUtils.log("[GetApplication] "+e+": Not Found"),!1)})),t}function m(e,t,r,n,o,i){if(!a.telemetryInstance&&"undefined"==typeof OTel){var c=[{name:s.Constants.Telemetry.Duration,int64:n.ms},{name:s.Constants.Telemetry.Succeeded,bool:!0},{name:s.Constants.Telemetry.IdentityProvider,string:a.idp.toLowerCase()},{name:s.Constants.Telemetry.CorrelationId,string:t||"unknown"},{name:s.Constants.Telemetry.LoadedApplicationCount,int64:r?r.length:0},{name:s.Constants.Telemetry.ErrorCode,string:o||"unknown"},{name:s.Constants.Telemetry.ErrorMessage,string:i||"unknown"}];d.sendTelemetryEvent({name:s.Constants.Telemetry.LoadTelemetryName,dataFields:c})}return{Telemetry:{timeToLoad:n.ms,succeeded:e,idp:a.idp.toLowerCase(),correlationId:t||"",loadedApplicationCount:r?r.length:0,errorCode:o||void 0,errorMessage:i||void 0}}}function v(e,t,r,n,o,i){if(!a.telemetryInstance&&"undefined"==typeof OTel){var c=[{name:s.Constants.Telemetry.Duration,int64:o.ms},{name:s.Constants.Telemetry.Succeeded,string:!e.Token},{name:s.Constants.Telemetry.IdentityProvider,string:a.idp.toLowerCase()},{name:s.Constants.Telemetry.ApplicationId,string:r},{name:s.Constants.Telemetry.TokenScope,string:i&&!n?i.toString():"unknown"},{name:s.Constants.Telemetry.CorrelationId,string:t||"unknown"},{name:s.Constants.Telemetry.ErrorCode,string:e.ErrorCode?e.ErrorCode:"unknown"},{name:s.Constants.Telemetry.ErrorMessage,string:e.ErrorMessage&&!n?e.ErrorMessage:"unknown"},{name:s.Constants.Telemetry.ErrorCodeForGetToken,string:e.ErrorCode?e.ErrorCode:"unknown"},{name:s.Constants.Telemetry.ErrorMessageForGetToken,string:e.ErrorMessage&&!n?e.ErrorMessage:"unknown"}];d.sendTelemetryEvent({name:s.Constants.Telemetry.GetTokenTelemetryName,dataFields:c})}return e.Telemetry={timeToGetToken:o.ms,succeeded:!e.Token,idp:a.idp.toLowerCase(),applicationId:r,tokenScope:i&&!n?i.toString():void 0,correlationId:t,errorCode:e.ErrorCode?e.ErrorCode:void 0,errorMessage:e.ErrorMessage&&!n?e.ErrorMessage:void 0,errorCodeForGetToken:e.ErrorCode?e.ErrorCode:void 0,errorMessageForGetToken:e.ErrorMessage&&!n?e.ErrorMessage:void 0,fromCache:!!e.MsalResult&&!!e.MsalResult.fromCache,expiresOn:e.MsalResult&&e.MsalResult.expiresOn?e.MsalResult.expiresOn.getTime()/1e3:void 0},e}function y(e,t,r,n,o,i,c){var u=[{name:s.Constants.Telemetry.Duration,int64:n.ms},{name:s.Constants.Telemetry.Succeeded,bool:!i},{name:s.Constants.Telemetry.IdentityProvider,string:a.idp.toLowerCase()},{name:s.Constants.Telemetry.ApplicationId,string:r},{name:s.Constants.Telemetry.TokenScope,string:o?o.toString():"unknown"},{name:s.Constants.Telemetry.CorrelationId,string:t||"unknown"},{name:s.Constants.Telemetry.ErrorCode,string:i||"unknown"},{name:s.Constants.Telemetry.ErrorMessage,string:c||"unknown"},{name:s.Constants.Telemetry.ErrorCodeForCheckUpn,string:i||"unknown"},{name:s.Constants.Telemetry.ErrorMessageForCheckUpn,string:c||"unknown"}];a.telemetryInstance||"undefined"!=typeof OTel||d.sendTelemetryEvent({name:s.Constants.Telemetry.CheckUpnTelemetryName,dataFields:u}),e.Telemetry={timeToCheckUPN:n.ms,succeeded:!i,idp:a.idp.toLowerCase(),applicationId:r,tokenScope:o?o.toString():void 0,correlationId:t,errorCode:i,errorMessage:c,errorCodeForCheckUPN:i,errorMessageForCheckUPN:c}}d.addNamespaceMapping("Office.Identity.WebAuth.BrowserAuth","5c65bbc4edbf480d9637ace04d62bd98-12844893-8ab9-4dde-b850-5612cb12e0f2-7822"),t.Load=h,t.GetToken=p,t.GetTokenOnce=function(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=!1),h({idp:r?s.Constants.IdentityProvider.Msa.toLowerCase():s.Constants.IdentityProvider.Aad.toLowerCase(),appIds:[t],authority:n?s.Constants.Authority.Ppe:s.Constants.Authority.Prod,upn:"",prefetch:[e],autoPopup:!0,enableConsoleLogging:!0}).then((function(){return p(e,t,void 0,!0)})).catch((function(e){return Promise.reject(e)}))},t.GetApplication=g,t.CheckUpnMatchIdToken=function(e,t){var r=l.TimerUtils.timer();t&&u.ValidateUtils.isGuid(t)||(t=void 0);var n={};if(!e||!u.ValidateUtils.isGuid(e))return n.ErrorCode="invalid_application_ID",n.ErrorMessage="The provided application ID for BrowserAuth.CheckUpnMatchIdToken is null, blank, empty or with invalid format",y(n,t,e,r,void 0,n.ErrorCode,n.ErrorMessage),Promise.reject(n);var o=g(e);if(void 0===o||!o)return n.ErrorCode="missing_msal",n.ErrorMessage="BrowserAuth can't find msal instance",Promise.reject();var i=[e];return new Promise((function(s,l){var d=o.getAccountByUsername(a.upn);c.LoggingUtils.log("[CheckUpnMatchIdToken] "+e+": Calls acquireTokenSilent"),o.acquireTokenSilent({scopes:i,account:d,correlationId:t}).then((function(o){if(n.IsUpnMatch=u.ValidateUtils.matchUserInfoFromIdToken(o.idToken,a),n.IsUpnMatch)return y(n,t,e,r,i),s(n)})).catch((function(o){return n.ErrorCode=o.errorCode,n.ErrorMessage=o.errorMessage,c.LoggingUtils.log("[CheckUpnMatchIdToken] "+e+": error: "+n.ErrorMessage),n.IsUpnMatch=!1,y(n,t,e,r,i,o.errorCode,o.errorMessage),l(n)}))}))}},"./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/Constants.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Constants=void 0,function(e){var t=function(){function e(){}return e.Aad="aad",e.Msa="msa",e}();e.IdentityProvider=t;var r=function(){function e(){}return e.RequestAuthConfig="RequestAuthConfig",e.ResponseAuthConfig="ResponseAuthConfig",e.iFrameIdTokenPrefix="msalIdTokenFrame",e.iFramePrefix="msalRenewFrame",e}();e.PostMessageType=r;var n=function(){function e(){}return e.Prod="https://login.microsoftonline.com/",e.ProdLegacy="https://login.windows.net/",e.Ppe="https://login.windows-ppe.net/",e.AadSuffix="organizations",e.MsaSuffix="consumers",e.DefaultTarget="https://graph.microsoft.com",e}();e.Authority=n;var o=function(){function e(){}return e.OtelInstance="otel",e.CheckUpnTelemetryName="Office.Identity.WebAuth.BrowserAuth.CheckUpn",e.GetTokenTelemetryName="Office.Identity.WebAuth.BrowserAuth.GetToken",e.LoadTelemetryName="Office.Identity.WebAuth.BrowserAuth.Load",e.Duration="Duration",e.Succeeded="Succeeded",e.ApplicationId="ApplicationId",e.CorrelationId="CorrelationId",e.IdentityProvider="IdentityProvider",e.LoadedApplicationCount="LoadedApplicationCount",e.TokenScope="TokenScope",e.ErrorCode="ErrorCode",e.ErrorMessage="ErrorMessage",e.ErrorCodeForLoad="ErrorCodeForLoad",e.ErrorMessageForLoad="ErrorMessageForLoad",e.ErrorCodeForGetToken="ErrorCodeForGetToken",e.ErrorMessageForGetToken="ErrorMessageForGetToken",e.ErrorCodeForCheckUpn="ErrorCodeForCheckUpn",e.ErrorMessageForCheckUpn="ErrorMessageForCheckUpn",e}();e.Telemetry=o}(t.Constants||(t.Constants={}))},"./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/ExtractUtils.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtractUtils=void 0;var n=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/LoggingUtils.ts"),o=function(){function e(){}return e.extractToken=function(e){var t=this.decodeJwt(e);if(!t)return null;try{var r=t.JWSPayload,o=this.base64Decode(r);return o?JSON.parse(o):(n.LoggingUtils.log("The returned token could not be base64 url safe decoded."),null)}catch(e){n.LoggingUtils.error("The returned token could not be decoded"+e)}return null},e.base64Decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}return decodeURIComponent(atob(t).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))},e.decodeJwt=function(e){if("undefined"===e||!e||0===e.length)return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?(n.LoggingUtils.warn("The returned access_token is not parseable."),null):{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},e}();t.ExtractUtils=o},"./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/LoggingUtils.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoggingUtils=void 0;var n=function(){function e(){}return e.log=function(e,t){return!!this.shouldProceed(t)&&(console.log(e),!0)},e.warn=function(e,t){return!!this.shouldProceed(t)&&(console.warn(e),!0)},e.error=function(e,t){return!!this.shouldProceed(t)&&(console.error(e),!0)},e.shouldProceed=function(e){return!(null!=e&&void 0!==e&&!e||null==e&&void 0===e&&!this.enableConsoleLogging)},e.enableConsoleLogging=!1,e}();t.LoggingUtils=n},"./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/TimerUtils.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TimerUtils=void 0;var n=function(){function e(){}return e.timer=function(){var e=(new Date).getTime();return{get seconds(){return Math.ceil(((new Date).getTime()-e)/1e3)},get ms(){return(new Date).getTime()-e},get formattedSeconds(){return Math.ceil(this.seconds/1e3)+"s"},get formattedMs(){return this.ms+"ms"}}},e}();t.TimerUtils=n},"./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/ValidateUtils.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ValidateUtils=void 0;var n=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/ExtractUtils.ts"),o=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/LoggingUtils.ts"),i=function(){function e(){}return e.getScope=function(e){return["HTTPS:","API:"].some((function(t){return e.toLocaleUpperCase().startsWith(t)}))||this.isGuid(e)?e+"/.default":e},e.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)},e.matchUserInfoFromIdToken=function(e,t){if(!this.enableUserInfoCheck)return o.LoggingUtils.log("Skip user info check of id token, returning true"),!0;if(!t||!t.upn)return o.LoggingUtils.log("Upn does not exist in the configuration, returning true"),!0;var r=n.ExtractUtils.extractToken(e);return!(r&&!(r&&t.puid&&r.puid&&r.puid.toLowerCase()===t.puid.toLowerCase())&&(!r||!r.preferred_username||r.preferred_username.toLowerCase()!==t.upn.toLowerCase())&&(o.LoggingUtils.log("provided Upn/Puid do not match Upn extracted from id token"),1))},e.matchUserInfoFromAccessToken=function(e,t){if(!this.enableUserInfoCheck)return o.LoggingUtils.log("Skip user info check of access token, returning true"),!0;if(!t||!t.upn)return o.LoggingUtils.log("Upn does not exist in the configuration, returning true"),!0;var r=n.ExtractUtils.extractToken(e);return!(r&&!(r&&t.puid&&r.puid&&r.puid.toLowerCase()===t.puid.toLowerCase())&&(!r||!r.upn||r.upn.toLowerCase()!==t.upn.toLowerCase())&&(o.LoggingUtils.log("provided Upn/Puid do not match Upn extracted from access token"),1))},e.enableUserInfoCheck=!1,e}();t.ValidateUtils=i},0:function(e,t,r){r("./packages/Microsoft.Office.WebAuth.BrowserAuth/lib/api.js"),e.exports=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/BrowserAuth.ts")}})},function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return i})),r.d(t,"c",(function(){return a})),r.d(t,"b",(function(){return s}));var n=r(2),o=null;function i(t){void 0===t&&(t=!0);var r=!1===t?null:o;return r||(typeof globalThis!==n.l&&(r=globalThis),r||typeof self===n.l||(r=self),r||typeof window===n.l||(r=window),r||typeof e===n.l||(r=e),o=r),r}function a(e){throw new TypeError(e)}function s(e){var t=n.c;if(t)return t(e);if(null==e)return{};var r=typeof e;function o(){}return r!==n.j&&r!==n.h&&a("Object prototype may only be an Object:"+e),o[n.k]=e,new o}}).call(this,r(9))},,,function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},,,function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"BrowserCacheManager",(function(){return vr})),r.d(n,"StandardInteractionClient",(function(){return $r})),r.d(n,"RedirectClient",(function(){return pn})),r.d(n,"PopupClient",(function(){return dn})),r.d(n,"SilentIframeClient",(function(){return gn})),r.d(n,"SilentCacheClient",(function(){return sn})),r.d(n,"SilentRefreshClient",(function(){return mn})),r.d(n,"NativeInteractionClient",(function(){return cn})),r.d(n,"RedirectHandler",(function(){return hn})),r.d(n,"EventHandler",(function(){return Or})),r.d(n,"NativeMessageHandler",(function(){return un})),r.d(n,"BrowserConstants",(function(){return ot})),r.d(n,"TemporaryCacheKeys",(function(){return We})),r.d(n,"CryptoOps",(function(){return xt})),r.d(n,"NativeAuthError",(function(){return nn})),r.d(n,"BrowserPerformanceClient",(function(){return En})),r.d(n,"BrowserPerformanceMeasurement",(function(){return Tn}));var o,i,a,s={};function c(e,t,r,n){var o=[],i=e.map((function(e){return function(e,t,r){var n={};if(n.G=e.tag,n.T=e.timestamp-t,n.M=e.message,n.C=e.category,e.correlationId){var o=r.findIndex((function(t){return t===e.correlationId}));o<0&&(o=r.push(e.correlationId)-1),n.I=o}var i=1e3*e.type+e.level;return n.D=i,n}(e,n,o)})),a=function(e,t,r,n,o){var i={};i.T=e,i.L=t,i.S=r,i.I=n,o&&o.length>0&&(i.W=o);return i.V=1,i}(n,i,t,r,o);return JSON.stringify(a)}r.r(s),r.d(s,"PublicClientApplication",(function(){return $c})),r.d(s,"ExperimentalPublicClientApplication",(function(){return zu})),r.d(s,"ApiId",(function(){return Ye})),r.d(s,"BrowserAuthError",(function(){return St})),r.d(s,"BrowserAuthErrorMessage",(function(){return wt})),r.d(s,"BrowserCacheLocation",(function(){return Ge})),r.d(s,"BrowserConfigurationAuthError",(function(){return Nt})),r.d(s,"BrowserConfigurationAuthErrorMessage",(function(){return Pt})),r.d(s,"BrowserUtils",(function(){return Ar})),r.d(s,"DEFAULT_IFRAME_TIMEOUT_MS",(function(){return Pr})),r.d(s,"EventMessageUtils",(function(){return Wu})),r.d(s,"EventType",(function(){return Nr})),r.d(s,"InteractionStatus",(function(){return Je})),r.d(s,"InteractionType",(function(){return Ve})),r.d(s,"NavigationClient",(function(){return Rr})),r.d(s,"SignedHttpRequest",(function(){return ju})),r.d(s,"WrapperSKU",(function(){return ct})),r.d(s,"stubbedPublicClientApplication",(function(){return Qu})),r.d(s,"AccountEntity",(function(){return er})),r.d(s,"AuthError",(function(){return Ze})),r.d(s,"AuthErrorMessage",(function(){return Xe})),r.d(s,"AuthenticationHeaderParser",(function(){return Yu})),r.d(s,"AuthenticationScheme",(function(){return Ae})),r.d(s,"ClientAuthError",(function(){return _t})),r.d(s,"ClientAuthErrorMessage",(function(){return Et})),r.d(s,"ClientConfigurationError",(function(){return Vt})),r.d(s,"ClientConfigurationErrorMessage",(function(){return Yt})),r.d(s,"InteractionRequiredAuthError",(function(){return nt})),r.d(s,"InteractionRequiredAuthErrorMessage",(function(){return rt})),r.d(s,"LogLevel",(function(){return Ht})),r.d(s,"Logger",(function(){return Ft})),r.d(s,"ProtocolMode",(function(){return hr})),r.d(s,"ServerError",(function(){return $e})),r.d(s,"StringUtils",(function(){return It})),r.d(s,"UrlString",(function(){return gr})),r.d(s,"version",(function(){return Vu})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_MSOSP_AddInCommands=220]="msoulscat_MSOSP_AddInCommands",e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WacFeedback=356]="msoulscat_Wac_WacFeedback",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptGc2General=835]="msoulscat_Wac_PptGc2General",e[e.msoulscat_Wac_PptGc2GraphicHost=836]="msoulscat_Wac_PptGc2GraphicHost",e[e.msoulscat_Wac_PptGc2Operation=837]="msoulscat_Wac_PptGc2Operation",e[e.msoulscat_Wac_PptDataSync=844]="msoulscat_Wac_PptDataSync",e[e.msoulscat_Wac_PptFluidRuntime=848]="msoulscat_Wac_PptFluidRuntime",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",e[e.msoulscat_Wac_PptVideos=846]="msoulscat_Wac_PptVideos",e[e.msoulscat_Uci_Insights=1303]="msoulscat_Uci_Insights",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_OAuth=3e3]="msoulscat_Wac_OAuth",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",e[e.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools",e[e.msoulscat_Osf_Latency=1401]="msoulscat_Osf_Latency",e[e.msoulscat_Osf_Notification=1402]="msoulscat_Osf_Notification",e[e.msoulscat_Osf_Runtime=1403]="msoulscat_Osf_Runtime",e[e.msoulscat_Wac_AiMaker=3041]="msoulscat_Wac_AiMaker",e[e.msoulscat_Wac_AiRewrite=3043]="msoulscat_Wac_AiRewrite",e[e.msoulscat_Wac_AiInsert=3044]="msoulscat_Wac_AiInsert",e[e.msoulscat_Wac_AiSummarize=3047]="msoulscat_Wac_AiSummarize",e[e.msoulscat_Wac_CopilotCompose=3048]="msoulscat_Wac_CopilotCompose",e[e.msoulscat_Wac_Skittles=3049]="msoulscat_Wac_Skittles"}(o||(o={})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(i||(i={})),function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(a||(a={}));function u(e,t,r){if(t){var n=window.navigator;if(n&&n.sendBeacon)try{return void n.sendBeacon(t,e)}catch(e){}!function(e,t,r){var n=new XMLHttpRequest;n.readyState!==XMLHttpRequest.UNSENT&&n.readyState!==XMLHttpRequest.DONE||(n.open("POST",t,r),n.send(e))}(e,t,r)}}var l,d=function(){try{var e=window.performance;return e&&e.now&&e.now()!==1/0}catch(e){return!1}}();function h(){return d?window.performance.now():Date.now()}function p(){if(!l){var e=window.performance;l=d&&e.timing&&e.timing.navigationStart?function(){return Math.round(e.now()+e.timing.navigationStart)}:Date.now?Date.now:function(){return(new Date).getTime()}}return l()}var f={BUILD_NUMBER:"###VERSION###"};function g(){try{return __VERSION_PLACEHOLDER__}catch(e){return f.BUILD_NUMBER}}var m,v,y=function(){function e(e){var t=this;this._uploadCadenceInMs=3e4,this._uploadTriggerSize=30,this._uploadId=0,this._logCache=[],this._timestampBase=p(),this._onCompleteUploadCallbacks=[],this._userSessionId="",this._timeSpentLogging=0,this.flushOnClose=function(){t._triggerUpload(!1,!1)},this.flush=function(){t._triggerUploadAsync()},this.flushAndSetNewEndpoint=function(e,r){var n,o=t._transformRemoteUrlEndpoint(e);o.localeCompare(null!==(n=t._remoteUrlEndpoint)&&void 0!==n?n:"",void 0,{sensitivity:"accent"})&&(t._onCompleteUploadCallbacks.push((function(){t._remoteUrlEndpoint=o,r&&r()})),t._triggerUpload(!0,!0))},this._transformRemoteUrlEndpoint=function(e){return e+"?usid="+t._userSessionId+"&officeserverversion="+g()},this._triggerUploadAsync=function(){window.setTimeout((function(){return t._triggerUpload(!0,!0)}),0)},this._triggerUpload=function(e,r){var n=h();if(window.clearTimeout(t._timeoutId),t._remoteUrlEndpoint){if(t._logCache.length>0)t._uploadId+=1,u(c(t._logCache.splice(0,e?t._uploadTriggerSize:t._logCache.length),t._userSessionId,t._uploadId,t._timestampBase),t._remoteUrlEndpoint,r),t._timestampBase=p();0===t._logCache.length&&t._onCompleteUploadCallbacks.length>0&&(t._onCompleteUploadCallbacks.forEach((function(e){"requestIdleCallback"in window?window.requestIdleCallback(e):window.setTimeout(e,0)})),t._onCompleteUploadCallbacks=[]),e&&(t._timeoutId=window.setTimeout((function(){t._triggerUploadAsync()}),t._logCache.length>t._uploadTriggerSize||t._onCompleteUploadCallbacks.length>0?1e3:t._uploadCadenceInMs)),t._timeSpentLogging+=h()-n}},e&&this.configure(e)}return e.prototype.getTimeSpentLogging=function(){return this._timeSpentLogging},e.prototype.addLoggingTime=function(e){this._timeSpentLogging+=e},e.prototype.configure=function(e){var t=this,r=h();if(e.uploadCadenceInMs&&(this._uploadCadenceInMs=e.uploadCadenceInMs),e.uploadTriggerSize&&(this._uploadTriggerSize=e.uploadTriggerSize),e.sessionId&&(this._userSessionId=e.sessionId),e.remoteUlsEndpoint){if(!e.sessionId&&this._remoteUrlEndpoint)throw new Error("Remote ULS endpoint is already set");this._remoteUrlEndpoint=this._transformRemoteUrlEndpoint(e.remoteUlsEndpoint),this._timestampBase=p(),window.setTimeout((function(){return t._triggerUpload(!0,!0)}),0)}this._timeSpentLogging+=h()-r},e.prototype.handleTrace=function(e){var t=h();e.message.length>3072&&(e.message=e.message.substring(0,3072-"... [Trimmed]".length)+"... [Trimmed]"),this._logCache.push(e),(this._logCache.length>this._uploadTriggerSize||e.level===i.Error)&&this._triggerUploadAsync(),this._timeSpentLogging+=h()-t},e.prototype.getUserSessionId=function(){return this._userSessionId},e}(),C=[];!function(e){e.setting_MaxUlsHeartbeatTime="BootstrapperMaxUlsHeartbeatTime",e.setting_NoCompleteWarning1Time="BootstrapperNoCompleteWarning1Time",e.setting_NoCompleteWarning2Time="BootstrapperNoCompleteWarning2Time",e.setting_RemoteUlsETag="RemoteUlsETag",e.setting_RemoteUlsSuppressions="RemoteUlsSuppressions",e.setting_SettingsFetchPeriod="BootstrapperSettingsFetchPeriod",e.setting_Timestamp="timestamp",e.setting_UlsHeartbeatIntervalMs="BootstrapperUlsHeartbeatIntervalMs",e.setting_UlsHeartBeatIsEnabled="BootstrapperUlsHeartBeatIsEnabled",e.setting_UlsUploadCadenceMs="BootstrapperUlsUploadCadenceMs",e.setting_WordConsumptionViewToEditRedirectIsEnabled="WordConsumptionViewToEditRedirectIsEnabled",e.setting_RequestedCallThrottlingDefaultToViewMinimumValue="RequestedCallThrottlingDefaultToViewMinimumValue",e.setting_BulsEndpointUrl="BulsEndpointUrl",e.setting_EnableCommonHostDiagnosticsParams="EnableCommonHostDiagnosticsParams",e.setting_EnableTwoStepBootForWordForEmptyWopisrc="EnableICNForWord",e.setting_EnableModernEmbedViewForPowerPoint="EnableModernEmbedViewForPowerPoint",e.setting_EnableModernReadingViewForPowerPoint="EnableModernReadingViewForPowerPoint",e.setting_EnableDefaultToModernForPowerPoint="EnableDefaultToModernForPowerPoint",e.setting_ShouldLogJsApiKpisForWord="ShouldLogJsApiKpisForWord",e.setting_EnableFramePageErrorReportingForWord="EnableFramePageErrorReportingForWord"}(v||(v={}));var T=new URL(window.location.href);function E(e){return e&&["aad","msa"].includes(e)?e:"aad"}function _(e){return"93d53678-613d-4013-afc1-62e9e444a0a5"===e}function I(e){return e instanceof Error?"".concat(e.name,": ").concat(e.message):"string"==typeof e?e:JSON.stringify(e)}var w,S,b,k,A,R,P,N=function(){function e(){var e=this;this.startTime=0,this._resolve=function(){},this._reject=function(){},this.promise=new Promise((function(t,r){e._resolve=t,e._reject=r}))}return e.prototype.resolve=function(e){this._resolve(e)},e.prototype.reject=function(e){this._reject(e)},e}(),M=function(e){var t=new y(e);function r(e,r,n,o){var i=h();if(!function(e){return 1===C[e]}(e)){var s={timestamp:p(),category:r,tag:e,level:n,type:a.Trace,message:o,correlationId:""};t.addLoggingTime(h()-i),t.handleTrace(s)}}return{ULS:{sendTraceTag:function(e,t,n,o){r(e,t,n,o)},shipAssertTag:function(e,t,n,o){n&&r(e,t,i.Error,o)},debugAssertTag:function(e,t,r,n){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:t.flush,flushOnClose:t.flushOnClose,setCorrelationId:function(){}},configure:function(e){t.configure(e)},settingsChangeHandler:function(e){var r,n;r=e.settingsManager.getValue(v.setting_RemoteUlsSuppressions,""),n=e.settingsManager.getValue(v.setting_RemoteUlsETag,""),m&&n===m||(C=[],m=n,r&&r.split(",").forEach((function(e){var t=parseInt(e,10);t&&(C[t]=1)}))),t.configure({uploadCadenceInMs:e.settingsManager.getValue(v.setting_UlsUploadCadenceMs,6e4)});var o=e.settingsManager.getValue(v.setting_BulsEndpointUrl,"").toString();""!==o&&t.flushAndSetNewEndpoint(o)},getTimeSpentLogging:function(){return t.getTimeSpentLogging()},getUserSessionId:function(){return t.getUserSessionId()},flushAndSetNewEndpoint:function(e,r){t.flushAndSetNewEndpoint(e,r)}}}({remoteUlsEndpoint:new URL("RemoteUls.ashx",window.location.href).href,sessionId:null!==(w=T.searchParams.get("usid"))&&void 0!==w?w:void 0});!function(e){e[e.external=0]="external",e[e.msa=1]="msa",e[e.aad=2]="aad"}(S||(S={})),function(e){e.init="SharedAuth_Init",e.showSignInCancelButtons="SharedAuth_ShowSignInCancelButtons",e.tryGetToken="SharedAuth_TryGetToken",e.tryLogin="SharedAuth_TryLogin"}(b||(b={})),function(e){e.closeDialog="SharedAuth_CloseDialog",e.getTokenResponse="SharedAuth_GetTokenResponse",e.hideDialog="SharedAuth_HideDialog",e.interactiveFlowReady="SharedAuth_InteractiveFlowReady",e.loginResponse="SharedAuth_LoginResponse",e.scriptInitialized="SharedAuth_ScriptInitialized",e.scriptLoaded="SharedAuth_ScriptLoaded"}(k||(k={})),function(e){e.registerPrimary="SharedAuthWorker_RegisterPrimary",e.unregisterPrimary="SharedAuthWorker_UnregisterPrimary",e.getToken="SharedAuthWorker_GetToken",e.postToken="SharedAuthWorker_PostToken"}(A||(A={})),function(e){e.registrationResponse="SharedAuthWorker_RegistrationResponse",e.brokerToken="SharedAuthWorker_BrokerToken",e.tokenReady="SharedAuthWorker_TokenReady",e.noPrimaryReady="SharedAuthWorker_NoPrimaryReady"}(R||(R={})),function(e){e.timeout="Timeout",e.general="Token Renewal Failed",e.renewal="token_renewal_error"}(P||(P={}));var O=function(){function e(e,t){this._target=e,this._trusted=t}return e.prototype.postTokenResponseDataToParent=function(e,t){if(this._trusted)window.parent.postMessage(JSON.stringify(q(e,t)),this._target);else{var r={isSuccess:t.isSuccess,messageCorrelationId:t.messageCorrelationId};window.parent.postMessage(JSON.stringify(q(e,r)),this._target)}},e.prototype.postToUntrustedParent=function(e,t){e!==k.getTokenResponse&&e!==k.loginResponse&&window.parent.postMessage(JSON.stringify(q(e,t)),this._target)},e}(),U=function(){function e(e){this._target=e}return e.prototype.postToWorker=function(e,t,r){this._target.postMessage(JSON.stringify(q(e,t,r)))},e}();function q(e,t,r){return{MessageId:e,SendTime:Date.now(),Values:t,Routing:{clientId:r}}}function L(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))}function H(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}Object.create;Object.create;
/*! @azure/msal-browser-1p v2.37.0 2023-05-02 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var D=function(e,t){return(D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function x(e,t){function r(){this.constructor=e}D(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var B=function(){return(B=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function F(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))}function K(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function G(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function z(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(G(arguments[t]));return e}
/*! @azure/msal-browser v2.37.0 2023-05-01 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var W=function(e,t){return(W=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function j(e,t){function r(){this.constructor=e}W(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var Q,Y,V=function(){return(V=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function J(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function X(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))}function Z(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function $(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function ee(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat($(arguments[t]));return e}
/*! @azure/msal-common v13.0.0 2023-05-01 */!function(e){e.AcquireTokenByCode="acquireTokenByCode",e.AcquireTokenByRefreshToken="acquireTokenByRefreshToken",e.AcquireTokenSilent="acquireTokenSilent",e.AcquireTokenSilentAsync="acquireTokenSilentAsync",e.AcquireTokenPopup="acquireTokenPopup",e.CryptoOptsGetPublicKeyThumbprint="cryptoOptsGetPublicKeyThumbprint",e.CryptoOptsSignJwt="cryptoOptsSignJwt",e.SilentCacheClientAcquireToken="silentCacheClientAcquireToken",e.SilentIframeClientAcquireToken="silentIframeClientAcquireToken",e.SilentRefreshClientAcquireToken="silentRefreshClientAcquireToken",e.SsoSilent="ssoSilent",e.StandardInteractionClientGetDiscoveredAuthority="standardInteractionClientGetDiscoveredAuthority",e.FetchAccountIdWithNativeBroker="fetchAccountIdWithNativeBroker",e.NativeInteractionClientAcquireToken="nativeInteractionClientAcquireToken",e.BaseClientCreateTokenRequestHeaders="baseClientCreateTokenRequestHeaders",e.BrokerHandhshake="brokerHandshake",e.AcquireTokenByRefreshTokenInBroker="acquireTokenByRefreshTokenInBroker",e.AcquireTokenByBroker="acquireTokenByBroker",e.RefreshTokenClientExecuteTokenRequest="refreshTokenClientExecuteTokenRequest",e.RefreshTokenClientAcquireToken="refreshTokenClientAcquireToken",e.RefreshTokenClientAcquireTokenWithCachedRefreshToken="refreshTokenClientAcquireTokenWithCachedRefreshToken",e.RefreshTokenClientAcquireTokenByRefreshToken="refreshTokenClientAcquireTokenByRefreshToken",e.RefreshTokenClientCreateTokenRequestBody="refreshTokenClientCreateTokenRequestBody",e.AcquireTokenFromCache="acquireTokenFromCache",e.AcquireTokenBySilentIframe="acquireTokenBySilentIframe",e.InitializeBaseRequest="initializeBaseRequest",e.InitializeSilentRequest="initializeSilentRequest",e.InitializeClientApplication="initializeClientApplication",e.SilentIframeClientTokenHelper="silentIframeClientTokenHelper",e.SilentHandlerInitiateAuthRequest="silentHandlerInitiateAuthRequest",e.SilentHandlerMonitorIframeForHash="silentHandlerMonitorIframeForHash",e.SilentHandlerLoadFrame="silentHandlerLoadFrame",e.StandardInteractionClientCreateAuthCodeClient="standardInteractionClientCreateAuthCodeClient",e.StandardInteractionClientGetClientConfiguration="standardInteractionClientGetClientConfiguration",e.StandardInteractionClientInitializeAuthorizationRequest="standardInteractionClientInitializeAuthorizationRequest",e.StandardInteractionClientInitializeAuthorizationCodeRequest="standardInteractionClientInitializeAuthorizationCodeRequest",e.GetAuthCodeUrl="getAuthCodeUrl",e.HandleCodeResponseFromServer="handleCodeResponseFromServer",e.HandleCodeResponseFromHash="handleCodeResponseFromHash",e.UpdateTokenEndpointAuthority="updateTokenEndpointAuthority",e.AuthClientAcquireToken="authClientAcquireToken",e.AuthClientExecuteTokenRequest="authClientExecuteTokenRequest",e.AuthClientCreateTokenRequestBody="authClientCreateTokenRequestBody",e.AuthClientCreateQueryString="authClientCreateQueryString",e.PopTokenGenerateCnf="popTokenGenerateCnf",e.PopTokenGenerateKid="popTokenGenerateKid",e.HandleServerTokenResponse="handleServerTokenResponse",e.AuthorityFactoryCreateDiscoveredInstance="authorityFactoryCreateDiscoveredInstance",e.AuthorityResolveEndpointsAsync="authorityResolveEndpointsAsync",e.AuthorityGetCloudDiscoveryMetadataFromNetwork="authorityGetCloudDiscoveryMetadataFromNetwork",e.AuthorityUpdateCloudDiscoveryMetadata="authorityUpdateCloudDiscoveryMetadata",e.AuthorityGetEndpointMetadataFromNetwork="authorityGetEndpointMetadataFromNetwork",e.AuthorityUpdateEndpointMetadata="authorityUpdateEndpointMetadata",e.AuthorityUpdateMetadataWithRegionalInformation="authorityUpdateMetadataWithRegionalInformation",e.RegionDiscoveryDetectRegion="regionDiscoveryDetectRegion",e.RegionDiscoveryGetRegionFromIMDS="regionDiscoveryGetRegionFromIMDS",e.RegionDiscoveryGetCurrentVersion="regionDiscoveryGetCurrentVersion",e.AcquireTokenByCodeAsync="acquireTokenByCodeAsync",e.GetEndpointMetadataFromNetwork="getEndpointMetadataFromNetwork",e.GetCloudDiscoveryMetadataFromNetworkMeasurement="getCloudDiscoveryMetadataFromNetworkMeasurement",e.HandleRedirectPromiseMeasurement="handleRedirectPromiseMeasurement",e.UpdateCloudDiscoveryMetadataMeasurement="updateCloudDiscoveryMetadataMeasurement",e.UsernamePasswordClientAcquireToken="usernamePasswordClientAcquireToken",e.NativeMessageHandlerHandshake="nativeMessageHandlerHandshake"}(Q||(Q={})),function(e){e[e.NotStarted=0]="NotStarted",e[e.InProgress=1]="InProgress",e[e.Completed=2]="Completed"}(Y||(Y={}));var te=new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status"]),re=function(e,t){return(re=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};
/*! @azure/msal-common v13.0.0 2023-05-01 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function ne(e,t){function r(){this.constructor=e}re(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var oe=function(){return(oe=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function ie(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))}function ae(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function se(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n}
/*! @azure/msal-common v13.0.0 2023-05-01 */var ce,ue,le,de,he,pe={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",REGIONAL_AUTH_NON_MSI_QUERY_STRING:"allowestsrnonmsi=true",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},fe=[pe.OPENID_SCOPE,pe.PROFILE_SCOPE,pe.OFFLINE_ACCESS_SCOPE],ge=se(fe,[pe.EMAIL_SCOPE]);!function(e){e.CONTENT_TYPE="Content-Type",e.RETRY_AFTER="Retry-After",e.CCS_HEADER="X-AnchorMailbox",e.WWWAuthenticate="WWW-Authenticate",e.AuthenticationInfo="Authentication-Info",e.X_MS_REQUEST_ID="x-ms-request-id",e.X_MS_HTTP_VERSION="x-ms-httpver"}(ce||(ce={})),function(e){e.ID_TOKEN="idtoken",e.CLIENT_INFO="client.info",e.ADAL_ID_TOKEN="adal.idtoken",e.ERROR="error",e.ERROR_DESC="error.description",e.ACTIVE_ACCOUNT="active-account",e.ACTIVE_ACCOUNT_FILTERS="active-account-filters"}(ue||(ue={})),function(e){e.COMMON="common",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers"}(le||(le={})),function(e){e.CLIENT_ID="client_id",e.REDIRECT_URI="redirect_uri",e.RESPONSE_TYPE="response_type",e.RESPONSE_MODE="response_mode",e.GRANT_TYPE="grant_type",e.CLAIMS="claims",e.SCOPE="scope",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.REFRESH_TOKEN="refresh_token",e.EXPIRES_IN="expires_in",e.STATE="state",e.NONCE="nonce",e.PROMPT="prompt",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info",e.CODE="code",e.CODE_CHALLENGE="code_challenge",e.CODE_CHALLENGE_METHOD="code_challenge_method",e.CODE_VERIFIER="code_verifier",e.CLIENT_REQUEST_ID="client-request-id",e.X_CLIENT_SKU="x-client-SKU",e.X_CLIENT_VER="x-client-VER",e.X_CLIENT_OS="x-client-OS",e.X_CLIENT_CPU="x-client-CPU",e.X_CLIENT_CURR_TELEM="x-client-current-telemetry",e.X_CLIENT_LAST_TELEM="x-client-last-telemetry",e.X_MS_LIB_CAPABILITY="x-ms-lib-capability",e.X_APP_NAME="x-app-name",e.X_APP_VER="x-app-ver",e.POST_LOGOUT_URI="post_logout_redirect_uri",e.ID_TOKEN_HINT="id_token_hint",e.DEVICE_CODE="device_code",e.CLIENT_SECRET="client_secret",e.CLIENT_ASSERTION="client_assertion",e.CLIENT_ASSERTION_TYPE="client_assertion_type",e.TOKEN_TYPE="token_type",e.REQ_CNF="req_cnf",e.OBO_ASSERTION="assertion",e.REQUESTED_TOKEN_USE="requested_token_use",e.ON_BEHALF_OF="on_behalf_of",e.FOCI="foci",e.CCS_HEADER="X-AnchorMailbox",e.RETURN_SPA_CODE="return_spa_code",e.NATIVE_BROKER="nativebroker",e.LOGOUT_HINT="logout_hint"}(de||(de={})),function(e){e.ACCESS_TOKEN="access_token",e.XMS_CC="xms_cc"}(he||(he={}));var me,ve={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"};!function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ID_TOKEN="id_token",e.DOMAIN_HINT="domain_hint",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(me||(me={}));var ye,Ce,Te,Ee,_e,Ie,we={PLAIN:"plain",S256:"S256"};!function(e){e.QUERY="query",e.FRAGMENT="fragment",e.FORM_POST="form_post"}(ye||(ye={})),function(e){e.IMPLICIT_GRANT="implicit",e.AUTHORIZATION_CODE_GRANT="authorization_code",e.CLIENT_CREDENTIALS_GRANT="client_credentials",e.RESOURCE_OWNER_PASSWORD_GRANT="password",e.REFRESH_TOKEN_GRANT="refresh_token",e.DEVICE_CODE_GRANT="device_code",e.JWT_BEARER="urn:ietf:params:oauth:grant-type:jwt-bearer"}(Ce||(Ce={})),function(e){e.MSSTS_ACCOUNT_TYPE="MSSTS",e.ADFS_ACCOUNT_TYPE="ADFS",e.MSAV1_ACCOUNT_TYPE="MSA",e.GENERIC_ACCOUNT_TYPE="Generic"}(Te||(Te={})),function(e){e.CACHE_KEY_SEPARATOR="-",e.CLIENT_INFO_SEPARATOR="."}(Ee||(Ee={})),function(e){e.ID_TOKEN="IdToken",e.ACCESS_TOKEN="AccessToken",e.ACCESS_TOKEN_WITH_AUTH_SCHEME="AccessToken_With_AuthScheme",e.REFRESH_TOKEN="RefreshToken"}(_e||(_e={})),function(e){e[e.ADFS=1001]="ADFS",e[e.MSA=1002]="MSA",e[e.MSSTS=1003]="MSSTS",e[e.GENERIC=1004]="GENERIC",e[e.ACCESS_TOKEN=2001]="ACCESS_TOKEN",e[e.REFRESH_TOKEN=2002]="REFRESH_TOKEN",e[e.ID_TOKEN=2003]="ID_TOKEN",e[e.APP_METADATA=3001]="APP_METADATA",e[e.UNDEFINED=9999]="UNDEFINED"}(Ie||(Ie={}));var Se,be="authority-metadata",ke=86400;!function(e){e.CONFIG="config",e.CACHE="cache",e.NETWORK="network",e.HARDCODED_VALUES="hardcoded_values"}(Se||(Se={}));var Ae,Re={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"};!function(e){e.BEARER="Bearer",e.POP="pop",e.SSH="ssh-cert"}(Ae||(Ae={}));var Pe,Ne,Me,Oe,Ue,qe,Le=60,He=3600,De="throttling",xe="retry-after, h429",Be="invalid_grant",Fe="client_mismatch";!function(e){e.username="username",e.password="password"}(Pe||(Pe={})),function(e){e[e.httpSuccess=200]="httpSuccess",e[e.httpBadRequest=400]="httpBadRequest"}(Ne||(Ne={})),function(e){e.FAILED_AUTO_DETECTION="1",e.INTERNAL_CACHE="2",e.ENVIRONMENT_VARIABLE="3",e.IMDS="4"}(Me||(Me={})),function(e){e.CONFIGURED_MATCHES_DETECTED="1",e.CONFIGURED_NO_AUTO_DETECTION="2",e.CONFIGURED_NOT_DETECTED="3",e.AUTO_DETECTION_REQUESTED_SUCCESSFUL="4",e.AUTO_DETECTION_REQUESTED_FAILED="5"}(Oe||(Oe={})),function(e){e.NO_CACHE_HIT="0",e.FORCE_REFRESH="1",e.NO_CACHED_ACCESS_TOKEN="2",e.CACHED_ACCESS_TOKEN_EXPIRED="3",e.REFRESH_CACHED_ACCESS_TOKEN="4"}(Ue||(Ue={})),function(e){e.Jwt="JWT",e.Jwk="JWK",e.Pop="pop"}(qe||(qe={}));var Ke,Ge,ze,We,je,Qe,Ye,Ve,Je,Xe={unexpectedError:{code:"unexpected_error",desc:"Unexpected error in authentication."},postRequestFailed:{code:"post_request_failed",desc:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."}},Ze=function(e){function t(r,n,o){var i=this,a=n?r+": "+n:r;return i=e.call(this,a)||this,Object.setPrototypeOf(i,t.prototype),i.errorCode=r||pe.EMPTY_STRING,i.errorMessage=n||pe.EMPTY_STRING,i.subError=o||pe.EMPTY_STRING,i.name="AuthError",i}return ne(t,e),t.prototype.setCorrelationId=function(e){this.correlationId=e},t.createUnexpectedError=function(e){return new t(Xe.unexpectedError.code,Xe.unexpectedError.desc+": "+e)},t.createPostRequestFailed=function(e){return new t(Xe.postRequestFailed.code,Xe.postRequestFailed.desc+": "+e)},t}(Error),$e=function(e){function t(r,n,o){var i=e.call(this,r,n,o)||this;return i.name="ServerError",Object.setPrototypeOf(i,t.prototype),i}return ne(t,e),t}(Ze),et=["interaction_required","consent_required","login_required"],tt=["message_only","additional_action","basic_action","user_password_expired","consent_required"],rt={noTokensFoundError:{code:"no_tokens_found",desc:"No refresh token found in the cache. Please sign-in."},native_account_unavailable:{code:"native_account_unavailable",desc:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API."}},nt=function(e){function t(r,n,o,i,a,s,c){var u=e.call(this,r,n,o)||this;return Object.setPrototypeOf(u,t.prototype),u.timestamp=i||pe.EMPTY_STRING,u.traceId=a||pe.EMPTY_STRING,u.correlationId=s||pe.EMPTY_STRING,u.claims=c||pe.EMPTY_STRING,u.name="InteractionRequiredAuthError",u}return ne(t,e),t.isInteractionRequiredError=function(e,t,r){var n=!!e&&et.indexOf(e)>-1,o=!!r&&tt.indexOf(r)>-1,i=!!t&&et.some((function(e){return t.indexOf(e)>-1}));return n||i||o},t.createNoTokensFoundError=function(){return new t(rt.noTokensFoundError.code,rt.noTokensFoundError.desc)},t.createNativeAccountUnavailableError=function(){return new t(rt.native_account_unavailable.code,rt.native_account_unavailable.desc)},t}(Ze),ot={INTERACTION_IN_PROGRESS_VALUE:"interaction_in_progress",INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},it="53ee284d-920a-4b59-9d30-a60315b26836",at="ppnbnpeolgkicgegkbkbjmhlideopiji",st="MATS";
/*! @azure/msal-common v13.0.0 2023-05-01 */!function(e){e.HandshakeRequest="Handshake",e.HandshakeResponse="HandshakeResponse",e.GetToken="GetToken",e.Response="Response"}(Ke||(Ke={})),function(e){e.LocalStorage="localStorage",e.SessionStorage="sessionStorage",e.MemoryStorage="memoryStorage"}(Ge||(Ge={})),function(e){e.GET="GET",e.POST="POST"}(ze||(ze={})),function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",e.SESSION_STATE="session.state",e.REQUEST_STATE="request.state",e.NONCE_IDTOKEN="nonce.id_token",e.ORIGIN_URI="request.origin",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.REQUEST_PARAMS="request.params",e.SCOPES="scopes",e.INTERACTION_STATUS_KEY="interaction.status",e.CCS_CREDENTIAL="ccs.credential",e.CORRELATION_ID="request.correlationId",e.NATIVE_REQUEST="request.native",e.REDIRECT_CONTEXT="request.redirect.context"}(We||(We={})),function(e){e.ACCOUNT_KEYS="msal.account.keys",e.TOKEN_KEYS="msal.token.keys"}(je||(je={})),function(e){e.WRAPPER_SKU="wrapper.sku",e.WRAPPER_VER="wrapper.version"}(Qe||(Qe={})),function(e){e[e.acquireTokenRedirect=861]="acquireTokenRedirect",e[e.acquireTokenPopup=862]="acquireTokenPopup",e[e.ssoSilent=863]="ssoSilent",e[e.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",e[e.handleRedirectPromise=865]="handleRedirectPromise",e[e.acquireTokenByCode=866]="acquireTokenByCode",e[e.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow",e[e.logout=961]="logout",e[e.logoutPopup=962]="logoutPopup"}(Ye||(Ye={})),function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent",e.None="none"}(Ve||(Ve={})),function(e){e.Startup="startup",e.Login="login",e.Logout="logout",e.AcquireToken="acquireToken",e.SsoSilent="ssoSilent",e.HandleRedirect="handleRedirect",e.None="none"}(Je||(Je={}));var ct,ut={scopes:fe};!function(e){e.React="@azure/msal-react",e.Angular="@azure/msal-angular"}(ct||(ct={}));var lt;!function(e){e[e.Default=0]="Default",e[e.AccessToken=1]="AccessToken",e[e.AccessTokenAndRefreshToken=2]="AccessTokenAndRefreshToken",e[e.RefreshToken=3]="RefreshToken",e[e.RefreshTokenAndNetwork=4]="RefreshTokenAndNetwork",e[e.Skip=5]="Skip"}(lt||(lt={}));
/*! @azure/msal-common v13.0.0 2023-05-01 */
var dt,ht={code:"missing_kid_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided."},pt={code:"missing_alg_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."},ft=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="JoseHeaderError",Object.setPrototypeOf(o,t.prototype),o}return ne(t,e),t.createMissingKidError=function(){return new t(ht.code,ht.desc)},t.createMissingAlgError=function(){return new t(pt.code,pt.desc)},t}(Ze),gt=function(){function e(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}return e.getShrHeaderString=function(t){if(!t.kid)throw ft.createMissingKidError();if(!t.alg)throw ft.createMissingAlgError();var r=new e({typ:t.typ||qe.Pop,kid:t.kid,alg:t.alg});return JSON.stringify(r)},e}(),mt=function(){function e(){}return e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e}(),vt=function(){function e(e){this.cryptoObj=e}return e.prototype.generateGuid=function(){try{var e=new Uint8Array(16);return this.cryptoObj.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,mt.decimalToHex(e[0])+mt.decimalToHex(e[1])+mt.decimalToHex(e[2])+mt.decimalToHex(e[3])+"-"+mt.decimalToHex(e[4])+mt.decimalToHex(e[5])+"-"+mt.decimalToHex(e[6])+mt.decimalToHex(e[7])+"-"+mt.decimalToHex(e[8])+mt.decimalToHex(e[9])+"-"+mt.decimalToHex(e[10])+mt.decimalToHex(e[11])+mt.decimalToHex(e[12])+mt.decimalToHex(e[13])+mt.decimalToHex(e[14])+mt.decimalToHex(e[15])}catch(e){for(var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",n=0,o=pe.EMPTY_STRING,i=0;i<36;i++)"-"!==t[i]&&"4"!==t[i]&&(n=16*Math.random()|0),"x"===t[i]?o+=r[n]:"y"===t[i]?(n&=3,o+=r[n|=8]):o+=t[i];return o}},e.prototype.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e}(),yt=function(){function e(){}return e.stringToUtf8Arr=function(e){for(var t,r=0,n=e.length,o=0;o<n;o++)r+=(t=e.charCodeAt(o))<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;for(var i=new Uint8Array(r),a=0,s=0;a<r;s++)(t=e.charCodeAt(s))<128?i[a++]=t:t<2048?(i[a++]=192+(t>>>6),i[a++]=128+(63&t)):t<65536?(i[a++]=224+(t>>>12),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t)):t<2097152?(i[a++]=240+(t>>>18),i[a++]=128+(t>>>12&63),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t)):t<67108864?(i[a++]=248+(t>>>24),i[a++]=128+(t>>>18&63),i[a++]=128+(t>>>12&63),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t)):(i[a++]=252+(t>>>30),i[a++]=128+(t>>>24&63),i[a++]=128+(t>>>18&63),i[a++]=128+(t>>>12&63),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t));return i},e.stringToArrayBuffer=function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return t},e.utf8ArrToString=function(e){for(var t=pe.EMPTY_STRING,r=void 0,n=e.length,o=0;o<n;o++)r=e[o],t+=String.fromCharCode(r>251&&r<254&&o+5<n?1073741824*(r-252)+(e[++o]-128<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>247&&r<252&&o+4<n?(r-248<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>239&&r<248&&o+3<n?(r-240<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>223&&r<240&&o+2<n?(r-224<<12)+(e[++o]-128<<6)+e[++o]-128:r>191&&r<224&&o+1<n?(r-192<<6)+e[++o]-128:r);return t},e.getSortedObjectString=function(e){return JSON.stringify(e,Object.keys(e).sort())},e}(),Ct=function(){function e(){}return e.prototype.urlEncode=function(e){return encodeURIComponent(this.encode(e).replace(/=/g,pe.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_"))},e.prototype.urlEncodeArr=function(e){return this.base64EncArr(e).replace(/=/g,pe.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_")},e.prototype.encode=function(e){var t=yt.stringToUtf8Arr(e);return this.base64EncArr(t)},e.prototype.base64EncArr=function(e){for(var t=(3-e.length%3)%3,r=pe.EMPTY_STRING,n=void 0,o=e.length,i=0,a=0;a<o;a++)n=a%3,i|=e[a]<<(16>>>n&24),2!==n&&e.length-a!=1||(r+=String.fromCharCode(this.uint6ToB64(i>>>18&63),this.uint6ToB64(i>>>12&63),this.uint6ToB64(i>>>6&63),this.uint6ToB64(63&i)),i=0);return 0===t?r:r.substring(0,r.length-t)+(1===t?"=":"==")},e.prototype.uint6ToB64=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65},e}(),Tt=function(){function e(){}return e.prototype.decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}var r=this.base64DecToArr(t);return yt.utf8ArrToString(r)},e.prototype.base64DecToArr=function(e,t){for(var r=e.replace(/[^A-Za-z0-9\+\/]/g,pe.EMPTY_STRING),n=r.length,o=t?Math.ceil((3*n+1>>>2)/t)*t:3*n+1>>>2,i=new Uint8Array(o),a=void 0,s=void 0,c=0,u=0,l=0;l<n;l++)if(s=3&l,c|=this.b64ToUint6(r.charCodeAt(l))<<18-6*s,3===s||n-l==1){for(a=0;a<3&&u<o;a++,u++)i[u]=c>>>(16>>>a&24)&255;c=0}return i},e.prototype.b64ToUint6=function(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:43===e?62:47===e?63:0},e}(),Et={clientInfoDecodingError:{code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},clientInfoEmptyError:{code:"client_info_empty_error",desc:"The client info was empty. Please review the trace to determine the root cause."},tokenParsingError:{code:"token_parsing_error",desc:"Token cannot be parsed. Please review stack trace to determine root cause."},nullOrEmptyToken:{code:"null_or_empty_token",desc:"The token is null or empty. Please review the trace to determine the root cause."},endpointResolutionError:{code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},networkError:{code:"network_error",desc:"Network request failed. Please check network trace to determine root cause."},unableToGetOpenidConfigError:{code:"openid_config_error",desc:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints."},hashNotDeserialized:{code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},blankGuidGenerated:{code:"blank_guid_generated",desc:"The guid generated was blank. Please review the trace to determine the root cause."},invalidStateError:{code:"invalid_state",desc:"State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState()."},stateMismatchError:{code:"state_mismatch",desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},stateNotFoundError:{code:"state_not_found",desc:"State not found"},nonceMismatchError:{code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},nonceNotFoundError:{code:"nonce_not_found",desc:"nonce not found"},authTimeNotFoundError:{code:"auth_time_not_found",desc:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information."},maxAgeTranspiredError:{code:"max_age_transpired",desc:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication."},noTokensFoundError:{code:"no_tokens_found",desc:"No tokens were found for the given scopes, and no authorization code was passed to acquireToken. You must retrieve an authorization code before making a call to acquireToken()."},multipleMatchingTokens:{code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account."},multipleMatchingAccounts:{code:"multiple_matching_accounts",desc:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"},multipleMatchingAppMetadata:{code:"multiple_matching_appMetadata",desc:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata"},tokenRequestCannotBeMade:{code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},appendEmptyScopeError:{code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},removeEmptyScopeError:{code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},appendScopeSetError:{code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},emptyInputScopeSetError:{code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},DeviceCodePollingCancelled:{code:"device_code_polling_cancelled",desc:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."},DeviceCodeExpired:{code:"device_code_expired",desc:"Device code is expired."},DeviceCodeUnknownError:{code:"device_code_unknown_error",desc:"Device code stopped polling for unknown reasons."},NoAccountInSilentRequest:{code:"no_account_in_silent_request",desc:"Please pass an account object, silent flow is not supported without account information"},invalidCacheRecord:{code:"invalid_cache_record",desc:"Cache record object was null or undefined."},invalidCacheEnvironment:{code:"invalid_cache_environment",desc:"Invalid environment when attempting to create cache entry"},noAccountFound:{code:"no_account_found",desc:"No account found in cache for given key."},CachePluginError:{code:"no cache plugin set on CacheManager",desc:"ICachePlugin needs to be set before using readFromStorage or writeFromStorage"},noCryptoObj:{code:"no_crypto_object",desc:"No crypto object detected. This is required for the following operation: "},invalidCacheType:{code:"invalid_cache_type",desc:"Invalid cache type"},unexpectedAccountType:{code:"unexpected_account_type",desc:"Unexpected account type."},unexpectedCredentialType:{code:"unexpected_credential_type",desc:"Unexpected credential type."},invalidAssertion:{code:"invalid_assertion",desc:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515"},invalidClientCredential:{code:"invalid_client_credential",desc:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential"},tokenRefreshRequired:{code:"token_refresh_required",desc:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired."},userTimeoutReached:{code:"user_timeout_reached",desc:"User defined timeout for device code polling reached"},tokenClaimsRequired:{code:"token_claims_cnf_required_for_signedjwt",desc:"Cannot generate a POP jwt if the token_claims are not populated"},noAuthorizationCodeFromServer:{code:"authorization_code_missing_from_server_response",desc:"Server response does not contain an authorization code to proceed"},noAzureRegionDetected:{code:"no_azure_region_detected",desc:"No azure region was detected and no fallback was made available"},accessTokenEntityNullError:{code:"access_token_entity_null",desc:"Access token entity is null, please check logs and cache to ensure a valid access token is present."},bindingKeyNotRemovedError:{code:"binding_key_not_removed",desc:"Could not remove the credential's binding key from storage."},logoutNotSupported:{code:"end_session_endpoint_not_supported",desc:"Provided authority does not support logout."},keyIdMissing:{code:"key_id_missing",desc:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key."},noNetworkConnectivity:{code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},userCanceledError:{code:"user_canceled",desc:"User canceled the flow."}},_t=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientAuthError",Object.setPrototypeOf(o,t.prototype),o}return ne(t,e),t.createClientInfoDecodingError=function(e){return new t(Et.clientInfoDecodingError.code,Et.clientInfoDecodingError.desc+" Failed with error: "+e)},t.createClientInfoEmptyError=function(){return new t(Et.clientInfoEmptyError.code,""+Et.clientInfoEmptyError.desc)},t.createTokenParsingError=function(e){return new t(Et.tokenParsingError.code,Et.tokenParsingError.desc+" Failed with error: "+e)},t.createTokenNullOrEmptyError=function(e){return new t(Et.nullOrEmptyToken.code,Et.nullOrEmptyToken.desc+" Raw Token Value: "+e)},t.createEndpointDiscoveryIncompleteError=function(e){return new t(Et.endpointResolutionError.code,Et.endpointResolutionError.desc+" Detail: "+e)},t.createNetworkError=function(e,r){return new t(Et.networkError.code,Et.networkError.desc+" | Fetch client threw: "+r+" | Attempted to reach: "+e.split("?")[0])},t.createUnableToGetOpenidConfigError=function(e){return new t(Et.unableToGetOpenidConfigError.code,Et.unableToGetOpenidConfigError.desc+" Attempted to retrieve endpoints from: "+e)},t.createHashNotDeserializedError=function(e){return new t(Et.hashNotDeserialized.code,Et.hashNotDeserialized.desc+" Given Object: "+e)},t.createInvalidStateError=function(e,r){return new t(Et.invalidStateError.code,Et.invalidStateError.desc+" Invalid State: "+e+", Root Err: "+r)},t.createStateMismatchError=function(){return new t(Et.stateMismatchError.code,Et.stateMismatchError.desc)},t.createStateNotFoundError=function(e){return new t(Et.stateNotFoundError.code,Et.stateNotFoundError.desc+":  "+e)},t.createNonceMismatchError=function(){return new t(Et.nonceMismatchError.code,Et.nonceMismatchError.desc)},t.createAuthTimeNotFoundError=function(){return new t(Et.authTimeNotFoundError.code,Et.authTimeNotFoundError.desc)},t.createMaxAgeTranspiredError=function(){return new t(Et.maxAgeTranspiredError.code,Et.maxAgeTranspiredError.desc)},t.createNonceNotFoundError=function(e){return new t(Et.nonceNotFoundError.code,Et.nonceNotFoundError.desc+":  "+e)},t.createMultipleMatchingTokensInCacheError=function(){return new t(Et.multipleMatchingTokens.code,Et.multipleMatchingTokens.desc+".")},t.createMultipleMatchingAccountsInCacheError=function(){return new t(Et.multipleMatchingAccounts.code,Et.multipleMatchingAccounts.desc)},t.createMultipleMatchingAppMetadataInCacheError=function(){return new t(Et.multipleMatchingAppMetadata.code,Et.multipleMatchingAppMetadata.desc)},t.createTokenRequestCannotBeMadeError=function(){return new t(Et.tokenRequestCannotBeMade.code,Et.tokenRequestCannotBeMade.desc)},t.createAppendEmptyScopeToSetError=function(e){return new t(Et.appendEmptyScopeError.code,Et.appendEmptyScopeError.desc+" Given Scope: "+e)},t.createRemoveEmptyScopeFromSetError=function(e){return new t(Et.removeEmptyScopeError.code,Et.removeEmptyScopeError.desc+" Given Scope: "+e)},t.createAppendScopeSetError=function(e){return new t(Et.appendScopeSetError.code,Et.appendScopeSetError.desc+" Detail Error: "+e)},t.createEmptyInputScopeSetError=function(){return new t(Et.emptyInputScopeSetError.code,""+Et.emptyInputScopeSetError.desc)},t.createDeviceCodeCancelledError=function(){return new t(Et.DeviceCodePollingCancelled.code,""+Et.DeviceCodePollingCancelled.desc)},t.createDeviceCodeExpiredError=function(){return new t(Et.DeviceCodeExpired.code,""+Et.DeviceCodeExpired.desc)},t.createDeviceCodeUnknownError=function(){return new t(Et.DeviceCodeUnknownError.code,""+Et.DeviceCodeUnknownError.desc)},t.createNoAccountInSilentRequestError=function(){return new t(Et.NoAccountInSilentRequest.code,""+Et.NoAccountInSilentRequest.desc)},t.createNullOrUndefinedCacheRecord=function(){return new t(Et.invalidCacheRecord.code,Et.invalidCacheRecord.desc)},t.createInvalidCacheEnvironmentError=function(){return new t(Et.invalidCacheEnvironment.code,Et.invalidCacheEnvironment.desc)},t.createNoAccountFoundError=function(){return new t(Et.noAccountFound.code,Et.noAccountFound.desc)},t.createCachePluginError=function(){return new t(Et.CachePluginError.code,""+Et.CachePluginError.desc)},t.createNoCryptoObjectError=function(e){return new t(Et.noCryptoObj.code,""+Et.noCryptoObj.desc+e)},t.createInvalidCacheTypeError=function(){return new t(Et.invalidCacheType.code,""+Et.invalidCacheType.desc)},t.createUnexpectedAccountTypeError=function(){return new t(Et.unexpectedAccountType.code,""+Et.unexpectedAccountType.desc)},t.createUnexpectedCredentialTypeError=function(){return new t(Et.unexpectedCredentialType.code,""+Et.unexpectedCredentialType.desc)},t.createInvalidAssertionError=function(){return new t(Et.invalidAssertion.code,""+Et.invalidAssertion.desc)},t.createInvalidCredentialError=function(){return new t(Et.invalidClientCredential.code,""+Et.invalidClientCredential.desc)},t.createRefreshRequiredError=function(){return new t(Et.tokenRefreshRequired.code,Et.tokenRefreshRequired.desc)},t.createUserTimeoutReachedError=function(){return new t(Et.userTimeoutReached.code,Et.userTimeoutReached.desc)},t.createTokenClaimsRequiredError=function(){return new t(Et.tokenClaimsRequired.code,Et.tokenClaimsRequired.desc)},t.createNoAuthCodeInServerResponseError=function(){return new t(Et.noAuthorizationCodeFromServer.code,Et.noAuthorizationCodeFromServer.desc)},t.createBindingKeyNotRemovedError=function(){return new t(Et.bindingKeyNotRemovedError.code,Et.bindingKeyNotRemovedError.desc)},t.createLogoutNotSupportedError=function(){return new t(Et.logoutNotSupported.code,Et.logoutNotSupported.desc)},t.createKeyIdMissingError=function(){return new t(Et.keyIdMissing.code,Et.keyIdMissing.desc)},t.createNoNetworkConnectivityError=function(){return new t(Et.noNetworkConnectivity.code,Et.noNetworkConnectivity.desc)},t.createUserCanceledError=function(){return new t(Et.userCanceledError.code,Et.userCanceledError.desc)},t}(Ze),It=function(){function e(){}return e.decodeAuthToken=function(t){if(e.isEmpty(t))throw _t.createTokenNullOrEmptyError(t);var r=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);if(!r||r.length<4)throw _t.createTokenParsingError("Given token is malformed: "+JSON.stringify(t));return{header:r[1],JWSPayload:r[2],JWSSig:r[3]}},e.isEmpty=function(e){return void 0===e||!e||0===e.length},e.isEmptyObj=function(t){if(t&&!e.isEmpty(t))try{var r=JSON.parse(t);return 0===Object.keys(r).length}catch(e){}return!0},e.startsWith=function(e,t){return 0===e.indexOf(t)},e.endsWith=function(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length},e.queryStringToObject=function(e){var t={},r=e.split("&"),n=function(e){return decodeURIComponent(e.replace(/\+/g," "))};return r.forEach((function(e){if(e.trim()){var r=e.split(/=(.+)/g,2),o=r[0],i=r[1];o&&i&&(t[n(o)]=n(i))}})),t},e.trimArrayEntries=function(e){return e.map((function(e){return e.trim()}))},e.removeEmptyStringsFromArray=function(t){return t.filter((function(t){return!e.isEmpty(t)}))},e.jsonParseHelper=function(e){try{return JSON.parse(e)}catch(e){return null}},e.matchPattern=function(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)},e}(),wt={pkceNotGenerated:{code:"pkce_not_created",desc:"The PKCE code challenge and verifier could not be generated."},cryptoDoesNotExist:{code:"crypto_nonexistent",desc:"The crypto object or function is not available."},httpMethodNotImplementedError:{code:"http_method_not_implemented",desc:"The HTTP method given has not been implemented in this library."},emptyNavigateUriError:{code:"empty_navigate_uri",desc:"Navigation URI is empty. Please check stack trace for more info."},hashEmptyError:{code:"hash_empty_error",desc:"Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. For more visit: aka.ms/msaljs/browser-errors."},hashDoesNotContainStateError:{code:"no_state_in_hash",desc:"Hash does not contain state. Please verify that the request originated from msal."},hashDoesNotContainKnownPropertiesError:{code:"hash_does_not_contain_known_properties",desc:"Hash does not contain known properites. Please verify that your redirectUri is not changing the hash. For more visit: aka.ms/msaljs/browser-errors."},unableToParseStateError:{code:"unable_to_parse_state",desc:"Unable to parse state. Please verify that the request originated from msal."},stateInteractionTypeMismatchError:{code:"state_interaction_type_mismatch",desc:"Hash contains state but the interaction type does not match the caller."},interactionInProgress:{code:"interaction_in_progress",desc:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.  For more visit: aka.ms/msaljs/browser-errors."},popupWindowError:{code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},emptyWindowError:{code:"empty_window_error",desc:"window.open returned null or undefined window object."},userCancelledError:{code:"user_cancelled",desc:"User cancelled the flow."},monitorPopupTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in popup failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},monitorIframeTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in iframe failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},redirectInIframeError:{code:"redirect_in_iframe",desc:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."},blockTokenRequestsInHiddenIframeError:{code:"block_iframe_reload",desc:"Request was blocked inside an iframe because MSAL detected an authentication response. For more visit: aka.ms/msaljs/browser-errors"},blockAcquireTokenInPopupsError:{code:"block_nested_popups",desc:"Request was blocked inside a popup because MSAL detected it was running in a popup."},iframeClosedPrematurelyError:{code:"iframe_closed_prematurely",desc:"The iframe being monitored was closed prematurely."},silentLogoutUnsupportedError:{code:"silent_logout_unsupported",desc:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead."},noAccountError:{code:"no_account_error",desc:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request."},silentPromptValueError:{code:"silent_prompt_value_error",desc:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'."},noTokenRequestCacheError:{code:"no_token_request_cache_error",desc:"No token request found in cache."},unableToParseTokenRequestCacheError:{code:"unable_to_parse_token_request_cache_error",desc:"The cached token request could not be parsed."},noCachedAuthorityError:{code:"no_cached_authority_error",desc:"No cached authority found."},authRequestNotSet:{code:"auth_request_not_set_error",desc:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler"},invalidCacheType:{code:"invalid_cache_type",desc:"Invalid cache type"},notInBrowserEnvironment:{code:"non_browser_environment",desc:"Login and token requests are not supported in non-browser environments."},databaseNotOpen:{code:"database_not_open",desc:"Database is not open!"},noNetworkConnectivity:{code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},postRequestFailed:{code:"post_request_failed",desc:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'"},getRequestFailed:{code:"get_request_failed",desc:"Network request failed. Please check the network trace to determine root cause."},failedToParseNetworkResponse:{code:"failed_to_parse_response",desc:"Failed to parse network response. Check network trace."},unableToLoadTokenError:{code:"unable_to_load_token",desc:"Error loading token to cache."},signingKeyNotFoundInStorage:{code:"crypto_key_not_found",desc:"Cryptographic Key or Keypair not found in browser storage."},authCodeRequired:{code:"auth_code_required",desc:"An authorization code must be provided (as the `code` property on the request) to this flow."},authCodeOrNativeAccountRequired:{code:"auth_code_or_nativeAccountId_required",desc:"An authorization code or nativeAccountId must be provided to this flow."},spaCodeAndNativeAccountPresent:{code:"spa_code_and_nativeAccountId_present",desc:"Request cannot contain both spa code and native account id."},databaseUnavailable:{code:"database_unavailable",desc:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts."},unableToAcquireTokenFromNativePlatform:{code:"unable_to_acquire_token_from_native_platform",desc:"Unable to acquire token from native platform. For a list of possible reasons visit aka.ms/msaljs/browser-errors."},nativeHandshakeTimeout:{code:"native_handshake_timeout",desc:"Timed out while attempting to establish connection to browser extension"},nativeExtensionNotInstalled:{code:"native_extension_not_installed",desc:"Native extension is not installed. If you think this is a mistake call the initialize function."},nativeConnectionNotEstablished:{code:"native_connection_not_established",desc:"Connection to native platform has not been established. Please install a compatible browser extension and run initialize(). For more please visit aka.ms/msaljs/browser-errors."},nativeBrokerCalledBeforeInitialize:{code:"native_broker_called_before_initialize",desc:"You must call and await the initialize function before attempting to call any other MSAL API when native brokering is enabled. For more please visit aka.ms/msaljs/browser-errors."},nativePromptNotSupported:{code:"native_prompt_not_supported",desc:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow."}},St=function(e){function t(r,n){var o=e.call(this,r,n)||this;return Object.setPrototypeOf(o,t.prototype),o.name="BrowserAuthError",o}return j(t,e),t.createPkceNotGeneratedError=function(e){return new t(wt.pkceNotGenerated.code,wt.pkceNotGenerated.desc+" Detail:"+e)},t.createCryptoNotAvailableError=function(e){return new t(wt.cryptoDoesNotExist.code,wt.cryptoDoesNotExist.desc+" Detail:"+e)},t.createHttpMethodNotImplementedError=function(e){return new t(wt.httpMethodNotImplementedError.code,wt.httpMethodNotImplementedError.desc+" Given Method: "+e)},t.createEmptyNavigationUriError=function(){return new t(wt.emptyNavigateUriError.code,wt.emptyNavigateUriError.desc)},t.createEmptyHashError=function(e){return new t(wt.hashEmptyError.code,wt.hashEmptyError.desc+" Given Url: "+e)},t.createHashDoesNotContainStateError=function(){return new t(wt.hashDoesNotContainStateError.code,wt.hashDoesNotContainStateError.desc)},t.createHashDoesNotContainKnownPropertiesError=function(){return new t(wt.hashDoesNotContainKnownPropertiesError.code,wt.hashDoesNotContainKnownPropertiesError.desc)},t.createUnableToParseStateError=function(){return new t(wt.unableToParseStateError.code,wt.unableToParseStateError.desc)},t.createStateInteractionTypeMismatchError=function(){return new t(wt.stateInteractionTypeMismatchError.code,wt.stateInteractionTypeMismatchError.desc)},t.createInteractionInProgressError=function(){return new t(wt.interactionInProgress.code,wt.interactionInProgress.desc)},t.createPopupWindowError=function(e){var r=wt.popupWindowError.desc;return r=It.isEmpty(e)?r:r+" Details: "+e,new t(wt.popupWindowError.code,r)},t.createEmptyWindowCreatedError=function(){return new t(wt.emptyWindowError.code,wt.emptyWindowError.desc)},t.createUserCancelledError=function(){return new t(wt.userCancelledError.code,wt.userCancelledError.desc)},t.createMonitorPopupTimeoutError=function(){return new t(wt.monitorPopupTimeoutError.code,wt.monitorPopupTimeoutError.desc)},t.createMonitorIframeTimeoutError=function(){return new t(wt.monitorIframeTimeoutError.code,wt.monitorIframeTimeoutError.desc)},t.createRedirectInIframeError=function(e){return new t(wt.redirectInIframeError.code,wt.redirectInIframeError.desc+" (window.parent !== window) => "+e)},t.createBlockReloadInHiddenIframeError=function(){return new t(wt.blockTokenRequestsInHiddenIframeError.code,wt.blockTokenRequestsInHiddenIframeError.desc)},t.createBlockAcquireTokenInPopupsError=function(){return new t(wt.blockAcquireTokenInPopupsError.code,wt.blockAcquireTokenInPopupsError.desc)},t.createIframeClosedPrematurelyError=function(){return new t(wt.iframeClosedPrematurelyError.code,wt.iframeClosedPrematurelyError.desc)},t.createSilentLogoutUnsupportedError=function(){return new t(wt.silentLogoutUnsupportedError.code,wt.silentLogoutUnsupportedError.desc)},t.createNoAccountError=function(){return new t(wt.noAccountError.code,wt.noAccountError.desc)},t.createSilentPromptValueError=function(e){return new t(wt.silentPromptValueError.code,wt.silentPromptValueError.desc+" Given value: "+e)},t.createUnableToParseTokenRequestCacheError=function(){return new t(wt.unableToParseTokenRequestCacheError.code,wt.unableToParseTokenRequestCacheError.desc)},t.createNoTokenRequestCacheError=function(){return new t(wt.noTokenRequestCacheError.code,wt.noTokenRequestCacheError.desc)},t.createAuthRequestNotSetError=function(){return new t(wt.authRequestNotSet.code,wt.authRequestNotSet.desc)},t.createNoCachedAuthorityError=function(){return new t(wt.noCachedAuthorityError.code,wt.noCachedAuthorityError.desc)},t.createInvalidCacheTypeError=function(){return new t(wt.invalidCacheType.code,""+wt.invalidCacheType.desc)},t.createNonBrowserEnvironmentError=function(){return new t(wt.notInBrowserEnvironment.code,wt.notInBrowserEnvironment.desc)},t.createDatabaseNotOpenError=function(){return new t(wt.databaseNotOpen.code,wt.databaseNotOpen.desc)},t.createNoNetworkConnectivityError=function(){return new t(wt.noNetworkConnectivity.code,wt.noNetworkConnectivity.desc)},t.createPostRequestFailedError=function(e,r){return new t(wt.postRequestFailed.code,wt.postRequestFailed.desc+" | Network client threw: "+e+" | Attempted to reach: "+r.split("?")[0])},t.createGetRequestFailedError=function(e,r){return new t(wt.getRequestFailed.code,wt.getRequestFailed.desc+" | Network client threw: "+e+" | Attempted to reach: "+r.split("?")[0])},t.createFailedToParseNetworkResponseError=function(e){return new t(wt.failedToParseNetworkResponse.code,wt.failedToParseNetworkResponse.desc+" | Attempted to reach: "+e.split("?")[0])},t.createUnableToLoadTokenError=function(e){return new t(wt.unableToLoadTokenError.code,wt.unableToLoadTokenError.desc+" | "+e)},t.createSigningKeyNotFoundInStorageError=function(e){return new t(wt.signingKeyNotFoundInStorage.code,wt.signingKeyNotFoundInStorage.desc+" | No match found for KeyId: "+e)},t.createAuthCodeRequiredError=function(){return new t(wt.authCodeRequired.code,wt.authCodeRequired.desc)},t.createAuthCodeOrNativeAccountIdRequiredError=function(){return new t(wt.authCodeOrNativeAccountRequired.code,wt.authCodeOrNativeAccountRequired.desc)},t.createSpaCodeAndNativeAccountIdPresentError=function(){return new t(wt.spaCodeAndNativeAccountPresent.code,wt.spaCodeAndNativeAccountPresent.desc)},t.createDatabaseUnavailableError=function(){return new t(wt.databaseUnavailable.code,wt.databaseUnavailable.desc)},t.createUnableToAcquireTokenFromNativePlatformError=function(){return new t(wt.unableToAcquireTokenFromNativePlatform.code,wt.unableToAcquireTokenFromNativePlatform.desc)},t.createNativeHandshakeTimeoutError=function(){return new t(wt.nativeHandshakeTimeout.code,wt.nativeHandshakeTimeout.desc)},t.createNativeExtensionNotInstalledError=function(){return new t(wt.nativeExtensionNotInstalled.code,wt.nativeExtensionNotInstalled.desc)},t.createNativeConnectionNotEstablishedError=function(){return new t(wt.nativeConnectionNotEstablished.code,wt.nativeConnectionNotEstablished.desc)},t.createNativeBrokerCalledBeforeInitialize=function(){return new t(wt.nativeBrokerCalledBeforeInitialize.code,wt.nativeBrokerCalledBeforeInitialize.desc)},t.createNativePromptParameterNotSupportedError=function(){return new t(wt.nativePromptNotSupported.code,wt.nativePromptNotSupported.desc)},t}(Ze),bt=function(){function e(e){this.base64Encode=new Ct,this.cryptoObj=e}return e.prototype.generateCodes=function(){return X(this,void 0,void 0,(function(){var e,t;return Z(this,(function(r){switch(r.label){case 0:return e=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(e)];case 1:return t=r.sent(),[2,{verifier:e,challenge:t}]}}))}))},e.prototype.generateCodeVerifier=function(){try{var e=new Uint8Array(32);return this.cryptoObj.getRandomValues(e),this.base64Encode.urlEncodeArr(e)}catch(e){throw St.createPkceNotGeneratedError(e)}},e.prototype.generateCodeChallengeFromVerifier=function(e){return X(this,void 0,void 0,(function(){var t,r;return Z(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(e)];case 1:return t=n.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(t))];case 2:throw r=n.sent(),St.createPkceNotGeneratedError(r);case 3:return[2]}}))}))},e}(),kt=function(){function e(){}return e.prototype.getRandomValues=function(e){return window.crypto.getRandomValues(e)},e.prototype.generateKey=function(e,t,r){return X(this,void 0,void 0,(function(){return Z(this,(function(n){return[2,window.crypto.subtle.generateKey(e,t,r)]}))}))},e.prototype.exportKey=function(e){return X(this,void 0,void 0,(function(){return Z(this,(function(t){return[2,window.crypto.subtle.exportKey("jwk",e)]}))}))},e.prototype.importKey=function(e,t,r,n){return X(this,void 0,void 0,(function(){return Z(this,(function(o){return[2,window.crypto.subtle.importKey("jwk",e,t,r,n)]}))}))},e.prototype.sign=function(e,t,r){return X(this,void 0,void 0,(function(){return Z(this,(function(n){return[2,window.crypto.subtle.sign(e,t,r)]}))}))},e.prototype.digest=function(e,t){return X(this,void 0,void 0,(function(){return Z(this,(function(r){return[2,window.crypto.subtle.digest(e,t)]}))}))},e}(),At=function(){function e(){}return e.prototype.initPrng=function(e){return window.msrCrypto.initPrng(ee(e))},e.prototype.getRandomValues=function(e){return window.msrCrypto.getRandomValues(e)},e.prototype.generateKey=function(e,t,r){return X(this,void 0,void 0,(function(){return Z(this,(function(n){return[2,window.msrCrypto.subtle.generateKey(e,t,r)]}))}))},e.prototype.exportKey=function(e){return X(this,void 0,void 0,(function(){return Z(this,(function(t){return[2,window.msrCrypto.subtle.exportKey("jwk",e)]}))}))},e.prototype.importKey=function(e,t,r,n){return X(this,void 0,void 0,(function(){return Z(this,(function(o){return[2,window.msrCrypto.subtle.importKey("jwk",e,t,r,n)]}))}))},e.prototype.sign=function(e,t,r){return X(this,void 0,void 0,(function(){return Z(this,(function(n){return[2,window.msrCrypto.subtle.sign(e,t,r)]}))}))},e.prototype.digest=function(e,t){return X(this,void 0,void 0,(function(){return Z(this,(function(r){return[2,window.msrCrypto.subtle.digest(e,t)]}))}))},e}(),Rt=function(){function e(){}return e.prototype.getRandomValues=function(e){return window.msCrypto.getRandomValues(e)},e.prototype.generateKey=function(e,t,r){return X(this,void 0,void 0,(function(){return Z(this,(function(n){return[2,new Promise((function(n,o){var i=window.msCrypto.subtle.generateKey(e,t,r);i.addEventListener("complete",(function(e){n(e.target.result)})),i.addEventListener("error",(function(e){o(e)}))}))]}))}))},e.prototype.exportKey=function(e){return X(this,void 0,void 0,(function(){return Z(this,(function(t){return[2,new Promise((function(t,r){var n=window.msCrypto.subtle.exportKey("jwk",e);n.addEventListener("complete",(function(e){var n=e.target.result,o=yt.utf8ArrToString(new Uint8Array(n)).replace(/\r/g,pe.EMPTY_STRING).replace(/\n/g,pe.EMPTY_STRING).replace(/\t/g,pe.EMPTY_STRING).split(" ").join(pe.EMPTY_STRING).replace("\0",pe.EMPTY_STRING);try{t(JSON.parse(o))}catch(e){r(e)}})),n.addEventListener("error",(function(e){r(e)}))}))]}))}))},e.prototype.importKey=function(e,t,r,n){return X(this,void 0,void 0,(function(){var o,i;return Z(this,(function(a){return o=yt.getSortedObjectString(e),i=yt.stringToArrayBuffer(o),[2,new Promise((function(e,o){var a=window.msCrypto.subtle.importKey("jwk",i,t,r,n);a.addEventListener("complete",(function(t){e(t.target.result)})),a.addEventListener("error",(function(e){o(e)}))}))]}))}))},e.prototype.sign=function(e,t,r){return X(this,void 0,void 0,(function(){return Z(this,(function(n){return[2,new Promise((function(n,o){var i=window.msCrypto.subtle.sign(e,t,r);i.addEventListener("complete",(function(e){n(e.target.result)})),i.addEventListener("error",(function(e){o(e)}))}))]}))}))},e.prototype.digest=function(e,t){return X(this,void 0,void 0,(function(){return Z(this,(function(r){return[2,new Promise((function(r,n){var o=window.msCrypto.subtle.digest(e,t.buffer);o.addEventListener("complete",(function(e){r(e.target.result)})),o.addEventListener("error",(function(e){n(e)}))}))]}))}))},e}(),Pt={redirectUriNotSet:{code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},storageNotSupportedError:{code:"storage_not_supported",desc:"Given storage configuration option was not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},stubPcaInstanceCalled:{code:"stubbed_public_client_application_called",desc:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors"},inMemRedirectUnavailable:{code:"in_mem_redirect_unavailable",desc:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."},entropyNotProvided:{code:"entropy_not_provided",desc:"The available browser crypto interface requires entropy set via system.cryptoOptions.entropy configuration option."}},Nt=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="BrowserConfigurationAuthError",Object.setPrototypeOf(o,t.prototype),o}return j(t,e),t.createRedirectUriEmptyError=function(){return new t(Pt.redirectUriNotSet.code,Pt.redirectUriNotSet.desc)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(Pt.postLogoutUriNotSet.code,Pt.postLogoutUriNotSet.desc)},t.createStorageNotSupportedError=function(e){return new t(Pt.storageNotSupportedError.code,Pt.storageNotSupportedError.desc+" Given Location: "+e)},t.createRedirectCallbacksNotSetError=function(){return new t(Pt.noRedirectCallbacksSet.code,Pt.noRedirectCallbacksSet.desc)},t.createStubPcaInstanceCalledError=function(){return new t(Pt.stubPcaInstanceCalled.code,Pt.stubPcaInstanceCalled.desc)},t.createInMemoryRedirectUnavailableError=function(){return new t(Pt.inMemRedirectUnavailable.code,Pt.inMemRedirectUnavailable.desc)},t.createEntropyNotProvided=function(){return new t(Pt.entropyNotProvided.code,Pt.entropyNotProvided.desc)},t}(Ze),Mt=new Uint8Array([1,0,1]),Ot=function(){function e(e,t){var r,n;if(this.logger=e,this.cryptoOptions=t,this.hasBrowserCrypto())this.logger.verbose("BrowserCrypto: modern crypto interface available"),this.subtleCrypto=new kt;else if(this.hasIECrypto())this.logger.verbose("BrowserCrypto: MS crypto interface available"),this.subtleCrypto=new Rt;else{if(!this.hasMsrCrypto()||!(null===(r=this.cryptoOptions)||void 0===r?void 0:r.useMsrCrypto))throw this.hasMsrCrypto()&&this.logger.info("BrowserCrypto: MSR Crypto interface available but system.cryptoOptions.useMsrCrypto not enabled"),this.logger.error("BrowserCrypto: No crypto interfaces available."),St.createCryptoNotAvailableError("Browser crypto, msCrypto, or msrCrypto interfaces not available.");this.logger.verbose("BrowserCrypto: MSR crypto interface available"),this.subtleCrypto=new At}if(this.subtleCrypto.initPrng){if(this.logger.verbose("BrowserCrypto: Interface requires entropy"),!(null===(n=this.cryptoOptions)||void 0===n?void 0:n.entropy))throw this.logger.error("BrowserCrypto: Interface requires entropy but none provided."),Nt.createEntropyNotProvided();this.logger.verbose("BrowserCrypto: Entropy provided"),this.subtleCrypto.initPrng(this.cryptoOptions.entropy)}this.keygenAlgorithmOptions={name:"RSASSA-PKCS1-v1_5",hash:"SHA-256",modulusLength:2048,publicExponent:Mt}}return e.prototype.hasIECrypto=function(){return"msCrypto"in window},e.prototype.hasBrowserCrypto=function(){return"crypto"in window},e.prototype.hasMsrCrypto=function(){return"msrCrypto"in window},e.prototype.sha256Digest=function(e){return X(this,void 0,void 0,(function(){var t;return Z(this,(function(r){return t=yt.stringToUtf8Arr(e),[2,this.subtleCrypto.digest({name:"SHA-256"},t)]}))}))},e.prototype.getRandomValues=function(e){return this.subtleCrypto.getRandomValues(e)},e.prototype.generateKeyPair=function(e,t){return X(this,void 0,void 0,(function(){return Z(this,(function(r){return[2,this.subtleCrypto.generateKey(this.keygenAlgorithmOptions,e,t)]}))}))},e.prototype.exportJwk=function(e){return X(this,void 0,void 0,(function(){return Z(this,(function(t){return[2,this.subtleCrypto.exportKey(e)]}))}))},e.prototype.importJwk=function(e,t,r){return X(this,void 0,void 0,(function(){return Z(this,(function(n){return[2,this.subtleCrypto.importKey(e,this.keygenAlgorithmOptions,t,r)]}))}))},e.prototype.sign=function(e,t){return X(this,void 0,void 0,(function(){return Z(this,(function(r){return[2,this.subtleCrypto.sign(this.keygenAlgorithmOptions,e,t)]}))}))},e}(),Ut=function(){function e(){this.dbName="msal.db",this.version=1,this.tableName="msal.db.keys",this.dbOpen=!1}return e.prototype.open=function(){return X(this,void 0,void 0,(function(){var e=this;return Z(this,(function(t){return[2,new Promise((function(t,r){var n=window.indexedDB.open(e.dbName,e.version);n.addEventListener("upgradeneeded",(function(t){t.target.result.createObjectStore(e.tableName)})),n.addEventListener("success",(function(r){var n=r;e.db=n.target.result,e.dbOpen=!0,t()})),n.addEventListener("error",(function(){return r(St.createDatabaseUnavailableError())}))}))]}))}))},e.prototype.closeConnection=function(){var e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)},e.prototype.validateDbIsOpen=function(){return X(this,void 0,void 0,(function(){return Z(this,(function(e){switch(e.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:return[2,e.sent()];case 2:return[2]}}))}))},e.prototype.getItem=function(e){return X(this,void 0,void 0,(function(){var t=this;return Z(this,(function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise((function(r,n){if(!t.db)return n(St.createDatabaseNotOpenError());var o=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).get(e);o.addEventListener("success",(function(e){var n=e;t.closeConnection(),r(n.target.result)})),o.addEventListener("error",(function(e){t.closeConnection(),n(e)}))}))]}}))}))},e.prototype.setItem=function(e,t){return X(this,void 0,void 0,(function(){var r=this;return Z(this,(function(n){switch(n.label){case 0:return[4,this.validateDbIsOpen()];case 1:return n.sent(),[2,new Promise((function(n,o){if(!r.db)return o(St.createDatabaseNotOpenError());var i=r.db.transaction([r.tableName],"readwrite").objectStore(r.tableName).put(t,e);i.addEventListener("success",(function(){r.closeConnection(),n()})),i.addEventListener("error",(function(e){r.closeConnection(),o(e)}))}))]}}))}))},e.prototype.removeItem=function(e){return X(this,void 0,void 0,(function(){var t=this;return Z(this,(function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise((function(r,n){if(!t.db)return n(St.createDatabaseNotOpenError());var o=t.db.transaction([t.tableName],"readwrite").objectStore(t.tableName).delete(e);o.addEventListener("success",(function(){t.closeConnection(),r()})),o.addEventListener("error",(function(e){t.closeConnection(),n(e)}))}))]}}))}))},e.prototype.getKeys=function(){return X(this,void 0,void 0,(function(){var e=this;return Z(this,(function(t){switch(t.label){case 0:return[4,this.validateDbIsOpen()];case 1:return t.sent(),[2,new Promise((function(t,r){if(!e.db)return r(St.createDatabaseNotOpenError());var n=e.db.transaction([e.tableName],"readonly").objectStore(e.tableName).getAllKeys();n.addEventListener("success",(function(r){var n=r;e.closeConnection(),t(n.target.result)})),n.addEventListener("error",(function(t){e.closeConnection(),r(t)}))}))]}}))}))},e.prototype.containsKey=function(e){return X(this,void 0,void 0,(function(){var t=this;return Z(this,(function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise((function(r,n){if(!t.db)return n(St.createDatabaseNotOpenError());var o=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).count(e);o.addEventListener("success",(function(e){var n=e;t.closeConnection(),r(1===n.target.result)})),o.addEventListener("error",(function(e){t.closeConnection(),n(e)}))}))]}}))}))},e.prototype.deleteDatabase=function(){return X(this,void 0,void 0,(function(){return Z(this,(function(e){return this.db&&this.dbOpen&&this.closeConnection(),[2,new Promise((function(e,t){var r=window.indexedDB.deleteDatabase("msal.db");r.addEventListener("success",(function(){return e(!0)})),r.addEventListener("blocked",(function(){return e(!0)})),r.addEventListener("error",(function(){return t(!1)}))}))]}))}))},e}(),qt=function(){function e(){this.cache=new Map}return e.prototype.getItem=function(e){return this.cache.get(e)||null},e.prototype.setItem=function(e,t){this.cache.set(e,t)},e.prototype.removeItem=function(e){this.cache.delete(e)},e.prototype.getKeys=function(){var e=[];return this.cache.forEach((function(t,r){e.push(r)})),e},e.prototype.containsKey=function(e){return this.cache.has(e)},e.prototype.clear=function(){this.cache.clear()},e}(),Lt=function(){function e(e,t){this.inMemoryCache=new qt,this.indexedDBCache=new Ut,this.logger=e,this.storeName=t}return e.prototype.handleDatabaseAccessError=function(e){if(!(e instanceof St&&e.errorCode===wt.databaseUnavailable.code))throw e;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")},e.prototype.getItem=function(e){return X(this,void 0,void 0,(function(){var t,r;return Z(this,(function(n){switch(n.label){case 0:if(t=this.inMemoryCache.getItem(e))return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.getItem(e)];case 2:return[2,n.sent()];case 3:return r=n.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2,t]}}))}))},e.prototype.setItem=function(e,t){return X(this,void 0,void 0,(function(){var r;return Z(this,(function(n){switch(n.label){case 0:this.inMemoryCache.setItem(e,t),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.indexedDBCache.setItem(e,t)];case 2:return n.sent(),[3,4];case 3:return r=n.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2]}}))}))},e.prototype.removeItem=function(e){return X(this,void 0,void 0,(function(){var t;return Z(this,(function(r){switch(r.label){case 0:this.inMemoryCache.removeItem(e),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.indexedDBCache.removeItem(e)];case 2:return r.sent(),[3,4];case 3:return t=r.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2]}}))}))},e.prototype.getKeys=function(){return X(this,void 0,void 0,(function(){var e,t;return Z(this,(function(r){switch(r.label){case 0:if(0!==(e=this.inMemoryCache.getKeys()).length)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),this.logger.verbose("In-memory cache is empty, now querying persistent storage."),[4,this.indexedDBCache.getKeys()];case 2:return[2,r.sent()];case 3:return t=r.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2,e]}}))}))},e.prototype.containsKey=function(e){return X(this,void 0,void 0,(function(){var t,r;return Z(this,(function(n){switch(n.label){case 0:if(t=this.inMemoryCache.containsKey(e))return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.containsKey(e)];case 2:return[2,n.sent()];case 3:return r=n.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2,t]}}))}))},e.prototype.clearInMemory=function(){this.logger.verbose("Deleting in-memory keystore "+this.storeName),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore "+this.storeName+" deleted")},e.prototype.clearPersistent=function(){return X(this,void 0,void 0,(function(){var e,t;return Z(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),this.logger.verbose("Deleting persistent keystore"),[4,this.indexedDBCache.deleteDatabase()];case 1:return(e=r.sent())&&this.logger.verbose("Persistent keystore deleted"),[2,e];case 2:return t=r.sent(),this.handleDatabaseAccessError(t),[2,!1];case 3:return[2]}}))}))},e}();!function(e){e.asymmetricKeys="asymmetricKeys",e.symmetricKeys="symmetricKeys"}(dt||(dt={}));var Ht,Dt=function(){function e(e){this.logger=e,this.asymmetricKeys=new Lt(this.logger,dt.asymmetricKeys),this.symmetricKeys=new Lt(this.logger,dt.symmetricKeys)}return e.prototype.clear=function(){return X(this,void 0,void 0,(function(){var e;return Z(this,(function(t){switch(t.label){case 0:this.asymmetricKeys.clearInMemory(),this.symmetricKeys.clearInMemory(),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.asymmetricKeys.clearPersistent()];case 2:return t.sent(),[2,!0];case 3:return(e=t.sent())instanceof Error?this.logger.error("Clearing keystore failed with error: "+e.message):this.logger.error("Clearing keystore failed with unknown error"),[2,!1];case 4:return[2]}}))}))},e}(),xt=function(){function e(e,t,r){this.logger=e,this.browserCrypto=new Ot(this.logger,r),this.b64Encode=new Ct,this.b64Decode=new Tt,this.guidGenerator=new vt(this.browserCrypto),this.pkceGenerator=new bt(this.browserCrypto),this.cache=new Dt(this.logger),this.performanceClient=t}return e.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},e.prototype.base64Encode=function(e){return this.b64Encode.encode(e)},e.prototype.base64Decode=function(e){return this.b64Decode.decode(e)},e.prototype.generatePkceCodes=function(){return X(this,void 0,void 0,(function(){return Z(this,(function(e){return[2,this.pkceGenerator.generateCodes()]}))}))},e.prototype.getPublicKeyThumbprint=function(t){var r;return X(this,void 0,void 0,(function(){var n,o,i,a,s,c,u,l;return Z(this,(function(d){switch(d.label){case 0:return n=null===(r=this.performanceClient)||void 0===r?void 0:r.startMeasurement(Q.CryptoOptsGetPublicKeyThumbprint,t.correlationId),[4,this.browserCrypto.generateKeyPair(e.EXTRACTABLE,e.POP_KEY_USAGES)];case 1:return o=d.sent(),[4,this.browserCrypto.exportJwk(o.publicKey)];case 2:return i=d.sent(),a={e:i.e,kty:i.kty,n:i.n},s=yt.getSortedObjectString(a),[4,this.hashString(s)];case 3:return c=d.sent(),[4,this.browserCrypto.exportJwk(o.privateKey)];case 4:return u=d.sent(),[4,this.browserCrypto.importJwk(u,!1,["sign"])];case 5:return l=d.sent(),[4,this.cache.asymmetricKeys.setItem(c,{privateKey:l,publicKey:o.publicKey,requestMethod:t.resourceRequestMethod,requestUri:t.resourceRequestUri})];case 6:return d.sent(),n&&n.endMeasurement({success:!0}),[2,c]}}))}))},e.prototype.removeTokenBindingKey=function(e){return X(this,void 0,void 0,(function(){return Z(this,(function(t){switch(t.label){case 0:return[4,this.cache.asymmetricKeys.removeItem(e)];case 1:return t.sent(),[4,this.cache.asymmetricKeys.containsKey(e)];case 2:return[2,!t.sent()]}}))}))},e.prototype.clearKeystore=function(){return X(this,void 0,void 0,(function(){return Z(this,(function(e){switch(e.label){case 0:return[4,this.cache.clear()];case 1:return[2,e.sent()]}}))}))},e.prototype.signJwt=function(e,t,r){var n;return X(this,void 0,void 0,(function(){var o,i,a,s,c,u,l,d,h,p,f,g,m;return Z(this,(function(v){switch(v.label){case 0:return o=null===(n=this.performanceClient)||void 0===n?void 0:n.startMeasurement(Q.CryptoOptsSignJwt,r),[4,this.cache.asymmetricKeys.getItem(t)];case 1:if(!(i=v.sent()))throw St.createSigningKeyNotFoundInStorageError(t);return[4,this.browserCrypto.exportJwk(i.publicKey)];case 2:return a=v.sent(),s=yt.getSortedObjectString(a),c=this.b64Encode.urlEncode(JSON.stringify({kid:t})),u=gt.getShrHeaderString({kid:c,alg:a.alg}),l=this.b64Encode.urlEncode(u),e.cnf={jwk:JSON.parse(s)},d=this.b64Encode.urlEncode(JSON.stringify(e)),h=l+"."+d,p=yt.stringToArrayBuffer(h),[4,this.browserCrypto.sign(i.privateKey,p)];case 3:return f=v.sent(),g=this.b64Encode.urlEncodeArr(new Uint8Array(f)),m=h+"."+g,o&&o.endMeasurement({success:!0}),[2,m]}}))}))},e.prototype.hashString=function(e){return X(this,void 0,void 0,(function(){var t,r;return Z(this,(function(n){switch(n.label){case 0:return[4,this.browserCrypto.sha256Digest(e)];case 1:return t=n.sent(),r=new Uint8Array(t),[2,this.b64Encode.urlEncodeArr(r)]}}))}))},e.POP_KEY_USAGES=["sign","verify"],e.EXTRACTABLE=!0,e}();
/*! @azure/msal-browser v2.37.0 2023-05-01 */!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(Ht||(Ht={}));var Bt,Ft=function(){function e(t,r,n){this.level=Ht.Info;var o=t||e.createDefaultLoggerOptions();this.localCallback=o.loggerCallback||function(){},this.piiLoggingEnabled=o.piiLoggingEnabled||!1,this.level="number"==typeof o.logLevel?o.logLevel:Ht.Info,this.correlationId=o.correlationId||pe.EMPTY_STRING,this.packageName=r||pe.EMPTY_STRING,this.packageVersion=n||pe.EMPTY_STRING}return e.createDefaultLoggerOptions=function(){return{loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:Ht.Info}},e.prototype.clone=function(t,r,n){return new e({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},t,r)},e.prototype.logMessage=function(e,t){if(!(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)){var r=(new Date).toUTCString(),n=(It.isEmpty(t.correlationId)?It.isEmpty(this.correlationId)?"["+r+"]":"["+r+"] : ["+this.correlationId+"]":"["+r+"] : ["+t.correlationId+"]")+" : "+this.packageName+"@"+this.packageVersion+" : "+Ht[t.logLevel]+" - "+e;this.executeCallback(t.logLevel,n,t.containsPii||!1)}},e.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},e.prototype.error=function(e,t){this.logMessage(e,{logLevel:Ht.Error,containsPii:!1,correlationId:t||pe.EMPTY_STRING})},e.prototype.errorPii=function(e,t){this.logMessage(e,{logLevel:Ht.Error,containsPii:!0,correlationId:t||pe.EMPTY_STRING})},e.prototype.warning=function(e,t){this.logMessage(e,{logLevel:Ht.Warning,containsPii:!1,correlationId:t||pe.EMPTY_STRING})},e.prototype.warningPii=function(e,t){this.logMessage(e,{logLevel:Ht.Warning,containsPii:!0,correlationId:t||pe.EMPTY_STRING})},e.prototype.info=function(e,t){this.logMessage(e,{logLevel:Ht.Info,containsPii:!1,correlationId:t||pe.EMPTY_STRING})},e.prototype.infoPii=function(e,t){this.logMessage(e,{logLevel:Ht.Info,containsPii:!0,correlationId:t||pe.EMPTY_STRING})},e.prototype.verbose=function(e,t){this.logMessage(e,{logLevel:Ht.Verbose,containsPii:!1,correlationId:t||pe.EMPTY_STRING})},e.prototype.verbosePii=function(e,t){this.logMessage(e,{logLevel:Ht.Verbose,containsPii:!0,correlationId:t||pe.EMPTY_STRING})},e.prototype.trace=function(e,t){this.logMessage(e,{logLevel:Ht.Trace,containsPii:!1,correlationId:t||pe.EMPTY_STRING})},e.prototype.tracePii=function(e,t){this.logMessage(e,{logLevel:Ht.Trace,containsPii:!0,correlationId:t||pe.EMPTY_STRING})},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},e}(),Kt=function(){function e(e,t,r,n,o,i){this.authority=t,this.libraryName=n,this.libraryVersion=o,this.applicationTelemetry=i,this.clientId=e,this.logger=r,this.callbacks=new Map,this.eventsByCorrelationId=new Map,this.queueMeasurements=new Map,this.preQueueTimeByCorrelationId=new Map}return e.prototype.startPerformanceMeasurement=function(e,t){return{}},e.prototype.startPerformanceMeasuremeant=function(e,t){return{}},e.prototype.getIntFields=function(){return te},e.prototype.getPreQueueTime=function(e,t){var r=this.preQueueTimeByCorrelationId.get(t);if(r){if(r.name===e)return r.time;this.logger.trace("PerformanceClient.getPreQueueTime: no pre-queue time found for "+e+", unable to add queue measurement")}else this.logger.trace("PerformanceClient.getPreQueueTime: no pre-queue times found for correlationId: "+t+", unable to add queue measurement")},e.prototype.calculateQueuedTime=function(e,t){return e<1?(this.logger.trace("PerformanceClient: preQueueTime should be a positive integer and not "+e),0):t<1?(this.logger.trace("PerformanceClient: currentTime should be a positive integer and not "+t),0):t<e?(this.logger.trace("PerformanceClient: currentTime is less than preQueueTime, check how time is being retrieved"),0):t-e},e.prototype.addQueueMeasurement=function(e,t,r,n){if(t){if(0===r)this.logger.trace("PerformanceClient.addQueueMeasurement: queue time provided for "+e+" is "+r);else if(!r)return void this.logger.trace("PerformanceClient.addQueueMeasurement: no queue time provided for "+e);var o={eventName:e,queueTime:r,manuallyCompleted:n},i=this.queueMeasurements.get(t);if(i)i.push(o),this.queueMeasurements.set(t,i);else{this.logger.trace("PerformanceClient.addQueueMeasurement: adding correlationId "+t+" to queue measurements");var a=[o];this.queueMeasurements.set(t,a)}this.preQueueTimeByCorrelationId.delete(t)}else this.logger.trace("PerformanceClient.addQueueMeasurement: correlationId not provided for "+e+", cannot add queue measurement")},e.prototype.startMeasurement=function(e,t){var r,n,o=this,i=t||this.generateId();t||this.logger.info("PerformanceClient: No correlation id provided for "+e+", generating",i),this.logger.trace("PerformanceClient: Performance measurement started for "+e,i);var a=this.startPerformanceMeasuremeant(e,i);a.startMeasurement();var s={eventId:this.generateId(),status:Y.InProgress,authority:this.authority,libraryName:this.libraryName,libraryVersion:this.libraryVersion,clientId:this.clientId,name:e,startTimeMs:Date.now(),correlationId:i,appName:null===(r=this.applicationTelemetry)||void 0===r?void 0:r.appName,appVersion:null===(n=this.applicationTelemetry)||void 0===n?void 0:n.appVersion};return this.cacheEventByCorrelationId(s),{endMeasurement:function(e){return o.endMeasurement(oe(oe({},s),e),a)},discardMeasurement:function(){return o.discardMeasurements(s.correlationId)},addStaticFields:function(e){return o.addStaticFields(e,s.correlationId)},increment:function(e){return o.increment(e,s.correlationId)},measurement:a,event:s}},e.prototype.endMeasurement=function(e,t){var r,n,o=this,i=this.eventsByCorrelationId.get(e.correlationId);if(!i)return this.logger.trace("PerformanceClient: Measurement not found for "+e.eventId,e.correlationId),null;var a=e.eventId===i.eventId,s={totalQueueTime:0,totalQueueCount:0,manuallyCompletedCount:0};a?(s=this.getQueueInfo(e.correlationId),this.discardCache(i.correlationId)):null===(r=i.incompleteSubMeasurements)||void 0===r||r.delete(e.eventId),null==t||t.endMeasurement();var c=null==t?void 0:t.flushMeasurement();if(!c)return this.logger.trace("PerformanceClient: Performance measurement not taken",i.correlationId),null;if(this.logger.trace("PerformanceClient: Performance measurement ended for "+e.name+": "+c+" ms",e.correlationId),!a)return i[e.name+"DurationMs"]=Math.floor(c),oe({},i);var u=oe(oe({},i),e),l=0;return null===(n=u.incompleteSubMeasurements)||void 0===n||n.forEach((function(t){o.logger.trace("PerformanceClient: Incomplete submeasurement "+t.name+" found for "+e.name,u.correlationId),l++})),u.incompleteSubMeasurements=void 0,u=oe(oe({},u),{durationMs:Math.round(c),queuedTimeMs:s.totalQueueTime,queuedCount:s.totalQueueCount,queuedManuallyCompletedCount:s.manuallyCompletedCount,status:Y.Completed,incompleteSubsCount:l}),this.truncateIntegralFields(u,this.getIntFields()),this.emitEvents([u],e.correlationId),u},e.prototype.addStaticFields=function(e,t){this.logger.trace("PerformanceClient: Updating static fields");var r=this.eventsByCorrelationId.get(t);r?this.eventsByCorrelationId.set(t,oe(oe({},r),e)):this.logger.trace("PerformanceClient: Event not found for",t)},e.prototype.increment=function(e,t){this.logger.trace("PerformanceClient: Updating counters");var r=this.eventsByCorrelationId.get(t);if(r)for(var n in e)r.hasOwnProperty(n)||(r[n]=0),r[n]+=e[n];else this.logger.trace("PerformanceClient: Event not found for",t)},e.prototype.cacheEventByCorrelationId=function(e){var t=this.eventsByCorrelationId.get(e.correlationId);t?(this.logger.trace("PerformanceClient: Performance measurement for "+e.name+" added/updated",e.correlationId),t.incompleteSubMeasurements=t.incompleteSubMeasurements||new Map,t.incompleteSubMeasurements.set(e.eventId,{name:e.name,startTimeMs:e.startTimeMs})):(this.logger.trace("PerformanceClient: Performance measurement for "+e.name+" started",e.correlationId),this.eventsByCorrelationId.set(e.correlationId,oe({},e)))},e.prototype.getQueueInfo=function(e){var t=this.queueMeasurements.get(e);t||this.logger.trace("PerformanceClient: no queue measurements found for for correlationId: "+e);var r=0,n=0,o=0;return null==t||t.forEach((function(e){r+=e.queueTime,n++,o+=e.manuallyCompleted?1:0})),{totalQueueTime:r,totalQueueCount:n,manuallyCompletedCount:o}},e.prototype.discardMeasurements=function(e){this.logger.trace("PerformanceClient: Performance measurements discarded",e),this.eventsByCorrelationId.delete(e)},e.prototype.discardCache=function(e){this.discardMeasurements(e),this.logger.trace("PerformanceClient: QueueMeasurements discarded",e),this.queueMeasurements.delete(e),this.logger.trace("PerformanceClient: Pre-queue times discarded",e),this.preQueueTimeByCorrelationId.delete(e)},e.prototype.addPerformanceCallback=function(e){var t=this.generateId();return this.callbacks.set(t,e),this.logger.verbose("PerformanceClient: Performance callback registered with id: "+t),t},e.prototype.removePerformanceCallback=function(e){var t=this.callbacks.delete(e);return t?this.logger.verbose("PerformanceClient: Performance callback "+e+" removed."):this.logger.verbose("PerformanceClient: Performance callback "+e+" not removed."),t},e.prototype.emitEvents=function(e,t){var r=this;this.logger.verbose("PerformanceClient: Emitting performance events",t),this.callbacks.forEach((function(n,o){r.logger.trace("PerformanceClient: Emitting event to callback "+o,t),n.apply(null,[e])}))},e.prototype.truncateIntegralFields=function(e,t){t.forEach((function(t){t in e&&"number"==typeof e[t]&&(e[t]=Math.floor(e[t]))}))},e}(),Gt=function(){function e(){}return e.prototype.startMeasurement=function(){},e.prototype.endMeasurement=function(){},e.prototype.flushMeasurement=function(){return null},e}(),zt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ne(t,e),t.prototype.generateId=function(){return"callback-id"},t.prototype.startPerformanceMeasuremeant=function(){return new Gt},t.prototype.startPerformanceMeasurement=function(){return new Gt},t.prototype.calculateQueuedTime=function(e,t){return 0},t.prototype.addQueueMeasurement=function(e,t,r){},t.prototype.setPreQueueTime=function(e,t){},t}(Kt),Wt={createNewGuid:function(){throw Ze.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw Ze.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw Ze.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return ie(this,void 0,void 0,(function(){return ae(this,(function(e){throw"Crypto interface - generatePkceCodes() has not been implemented",Ze.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")}))}))},getPublicKeyThumbprint:function(){return ie(this,void 0,void 0,(function(){return ae(this,(function(e){throw"Crypto interface - getPublicKeyThumbprint() has not been implemented",Ze.createUnexpectedError("Crypto interface - getPublicKeyThumbprint() has not been implemented")}))}))},removeTokenBindingKey:function(){return ie(this,void 0,void 0,(function(){return ae(this,(function(e){throw"Crypto interface - removeTokenBindingKey() has not been implemented",Ze.createUnexpectedError("Crypto interface - removeTokenBindingKey() has not been implemented")}))}))},clearKeystore:function(){return ie(this,void 0,void 0,(function(){return ae(this,(function(e){throw"Crypto interface - clearKeystore() has not been implemented",Ze.createUnexpectedError("Crypto interface - clearKeystore() has not been implemented")}))}))},signJwt:function(){return ie(this,void 0,void 0,(function(){return ae(this,(function(e){throw"Crypto interface - signJwt() has not been implemented",Ze.createUnexpectedError("Crypto interface - signJwt() has not been implemented")}))}))},hashString:function(){return ie(this,void 0,void 0,(function(){return ae(this,(function(e){throw"Crypto interface - hashString() has not been implemented",Ze.createUnexpectedError("Crypto interface - hashString() has not been implemented")}))}))}},jt=function(){function e(){}return e.prototype.generateAccountId=function(){return e.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},e.prototype.generateCredentialId=function(){return e.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},e.prototype.generateTarget=function(){return e.generateTargetForCacheKey(this.target)},e.prototype.generateCredentialKey=function(){return e.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId,this.tokenType,this.requestedClaimsHash)},e.prototype.generateType=function(){switch(this.credentialType){case _e.ID_TOKEN:return Ie.ID_TOKEN;case _e.ACCESS_TOKEN:case _e.ACCESS_TOKEN_WITH_AUTH_SCHEME:return Ie.ACCESS_TOKEN;case _e.REFRESH_TOKEN:return Ie.REFRESH_TOKEN;default:throw _t.createUnexpectedCredentialTypeError()}},e.generateCredentialCacheKey=function(e,t,r,n,o,i,a,s,c){return[this.generateAccountIdForCacheKey(e,t),this.generateCredentialIdForCacheKey(r,n,o,a),this.generateTargetForCacheKey(i),this.generateClaimsHashForCacheKey(c),this.generateSchemeForCacheKey(s)].join(Ee.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateAccountIdForCacheKey=function(e,t){return[e,t].join(Ee.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateCredentialIdForCacheKey=function(e,t,r,n){return[e,e===_e.REFRESH_TOKEN&&n||t,r||pe.EMPTY_STRING].join(Ee.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateTargetForCacheKey=function(e){return(e||pe.EMPTY_STRING).toLowerCase()},e.generateClaimsHashForCacheKey=function(e){return(e||pe.EMPTY_STRING).toLowerCase()},e.generateSchemeForCacheKey=function(e){return e&&e.toLowerCase()!==Ae.BEARER.toLowerCase()?e.toLowerCase():pe.EMPTY_STRING},e}(),Qt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ne(t,e),t.createIdTokenEntity=function(e,r,n,o,i){var a=new t;return a.credentialType=_e.ID_TOKEN,a.homeAccountId=e,a.environment=r,a.clientId=o,a.secret=n,a.realm=i,a},t.isIdTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===_e.ID_TOKEN)},t}(jt),Yt={redirectUriNotSet:{code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},claimsRequestParsingError:{code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},authorityUriInsecure:{code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},urlParseError:{code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},urlEmptyError:{code:"empty_url_error",desc:"URL was empty or null."},emptyScopesError:{code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},nonArrayScopesError:{code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},clientIdSingleScopeError:{code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},invalidPrompt:{code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent', 'create', 'none' and 'no_session'.  Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest"},invalidClaimsRequest:{code:"invalid_claims",desc:"Given claims parameter must be a stringified JSON object."},tokenRequestEmptyError:{code:"token_request_empty",desc:"Token request was empty and not found in cache."},logoutRequestEmptyError:{code:"logout_request_empty",desc:"The logout request was null or undefined."},invalidCodeChallengeMethod:{code:"invalid_code_challenge_method",desc:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'},invalidCodeChallengeParams:{code:"pkce_params_missing",desc:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"},invalidCloudDiscoveryMetadata:{code:"invalid_cloud_discovery_metadata",desc:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields"},invalidAuthorityMetadata:{code:"invalid_authority_metadata",desc:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields."},untrustedAuthority:{code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter."},invalidAzureCloudInstance:{code:"invalid_azure_cloud_instance",desc:"Invalid AzureCloudInstance provided. Please refer MSAL JS docs: aks.ms/msaljs/azure_cloud_instance for valid values"},missingSshJwk:{code:"missing_ssh_jwk",desc:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme."},missingSshKid:{code:"missing_ssh_kid",desc:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme."},missingNonceAuthenticationHeader:{code:"missing_nonce_authentication_header",desc:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce."},invalidAuthenticationHeader:{code:"invalid_authentication_header",desc:"Invalid authentication header provided"}},Vt=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientConfigurationError",Object.setPrototypeOf(o,t.prototype),o}return ne(t,e),t.createRedirectUriEmptyError=function(){return new t(Yt.redirectUriNotSet.code,Yt.redirectUriNotSet.desc)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(Yt.postLogoutUriNotSet.code,Yt.postLogoutUriNotSet.desc)},t.createClaimsRequestParsingError=function(e){return new t(Yt.claimsRequestParsingError.code,Yt.claimsRequestParsingError.desc+" Given value: "+e)},t.createInsecureAuthorityUriError=function(e){return new t(Yt.authorityUriInsecure.code,Yt.authorityUriInsecure.desc+" Given URI: "+e)},t.createUrlParseError=function(e){return new t(Yt.urlParseError.code,Yt.urlParseError.desc+" Given Error: "+e)},t.createUrlEmptyError=function(){return new t(Yt.urlEmptyError.code,Yt.urlEmptyError.desc)},t.createEmptyScopesArrayError=function(){return new t(Yt.emptyScopesError.code,""+Yt.emptyScopesError.desc)},t.createClientIdSingleScopeError=function(e){return new t(Yt.clientIdSingleScopeError.code,Yt.clientIdSingleScopeError.desc+" Given Scopes: "+e)},t.createInvalidPromptError=function(e){return new t(Yt.invalidPrompt.code,Yt.invalidPrompt.desc+" Given value: "+e)},t.createInvalidClaimsRequestError=function(){return new t(Yt.invalidClaimsRequest.code,Yt.invalidClaimsRequest.desc)},t.createEmptyLogoutRequestError=function(){return new t(Yt.logoutRequestEmptyError.code,Yt.logoutRequestEmptyError.desc)},t.createEmptyTokenRequestError=function(){return new t(Yt.tokenRequestEmptyError.code,Yt.tokenRequestEmptyError.desc)},t.createInvalidCodeChallengeMethodError=function(){return new t(Yt.invalidCodeChallengeMethod.code,Yt.invalidCodeChallengeMethod.desc)},t.createInvalidCodeChallengeParamsError=function(){return new t(Yt.invalidCodeChallengeParams.code,Yt.invalidCodeChallengeParams.desc)},t.createInvalidCloudDiscoveryMetadataError=function(){return new t(Yt.invalidCloudDiscoveryMetadata.code,Yt.invalidCloudDiscoveryMetadata.desc)},t.createInvalidAuthorityMetadataError=function(){return new t(Yt.invalidAuthorityMetadata.code,Yt.invalidAuthorityMetadata.desc)},t.createUntrustedAuthorityError=function(){return new t(Yt.untrustedAuthority.code,Yt.untrustedAuthority.desc)},t.createInvalidAzureCloudInstanceError=function(){return new t(Yt.invalidAzureCloudInstance.code,Yt.invalidAzureCloudInstance.desc)},t.createMissingSshJwkError=function(){return new t(Yt.missingSshJwk.code,Yt.missingSshJwk.desc)},t.createMissingSshKidError=function(){return new t(Yt.missingSshKid.code,Yt.missingSshKid.desc)},t.createMissingNonceAuthenticationHeadersError=function(){return new t(Yt.missingNonceAuthenticationHeader.code,Yt.missingNonceAuthenticationHeader.desc)},t.createInvalidAuthenticationHeaderError=function(e,r){return new t(Yt.invalidAuthenticationHeader.code,Yt.invalidAuthenticationHeader.desc+". Invalid header: "+e+". Details: "+r)},t}(_t),Jt=function(){function e(e){var t=this,r=e?It.trimArrayEntries(se(e)):[],n=r?It.removeEmptyStringsFromArray(r):[];this.validateInputScopes(n),this.scopes=new Set,n.forEach((function(e){return t.scopes.add(e)}))}return e.fromString=function(t){return new e((t||pe.EMPTY_STRING).split(" "))},e.createSearchScopes=function(t){var r=new e(t);return r.containsOnlyOIDCScopes()?r.removeScope(pe.OFFLINE_ACCESS_SCOPE):r.removeOIDCScopes(),r},e.prototype.validateInputScopes=function(e){if(!e||e.length<1)throw Vt.createEmptyScopesArrayError()},e.prototype.containsScope=function(t){var r=new e(this.printScopesLowerCase().split(" "));return!It.isEmpty(t)&&r.scopes.has(t.toLowerCase())},e.prototype.containsScopeSet=function(e){var t=this;return!(!e||e.scopes.size<=0)&&(this.scopes.size>=e.scopes.size&&e.asArray().every((function(e){return t.containsScope(e)})))},e.prototype.containsOnlyOIDCScopes=function(){var e=this,t=0;return ge.forEach((function(r){e.containsScope(r)&&(t+=1)})),this.scopes.size===t},e.prototype.appendScope=function(e){It.isEmpty(e)||this.scopes.add(e.trim())},e.prototype.appendScopes=function(e){var t=this;try{e.forEach((function(e){return t.appendScope(e)}))}catch(e){throw _t.createAppendScopeSetError(e)}},e.prototype.removeScope=function(e){if(It.isEmpty(e))throw _t.createRemoveEmptyScopeFromSetError(e);this.scopes.delete(e.trim())},e.prototype.removeOIDCScopes=function(){var e=this;ge.forEach((function(t){e.scopes.delete(t)}))},e.prototype.unionScopeSets=function(e){if(!e)throw _t.createEmptyInputScopeSetError();var t=new Set;return e.scopes.forEach((function(e){return t.add(e.toLowerCase())})),this.scopes.forEach((function(e){return t.add(e.toLowerCase())})),t},e.prototype.intersectingScopeSets=function(e){if(!e)throw _t.createEmptyInputScopeSetError();e.containsOnlyOIDCScopes()||e.removeOIDCScopes();var t=this.unionScopeSets(e),r=e.getScopeCount(),n=this.getScopeCount();return t.size<n+r},e.prototype.getScopeCount=function(){return this.scopes.size},e.prototype.asArray=function(){var e=[];return this.scopes.forEach((function(t){return e.push(t)})),e},e.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):pe.EMPTY_STRING},e.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},e}();
/*! @azure/msal-common v13.0.0 2023-05-01 */
/*! @azure/msal-common v13.0.0 2023-05-01 */
function Xt(e,t){if(It.isEmpty(e))throw _t.createClientInfoEmptyError();try{var r=t.base64Decode(e);return JSON.parse(r)}catch(e){throw _t.createClientInfoDecodingError(e.message)}}function Zt(e){if(It.isEmpty(e))throw _t.createClientInfoDecodingError("Home account ID was empty.");var t=e.split(Ee.CLIENT_INFO_SEPARATOR,2);return{uid:t[0],utid:t.length<2?pe.EMPTY_STRING:t[1]}}
/*! @azure/msal-common v13.0.0 2023-05-01 */!function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs",e[e.Dsts=2]="Dsts",e[e.Ciam=3]="Ciam"}(Bt||(Bt={}));
/*! @azure/msal-common v13.0.0 2023-05-01 */
var $t,er=function(){function e(){}return e.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(Ee.CACHE_KEY_SEPARATOR).toLowerCase()},e.prototype.generateAccountKey=function(){return e.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},e.prototype.generateType=function(){switch(this.authorityType){case Te.ADFS_ACCOUNT_TYPE:return Ie.ADFS;case Te.MSAV1_ACCOUNT_TYPE:return Ie.MSA;case Te.MSSTS_ACCOUNT_TYPE:return Ie.MSSTS;case Te.GENERIC_ACCOUNT_TYPE:return Ie.GENERIC;default:throw _t.createUnexpectedAccountTypeError()}},e.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims,nativeAccountId:this.nativeAccountId}},e.generateAccountCacheKey=function(e){return[e.homeAccountId,e.environment||pe.EMPTY_STRING,e.tenantId||pe.EMPTY_STRING].join(Ee.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAccount=function(t,r,n,o,i,a,s,c){var u,l,d,h,p,f,g=new e;g.authorityType=Te.MSSTS_ACCOUNT_TYPE,g.clientInfo=t,g.homeAccountId=r,g.nativeAccountId=c;var m=s||o&&o.getPreferredCache();if(!m)throw _t.createInvalidCacheEnvironmentError();if(g.environment=m,g.realm=(null===(u=null==n?void 0:n.claims)||void 0===u?void 0:u.tid)||pe.EMPTY_STRING,n){g.idTokenClaims=n.claims,g.localAccountId=(null===(l=null==n?void 0:n.claims)||void 0===l?void 0:l.oid)||(null===(d=null==n?void 0:n.claims)||void 0===d?void 0:d.sub)||pe.EMPTY_STRING;var v=null===(h=null==n?void 0:n.claims)||void 0===h?void 0:h.preferred_username,y=(null===(p=null==n?void 0:n.claims)||void 0===p?void 0:p.emails)?n.claims.emails[0]:null;g.username=v||y||pe.EMPTY_STRING,g.name=null===(f=null==n?void 0:n.claims)||void 0===f?void 0:f.name}return g.cloudGraphHostName=i,g.msGraphHost=a,g},e.createGenericAccount=function(t,r,n,o,i,a){var s,c,u,l,d=new e;d.authorityType=n&&n.authorityType===Bt.Adfs?Te.ADFS_ACCOUNT_TYPE:Te.GENERIC_ACCOUNT_TYPE,d.homeAccountId=t,d.realm=pe.EMPTY_STRING;var h=a||n&&n.getPreferredCache();if(!h)throw _t.createInvalidCacheEnvironmentError();return r&&(d.localAccountId=(null===(s=null==r?void 0:r.claims)||void 0===s?void 0:s.oid)||(null===(c=null==r?void 0:r.claims)||void 0===c?void 0:c.sub)||pe.EMPTY_STRING,d.username=(null===(u=null==r?void 0:r.claims)||void 0===u?void 0:u.upn)||pe.EMPTY_STRING,d.name=(null===(l=null==r?void 0:r.claims)||void 0===l?void 0:l.name)||pe.EMPTY_STRING,d.idTokenClaims=null==r?void 0:r.claims),d.environment=h,d.cloudGraphHostName=o,d.msGraphHost=i,d},e.generateHomeAccountId=function(e,t,r,n,o){var i,a=(null===(i=null==o?void 0:o.claims)||void 0===i?void 0:i.sub)?o.claims.sub:pe.EMPTY_STRING;if(t===Bt.Adfs||t===Bt.Dsts)return a;if(e)try{var s=Xt(e,n);if(!It.isEmpty(s.uid)&&!It.isEmpty(s.utid))return""+s.uid+Ee.CLIENT_INFO_SEPARATOR+s.utid}catch(e){}return r.verbose("No client info in response"),a},e.isAccountEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"))},e.accountInfoIsEqual=function(e,t,r){if(!e||!t)return!1;var n=!0;if(r){var o=e.idTokenClaims||{},i=t.idTokenClaims||{};n=o.iat===i.iat&&o.nonce===i.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&n},e}(),tr=function(){function e(t,r){if(It.isEmpty(t))throw _t.createTokenNullOrEmptyError(t);this.rawToken=t,this.claims=e.extractTokenClaims(t,r)}return e.extractTokenClaims=function(e,t){var r=It.decodeAuthToken(e);try{var n=r.JWSPayload,o=t.base64Decode(n);return JSON.parse(o)}catch(e){throw _t.createTokenParsingError(e)}},e.checkMaxAge=function(e,t){if(0===t||Date.now()-3e5>e+t)throw _t.createMaxAgeTranspiredError()},e}(),rr=function(){function e(e,t,r){this.clientId=e,this.cryptoImpl=t,this.commonLogger=r.clone("@azure/msal-common","13.0.0")}return e.prototype.getAllAccounts=function(){var e=this,t=this.getAccountKeys();if(t.length<1)return[];var r=t.reduce((function(t,r){var n=e.getAccount(r);return n?(t.push(n),t):t}),[]);return r.length<1?[]:r.map((function(t){return e.getAccountInfoFromEntity(t)}))},e.prototype.getAccountInfoFilteredBy=function(e){var t=this.getAccountsFilteredBy(e);return t.length>0?this.getAccountInfoFromEntity(t[0]):null},e.prototype.getAccountInfoFromEntity=function(e){var t=e.getAccountInfo(),r=this.getIdToken(t);return r&&(t.idToken=r.secret,t.idTokenClaims=new tr(r.secret,this.cryptoImpl).claims),t},e.prototype.saveCacheRecord=function(e){return ie(this,void 0,void 0,(function(){return ae(this,(function(t){switch(t.label){case 0:if(!e)throw _t.createNullOrUndefinedCacheRecord();return e.account&&this.setAccount(e.account),e.idToken&&this.setIdTokenCredential(e.idToken),e.accessToken?[4,this.saveAccessToken(e.accessToken)]:[3,2];case 1:t.sent(),t.label=2;case 2:return e.refreshToken&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata),[2]}}))}))},e.prototype.saveAccessToken=function(e){return ie(this,void 0,void 0,(function(){var t,r,n,o,i=this;return ae(this,(function(a){switch(a.label){case 0:return t={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},r=this.getTokenKeys(),n=Jt.fromString(e.target),o=[],r.accessToken.forEach((function(e){if(i.accessTokenKeyMatchesFilter(e,t,!1)){var r=i.getAccessTokenCredential(e);if(r&&i.credentialMatchesFilter(r,t))Jt.fromString(r.target).intersectingScopeSets(n)&&o.push(i.removeAccessToken(e))}})),[4,Promise.all(o)];case 1:return a.sent(),this.setAccessTokenCredential(e),[2]}}))}))},e.prototype.getAccountsFilteredBy=function(e){var t=this,r=this.getAccountKeys(),n=[];return r.forEach((function(r){if(t.isAccountKey(r,e.homeAccountId,e.realm)){var o=t.getAccount(r);o&&(e.homeAccountId&&!t.matchHomeAccountId(o,e.homeAccountId)||e.localAccountId&&!t.matchLocalAccountId(o,e.localAccountId)||e.username&&!t.matchUsername(o,e.username)||e.environment&&!t.matchEnvironment(o,e.environment)||e.realm&&!t.matchRealm(o,e.realm)||e.nativeAccountId&&!t.matchNativeAccountId(o,e.nativeAccountId)||n.push(o))}})),n},e.prototype.isAccountKey=function(e,t,r){return!(e.split(Ee.CACHE_KEY_SEPARATOR).length<3)&&(!(t&&!e.toLowerCase().includes(t.toLowerCase()))&&!(r&&!e.toLowerCase().includes(r.toLowerCase())))},e.prototype.isCredentialKey=function(e){if(e.split(Ee.CACHE_KEY_SEPARATOR).length<6)return!1;var t=e.toLowerCase();if(-1===t.indexOf(_e.ID_TOKEN.toLowerCase())&&-1===t.indexOf(_e.ACCESS_TOKEN.toLowerCase())&&-1===t.indexOf(_e.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())&&-1===t.indexOf(_e.REFRESH_TOKEN.toLowerCase()))return!1;if(t.indexOf(_e.REFRESH_TOKEN.toLowerCase())>-1){var r=""+_e.REFRESH_TOKEN+Ee.CACHE_KEY_SEPARATOR+this.clientId+Ee.CACHE_KEY_SEPARATOR,n=""+_e.REFRESH_TOKEN+Ee.CACHE_KEY_SEPARATOR+"1"+Ee.CACHE_KEY_SEPARATOR;if(-1===t.indexOf(r.toLowerCase())&&-1===t.indexOf(n.toLowerCase()))return!1}else if(-1===t.indexOf(this.clientId.toLowerCase()))return!1;return!0},e.prototype.credentialMatchesFilter=function(e,t){if(t.clientId&&!this.matchClientId(e,t.clientId))return!1;if(t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash))return!1;if("string"==typeof t.homeAccountId&&!this.matchHomeAccountId(e,t.homeAccountId))return!1;if(t.environment&&!this.matchEnvironment(e,t.environment))return!1;if(t.realm&&!this.matchRealm(e,t.realm))return!1;if(t.credentialType&&!this.matchCredentialType(e,t.credentialType))return!1;if(t.familyId&&!this.matchFamilyId(e,t.familyId))return!1;if(t.target&&!this.matchTarget(e,t.target))return!1;if((t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash)return!1;if(e.credentialType===_e.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(t.tokenType&&!this.matchTokenType(e,t.tokenType))return!1;if(t.tokenType===Ae.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId))return!1}return!0},e.prototype.getAppMetadataFilteredBy=function(e){return this.getAppMetadataFilteredByInternal(e.environment,e.clientId)},e.prototype.getAppMetadataFilteredByInternal=function(e,t){var r=this,n=this.getKeys(),o={};return n.forEach((function(n){if(r.isAppMetadata(n)){var i=r.getAppMetadata(n);i&&(e&&!r.matchEnvironment(i,e)||t&&!r.matchClientId(i,t)||(o[n]=i))}})),o},e.prototype.getAuthorityMetadataByAlias=function(e){var t=this,r=this.getAuthorityMetadataKeys(),n=null;return r.forEach((function(r){if(t.isAuthorityMetadata(r)&&-1!==r.indexOf(t.clientId)){var o=t.getAuthorityMetadata(r);o&&-1!==o.aliases.indexOf(e)&&(n=o)}})),n},e.prototype.removeAllAccounts=function(){return ie(this,void 0,void 0,(function(){var e,t,r=this;return ae(this,(function(n){switch(n.label){case 0:return e=this.getAccountKeys(),t=[],e.forEach((function(e){t.push(r.removeAccount(e))})),[4,Promise.all(t)];case 1:return n.sent(),[2]}}))}))},e.prototype.removeAccount=function(e){return ie(this,void 0,void 0,(function(){var t;return ae(this,(function(r){switch(r.label){case 0:if(!(t=this.getAccount(e)))throw _t.createNoAccountFoundError();return[4,this.removeAccountContext(t)];case 1:return r.sent(),this.removeItem(e),[2]}}))}))},e.prototype.removeAccountContext=function(e){return ie(this,void 0,void 0,(function(){var t,r,n,o=this;return ae(this,(function(i){switch(i.label){case 0:return t=this.getTokenKeys(),r=e.generateAccountId(),n=[],t.idToken.forEach((function(e){0===e.indexOf(r)&&o.removeIdToken(e)})),t.accessToken.forEach((function(e){0===e.indexOf(r)&&n.push(o.removeAccessToken(e))})),t.refreshToken.forEach((function(e){0===e.indexOf(r)&&o.removeRefreshToken(e)})),[4,Promise.all(n)];case 1:return i.sent(),[2]}}))}))},e.prototype.removeAccessToken=function(e){return ie(this,void 0,void 0,(function(){var t,r;return ae(this,(function(n){switch(n.label){case 0:if(!(t=this.getAccessTokenCredential(e)))return[2];if(t.credentialType.toLowerCase()!==_e.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())return[3,4];if(t.tokenType!==Ae.POP)return[3,4];if(!(r=t.keyId))return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.cryptoImpl.removeTokenBindingKey(r)];case 2:return n.sent(),[3,4];case 3:throw n.sent(),_t.createBindingKeyNotRemovedError();case 4:return[2,this.removeItem(e)]}}))}))},e.prototype.removeAppMetadata=function(){var e=this;return this.getKeys().forEach((function(t){e.isAppMetadata(t)&&e.removeItem(t)})),!0},e.prototype.readCacheRecord=function(e,t,r){var n=this.getTokenKeys(),o=this.readAccountFromCache(e),i=this.getIdToken(e,n),a=this.getAccessToken(e,t,n),s=this.getRefreshToken(e,!1,n),c=this.readAppMetadataFromCache(r);return o&&i&&(o.idTokenClaims=new tr(i.secret,this.cryptoImpl).claims),{account:o,idToken:i,accessToken:a,refreshToken:s,appMetadata:c}},e.prototype.readAccountFromCache=function(e){var t=er.generateAccountCacheKey(e);return this.getAccount(t)},e.prototype.getIdToken=function(e,t){this.commonLogger.trace("CacheManager - getIdToken called");var r={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:_e.ID_TOKEN,clientId:this.clientId,realm:e.tenantId},n=this.getIdTokensByFilter(r,t),o=n.length;if(o<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(o>1)throw _t.createMultipleMatchingTokensInCacheError();return this.commonLogger.info("CacheManager:getIdToken - Returning id token"),n[0]},e.prototype.getIdTokensByFilter=function(e,t){var r=this,n=t&&t.idToken||this.getTokenKeys().idToken,o=[];return n.forEach((function(t){if(r.idTokenKeyMatchesFilter(t,oe({clientId:r.clientId},e))){var n=r.getIdTokenCredential(t);n&&r.credentialMatchesFilter(n,e)&&o.push(n)}})),o},e.prototype.idTokenKeyMatchesFilter=function(e,t){var r=e.toLowerCase();return(!t.clientId||-1!==r.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==r.indexOf(t.homeAccountId.toLowerCase()))},e.prototype.removeIdToken=function(e){this.removeItem(e)},e.prototype.removeRefreshToken=function(e){this.removeItem(e)},e.prototype.getAccessToken=function(e,t,r){var n=this;this.commonLogger.trace("CacheManager - getAccessToken called");var o=Jt.createSearchScopes(t.scopes),i=t.authenticationScheme||Ae.BEARER,a=i&&i.toLowerCase()!==Ae.BEARER.toLowerCase()?_e.ACCESS_TOKEN_WITH_AUTH_SCHEME:_e.ACCESS_TOKEN,s={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:a,clientId:this.clientId,realm:e.tenantId,target:o,tokenType:i,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},c=r&&r.accessToken||this.getTokenKeys().accessToken,u=[];c.forEach((function(e){if(n.accessTokenKeyMatchesFilter(e,s,!0)){var t=n.getAccessTokenCredential(e);t&&n.credentialMatchesFilter(t,s)&&u.push(t)}}));var l=u.length;if(l<1)return this.commonLogger.info("CacheManager:getAccessToken - No token found"),null;if(l>1)throw _t.createMultipleMatchingTokensInCacheError();return this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),u[0]},e.prototype.accessTokenKeyMatchesFilter=function(e,t,r){var n=e.toLowerCase();if(t.clientId&&-1===n.indexOf(t.clientId.toLowerCase()))return!1;if(t.homeAccountId&&-1===n.indexOf(t.homeAccountId.toLowerCase()))return!1;if(t.realm&&-1===n.indexOf(t.realm.toLowerCase()))return!1;if(t.requestedClaimsHash&&-1===n.indexOf(t.requestedClaimsHash.toLowerCase()))return!1;if(t.target)for(var o=t.target.asArray(),i=0;i<o.length;i++){if(r&&!n.includes(o[i].toLowerCase()))return!1;if(!r&&n.includes(o[i].toLowerCase()))return!0}return!0},e.prototype.getAccessTokensByFilter=function(e){var t=this,r=this.getTokenKeys(),n=[];return r.accessToken.forEach((function(r){if(t.accessTokenKeyMatchesFilter(r,e,!0)){var o=t.getAccessTokenCredential(r);o&&t.credentialMatchesFilter(o,e)&&n.push(o)}})),n},e.prototype.getRefreshToken=function(e,t,r){var n=this;this.commonLogger.trace("CacheManager - getRefreshToken called");var o=t?"1":void 0,i={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:_e.REFRESH_TOKEN,clientId:this.clientId,familyId:o},a=r&&r.refreshToken||this.getTokenKeys().refreshToken,s=[];return a.forEach((function(e){if(n.refreshTokenKeyMatchesFilter(e,i)){var t=n.getRefreshTokenCredential(e);t&&n.credentialMatchesFilter(t,i)&&s.push(t)}})),s.length<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),s[0])},e.prototype.refreshTokenKeyMatchesFilter=function(e,t){var r=e.toLowerCase();return(!t.familyId||-1!==r.indexOf(t.familyId.toLowerCase()))&&(!(!t.familyId&&t.clientId&&-1===r.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==r.indexOf(t.homeAccountId.toLowerCase())))},e.prototype.readAppMetadataFromCache=function(e){var t={environment:e,clientId:this.clientId},r=this.getAppMetadataFilteredBy(t),n=Object.keys(r).map((function(e){return r[e]})),o=n.length;if(o<1)return null;if(o>1)throw _t.createMultipleMatchingAppMetadataInCacheError();return n[0]},e.prototype.isAppMetadataFOCI=function(e){var t=this.readAppMetadataFromCache(e);return!(!t||"1"!==t.familyId)},e.prototype.matchHomeAccountId=function(e,t){return!("string"!=typeof e.homeAccountId||t!==e.homeAccountId)},e.prototype.matchLocalAccountId=function(e,t){return!("string"!=typeof e.localAccountId||t!==e.localAccountId)},e.prototype.matchUsername=function(e,t){return!("string"!=typeof e.username||t.toLowerCase()!==e.username.toLowerCase())},e.prototype.matchUserAssertionHash=function(e,t){return!(!e.userAssertionHash||t!==e.userAssertionHash)},e.prototype.matchEnvironment=function(e,t){var r=this.getAuthorityMetadataByAlias(t);return!!(r&&r.aliases.indexOf(e.environment)>-1)},e.prototype.matchCredentialType=function(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()},e.prototype.matchClientId=function(e,t){return!(!e.clientId||t!==e.clientId)},e.prototype.matchFamilyId=function(e,t){return!(!e.familyId||t!==e.familyId)},e.prototype.matchRealm=function(e,t){return!(!e.realm||t!==e.realm)},e.prototype.matchNativeAccountId=function(e,t){return!(!e.nativeAccountId||t!==e.nativeAccountId)},e.prototype.matchTarget=function(e,t){return!(e.credentialType!==_e.ACCESS_TOKEN&&e.credentialType!==_e.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)&&Jt.fromString(e.target).containsScopeSet(t)},e.prototype.matchTokenType=function(e,t){return!(!e.tokenType||e.tokenType!==t)},e.prototype.matchKeyId=function(e,t){return!(!e.keyId||e.keyId!==t)},e.prototype.isAppMetadata=function(e){return-1!==e.indexOf("appmetadata")},e.prototype.isAuthorityMetadata=function(e){return-1!==e.indexOf(be)},e.prototype.generateAuthorityMetadataCacheKey=function(e){return be+"-"+this.clientId+"-"+e},e.toObject=function(e,t){for(var r in t)e[r]=t[r];return e},e}(),nr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ne(t,e),t.prototype.setAccount=function(){throw Ze.createUnexpectedError("Storage interface - setAccount() has not been implemented for the cacheStorage interface.")},t.prototype.getAccount=function(){throw Ze.createUnexpectedError("Storage interface - getAccount() has not been implemented for the cacheStorage interface.")},t.prototype.setIdTokenCredential=function(){throw Ze.createUnexpectedError("Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getIdTokenCredential=function(){throw Ze.createUnexpectedError("Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setAccessTokenCredential=function(){throw Ze.createUnexpectedError("Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getAccessTokenCredential=function(){throw Ze.createUnexpectedError("Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setRefreshTokenCredential=function(){throw Ze.createUnexpectedError("Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getRefreshTokenCredential=function(){throw Ze.createUnexpectedError("Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setAppMetadata=function(){throw Ze.createUnexpectedError("Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAppMetadata=function(){throw Ze.createUnexpectedError("Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.setServerTelemetry=function(){throw Ze.createUnexpectedError("Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.")},t.prototype.getServerTelemetry=function(){throw Ze.createUnexpectedError("Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.")},t.prototype.setAuthorityMetadata=function(){throw Ze.createUnexpectedError("Storage interface - setAuthorityMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAuthorityMetadata=function(){throw Ze.createUnexpectedError("Storage interface - getAuthorityMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAuthorityMetadataKeys=function(){throw Ze.createUnexpectedError("Storage interface - getAuthorityMetadataKeys() has not been implemented for the cacheStorage interface.")},t.prototype.setThrottlingCache=function(){throw Ze.createUnexpectedError("Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.")},t.prototype.getThrottlingCache=function(){throw Ze.createUnexpectedError("Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.")},t.prototype.removeItem=function(){throw Ze.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},t.prototype.containsKey=function(){throw Ze.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},t.prototype.getKeys=function(){throw Ze.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},t.prototype.getAccountKeys=function(){throw Ze.createUnexpectedError("Storage interface - getAccountKeys() has not been implemented for the cacheStorage interface.")},t.prototype.getTokenKeys=function(){throw Ze.createUnexpectedError("Storage interface - getTokenKeys() has not been implemented for the cacheStorage interface.")},t.prototype.clear=function(){return ie(this,void 0,void 0,(function(){return ae(this,(function(e){throw"Storage interface - clear() has not been implemented for the cacheStorage interface.",Ze.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")}))}))},t.prototype.updateCredentialCacheKey=function(){throw Ze.createUnexpectedError("Storage interface - updateCredentialCacheKey() has not been implemented for the cacheStorage interface.")},t}(rr),or=function(){function e(){}return e.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},e.isTokenExpired=function(t,r){var n=Number(t)||0;return e.nowSeconds()+r>n},e.wasClockTurnedBack=function(t){return Number(t)>e.nowSeconds()},e.delay=function(e,t){return new Promise((function(r){return setTimeout((function(){return r(t)}),e)}))},e}(),ir=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ne(t,e),t.createAccessTokenEntity=function(e,r,n,o,i,a,s,c,u,l,d,h,p,f,g){var m,v,y=new t;y.homeAccountId=e,y.credentialType=_e.ACCESS_TOKEN,y.secret=n;var C=or.nowSeconds();if(y.cachedAt=C.toString(),y.expiresOn=s.toString(),y.extendedExpiresOn=c.toString(),l&&(y.refreshOn=l.toString()),y.environment=r,y.clientId=o,y.realm=i,y.target=a,y.userAssertionHash=h,y.tokenType=It.isEmpty(d)?Ae.BEARER:d,f&&(y.requestedClaims=f,y.requestedClaimsHash=g),(null===(m=y.tokenType)||void 0===m?void 0:m.toLowerCase())!==Ae.BEARER.toLowerCase())switch(y.credentialType=_e.ACCESS_TOKEN_WITH_AUTH_SCHEME,y.tokenType){case Ae.POP:var T=tr.extractTokenClaims(n,u);if(!(null===(v=null==T?void 0:T.cnf)||void 0===v?void 0:v.kid))throw _t.createTokenClaimsRequiredError();y.keyId=T.cnf.kid;break;case Ae.SSH:y.keyId=p}return y},t.isAccessTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.hasOwnProperty("target")&&(e.credentialType===_e.ACCESS_TOKEN||e.credentialType===_e.ACCESS_TOKEN_WITH_AUTH_SCHEME))},t}(jt),ar=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ne(t,e),t.createRefreshTokenEntity=function(e,r,n,o,i,a){var s=new t;return s.clientId=o,s.credentialType=_e.REFRESH_TOKEN,s.environment=r,s.homeAccountId=e,s.secret=n,s.userAssertionHash=a,i&&(s.familyId=i),s},t.isRefreshTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===_e.REFRESH_TOKEN)},t}(jt),sr=function(){function e(){}return e.prototype.generateAppMetadataKey=function(){return e.generateAppMetadataCacheKey(this.environment,this.clientId)},e.generateAppMetadataCacheKey=function(e,t){return["appmetadata",e,t].join(Ee.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAppMetadataEntity=function(t,r,n){var o=new e;return o.clientId=t,o.environment=r,n&&(o.familyId=n),o},e.isAppMetadataEntity=function(e,t){return!!t&&(0===e.indexOf("appmetadata")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("environment"))},e}(),cr=function(){function e(){this.failedRequests=[],this.errors=[],this.cacheHits=0}return e.isServerTelemetryEntity=function(e,t){var r=0===e.indexOf(Re.CACHE_KEY),n=!0;return t&&(n=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),r&&n},e}(),ur=function(){function e(){this.expiresAt=or.nowSeconds()+ke}return e.prototype.updateCloudDiscoveryMetadata=function(e,t){this.aliases=e.aliases,this.preferred_cache=e.preferred_cache,this.preferred_network=e.preferred_network,this.aliasesFromNetwork=t},e.prototype.updateEndpointMetadata=function(e,t){this.authorization_endpoint=e.authorization_endpoint,this.token_endpoint=e.token_endpoint,this.end_session_endpoint=e.end_session_endpoint,this.issuer=e.issuer,this.endpointsFromNetwork=t,this.jwks_uri=e.jwks_uri},e.prototype.updateCanonicalAuthority=function(e){this.canonical_authority=e},e.prototype.resetExpiresAt=function(){this.expiresAt=or.nowSeconds()+ke},e.prototype.isExpired=function(){return this.expiresAt<=or.nowSeconds()},e.isAuthorityMetadataEntity=function(e,t){return!!t&&(0===e.indexOf(be)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri"))},e}(),lr=function(){function e(){}return e.isThrottlingEntity=function(e,t){var r=!1;e&&(r=0===e.indexOf(De));var n=!0;return t&&(n=t.hasOwnProperty("throttleTime")),r&&n},e}(),dr=function(){function e(){}return e.setRequestState=function(t,r,n){var o=e.generateLibraryState(t,n);return It.isEmpty(r)?o:""+o+pe.RESOURCE_DELIM+r},e.generateLibraryState=function(e,t){if(!e)throw _t.createNoCryptoObjectError("generateLibraryState");var r={id:e.createNewGuid()};t&&(r.meta=t);var n=JSON.stringify(r);return e.base64Encode(n)},e.parseRequestState=function(e,t){if(!e)throw _t.createNoCryptoObjectError("parseRequestState");if(It.isEmpty(t))throw _t.createInvalidStateError(t,"Null, undefined or empty state");try{var r=t.split(pe.RESOURCE_DELIM),n=r[0],o=r.length>1?r.slice(1).join(pe.RESOURCE_DELIM):pe.EMPTY_STRING,i=e.base64Decode(n),a=JSON.parse(i);return{userRequestState:It.isEmpty(o)?pe.EMPTY_STRING:o,libraryState:a}}catch(e){throw _t.createInvalidStateError(t,e)}},e}();
/*! @azure/msal-common v13.0.0 2023-05-01 */!function(e){e.HOME_ACCOUNT_ID="home_account_id",e.UPN="UPN"}($t||($t={}));
/*! @azure/msal-browser v2.37.0 2023-05-01 */
var hr,pr,fr=function(){function e(e){this.validateWindowStorage(e),this.windowStorage=window[e]}return e.prototype.validateWindowStorage=function(e){if(e!==Ge.LocalStorage&&e!==Ge.SessionStorage)throw Nt.createStorageNotSupportedError(e);if(!!!window[e])throw Nt.createStorageNotSupportedError(e)},e.prototype.getItem=function(e){return this.windowStorage.getItem(e)},e.prototype.setItem=function(e,t){this.windowStorage.setItem(e,t)},e.prototype.removeItem=function(e){this.windowStorage.removeItem(e)},e.prototype.getKeys=function(){return Object.keys(this.windowStorage)},e.prototype.containsKey=function(e){return this.windowStorage.hasOwnProperty(e)},e}(),gr=function(){function e(t){if(this._urlString=t,It.isEmpty(this._urlString))throw Vt.createUrlEmptyError();It.isEmpty(this.getHash())&&(this._urlString=e.canonicalizeUri(t))}return Object.defineProperty(e.prototype,"urlString",{get:function(){return this._urlString},enumerable:!1,configurable:!0}),e.canonicalizeUri=function(e){if(e){var t=e.toLowerCase();return It.endsWith(t,"?")?t=t.slice(0,-1):It.endsWith(t,"?/")&&(t=t.slice(0,-2)),It.endsWith(t,"/")||(t+="/"),t}return e},e.prototype.validateAsUri=function(){var e;try{e=this.getUrlComponents()}catch(e){throw Vt.createUrlParseError(e)}if(!e.HostNameAndPort||!e.PathSegments)throw Vt.createUrlParseError("Given url string: "+this.urlString);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw Vt.createInsecureAuthorityUriError(this.urlString)},e.appendQueryString=function(e,t){return It.isEmpty(t)?e:e.indexOf("?")<0?e+"?"+t:e+"&"+t},e.removeHashFromUrl=function(t){return e.canonicalizeUri(t.split("#")[0])},e.prototype.replaceTenantPath=function(t){var r=this.getUrlComponents(),n=r.PathSegments;return!t||0===n.length||n[0]!==le.COMMON&&n[0]!==le.ORGANIZATIONS||(n[0]=t),e.constructAuthorityUriFromObject(r)},e.prototype.getHash=function(){return e.parseHash(this.urlString)},e.prototype.getUrlComponents=function(){var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw Vt.createUrlParseError("Given url string: "+this.urlString);var r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},n=r.AbsolutePath.split("/");return n=n.filter((function(e){return e&&e.length>0})),r.PathSegments=n,!It.isEmpty(r.QueryString)&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r},e.getDomainFromUrl=function(e){var t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw Vt.createUrlParseError("Given url string: "+e);return r[2]},e.getAbsoluteUrl=function(t,r){if(t[0]===pe.FORWARD_SLASH){var n=new e(r).getUrlComponents();return n.Protocol+"//"+n.HostNameAndPort+t}return t},e.parseHash=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):pe.EMPTY_STRING},e.parseQueryString=function(e){var t=e.indexOf("?"),r=e.indexOf("/?");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):pe.EMPTY_STRING},e.constructAuthorityUriFromObject=function(t){return new e(t.Protocol+"//"+t.HostNameAndPort+"/"+t.PathSegments.join("/"))},e.getDeserializedHash=function(t){if(It.isEmpty(t))return{};var r=e.parseHash(t),n=It.queryStringToObject(It.isEmpty(r)?t:r);if(!n)throw _t.createHashNotDeserializedError(JSON.stringify(n));return n},e.getDeserializedQueryString=function(t){if(It.isEmpty(t))return{};var r=e.parseQueryString(t),n=It.queryStringToObject(It.isEmpty(r)?t:r);if(!n)throw _t.createHashNotDeserializedError(JSON.stringify(n));return n},e.hashContainsKnownProperties=function(t){if(It.isEmpty(t)||t.indexOf("=")<0)return!1;var r=e.getDeserializedHash(t);return!!(r.code||r.error_description||r.error||r.state)},e}(),mr=function(){function e(){}return e.extractBrowserRequestState=function(e,t){if(It.isEmpty(t))return null;try{return dr.parseRequestState(e,t).libraryState.meta}catch(e){throw _t.createInvalidStateError(t,e)}},e.parseServerResponseFromHash=function(e){if(!e)return{};var t=new gr(e);return gr.getDeserializedHash(t.getHash())},e}(),vr=function(e){function t(t,r,n,o){var i=e.call(this,t,n,o)||this;return i.COOKIE_LIFE_MULTIPLIER=864e5,i.cacheConfig=r,i.logger=o,i.internalStorage=new qt,i.browserStorage=i.setupBrowserStorage(i.cacheConfig.cacheLocation),i.temporaryCacheStorage=i.setupTemporaryCacheStorage(i.cacheConfig.temporaryCacheLocation,i.cacheConfig.cacheLocation),r.cacheMigrationEnabled&&(i.migrateCacheEntries(),i.createKeyMaps()),i}return j(t,e),t.prototype.setupBrowserStorage=function(e){switch(e){case Ge.LocalStorage:case Ge.SessionStorage:try{return new fr(e)}catch(e){this.logger.verbose(e);break}}return this.cacheConfig.cacheLocation=Ge.MemoryStorage,new qt},t.prototype.setupTemporaryCacheStorage=function(e,t){switch(t){case Ge.LocalStorage:case Ge.SessionStorage:try{return new fr(e||Ge.SessionStorage)}catch(e){return this.logger.verbose(e),this.internalStorage}case Ge.MemoryStorage:default:return this.internalStorage}},t.prototype.migrateCacheEntries=function(){var e=this,t=pe.CACHE_PREFIX+"."+ue.ID_TOKEN,r=pe.CACHE_PREFIX+"."+ue.CLIENT_INFO,n=pe.CACHE_PREFIX+"."+ue.ERROR,o=pe.CACHE_PREFIX+"."+ue.ERROR_DESC,i=[this.browserStorage.getItem(t),this.browserStorage.getItem(r),this.browserStorage.getItem(n),this.browserStorage.getItem(o)];[ue.ID_TOKEN,ue.CLIENT_INFO,ue.ERROR,ue.ERROR_DESC].forEach((function(t,r){return e.migrateCacheEntry(t,i[r])}))},t.prototype.migrateCacheEntry=function(e,t){t&&this.setTemporaryCache(e,t,!0)},t.prototype.createKeyMaps=function(){var e=this;this.logger.trace("BrowserCacheManager - createKeyMaps called.");var t=this.getItem(je.ACCOUNT_KEYS),r=this.getItem(je.TOKEN_KEYS+"."+this.clientId);t&&r?this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration."):this.browserStorage.getKeys().forEach((function(t){var r;if(e.isCredentialKey(t)&&(r=e.getItem(t))){var n=e.validateAndParseJson(r);if(n&&n.hasOwnProperty("credentialType"))switch(n.credentialType){case _e.ID_TOKEN:if(Qt.isIdTokenEntity(n)){e.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),e.logger.tracePii("BrowserCacheManager:createKeyMaps - idToken with key: "+t+" found, saving key to token key map");var o=rr.toObject(new Qt,n),i=e.updateCredentialCacheKey(t,o);return void e.addTokenKey(i,_e.ID_TOKEN)}e.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),e.logger.tracePii("BrowserCacheManager:createKeyMaps - failed idToken validation on key: "+t);break;case _e.ACCESS_TOKEN:case _e.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(ir.isAccessTokenEntity(n)){e.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),e.logger.tracePii("BrowserCacheManager:createKeyMaps - accessToken with key: "+t+" found, saving key to token key map");var a=rr.toObject(new ir,n);i=e.updateCredentialCacheKey(t,a);return void e.addTokenKey(i,_e.ACCESS_TOKEN)}e.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),e.logger.tracePii("BrowserCacheManager:createKeyMaps - failed accessToken validation on key: "+t);break;case _e.REFRESH_TOKEN:if(ar.isRefreshTokenEntity(n)){e.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),e.logger.tracePii("BrowserCacheManager:createKeyMaps - refreshToken with key: "+t+" found, saving key to token key map");var s=rr.toObject(new ar,n);i=e.updateCredentialCacheKey(t,s);return void e.addTokenKey(i,_e.REFRESH_TOKEN)}e.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),e.logger.tracePii("BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: "+t)}}if(e.isAccountKey(t)&&(r=e.getItem(t))){var c=e.validateAndParseJson(r);c&&er.isAccountEntity(c)&&(e.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),e.logger.tracePii("BrowserCacheManager:createKeyMaps - account with key: "+t+" found, saving key to account key map"),e.addAccountKeyToMap(t))}}))},t.prototype.validateAndParseJson=function(e){try{var t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(e){return null}},t.prototype.getItem=function(e){return this.browserStorage.getItem(e)},t.prototype.setItem=function(e,t){this.browserStorage.setItem(e,t)},t.prototype.getAccount=function(e){this.logger.trace("BrowserCacheManager.getAccount called");var t=this.getItem(e);if(!t)return this.removeAccountKeyFromMap(e),null;var r=this.validateAndParseJson(t);return r&&er.isAccountEntity(r)?rr.toObject(new er,r):(this.removeAccountKeyFromMap(e),null)},t.prototype.setAccount=function(e){this.logger.trace("BrowserCacheManager.setAccount called");var t=e.generateAccountKey();this.setItem(t,JSON.stringify(e)),this.addAccountKeyToMap(t)},t.prototype.getAccountKeys=function(){this.logger.trace("BrowserCacheManager.getAccountKeys called");var e=this.getItem(je.ACCOUNT_KEYS);return e?JSON.parse(e):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])},t.prototype.addAccountKeyToMap=function(e){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii("BrowserCacheManager.addAccountKeyToMap called with key: "+e);var t=this.getAccountKeys();-1===t.indexOf(e)?(t.push(e),this.setItem(je.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")},t.prototype.removeAccountKeyFromMap=function(e){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii("BrowserCacheManager.removeAccountKeyFromMap called with key: "+e);var t=this.getAccountKeys(),r=t.indexOf(e);r>-1?(t.splice(r,1),this.setItem(je.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")},t.prototype.removeAccount=function(t){return X(this,void 0,void 0,(function(){return Z(this,(function(r){return e.prototype.removeAccount.call(this,t),this.removeAccountKeyFromMap(t),[2]}))}))},t.prototype.removeIdToken=function(t){e.prototype.removeIdToken.call(this,t),this.removeTokenKey(t,_e.ID_TOKEN)},t.prototype.removeAccessToken=function(t){return X(this,void 0,void 0,(function(){return Z(this,(function(r){return e.prototype.removeAccessToken.call(this,t),this.removeTokenKey(t,_e.ACCESS_TOKEN),[2]}))}))},t.prototype.removeRefreshToken=function(t){e.prototype.removeRefreshToken.call(this,t),this.removeTokenKey(t,_e.REFRESH_TOKEN)},t.prototype.getTokenKeys=function(){this.logger.trace("BrowserCacheManager.getTokenKeys called");var e=this.getItem(je.TOKEN_KEYS+"."+this.clientId);if(e){var t=this.validateAndParseJson(e);if(t&&t.hasOwnProperty("idToken")&&t.hasOwnProperty("accessToken")&&t.hasOwnProperty("refreshToken"))return t;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}},t.prototype.addTokenKey=function(e,t){this.logger.trace("BrowserCacheManager addTokenKey called");var r=this.getTokenKeys();switch(t){case _e.ID_TOKEN:-1===r.idToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),r.idToken.push(e));break;case _e.ACCESS_TOKEN:-1===r.accessToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),r.accessToken.push(e));break;case _e.REFRESH_TOKEN:-1===r.refreshToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),r.refreshToken.push(e));break;default:this.logger.error("BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: "+t),_t.createUnexpectedCredentialTypeError()}this.setItem(je.TOKEN_KEYS+"."+this.clientId,JSON.stringify(r))},t.prototype.removeTokenKey=function(e,t){this.logger.trace("BrowserCacheManager removeTokenKey called");var r=this.getTokenKeys();switch(t){case _e.ID_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: "+e+" from map");var n=r.idToken.indexOf(e);n>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),r.idToken.splice(n,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case _e.ACCESS_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: "+e+" from map");var o=r.accessToken.indexOf(e);o>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),r.accessToken.splice(o,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case _e.REFRESH_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: "+e+" from map");var i=r.refreshToken.indexOf(e);i>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),r.refreshToken.splice(i,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:this.logger.error("BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: "+t),_t.createUnexpectedCredentialTypeError()}this.setItem(je.TOKEN_KEYS+"."+this.clientId,JSON.stringify(r))},t.prototype.getIdTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,_e.ID_TOKEN),null;var r=this.validateAndParseJson(t);return r&&Qt.isIdTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),rr.toObject(new Qt,r)):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,_e.ID_TOKEN),null)},t.prototype.setIdTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,_e.ID_TOKEN)},t.prototype.getAccessTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,_e.ACCESS_TOKEN),null;var r=this.validateAndParseJson(t);return r&&ir.isAccessTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),rr.toObject(new ir,r)):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,_e.ACCESS_TOKEN),null)},t.prototype.setAccessTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,_e.ACCESS_TOKEN)},t.prototype.getRefreshTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,_e.REFRESH_TOKEN),null;var r=this.validateAndParseJson(t);return r&&ar.isRefreshTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),rr.toObject(new ar,r)):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,_e.REFRESH_TOKEN),null)},t.prototype.setRefreshTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,_e.REFRESH_TOKEN)},t.prototype.getAppMetadata=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&sr.isAppMetadataEntity(e,r)?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),rr.toObject(new sr,r)):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null)},t.prototype.setAppMetadata=function(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");var t=e.generateAppMetadataKey();this.setItem(t,JSON.stringify(e))},t.prototype.getServerTelemetry=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&cr.isServerTelemetryEntity(e,r)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),rr.toObject(new cr,r)):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)},t.prototype.setServerTelemetry=function(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t))},t.prototype.getAuthorityMetadata=function(e){var t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&ur.isAuthorityMetadataEntity(e,r)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),rr.toObject(new ur,r)):null},t.prototype.getAuthorityMetadataKeys=function(){var e=this;return this.internalStorage.getKeys().filter((function(t){return e.isAuthorityMetadata(t)}))},t.prototype.setWrapperMetadata=function(e,t){this.internalStorage.setItem(Qe.WRAPPER_SKU,e),this.internalStorage.setItem(Qe.WRAPPER_VER,t)},t.prototype.getWrapperMetadata=function(){return[this.internalStorage.getItem(Qe.WRAPPER_SKU)||pe.EMPTY_STRING,this.internalStorage.getItem(Qe.WRAPPER_VER)||pe.EMPTY_STRING]},t.prototype.setAuthorityMetadata=function(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))},t.prototype.getActiveAccount=function(){var e=this.generateCacheKey(ue.ACTIVE_ACCOUNT_FILTERS),t=this.getItem(e);if(!t){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");var r=this.generateCacheKey(ue.ACTIVE_ACCOUNT),n=this.getItem(r);if(!n)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;var o=this.getAccountInfoByFilter({localAccountId:n})[0]||null;return o?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(o),o):null}var i=this.validateAndParseJson(t);return i?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoByFilter({homeAccountId:i.homeAccountId,localAccountId:i.localAccountId})[0]||null):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)},t.prototype.setActiveAccount=function(e){var t=this.generateCacheKey(ue.ACTIVE_ACCOUNT_FILTERS),r=this.generateCacheKey(ue.ACTIVE_ACCOUNT);if(e){this.logger.verbose("setActiveAccount: Active account set");var n={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId};this.browserStorage.setItem(t,JSON.stringify(n)),this.browserStorage.setItem(r,e.localAccountId)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(t),this.browserStorage.removeItem(r)},t.prototype.getAccountInfoByFilter=function(e){var t=this.getAllAccounts();return this.logger.trace("BrowserCacheManager.getAccountInfoByFilter: total "+t.length+" accounts found"),t.filter((function(t){return(!e.username||e.username.toLowerCase()===t.username.toLowerCase())&&((!e.homeAccountId||e.homeAccountId===t.homeAccountId)&&((!e.localAccountId||e.localAccountId===t.localAccountId)&&((!e.tenantId||e.tenantId===t.tenantId)&&(!e.environment||e.environment===t.environment))))}))},t.prototype.getAccountInfoByHints=function(e,t){var r=this.getAllAccounts().filter((function(r){if(t){var n=r.idTokenClaims&&r.idTokenClaims.sid;return t===n}return!!e&&e===r.username}));if(1===r.length)return r[0];if(r.length>1)throw _t.createMultipleMatchingAccountsInCacheError();return null},t.prototype.getThrottlingCache=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&lr.isThrottlingEntity(e,r)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),rr.toObject(new lr,r)):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)},t.prototype.setThrottlingCache=function(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t))},t.prototype.getTemporaryCache=function(e,t){var r=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){var n=this.getItemCookie(r);if(n)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),n}var o=this.temporaryCacheStorage.getItem(r);if(!o){if(this.cacheConfig.cacheLocation===Ge.LocalStorage){var i=this.browserStorage.getItem(r);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),i}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),o},t.prototype.setTemporaryCache=function(e,t,r){var n=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(n,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(n,t))},t.prototype.removeItem=function(e){this.browserStorage.removeItem(e),this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(e))},t.prototype.containsKey=function(e){return this.browserStorage.containsKey(e)||this.temporaryCacheStorage.containsKey(e)},t.prototype.getKeys=function(){return ee(this.browserStorage.getKeys(),this.temporaryCacheStorage.getKeys())},t.prototype.clear=function(){return X(this,void 0,void 0,(function(){var e=this;return Z(this,(function(t){switch(t.label){case 0:return[4,this.removeAllAccounts()];case 1:return t.sent(),this.removeAppMetadata(),this.getKeys().forEach((function(t){!e.browserStorage.containsKey(t)&&!e.temporaryCacheStorage.containsKey(t)||-1===t.indexOf(pe.CACHE_PREFIX)&&-1===t.indexOf(e.clientId)||e.removeItem(t)})),this.internalStorage.clear(),[2]}}))}))},t.prototype.setItemCookie=function(e,t,r){var n=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;SameSite=Lax;";r&&(n+="expires="+this.getCookieExpirationTime(r)+";");this.cacheConfig.secureCookies&&(n+="Secure;"),document.cookie=n},t.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return decodeURIComponent(o.substring(t.length,o.length))}return pe.EMPTY_STRING},t.prototype.clearMsalCookies=function(){var e=this,t=pe.CACHE_PREFIX+"."+this.clientId;document.cookie.split(";").forEach((function(r){for(;" "===r.charAt(0);)r=r.substring(1);if(0===r.indexOf(t)){var n=r.split("=")[0];e.clearItemCookie(n)}}))},t.prototype.clearItemCookie=function(e){this.setItemCookie(e,pe.EMPTY_STRING,-1)},t.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+e*this.COOKIE_LIFE_MULTIPLIER).toUTCString()},t.prototype.getCache=function(){return this.browserStorage},t.prototype.setCache=function(){},t.prototype.generateCacheKey=function(e){return this.validateAndParseJson(e)?JSON.stringify(e):It.startsWith(e,pe.CACHE_PREFIX)||It.startsWith(e,ue.ADAL_ID_TOKEN)?e:pe.CACHE_PREFIX+"."+this.clientId+"."+e},t.prototype.generateAuthorityKey=function(e){var t=dr.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(We.AUTHORITY+"."+t)},t.prototype.generateNonceKey=function(e){var t=dr.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(We.NONCE_IDTOKEN+"."+t)},t.prototype.generateStateKey=function(e){var t=dr.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(We.REQUEST_STATE+"."+t)},t.prototype.getCachedAuthority=function(e){var t=this.generateStateKey(e),r=this.getTemporaryCache(t);if(!r)return null;var n=this.generateAuthorityKey(r);return this.getTemporaryCache(n)},t.prototype.updateCacheEntries=function(e,t,r,n,o){this.logger.trace("BrowserCacheManager.updateCacheEntries called");var i=this.generateStateKey(e);this.setTemporaryCache(i,e,!1);var a=this.generateNonceKey(e);this.setTemporaryCache(a,t,!1);var s=this.generateAuthorityKey(e);if(this.setTemporaryCache(s,r,!1),o){var c={credential:o.homeAccountId,type:$t.HOME_ACCOUNT_ID};this.setTemporaryCache(We.CCS_CREDENTIAL,JSON.stringify(c),!0)}else if(!It.isEmpty(n)){c={credential:n,type:$t.UPN};this.setTemporaryCache(We.CCS_CREDENTIAL,JSON.stringify(c),!0)}},t.prototype.resetRequestCache=function(e){var t=this;this.logger.trace("BrowserCacheManager.resetRequestCache called"),It.isEmpty(e)||this.getKeys().forEach((function(r){-1!==r.indexOf(e)&&t.removeItem(r)})),e&&(this.removeItem(this.generateStateKey(e)),this.removeItem(this.generateNonceKey(e)),this.removeItem(this.generateAuthorityKey(e))),this.removeItem(this.generateCacheKey(We.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(We.ORIGIN_URI)),this.removeItem(this.generateCacheKey(We.URL_HASH)),this.removeItem(this.generateCacheKey(We.CORRELATION_ID)),this.removeItem(this.generateCacheKey(We.CCS_CREDENTIAL)),this.removeItem(this.generateCacheKey(We.NATIVE_REQUEST)),this.setInteractionInProgress(!1)},t.prototype.cleanRequestByState=function(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){var t=this.generateStateKey(e),r=this.temporaryCacheStorage.getItem(t);this.logger.infoPii("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: "+r),this.resetRequestCache(r||pe.EMPTY_STRING)}this.clearMsalCookies()},t.prototype.cleanRequestByInteractionType=function(e){var t=this;this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.getKeys().forEach((function(r){if(-1!==r.indexOf(We.REQUEST_STATE)){var n=t.temporaryCacheStorage.getItem(r);if(n){var o=mr.extractBrowserRequestState(t.cryptoImpl,n);o&&o.interactionType===e&&(t.logger.infoPii("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: "+n),t.resetRequestCache(n))}}})),this.clearMsalCookies(),this.setInteractionInProgress(!1)},t.prototype.cacheCodeRequest=function(e,t){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");var r=t.base64Encode(JSON.stringify(e));this.setTemporaryCache(We.REQUEST_PARAMS,r,!0)},t.prototype.getCachedRequest=function(e,t){this.logger.trace("BrowserCacheManager.getCachedRequest called");var r=this.getTemporaryCache(We.REQUEST_PARAMS,!0);if(!r)throw St.createNoTokenRequestCacheError();var n=this.validateAndParseJson(t.base64Decode(r));if(!n)throw St.createUnableToParseTokenRequestCacheError();if(this.removeItem(this.generateCacheKey(We.REQUEST_PARAMS)),It.isEmpty(n.authority)){var o=this.generateAuthorityKey(e),i=this.getTemporaryCache(o);if(!i)throw St.createNoCachedAuthorityError();n.authority=i}return n},t.prototype.getCachedNativeRequest=function(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");var e=this.getTemporaryCache(We.NATIVE_REQUEST,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;var t=this.validateAndParseJson(e);return t||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)},t.prototype.isInteractionInProgress=function(e){var t=this.getInteractionInProgress();return e?t===this.clientId:!!t},t.prototype.getInteractionInProgress=function(){var e=pe.CACHE_PREFIX+"."+We.INTERACTION_STATUS_KEY;return this.getTemporaryCache(e,!1)},t.prototype.setInteractionInProgress=function(e){var t=pe.CACHE_PREFIX+"."+We.INTERACTION_STATUS_KEY;if(e){if(this.getInteractionInProgress())throw St.createInteractionInProgressError();this.setTemporaryCache(t,this.clientId,!1)}else e||this.getInteractionInProgress()!==this.clientId||this.removeItem(t)},t.prototype.getLegacyLoginHint=function(){var e=this.getTemporaryCache(ue.ADAL_ID_TOKEN);e&&(this.browserStorage.removeItem(ue.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));var t=this.getTemporaryCache(ue.ID_TOKEN,!0);t&&(this.removeItem(this.generateCacheKey(ue.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));var r=t||e;if(r){var n=new tr(r,this.cryptoImpl);if(n.claims&&n.claims.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),n.claims.preferred_username;if(n.claims&&n.claims.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),n.claims.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null},t.prototype.updateCredentialCacheKey=function(e,t){var r=t.generateCredentialKey();if(e!==r){var n=this.getItem(e);if(n)return this.removeItem(e),this.setItem(r,n),this.logger.verbose("Updated an outdated "+t.credentialType+" cache key"),r;this.logger.error("Attempted to update an outdated "+t.credentialType+" cache key but no item matching the outdated key was found in storage")}return e},t.prototype.getRedirectRequestContext=function(){return this.getTemporaryCache(We.REDIRECT_CONTEXT,!0)},t.prototype.setRedirectRequestContext=function(e){this.setTemporaryCache(We.REDIRECT_CONTEXT,e,!0)},t}(rr);
/*! @azure/msal-common v13.0.0 2023-05-01 */!function(e){e.AAD="AAD",e.OIDC="OIDC"}(hr||(hr={})),function(e){e[e.None=0]="None",e.AzurePublic="https://login.microsoftonline.com",e.AzurePpe="https://login.windows-ppe.net",e.AzureChina="https://login.chinacloudapi.cn",e.AzureGermany="https://login.microsoftonline.de",e.AzureUsGovernment="https://login.microsoftonline.us"}(pr||(pr={}));
/*! @azure/msal-common v13.0.0 2023-05-01 */
var yr={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},Cr={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:Ht.Info,correlationId:pe.EMPTY_STRING},Tr={sendGetRequestAsync:function(){return ie(this,void 0,void 0,(function(){return ae(this,(function(e){throw"Network interface - sendGetRequestAsync() has not been implemented",Ze.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")}))}))},sendPostRequestAsync:function(){return ie(this,void 0,void 0,(function(){return ae(this,(function(e){throw"Network interface - sendPostRequestAsync() has not been implemented",Ze.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")}))}))}},Er={sku:pe.SKU,version:"13.0.0",cpu:pe.EMPTY_STRING,os:pe.EMPTY_STRING},_r={clientSecret:pe.EMPTY_STRING,clientAssertion:void 0},Ir={azureCloudInstance:pr.None,tenant:""+pe.DEFAULT_COMMON_TENANT},wr={application:{appName:"",appVersion:""}};
/*! @azure/msal-common v13.0.0 2023-05-01 */
var Sr={sendGetRequestAsync:function(){return Promise.reject(Ze.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented for the Network interface."))},sendPostRequestAsync:function(){return Promise.reject(Ze.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented for the Network interface."))}},br=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return X(this,void 0,void 0,(function(){var r,n,o;return Z(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,fetch(e,{method:ze.GET,headers:this.getFetchHeaders(t)})];case 1:return r=i.sent(),[3,3];case 2:throw n=i.sent(),window.navigator.onLine?St.createGetRequestFailedError(n,e):St.createNoNetworkConnectivityError();case 3:return i.trys.push([3,5,,6]),o={headers:this.getHeaderDict(r.headers)},[4,r.json()];case 4:return[2,(o.body=i.sent(),o.status=r.status,o)];case 5:throw i.sent(),St.createFailedToParseNetworkResponseError(e);case 6:return[2]}}))}))},e.prototype.sendPostRequestAsync=function(e,t){return X(this,void 0,void 0,(function(){var r,n,o,i;return Z(this,(function(a){switch(a.label){case 0:r=t&&t.body||pe.EMPTY_STRING,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,fetch(e,{method:ze.POST,headers:this.getFetchHeaders(t),body:r})];case 2:return n=a.sent(),[3,4];case 3:throw o=a.sent(),window.navigator.onLine?St.createPostRequestFailedError(o,e):St.createNoNetworkConnectivityError();case 4:return a.trys.push([4,6,,7]),i={headers:this.getHeaderDict(n.headers)},[4,n.json()];case 5:return[2,(i.body=a.sent(),i.status=n.status,i)];case 6:throw a.sent(),St.createFailedToParseNetworkResponseError(e);case 7:return[2]}}))}))},e.prototype.getFetchHeaders=function(e){var t=new Headers;if(!e||!e.headers)return t;var r=e.headers;return Object.keys(r).forEach((function(e){t.append(e,r[e])})),t},e.prototype.getHeaderDict=function(e){var t={};return e.forEach((function(e,r){t[r]=e})),t},e}(),kr=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return X(this,void 0,void 0,(function(){return Z(this,(function(r){return[2,this.sendRequestAsync(e,ze.GET,t)]}))}))},e.prototype.sendPostRequestAsync=function(e,t){return X(this,void 0,void 0,(function(){return Z(this,(function(r){return[2,this.sendRequestAsync(e,ze.POST,t)]}))}))},e.prototype.sendRequestAsync=function(e,t,r){var n=this;return new Promise((function(o,i){var a=new XMLHttpRequest;if(a.open(t,e,!0),n.setXhrHeaders(a,r),a.onload=function(){(a.status<200||a.status>=300)&&(t===ze.POST?i(St.createPostRequestFailedError("Failed with status "+a.status,e)):i(St.createGetRequestFailedError("Failed with status "+a.status,e)));try{var r=JSON.parse(a.responseText),s={headers:n.getHeaderDict(a),body:r,status:a.status};o(s)}catch(t){i(St.createFailedToParseNetworkResponseError(e))}},a.onerror=function(){window.navigator.onLine?t===ze.POST?i(St.createPostRequestFailedError("Failed with status "+a.status,e)):i(St.createGetRequestFailedError("Failed with status "+a.status,e)):i(St.createNoNetworkConnectivityError())},t===ze.POST&&r&&r.body)a.send(r.body);else{if(t!==ze.GET)throw St.createHttpMethodNotImplementedError(t);a.send()}}))},e.prototype.setXhrHeaders=function(e,t){if(t&&t.headers){var r=t.headers;Object.keys(r).forEach((function(t){e.setRequestHeader(t,r[t])}))}},e.prototype.getHeaderDict=function(e){var t=e.getAllResponseHeaders().trim().split(/[\r\n]+/),r={};return t.forEach((function(e){var t=e.split(": "),n=t.shift(),o=t.join(": ");n&&o&&(r[n]=o)})),r},e}(),Ar=function(){function e(){}return e.clearHash=function(e){e.location.hash=pe.EMPTY_STRING,"function"==typeof e.history.replaceState&&e.history.replaceState(null,pe.EMPTY_STRING,""+e.location.origin+e.location.pathname+e.location.search)},e.replaceHash=function(e){var t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):pe.EMPTY_STRING},e.isInIframe=function(){return window.parent!==window},e.isInPopup=function(){return"undefined"!=typeof window&&!!window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf(ot.POPUP_NAME_PREFIX+".")},e.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},e.getHomepage=function(){var e=new gr(window.location.href).getUrlComponents();return e.Protocol+"//"+e.HostNameAndPort+"/"},e.getBrowserNetworkClient=function(){return window.fetch&&window.Headers?new br:new kr},e.blockReloadInHiddenIframes=function(){if(gr.hashContainsKnownProperties(window.location.hash)&&e.isInIframe())throw St.createBlockReloadInHiddenIframeError()},e.blockRedirectInIframe=function(t,r){var n=e.isInIframe();if(t===Ve.Redirect&&n&&!r)throw St.createRedirectInIframeError(n)},e.blockAcquireTokenInPopups=function(){if(e.isInPopup())throw St.createBlockAcquireTokenInPopupsError()},e.blockNonBrowserEnvironment=function(e){if(!e)throw St.createNonBrowserEnvironmentError()},e.blockNativeBrokerCalledBeforeInitialized=function(e,t){if(e&&!t)throw St.createNativeBrokerCalledBeforeInitialize()},e.detectIEOrEdge=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),r=e.indexOf("Trident/"),n=e.indexOf("Edge/");return t>0||r>0||n>0},e}(),Rr=function(){function e(){}return e.prototype.navigateInternal=function(t,r){return e.defaultNavigateWindow(t,r)},e.prototype.navigateExternal=function(t,r){return e.defaultNavigateWindow(t,r)},e.defaultNavigateWindow=function(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise((function(e){setTimeout((function(){e(!0)}),t.timeout)}))},e}(),Pr=6e3;
/*! @azure/msal-browser v2.37.0 2023-05-01 */
/*! @azure/msal-browser v2.37.0 2023-05-01 */
var Nr;!function(e){e.INITIALIZE_START="msal:initializeStart",e.INITIALIZE_END="msal:initializeEnd",e.ACCOUNT_ADDED="msal:accountAdded",e.ACCOUNT_REMOVED="msal:accountRemoved",e.LOGIN_START="msal:loginStart",e.LOGIN_SUCCESS="msal:loginSuccess",e.LOGIN_FAILURE="msal:loginFailure",e.ACQUIRE_TOKEN_START="msal:acquireTokenStart",e.ACQUIRE_TOKEN_SUCCESS="msal:acquireTokenSuccess",e.ACQUIRE_TOKEN_FAILURE="msal:acquireTokenFailure",e.ACQUIRE_TOKEN_NETWORK_START="msal:acquireTokenFromNetworkStart",e.SSO_SILENT_START="msal:ssoSilentStart",e.SSO_SILENT_SUCCESS="msal:ssoSilentSuccess",e.SSO_SILENT_FAILURE="msal:ssoSilentFailure",e.ACQUIRE_TOKEN_BY_CODE_START="msal:acquireTokenByCodeStart",e.ACQUIRE_TOKEN_BY_CODE_SUCCESS="msal:acquireTokenByCodeSuccess",e.ACQUIRE_TOKEN_BY_CODE_FAILURE="msal:acquireTokenByCodeFailure",e.HANDLE_REDIRECT_START="msal:handleRedirectStart",e.HANDLE_REDIRECT_END="msal:handleRedirectEnd",e.POPUP_OPENED="msal:popupOpened",e.LOGOUT_START="msal:logoutStart",e.LOGOUT_SUCCESS="msal:logoutSuccess",e.LOGOUT_FAILURE="msal:logoutFailure",e.LOGOUT_END="msal:logoutEnd"}(Nr||(Nr={}));
/*! @azure/msal-browser v2.37.0 2023-05-01 */
var Mr,Or=function(){function e(e,t){this.eventCallbacks=new Map,this.logger=e,this.browserCrypto=t,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}return e.prototype.addEventCallback=function(e){if("undefined"!=typeof window){var t=this.browserCrypto.createNewGuid();return this.eventCallbacks.set(t,e),this.logger.verbose("Event callback registered with id: "+t),t}return null},e.prototype.removeEventCallback=function(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback "+e+" removed.")},e.prototype.enableAccountStorageEvents=function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))},e.prototype.disableAccountStorageEvents=function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))},e.prototype.emitEvent=function(e,t,r,n){var o=this;if("undefined"!=typeof window){var i={eventType:e,interactionType:t||null,payload:r||null,error:n||null,timestamp:Date.now()};this.logger.info("Emitting event: "+e),this.eventCallbacks.forEach((function(t,r){o.logger.verbose("Emitting event to callback "+r+": "+e),t.apply(null,[i])}))}},e.prototype.handleAccountCacheChange=function(e){try{var t=e.newValue||e.oldValue;if(!t)return;var r=JSON.parse(t);if("object"!=typeof r||!er.isAccountEntity(r))return;var n=rr.toObject(new er,r).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent(Nr.ACCOUNT_ADDED,void 0,n)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent(Nr.ACCOUNT_REMOVED,void 0,n))}catch(e){return}},e}(),Ur=function(){function e(){}return e.generateThrottlingStorageKey=function(e){return De+"."+JSON.stringify(e)},e.preProcess=function(t,r){var n,o=e.generateThrottlingStorageKey(r),i=t.getThrottlingCache(o);if(i){if(i.throttleTime<Date.now())return void t.removeItem(o);throw new $e((null===(n=i.errorCodes)||void 0===n?void 0:n.join(" "))||pe.EMPTY_STRING,i.errorMessage,i.subError)}},e.postProcess=function(t,r,n){if(e.checkResponseStatus(n)||e.checkResponseForRetryAfter(n)){var o={throttleTime:e.calculateThrottleTime(parseInt(n.headers[ce.RETRY_AFTER])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};t.setThrottlingCache(e.generateThrottlingStorageKey(r),o)}},e.checkResponseStatus=function(e){return 429===e.status||e.status>=500&&e.status<600},e.checkResponseForRetryAfter=function(e){return!!e.headers&&(e.headers.hasOwnProperty(ce.RETRY_AFTER)&&(e.status<200||e.status>=300))},e.calculateThrottleTime=function(e){var t=e<=0?0:e,r=Date.now()/1e3;return Math.floor(1e3*Math.min(r+(t||Le),r+He))},e.removeThrottle=function(e,t,r,n){var o={clientId:t,authority:r.authority,scopes:r.scopes,homeAccountIdentifier:n,claims:r.claims,authenticationScheme:r.authenticationScheme,resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,sshKid:r.sshKid},i=this.generateThrottlingStorageKey(o);e.removeItem(i)},e}(),qr=function(){function e(e,t){this.networkClient=e,this.cacheManager=t}return e.prototype.sendPostRequest=function(e,t,r){return ie(this,void 0,void 0,(function(){var n,o;return ae(this,(function(i){switch(i.label){case 0:Ur.preProcess(this.cacheManager,e),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.networkClient.sendPostRequestAsync(t,r)];case 2:return n=i.sent(),[3,4];case 3:throw(o=i.sent())instanceof Ze?o:_t.createNetworkError(t,o);case 4:return Ur.postProcess(this.cacheManager,e,n),[2,n]}}))}))},e}(),Lr=function(){function e(){}return e.validateRedirectUri=function(e){if(It.isEmpty(e))throw Vt.createRedirectUriEmptyError()},e.validatePrompt=function(e){var t=[];for(var r in ve)t.push(ve[r]);if(t.indexOf(e)<0)throw Vt.createInvalidPromptError(e)},e.validateClaims=function(e){try{JSON.parse(e)}catch(e){throw Vt.createInvalidClaimsRequestError()}},e.validateCodeChallengeParams=function(e,t){if(It.isEmpty(e)||It.isEmpty(t))throw Vt.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)},e.validateCodeChallengeMethod=function(e){if([we.PLAIN,we.S256].indexOf(e)<0)throw Vt.createInvalidCodeChallengeMethodError()},e.sanitizeEQParams=function(e,t){return e?(t.forEach((function(t,r){e[r]&&delete e[r]})),Object.fromEntries(Object.entries(e).filter((function(e){return""!==e[1]})))):{}},e}(),Hr=function(){function e(){this.parameters=new Map}return e.prototype.addResponseTypeCode=function(){this.parameters.set(de.RESPONSE_TYPE,encodeURIComponent(pe.CODE_RESPONSE_TYPE))},e.prototype.addResponseTypeForTokenAndIdToken=function(){this.parameters.set(de.RESPONSE_TYPE,encodeURIComponent(pe.TOKEN_RESPONSE_TYPE+" "+pe.ID_TOKEN_RESPONSE_TYPE))},e.prototype.addResponseMode=function(e){this.parameters.set(de.RESPONSE_MODE,encodeURIComponent(e||ye.QUERY))},e.prototype.addNativeBroker=function(){this.parameters.set(de.NATIVE_BROKER,encodeURIComponent("1"))},e.prototype.addScopes=function(e,t){void 0===t&&(t=!0);var r=t?se(e||[],fe):e||[],n=new Jt(r);this.parameters.set(de.SCOPE,encodeURIComponent(n.printScopes()))},e.prototype.addClientId=function(e){this.parameters.set(de.CLIENT_ID,encodeURIComponent(e))},e.prototype.addRedirectUri=function(e){Lr.validateRedirectUri(e),this.parameters.set(de.REDIRECT_URI,encodeURIComponent(e))},e.prototype.addPostLogoutRedirectUri=function(e){Lr.validateRedirectUri(e),this.parameters.set(de.POST_LOGOUT_URI,encodeURIComponent(e))},e.prototype.addIdTokenHint=function(e){this.parameters.set(de.ID_TOKEN_HINT,encodeURIComponent(e))},e.prototype.addDomainHint=function(e){this.parameters.set(me.DOMAIN_HINT,encodeURIComponent(e))},e.prototype.addLoginHint=function(e){this.parameters.set(me.LOGIN_HINT,encodeURIComponent(e))},e.prototype.addCcsUpn=function(e){this.parameters.set(ce.CCS_HEADER,encodeURIComponent("UPN:"+e))},e.prototype.addCcsOid=function(e){this.parameters.set(ce.CCS_HEADER,encodeURIComponent("Oid:"+e.uid+"@"+e.utid))},e.prototype.addSid=function(e){this.parameters.set(me.SID,encodeURIComponent(e))},e.prototype.addClaims=function(e,t){var r=this.addClientCapabilitiesToClaims(e,t);Lr.validateClaims(r),this.parameters.set(de.CLAIMS,encodeURIComponent(r))},e.prototype.addCorrelationId=function(e){this.parameters.set(de.CLIENT_REQUEST_ID,encodeURIComponent(e))},e.prototype.addLibraryInfo=function(e){this.parameters.set(de.X_CLIENT_SKU,e.sku),this.parameters.set(de.X_CLIENT_VER,e.version),e.os&&this.parameters.set(de.X_CLIENT_OS,e.os),e.cpu&&this.parameters.set(de.X_CLIENT_CPU,e.cpu)},e.prototype.addApplicationTelemetry=function(e){(null==e?void 0:e.appName)&&this.parameters.set(de.X_APP_NAME,e.appName),(null==e?void 0:e.appVersion)&&this.parameters.set(de.X_APP_VER,e.appVersion)},e.prototype.addPrompt=function(e){Lr.validatePrompt(e),this.parameters.set(""+de.PROMPT,encodeURIComponent(e))},e.prototype.addState=function(e){It.isEmpty(e)||this.parameters.set(de.STATE,encodeURIComponent(e))},e.prototype.addNonce=function(e){this.parameters.set(de.NONCE,encodeURIComponent(e))},e.prototype.addCodeChallengeParams=function(e,t){if(Lr.validateCodeChallengeParams(e,t),!e||!t)throw Vt.createInvalidCodeChallengeParamsError();this.parameters.set(de.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(de.CODE_CHALLENGE_METHOD,encodeURIComponent(t))},e.prototype.addAuthorizationCode=function(e){this.parameters.set(de.CODE,encodeURIComponent(e))},e.prototype.addDeviceCode=function(e){this.parameters.set(de.DEVICE_CODE,encodeURIComponent(e))},e.prototype.addRefreshToken=function(e){this.parameters.set(de.REFRESH_TOKEN,encodeURIComponent(e))},e.prototype.addCodeVerifier=function(e){this.parameters.set(de.CODE_VERIFIER,encodeURIComponent(e))},e.prototype.addClientSecret=function(e){this.parameters.set(de.CLIENT_SECRET,encodeURIComponent(e))},e.prototype.addClientAssertion=function(e){It.isEmpty(e)||this.parameters.set(de.CLIENT_ASSERTION,encodeURIComponent(e))},e.prototype.addClientAssertionType=function(e){It.isEmpty(e)||this.parameters.set(de.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))},e.prototype.addOboAssertion=function(e){this.parameters.set(de.OBO_ASSERTION,encodeURIComponent(e))},e.prototype.addRequestTokenUse=function(e){this.parameters.set(de.REQUESTED_TOKEN_USE,encodeURIComponent(e))},e.prototype.addGrantType=function(e){this.parameters.set(de.GRANT_TYPE,encodeURIComponent(e))},e.prototype.addClientInfo=function(){this.parameters.set("client_info","1")},e.prototype.addExtraQueryParameters=function(e){var t=this,r=Lr.sanitizeEQParams(e,this.parameters);Object.keys(r).forEach((function(r){t.parameters.set(r,e[r])}))},e.prototype.addClientCapabilitiesToClaims=function(e,t){var r;if(e)try{r=JSON.parse(e)}catch(e){throw Vt.createInvalidClaimsRequestError()}else r={};return t&&t.length>0&&(r.hasOwnProperty(he.ACCESS_TOKEN)||(r[he.ACCESS_TOKEN]={}),r[he.ACCESS_TOKEN][he.XMS_CC]={values:t}),JSON.stringify(r)},e.prototype.addUsername=function(e){this.parameters.set(Pe.username,encodeURIComponent(e))},e.prototype.addPassword=function(e){this.parameters.set(Pe.password,encodeURIComponent(e))},e.prototype.addPopToken=function(e){It.isEmpty(e)||(this.parameters.set(de.TOKEN_TYPE,Ae.POP),this.parameters.set(de.REQ_CNF,encodeURIComponent(e)))},e.prototype.addSshJwk=function(e){It.isEmpty(e)||(this.parameters.set(de.TOKEN_TYPE,Ae.SSH),this.parameters.set(de.REQ_CNF,encodeURIComponent(e)))},e.prototype.addServerTelemetry=function(e){this.parameters.set(de.X_CLIENT_CURR_TELEM,e.generateCurrentRequestHeaderValue()),this.parameters.set(de.X_CLIENT_LAST_TELEM,e.generateLastRequestHeaderValue())},e.prototype.addThrottling=function(){this.parameters.set(de.X_MS_LIB_CAPABILITY,xe)},e.prototype.addLogoutHint=function(e){this.parameters.set(de.LOGOUT_HINT,encodeURIComponent(e))},e.prototype.createQueryString=function(){var e=new Array;return this.parameters.forEach((function(t,r){e.push(r+"="+t)})),e.join("&")},e}(),Dr=function(){function e(e,t){var r,n,o,i,a,s,c,u,l,d,h,p,f,g,m;this.config=(o=(r=e).authOptions,i=r.systemOptions,a=r.loggerOptions,s=r.storageInterface,c=r.networkInterface,u=r.cryptoInterface,l=r.clientCredentials,d=r.libraryInfo,h=r.telemetry,p=r.serverTelemetryManager,f=r.persistencePlugin,g=r.serializableCache,m=oe(oe({},Cr),a),{authOptions:(n=o,oe({clientCapabilities:[],azureCloudOptions:Ir,skipAuthorityMetadataCache:!1},n)),systemOptions:oe(oe({},yr),i),loggerOptions:m,storageInterface:s||new nr(o.clientId,Wt,new Ft(m)),networkInterface:c||Tr,cryptoInterface:u||Wt,clientCredentials:l||_r,libraryInfo:oe(oe({},Er),d),telemetry:oe(oe({},wr),h),serverTelemetryManager:p||null,persistencePlugin:f||null,serializableCache:g||null}),this.logger=new Ft(this.config.loggerOptions,"@azure/msal-common","13.0.0"),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new qr(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}return e.prototype.createTokenRequestHeaders=function(e){var t={};if(t[ce.CONTENT_TYPE]=pe.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case $t.HOME_ACCOUNT_ID:try{var r=Zt(e.credential);t[ce.CCS_HEADER]="Oid:"+r.uid+"@"+r.utid}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case $t.UPN:t[ce.CCS_HEADER]="UPN: "+e.credential}return t},e.prototype.executePostToTokenEndpoint=function(e,t,r,n){return ie(this,void 0,void 0,(function(){var o;return ae(this,(function(i){switch(i.label){case 0:return[4,this.networkManager.sendPostRequest(n,e,{body:t,headers:r})];case 1:return o=i.sent(),this.config.serverTelemetryManager&&o.status<500&&429!==o.status&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,o]}}))}))},e.prototype.updateAuthority=function(e){if(!e.discoveryComplete())throw _t.createEndpointDiscoveryIncompleteError("Updated authority has not completed endpoint discovery.");this.authority=e},e.prototype.createTokenQueryParameters=function(e){var t=new Hr;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()},e}(),xr=function(e,t,r,n,o){this.account=e||null,this.idToken=t||null,this.accessToken=r||null,this.refreshToken=n||null,this.appMetadata=o||null};
/*! @azure/msal-common v13.0.0 2023-05-01 */!function(e){e.SW="sw",e.UHW="uhw"}(Mr||(Mr={}));var Br=function(){function e(e,t){this.cryptoUtils=e,this.performanceClient=t}return e.prototype.generateCnf=function(e){var t,r;return ie(this,void 0,void 0,(function(){var n,o,i;return ae(this,(function(a){switch(a.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Q.PopTokenGenerateCnf,e.correlationId),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(Q.PopTokenGenerateKid,e.correlationId),[4,this.generateKid(e)];case 1:return n=a.sent(),o=this.cryptoUtils.base64Encode(JSON.stringify(n)),i={kid:n.kid,reqCnfString:o},[4,this.cryptoUtils.hashString(o)];case 2:return[2,(i.reqCnfHash=a.sent(),i)]}}))}))},e.prototype.generateKid=function(e){var t;return ie(this,void 0,void 0,(function(){return ae(this,(function(r){switch(r.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Q.PopTokenGenerateKid,e.correlationId),[4,this.cryptoUtils.getPublicKeyThumbprint(e)];case 1:return[2,{kid:r.sent(),xms_ksl:Mr.SW}]}}))}))},e.prototype.signPopToken=function(e,t,r){return ie(this,void 0,void 0,(function(){return ae(this,(function(n){return[2,this.signPayload(e,t,r)]}))}))},e.prototype.signPayload=function(e,t,r,n){return ie(this,void 0,void 0,(function(){var o,i,a,s,c,u;return ae(this,(function(l){switch(l.label){case 0:return o=r.resourceRequestMethod,i=r.resourceRequestUri,a=r.shrClaims,s=r.shrNonce,c=i?new gr(i):void 0,u=null==c?void 0:c.getUrlComponents(),[4,this.cryptoUtils.signJwt(oe({at:e,ts:or.nowSeconds(),m:null==o?void 0:o.toUpperCase(),u:null==u?void 0:u.HostNameAndPort,nonce:s||this.cryptoUtils.createNewGuid(),p:null==u?void 0:u.AbsolutePath,q:(null==u?void 0:u.QueryString)?[[],u.QueryString]:void 0,client_claims:a||void 0},n),t,r.correlationId)];case 1:return[2,l.sent()]}}))}))},e}(),Fr=function(){function e(e,t){this.cache=e,this.hasChanged=t}return Object.defineProperty(e.prototype,"cacheHasChanged",{get:function(){return this.hasChanged},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenCache",{get:function(){return this.cache},enumerable:!1,configurable:!0}),e}(),Kr=function(){function e(e,t,r,n,o,i,a){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=n,this.serializableCache=o,this.persistencePlugin=i,this.performanceClient=a}return e.prototype.validateServerAuthorizationCodeResponse=function(e,t,r){if(!e.state||!t)throw e.state?_t.createStateNotFoundError("Cached State"):_t.createStateNotFoundError("Server State");if(decodeURIComponent(e.state)!==decodeURIComponent(t))throw _t.createStateMismatchError();if(e.error||e.error_description||e.suberror){if(nt.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new nt(e.error||pe.EMPTY_STRING,e.error_description,e.suberror,e.timestamp||pe.EMPTY_STRING,e.trace_id||pe.EMPTY_STRING,e.correlation_id||pe.EMPTY_STRING,e.claims||pe.EMPTY_STRING);throw new $e(e.error||pe.EMPTY_STRING,e.error_description,e.suberror)}e.client_info&&Xt(e.client_info,r)},e.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if(nt.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new nt(e.error,e.error_description,e.suberror,e.timestamp||pe.EMPTY_STRING,e.trace_id||pe.EMPTY_STRING,e.correlation_id||pe.EMPTY_STRING,e.claims||pe.EMPTY_STRING);var t=e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id;throw new $e(e.error,t,e.suberror)}},e.prototype.handleServerTokenResponse=function(t,r,n,o,i,a,s,c,u){var l;return ie(this,void 0,void 0,(function(){var d,h,p,f,g,m;return ae(this,(function(v){switch(v.label){case 0:if(null===(l=this.performanceClient)||void 0===l||l.addQueueMeasurement(Q.HandleServerTokenResponse,t.correlation_id),t.id_token){if(d=new tr(t.id_token||pe.EMPTY_STRING,this.cryptoObj),i&&!It.isEmpty(i.nonce)&&d.claims.nonce!==i.nonce)throw _t.createNonceMismatchError();if(o.maxAge||0===o.maxAge){if(!(h=d.claims.auth_time))throw _t.createAuthTimeNotFoundError();tr.checkMaxAge(h,o.maxAge)}}this.homeAccountIdentifier=er.generateHomeAccountId(t.client_info||pe.EMPTY_STRING,r.authorityType,this.logger,this.cryptoObj,d),i&&i.state&&(p=dr.parseRequestState(this.cryptoObj,i.state)),t.key_id=t.key_id||o.sshKid||void 0,f=this.generateCacheRecord(t,r,n,o,d,a,i),v.label=1;case 1:return v.trys.push([1,,5,8]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),g=new Fr(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(g)]):[3,3];case 2:v.sent(),v.label=3;case 3:return!s||c||!f.account||(m=f.account.generateAccountKey(),this.cacheStorage.getAccount(m))?[4,this.cacheStorage.saveCacheRecord(f)]:(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,e.generateAuthenticationResult(this.cryptoObj,r,f,!1,o,d,p,void 0,u)]);case 4:return v.sent(),[3,8];case 5:return this.persistencePlugin&&this.serializableCache&&g?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(g)]):[3,7];case 6:v.sent(),v.label=7;case 7:return[7];case 8:return[2,e.generateAuthenticationResult(this.cryptoObj,r,f,!1,o,d,p,t,u)]}}))}))},e.prototype.generateCacheRecord=function(e,t,r,n,o,i,a){var s,c,u=t.getPreferredCache();if(It.isEmpty(u))throw _t.createInvalidCacheEnvironmentError();!It.isEmpty(e.id_token)&&o&&(s=Qt.createIdTokenEntity(this.homeAccountIdentifier,u,e.id_token||pe.EMPTY_STRING,this.clientId,o.claims.tid||pe.EMPTY_STRING),c=this.generateAccountEntity(e,o,t,a));var l=null;if(!It.isEmpty(e.access_token)){var d=e.scope?Jt.fromString(e.scope):new Jt(n.scopes||[]),h=("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,p=("string"==typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,f=("string"==typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,g=r+h,m=g+p,v=f&&f>0?r+f:void 0;l=ir.createAccessTokenEntity(this.homeAccountIdentifier,u,e.access_token||pe.EMPTY_STRING,this.clientId,o?o.claims.tid||pe.EMPTY_STRING:t.tenant,d.printScopes(),g,m,this.cryptoObj,v,e.token_type,i,e.key_id,n.claims,n.requestedClaimsHash)}var y=null;It.isEmpty(e.refresh_token)||(y=ar.createRefreshTokenEntity(this.homeAccountIdentifier,u,e.refresh_token||pe.EMPTY_STRING,this.clientId,e.foci,i));var C=null;return It.isEmpty(e.foci)||(C=sr.createAppMetadataEntity(this.clientId,u,e.foci)),new xr(c,s,l,y,C)},e.prototype.generateAccountEntity=function(e,t,r,n){var o=r.authorityType,i=n?n.cloud_graph_host_name:pe.EMPTY_STRING,a=n?n.msgraph_host:pe.EMPTY_STRING;if(o===Bt.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),er.createGenericAccount(this.homeAccountIdentifier,t,r,i,a);if(It.isEmpty(e.client_info)&&"AAD"===r.protocolMode)throw _t.createClientInfoEmptyError();return e.client_info?er.createAccount(e.client_info,this.homeAccountIdentifier,t,r,i,a):er.createGenericAccount(this.homeAccountIdentifier,t,r,i,a)},e.generateAuthenticationResult=function(e,t,r,n,o,i,a,s,c){var u,l,d;return ie(this,void 0,void 0,(function(){var h,p,f,g,m,v,y,C,T,E,_;return ae(this,(function(I){switch(I.label){case 0:if(h=pe.EMPTY_STRING,p=[],f=null,m=pe.EMPTY_STRING,!r.accessToken)return[3,4];if(r.accessToken.tokenType!==Ae.POP)return[3,2];if(v=new Br(e),y=r.accessToken,C=y.secret,!(T=y.keyId))throw _t.createKeyIdMissingError();return[4,v.signPopToken(C,T,o)];case 1:return h=I.sent(),[3,3];case 2:h=r.accessToken.secret,I.label=3;case 3:p=Jt.fromString(r.accessToken.target).asArray(),f=new Date(1e3*Number(r.accessToken.expiresOn)),g=new Date(1e3*Number(r.accessToken.extendedExpiresOn)),I.label=4;case 4:return r.appMetadata&&(m="1"===r.appMetadata.familyId?"1":pe.EMPTY_STRING),E=(null==i?void 0:i.claims.oid)||(null==i?void 0:i.claims.sub)||pe.EMPTY_STRING,_=(null==i?void 0:i.claims.tid)||pe.EMPTY_STRING,(null==s?void 0:s.spa_accountid)&&r.account&&(r.account.nativeAccountId=null==s?void 0:s.spa_accountid),[2,{authority:t.canonicalAuthority,uniqueId:E,tenantId:_,scopes:p,account:r.account?r.account.getAccountInfo():null,idToken:i?i.rawToken:pe.EMPTY_STRING,idTokenClaims:i?i.claims:{},accessToken:h,fromCache:n,expiresOn:f,correlationId:o.correlationId,requestId:c||pe.EMPTY_STRING,extExpiresOn:g,familyId:m,tokenType:(null===(u=r.accessToken)||void 0===u?void 0:u.tokenType)||pe.EMPTY_STRING,state:a?a.userRequestState:pe.EMPTY_STRING,cloudGraphHostName:(null===(l=r.account)||void 0===l?void 0:l.cloudGraphHostName)||pe.EMPTY_STRING,msGraphHost:(null===(d=r.account)||void 0===d?void 0:d.msGraphHost)||pe.EMPTY_STRING,code:null==s?void 0:s.spa_code,fromNativeBroker:!1}]}}))}))},e}(),Gr=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.includeRedirectUri=!0,n}return ne(t,e),t.prototype.getAuthCodeUrl=function(e){var t,r;return ie(this,void 0,void 0,(function(){var n;return ae(this,(function(o){switch(o.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Q.GetAuthCodeUrl,e.correlationId),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(Q.AuthClientCreateQueryString,e.correlationId),[4,this.createAuthCodeUrlQueryString(e)];case 1:return n=o.sent(),[2,gr.appendQueryString(this.authority.authorizationEndpoint,n)]}}))}))},t.prototype.acquireToken=function(e,t){var r,n,o,i,a,s;return ie(this,void 0,void 0,(function(){var c,u,l,d,h,p,f=this;return ae(this,(function(g){switch(g.label){case 0:if(!e||!e.code)throw _t.createTokenRequestCannotBeMadeError();return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(Q.AuthClientAcquireToken,e.correlationId),c=null===(n=this.performanceClient)||void 0===n?void 0:n.startMeasurement("AuthCodeClientAcquireToken",e.correlationId),this.logger.info("in acquireToken call in auth-code client"),u=or.nowSeconds(),null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(Q.AuthClientExecuteTokenRequest,e.correlationId),[4,this.executeTokenRequest(this.authority,e)];case 1:return l=g.sent(),d=null===(i=l.headers)||void 0===i?void 0:i[ce.X_MS_REQUEST_ID],(h=null===(a=l.headers)||void 0===a?void 0:a[ce.X_MS_HTTP_VERSION])&&(null==c||c.addStaticFields({httpVerAuthority:h})),(p=new Kr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient)).validateTokenResponse(l.body),null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(Q.HandleServerTokenResponse,e.correlationId),[2,p.handleServerTokenResponse(l.body,this.authority,u,e,t,void 0,void 0,void 0,d).then((function(e){return null==c||c.endMeasurement({success:!0}),e})).catch((function(t){throw f.logger.verbose("Error in fetching token in ACC",e.correlationId),null==c||c.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t}))]}}))}))},t.prototype.handleFragmentResponse=function(e,t){var r=new Kr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null),n=new gr(e),o=gr.getDeserializedHash(n.getHash());if(r.validateServerAuthorizationCodeResponse(o,t,this.cryptoUtils),!o.code)throw _t.createNoAuthCodeInServerResponseError();return oe(oe({},o),{code:o.code})},t.prototype.getLogoutUri=function(e){if(!e)throw Vt.createEmptyLogoutRequestError();var t=this.createLogoutUrlQueryString(e);return gr.appendQueryString(this.authority.endSessionEndpoint,t)},t.prototype.executeTokenRequest=function(e,t){var r,n;return ie(this,void 0,void 0,(function(){var o,i,a,s,c,u,l;return ae(this,(function(d){switch(d.label){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(Q.AuthClientExecuteTokenRequest,t.correlationId),null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(Q.AuthClientCreateTokenRequestBody,t.correlationId),o=this.createTokenQueryParameters(t),i=gr.appendQueryString(e.tokenEndpoint,o),[4,this.createTokenRequestBody(t)];case 1:if(a=d.sent(),s=void 0,t.clientInfo)try{c=Xt(t.clientInfo,this.cryptoUtils),s={credential:""+c.uid+Ee.CLIENT_INFO_SEPARATOR+c.utid,type:$t.HOME_ACCOUNT_ID}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}return u=this.createTokenRequestHeaders(s||t.ccsCredential),l={clientId:this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},[2,this.executePostToTokenEndpoint(i,a,u,l)]}}))}))},t.prototype.createTokenRequestBody=function(e){var t,r;return ie(this,void 0,void 0,(function(){var n,o,i,a,s,c,u,l;return ae(this,(function(d){switch(d.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Q.AuthClientCreateTokenRequestBody,e.correlationId),(n=new Hr).addClientId(this.config.authOptions.clientId),this.includeRedirectUri?n.addRedirectUri(e.redirectUri):Lr.validateRedirectUri(e.redirectUri),n.addScopes(e.scopes),n.addAuthorizationCode(e.code),n.addLibraryInfo(this.config.libraryInfo),n.addApplicationTelemetry(this.config.telemetry.application),n.addThrottling(),this.serverTelemetryManager&&n.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&n.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&n.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(o=this.config.clientCredentials.clientAssertion,n.addClientAssertion(o.assertion),n.addClientAssertionType(o.assertionType)),n.addGrantType(Ce.AUTHORIZATION_CODE_GRANT),n.addClientInfo(),e.authenticationScheme!==Ae.POP?[3,2]:(i=new Br(this.cryptoUtils,this.performanceClient),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(Q.PopTokenGenerateCnf,e.correlationId),[4,i.generateCnf(e)]);case 1:return a=d.sent(),n.addPopToken(a.reqCnfString),[3,3];case 2:if(e.authenticationScheme===Ae.SSH){if(!e.sshJwk)throw Vt.createMissingSshJwkError();n.addSshJwk(e.sshJwk)}d.label=3;case 3:if(s=e.correlationId||this.config.cryptoInterface.createNewGuid(),n.addCorrelationId(s),(!It.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(e.claims,this.config.authOptions.clientCapabilities),c=void 0,e.clientInfo)try{u=Xt(e.clientInfo,this.cryptoUtils),c={credential:""+u.uid+Ee.CLIENT_INFO_SEPARATOR+u.utid,type:$t.HOME_ACCOUNT_ID}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}else c=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&c)switch(c.type){case $t.HOME_ACCOUNT_ID:try{u=Zt(c.credential),n.addCcsOid(u)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case $t.UPN:n.addCcsUpn(c.credential)}return e.tokenBodyParameters&&n.addExtraQueryParameters(e.tokenBodyParameters),!e.enableSpaAuthorizationCode||e.tokenBodyParameters&&e.tokenBodyParameters[de.RETURN_SPA_CODE]||n.addExtraQueryParameters(((l={})[de.RETURN_SPA_CODE]="1",l)),[2,n.createQueryString()]}}))}))},t.prototype.createAuthCodeUrlQueryString=function(e){var t;return ie(this,void 0,void 0,(function(){var r,n,o,i,a,s,c;return ae(this,(function(u){switch(u.label){case 0:if(null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Q.AuthClientCreateQueryString,e.correlationId),(r=new Hr).addClientId(this.config.authOptions.clientId),n=se(e.scopes||[],e.extraScopesToConsent||[]),r.addScopes(n),r.addRedirectUri(e.redirectUri),o=e.correlationId||this.config.cryptoInterface.createNewGuid(),r.addCorrelationId(o),r.addResponseMode(e.responseMode),r.addResponseTypeCode(),r.addLibraryInfo(this.config.libraryInfo),r.addApplicationTelemetry(this.config.telemetry.application),r.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&r.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&r.addPrompt(e.prompt),e.domainHint&&r.addDomainHint(e.domainHint),e.prompt!==ve.SELECT_ACCOUNT)if(e.sid&&e.prompt===ve.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),r.addSid(e.sid);else if(e.account){if(i=this.extractAccountSid(e.account),a=this.extractLoginHint(e.account)){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),r.addLoginHint(a);try{s=Zt(e.account.homeAccountId),r.addCcsOid(s)}catch(e){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(i&&e.prompt===ve.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),r.addSid(i);try{s=Zt(e.account.homeAccountId),r.addCcsOid(s)}catch(e){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),r.addLoginHint(e.loginHint),r.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),r.addLoginHint(e.account.username);try{s=Zt(e.account.homeAccountId),r.addCcsOid(s)}catch(e){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),r.addLoginHint(e.loginHint),r.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return e.nonce&&r.addNonce(e.nonce),e.state&&r.addState(e.state),(!It.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.extraQueryParameters&&r.addExtraQueryParameters(e.extraQueryParameters),e.nativeBroker?(r.addNativeBroker(),e.authenticationScheme!==Ae.POP?[3,2]:[4,new Br(this.cryptoUtils).generateCnf(e)]):[3,2];case 1:c=u.sent(),r.addPopToken(c.reqCnfHash),u.label=2;case 2:return[2,r.createQueryString()]}}))}))},t.prototype.createLogoutUrlQueryString=function(e){var t=new Hr;return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.logoutHint&&t.addLogoutHint(e.logoutHint),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()},t.prototype.extractAccountSid=function(e){var t;return(null===(t=e.idTokenClaims)||void 0===t?void 0:t.sid)||null},t.prototype.extractLoginHint=function(e){var t;return(null===(t=e.idTokenClaims)||void 0===t?void 0:t.login_hint)||null},t}(Dr);
/*! @azure/msal-common v13.0.0 2023-05-01 */
/*! @azure/msal-common v13.0.0 2023-05-01 */
function zr(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("jwks_uri")}
/*! @azure/msal-common v13.0.0 2023-05-01 */var Wr={"https://login.microsoftonline.com/common/":{token_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/common/":{token_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/common/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/common/":{token_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/consumers/":{token_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/consumers/":{token_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/consumers/":{token_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/organizations/":{token_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/organizations/":{token_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/organizations/":{token_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"}},jr={"https://login.microsoftonline.com/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/common/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/consumers/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/organizations/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}};
/*! @azure/msal-common v13.0.0 2023-05-01 */
var Qr,Yr=function(){function e(e,t,r){this.networkInterface=e,this.performanceClient=t,this.correlationId=r}return e.prototype.detectRegion=function(t,r){var n,o,i,a;return ie(this,void 0,void 0,(function(){var s,c,u,l,d;return ae(this,(function(h){switch(h.label){case 0:if(null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(Q.RegionDiscoveryDetectRegion,this.correlationId),s=t)return[3,8];c=e.IMDS_OPTIONS,h.label=1;case 1:return h.trys.push([1,6,,7]),null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(Q.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[4,this.getRegionFromIMDS(pe.IMDS_VERSION,c)];case 2:return(u=h.sent()).status===Ne.httpSuccess&&(s=u.body,r.region_source=Me.IMDS),u.status!==Ne.httpBadRequest?[3,5]:(null===(i=this.performanceClient)||void 0===i||i.setPreQueueTime(Q.RegionDiscoveryGetCurrentVersion,this.correlationId),[4,this.getCurrentVersion(c)]);case 3:return(l=h.sent())?(null===(a=this.performanceClient)||void 0===a||a.setPreQueueTime(Q.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[4,this.getRegionFromIMDS(l,c)]):(r.region_source=Me.FAILED_AUTO_DETECTION,[2,null]);case 4:(d=h.sent()).status===Ne.httpSuccess&&(s=d.body,r.region_source=Me.IMDS),h.label=5;case 5:return[3,7];case 6:return h.sent(),r.region_source=Me.FAILED_AUTO_DETECTION,[2,null];case 7:return[3,9];case 8:r.region_source=Me.ENVIRONMENT_VARIABLE,h.label=9;case 9:return s||(r.region_source=Me.FAILED_AUTO_DETECTION),[2,s||null]}}))}))},e.prototype.getRegionFromIMDS=function(e,t){var r;return ie(this,void 0,void 0,(function(){return ae(this,(function(n){return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(Q.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[2,this.networkInterface.sendGetRequestAsync(pe.IMDS_ENDPOINT+"?api-version="+e+"&format=text",t,pe.IMDS_TIMEOUT)]}))}))},e.prototype.getCurrentVersion=function(e){var t;return ie(this,void 0,void 0,(function(){var r;return ae(this,(function(n){switch(n.label){case 0:null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Q.RegionDiscoveryGetCurrentVersion,this.correlationId),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(pe.IMDS_ENDPOINT+"?format=json",e)];case 2:return(r=n.sent()).status===Ne.httpBadRequest&&r.body&&r.body["newest-versions"]&&r.body["newest-versions"].length>0?[2,r.body["newest-versions"][0]]:[2,null];case 3:return n.sent(),[2,null];case 4:return[2]}}))}))},e.IMDS_OPTIONS={headers:{Metadata:"true"}},e}(),Vr=function(){function e(e,t,r,n,o,i,a){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=r,this.authorityOptions=n,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=o,this.performanceClient=i,this.correlationId=a,this.regionDiscovery=new Yr(t,this.performanceClient,this.correlationId)}return Object.defineProperty(e.prototype,"authorityType",{get:function(){if(this.canonicalAuthorityUrlComponents.HostNameAndPort.endsWith(pe.CIAM_AUTH_URL))return Bt.Ciam;var e=this.canonicalAuthorityUrlComponents.PathSegments;if(e.length)switch(e[0].toLowerCase()){case pe.ADFS:return Bt.Adfs;case pe.DSTS:return Bt.Dsts}return Bt.Default},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"protocolMode",{get:function(){return this.authorityOptions.protocolMode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.authorityOptions},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new gr(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hostnameAndPort",{get:function(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.authorization_endpoint);return this.replaceTenant(e)}throw _t.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint);return this.replaceTenant(e)}throw _t.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));return this.replaceTenant(e)}throw _t.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw _t.createLogoutNotSupportedError();var e=this.replacePath(this.metadata.end_session_endpoint);return this.replaceTenant(e)}throw _t.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.issuer);return this.replaceTenant(e)}throw _t.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"jwksUri",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.jwks_uri);return this.replaceTenant(e)}throw _t.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),e.prototype.replaceTenant=function(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)},e.prototype.replacePath=function(e){var t=e,r=new gr(this.metadata.canonical_authority).getUrlComponents().PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((function(e,n){var o=r[n];e!==o&&(t=t.replace("/"+o+"/","/"+e+"/"))})),t},Object.defineProperty(e.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===Bt.Adfs||this.authorityType===Bt.Dsts||this.protocolMode===hr.OIDC?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!1,configurable:!0}),e.prototype.discoveryComplete=function(){return!!this.metadata},e.prototype.resolveEndpointsAsync=function(){var e,t,r;return ie(this,void 0,void 0,(function(){var n,o,i,a;return ae(this,(function(s){switch(s.label){case 0:return null===(e=this.performanceClient)||void 0===e||e.addQueueMeasurement(Q.AuthorityResolveEndpointsAsync,this.correlationId),(n=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort))||(n=new ur).updateCanonicalAuthority(this.canonicalAuthority),null===(t=this.performanceClient)||void 0===t||t.setPreQueueTime(Q.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId),[4,this.updateCloudDiscoveryMetadata(n)];case 1:return o=s.sent(),this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,n.preferred_network),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(Q.AuthorityUpdateEndpointMetadata,this.correlationId),[4,this.updateEndpointMetadata(n)];case 2:return i=s.sent(),o!==Se.CACHE&&i!==Se.CACHE&&(n.resetExpiresAt(),n.updateCanonicalAuthority(this.canonicalAuthority)),a=this.cacheManager.generateAuthorityMetadataCacheKey(n.preferred_cache),this.cacheManager.setAuthorityMetadata(a,n),this.metadata=n,[2]}}))}))},e.prototype.updateEndpointMetadata=function(e){var t,r,n,o,i,a;return ie(this,void 0,void 0,(function(){var s,c;return ae(this,(function(u){switch(u.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Q.AuthorityUpdateEndpointMetadata,this.correlationId),(s=this.getEndpointMetadataFromConfig())?(e.updateEndpointMetadata(s,!1),[2,Se.CONFIG]):this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!e.isExpired()?[2,Se.CACHE]:(null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(Q.AuthorityGetEndpointMetadataFromNetwork,this.correlationId),[4,this.getEndpointMetadataFromNetwork()]);case 1:return(s=u.sent())?(null===(n=this.authorityOptions.azureRegionConfiguration)||void 0===n?void 0:n.azureRegion)?(null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(Q.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),[4,this.updateMetadataWithRegionalInformation(s)]):[3,3]:[3,4];case 2:s=u.sent(),u.label=3;case 3:return e.updateEndpointMetadata(s,!0),[2,Se.NETWORK];case 4:return!(c=this.getEndpointMetadataFromHardcodedValues())||this.authorityOptions.skipAuthorityMetadataCache?[3,7]:(null===(i=this.authorityOptions.azureRegionConfiguration)||void 0===i?void 0:i.azureRegion)?(null===(a=this.performanceClient)||void 0===a||a.setPreQueueTime(Q.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),[4,this.updateMetadataWithRegionalInformation(c)]):[3,6];case 5:c=u.sent(),u.label=6;case 6:return e.updateEndpointMetadata(c,!1),[2,Se.HARDCODED_VALUES];case 7:throw _t.createUnableToGetOpenidConfigError(this.defaultOpenIdConfigurationEndpoint)}}))}))},e.prototype.isAuthoritySameType=function(e){return new gr(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length},e.prototype.getEndpointMetadataFromConfig=function(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw Vt.createInvalidAuthorityMetadataError()}return null},e.prototype.getEndpointMetadataFromNetwork=function(){var e;return ie(this,void 0,void 0,(function(){var t,r;return ae(this,(function(n){switch(n.label){case 0:null===(e=this.performanceClient)||void 0===e||e.addQueueMeasurement(Q.AuthorityGetEndpointMetadataFromNetwork,this.correlationId),t={},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(this.defaultOpenIdConfigurationEndpoint,t)];case 2:return[2,zr((r=n.sent()).body)?r.body:null];case 3:return n.sent(),[2,null];case 4:return[2]}}))}))},e.prototype.getEndpointMetadataFromHardcodedValues=function(){return this.canonicalAuthority in Wr?Wr[this.canonicalAuthority]:null},e.prototype.updateMetadataWithRegionalInformation=function(t){var r,n,o,i,a,s,c;return ie(this,void 0,void 0,(function(){var u,l;return ae(this,(function(d){switch(d.label){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(Q.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(Q.RegionDiscoveryDetectRegion,this.correlationId),[4,this.regionDiscovery.detectRegion(null===(o=this.authorityOptions.azureRegionConfiguration)||void 0===o?void 0:o.environmentRegion,this.regionDiscoveryMetadata)];case 1:return u=d.sent(),l=(null===(i=this.authorityOptions.azureRegionConfiguration)||void 0===i?void 0:i.azureRegion)===pe.AZURE_REGION_AUTO_DISCOVER_FLAG?u:null===(a=this.authorityOptions.azureRegionConfiguration)||void 0===a?void 0:a.azureRegion,(null===(s=this.authorityOptions.azureRegionConfiguration)||void 0===s?void 0:s.azureRegion)===pe.AZURE_REGION_AUTO_DISCOVER_FLAG?this.regionDiscoveryMetadata.region_outcome=u?Oe.AUTO_DETECTION_REQUESTED_SUCCESSFUL:Oe.AUTO_DETECTION_REQUESTED_FAILED:this.regionDiscoveryMetadata.region_outcome=u?(null===(c=this.authorityOptions.azureRegionConfiguration)||void 0===c?void 0:c.azureRegion)===u?Oe.CONFIGURED_MATCHES_DETECTED:Oe.CONFIGURED_NOT_DETECTED:Oe.CONFIGURED_NO_AUTO_DETECTION,l?(this.regionDiscoveryMetadata.region_used=l,[2,e.replaceWithRegionalInformation(t,l)]):[2,t]}}))}))},e.prototype.updateCloudDiscoveryMetadata=function(e){var t,r;return ie(this,void 0,void 0,(function(){var n,o,i;return ae(this,(function(a){switch(a.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Q.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId),this.logger.verbose("Attempting to get cloud discovery metadata in the config"),this.logger.verbosePii("Known Authorities: "+(this.authorityOptions.knownAuthorities||pe.NOT_APPLICABLE)),this.logger.verbosePii("Authority Metadata: "+(this.authorityOptions.authorityMetadata||pe.NOT_APPLICABLE)),this.logger.verbosePii("Canonical Authority: "+(e.canonical_authority||pe.NOT_APPLICABLE)),(n=this.getCloudDiscoveryMetadataFromConfig())?(this.logger.verbose("Found cloud discovery metadata in the config."),e.updateCloudDiscoveryMetadata(n,!1),[2,Se.CONFIG]):(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the cache."),o=e.isExpired(),this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!o?(this.logger.verbose("Found metadata in the cache."),[2,Se.CACHE]):(o&&this.logger.verbose("The metadata entity is expired."),this.logger.verbose("Did not find cloud discovery metadata in the cache... Attempting to get cloud discovery metadata from the network."),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(Q.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId),[4,this.getCloudDiscoveryMetadataFromNetwork()]));case 1:if(n=a.sent())return this.logger.verbose("cloud discovery metadata was successfully returned from getCloudDiscoveryMetadataFromNetwork()"),e.updateCloudDiscoveryMetadata(n,!0),[2,Se.NETWORK];if(this.logger.verbose("Did not find cloud discovery metadata from the network... Attempting to get cloud discovery metadata from hardcoded values."),(i=this.getCloudDiscoveryMetadataFromHarcodedValues())&&!this.options.skipAuthorityMetadataCache)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),e.updateCloudDiscoveryMetadata(i,!1),[2,Se.HARDCODED_VALUES];throw this.logger.error("Did not find cloud discovery metadata from hardcoded values... Metadata could not be obtained from config, cache, network or hardcoded values. Throwing Untrusted Authority Error."),Vt.createUntrustedAuthorityError()}}))}))},e.prototype.getCloudDiscoveryMetadataFromConfig=function(){if(this.authorityType===Bt.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");var t=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),r=e.getCloudDiscoveryMetadataFromNetworkResponse(t.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),r)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),r;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(e){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),Vt.createInvalidCloudDiscoveryMetadataError()}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null},e.prototype.getCloudDiscoveryMetadataFromNetwork=function(){var t;return ie(this,void 0,void 0,(function(){var r,n,o,i,a,s,c,u;return ae(this,(function(l){switch(l.label){case 0:null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Q.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId),r=""+pe.AAD_INSTANCE_DISCOVERY_ENDPT+this.canonicalAuthority+"oauth2/v2.0/authorize",n={},o=null,l.label=1;case 1:return l.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(r,n)];case 2:if(i=l.sent(),a=void 0,s=void 0,
/*! @azure/msal-common v13.0.0 2023-05-01 */
function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}
/*! @azure/msal-common v13.0.0 2023-05-01 */(i.body))a=i.body,s=a.metadata,this.logger.verbosePii("tenant_discovery_endpoint is: "+a.tenant_discovery_endpoint);else{if(!function(e){return e.hasOwnProperty("error")&&e.hasOwnProperty("error_description")}(i.body))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),[2,null];if(this.logger.warning("A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: "+i.status),(a=i.body).error===pe.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),[2,null];this.logger.warning("The CloudInstanceDiscoveryErrorResponse error is "+a.error),this.logger.warning("The CloudInstanceDiscoveryErrorResponse error description is "+a.error_description),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),s=[]}return this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),o=e.getCloudDiscoveryMetadataFromNetworkResponse(s,this.hostnameAndPort),[3,4];case 3:return(c=l.sent())instanceof Ze?this.logger.error("There was a network error while attempting to get the cloud discovery instance metadata.\nError: "+c.errorCode+"\nError Description: "+c.errorMessage):(u=c,this.logger.error("A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: "+u.name+"\nError Description: "+u.message)),[2,null];case 4:return o||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),o=e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),[2,o]}}))}))},e.prototype.getCloudDiscoveryMetadataFromHarcodedValues=function(){return this.canonicalAuthority in jr?jr[this.canonicalAuthority]:null},e.prototype.isInKnownAuthorities=function(){var e=this;return this.authorityOptions.knownAuthorities.filter((function(t){return gr.getDomainFromUrl(t).toLowerCase()===e.hostnameAndPort})).length>0},e.generateAuthority=function(e,t){var r;if(t&&t.azureCloudInstance!==pr.None){var n=t.tenant?t.tenant:pe.DEFAULT_COMMON_TENANT;r=t.azureCloudInstance+"/"+n+"/"}return r||e},e.createCloudDiscoveryMetadataFromHost=function(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}},e.getCloudDiscoveryMetadataFromNetworkResponse=function(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n.aliases.indexOf(t)>-1)return n}return null},e.prototype.getPreferredCache=function(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw _t.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},e.prototype.isAlias=function(e){return this.metadata.aliases.indexOf(e)>-1},e.isPublicCloudAuthority=function(e){return pe.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0},e.buildRegionalAuthorityString=function(e,t,r){var n=new gr(e);n.validateAsUri();var o=n.getUrlComponents(),i=t+"."+o.HostNameAndPort;this.isPublicCloudAuthority(o.HostNameAndPort)&&(i=t+"."+pe.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX);var a=gr.constructAuthorityUriFromObject(oe(oe({},n.getUrlComponents()),{HostNameAndPort:i})).urlString;return r?a+"?"+r:a},e.replaceWithRegionalInformation=function(t,r){return t.authorization_endpoint=e.buildRegionalAuthorityString(t.authorization_endpoint,r),t.token_endpoint=e.buildRegionalAuthorityString(t.token_endpoint,r,pe.REGIONAL_AUTH_NON_MSI_QUERY_STRING),t.end_session_endpoint&&(t.end_session_endpoint=e.buildRegionalAuthorityString(t.end_session_endpoint,r)),t},e.transformCIAMAuthority=function(e){var t=e.endsWith(pe.FORWARD_SLASH)?e:""+e+pe.FORWARD_SLASH,r=new gr(e).getUrlComponents();0===r.PathSegments.length&&r.HostNameAndPort.endsWith(pe.CIAM_AUTH_URL)&&(t=""+t+r.HostNameAndPort.split(".")[0]+pe.AAD_TENANT_DOMAIN_SUFFIX);return t},e}(),Jr=function(){function e(){}return e.createDiscoveredInstance=function(t,r,n,o,i,a,s){return ie(this,void 0,void 0,(function(){var c,u,l;return ae(this,(function(d){switch(d.label){case 0:null==a||a.addQueueMeasurement(Q.AuthorityFactoryCreateDiscoveredInstance,s),c=Vr.transformCIAMAuthority(t),u=e.createInstance(c,r,n,o,i,a,s),d.label=1;case 1:return d.trys.push([1,3,,4]),null==a||a.setPreQueueTime(Q.AuthorityResolveEndpointsAsync,s),[4,u.resolveEndpointsAsync()];case 2:return d.sent(),[2,u];case 3:throw l=d.sent(),_t.createEndpointDiscoveryIncompleteError(l);case 4:return[2]}}))}))},e.createInstance=function(e,t,r,n,o,i,a){if(It.isEmpty(e))throw Vt.createUrlEmptyError();return new Vr(e,t,r,n,o,i,a)},e}(),Xr=function(){function e(e,t){this.cacheOutcome=Ue.NO_CACHE_HIT,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||pe.EMPTY_STRING,this.wrapperVer=e.wrapperVer||pe.EMPTY_STRING,this.telemetryCacheKey=Re.CACHE_KEY+Ee.CACHE_KEY_SEPARATOR+e.clientId}return e.prototype.generateCurrentRequestHeaderValue=function(){var e=""+this.apiId+Re.VALUE_SEPARATOR+this.cacheOutcome,t=[this.wrapperSKU,this.wrapperVer].join(Re.VALUE_SEPARATOR),r=[e,this.getRegionDiscoveryFields()].join(Re.VALUE_SEPARATOR);return[Re.SCHEMA_VERSION,r,t].join(Re.CATEGORY_SEPARATOR)},e.prototype.generateLastRequestHeaderValue=function(){var t=this.getLastRequests(),r=e.maxErrorsToSend(t),n=t.failedRequests.slice(0,2*r).join(Re.VALUE_SEPARATOR),o=t.errors.slice(0,r).join(Re.VALUE_SEPARATOR),i=t.errors.length,a=[i,r<i?Re.OVERFLOW_TRUE:Re.OVERFLOW_FALSE].join(Re.VALUE_SEPARATOR);return[Re.SCHEMA_VERSION,t.cacheHits,n,o,a].join(Re.CATEGORY_SEPARATOR)},e.prototype.cacheFailedRequest=function(e){var t=this.getLastRequests();t.errors.length>=Re.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),It.isEmpty(e.subError)?It.isEmpty(e.errorCode)?e&&e.toString()?t.errors.push(e.toString()):t.errors.push(Re.UNKNOWN_ERROR):t.errors.push(e.errorCode):t.errors.push(e.subError),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)},e.prototype.incrementCacheHits=function(){var e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits},e.prototype.getLastRequests=function(){var e=new cr;return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e},e.prototype.clearTelemetryCache=function(){var t=this.getLastRequests(),r=e.maxErrorsToSend(t);if(r===t.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{var n=new cr;n.failedRequests=t.failedRequests.slice(2*r),n.errors=t.errors.slice(r),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,n)}},e.maxErrorsToSend=function(e){var t,r=0,n=0,o=e.errors.length;for(t=0;t<o;t++){var i=e.failedRequests[2*t]||pe.EMPTY_STRING,a=e.failedRequests[2*t+1]||pe.EMPTY_STRING,s=e.errors[t]||pe.EMPTY_STRING;if(!((n+=i.toString().length+a.toString().length+s.length+3)<Re.MAX_LAST_HEADER_BYTES))break;r+=1}return r},e.prototype.getRegionDiscoveryFields=function(){var e=[];return e.push(this.regionUsed||pe.EMPTY_STRING),e.push(this.regionSource||pe.EMPTY_STRING),e.push(this.regionOutcome||pe.EMPTY_STRING),e.join(",")},e.prototype.updateRegionDiscoveryMetadata=function(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome},e.prototype.setCacheOutcome=function(e){this.cacheOutcome=e},e}(),Zr=function(){function e(e,t,r,n,o,i,a,s,c){this.config=e,this.browserStorage=t,this.browserCrypto=r,this.networkClient=this.config.system.networkClient,this.eventHandler=o,this.navigationClient=i,this.nativeMessageHandler=s,this.correlationId=c||this.browserCrypto.createNewGuid(),this.logger=n.clone(ot.MSAL_SKU,"2.37.0",this.correlationId),this.performanceClient=a}return e.prototype.clearCacheOnLogout=function(e){return X(this,void 0,void 0,(function(){return Z(this,(function(t){switch(t.label){case 0:if(!e)return[3,5];er.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null)),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.browserStorage.removeAccount(er.generateAccountCacheKey(e))];case 2:return t.sent(),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request."),[3,4];case 3:return t.sent(),this.logger.error("Account provided in logout request was not found. Local cache unchanged."),[3,4];case 4:return[3,9];case 5:return t.trys.push([5,8,,9]),this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),[4,this.browserStorage.clear()];case 6:return t.sent(),[4,this.browserCrypto.clearKeystore()];case 7:return t.sent(),[3,9];case 8:return t.sent(),this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged."),[3,9];case 9:return[2]}}))}))},e.prototype.initializeBaseRequest=function(e){return X(this,void 0,void 0,(function(){var t,r,n,o;return Z(this,(function(i){switch(i.label){case 0:if(this.performanceClient.addQueueMeasurement(Q.InitializeBaseRequest,e.correlationId),this.logger.verbose("Initializing BaseAuthRequest"),t=e.authority||this.config.auth.authority,r=ee(e&&e.scopes||[]),(n=V(V({},e),{correlationId:this.correlationId,authority:t,scopes:r})).authenticationScheme){if(n.authenticationScheme===Ae.SSH){if(!e.sshJwk)throw Vt.createMissingSshJwkError();if(!e.sshKid)throw Vt.createMissingSshKidError()}this.logger.verbose('Authentication Scheme set to "'+n.authenticationScheme+'" as configured in Auth request')}else n.authenticationScheme=Ae.BEARER,this.logger.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return!e.claims||It.isEmpty(e.claims)?[3,2]:(o=n,[4,this.browserCrypto.hashString(e.claims)]);case 1:o.requestedClaimsHash=i.sent(),i.label=2;case 2:return[2,n]}}))}))},e.prototype.getRedirectUri=function(e){this.logger.verbose("getRedirectUri called");var t=e||this.config.auth.redirectUri||Ar.getCurrentUri();return gr.getAbsoluteUrl(t,Ar.getCurrentUri())},e.prototype.initializeServerTelemetryManager=function(e,t){this.logger.verbose("initializeServerTelemetryManager called");var r={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new Xr(r,this.browserStorage)},e.prototype.getDiscoveredAuthority=function(e){return X(this,void 0,void 0,(function(){var t;return Z(this,(function(r){switch(r.label){case 0:return this.logger.verbose("getDiscoveredAuthority called"),t={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},e?(this.logger.verbose("Creating discovered authority with request authority"),[4,Jr.createDiscoveredInstance(e,this.config.system.networkClient,this.browserStorage,t,this.logger)]):[3,2];case 1:return[2,r.sent()];case 2:return this.logger.verbose("Creating discovered authority with configured authority"),[4,Jr.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient,this.browserStorage,t,this.logger)];case 3:return[2,r.sent()]}}))}))},e}(),$r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return j(t,e),t.prototype.initializeAuthorizationCodeRequest=function(e){return X(this,void 0,void 0,(function(){var t,r;return Z(this,(function(n){switch(n.label){case 0:return this.performanceClient.addQueueMeasurement(Q.StandardInteractionClientInitializeAuthorizationCodeRequest,e.correlationId),this.logger.verbose("initializeAuthorizationRequest called",e.correlationId),[4,this.browserCrypto.generatePkceCodes()];case 1:return t=n.sent(),r=V(V({},e),{redirectUri:e.redirectUri,code:pe.EMPTY_STRING,codeVerifier:t.verifier}),e.codeChallenge=t.challenge,e.codeChallengeMethod=pe.S256_CODE_CHALLENGE_METHOD,[2,r]}}))}))},t.prototype.initializeLogoutRequest=function(e){this.logger.verbose("initializeLogoutRequest called",null==e?void 0:e.correlationId);var t=V({correlationId:this.correlationId||this.browserCrypto.createNewGuid()},e);if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){var r=this.getLogoutHintFromIdTokenClaims(e.account);r&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=r)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=gr.getAbsoluteUrl(e.postLogoutRedirectUri,Ar.getCurrentUri())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=gr.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,Ar.getCurrentUri())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=gr.getAbsoluteUrl(Ar.getCurrentUri(),Ar.getCurrentUri())),t},t.prototype.getLogoutHintFromIdTokenClaims=function(e){var t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null},t.prototype.createAuthCodeClient=function(e,t,r){return X(this,void 0,void 0,(function(){var n;return Z(this,(function(o){switch(o.label){case 0:return this.performanceClient.addQueueMeasurement(Q.StandardInteractionClientCreateAuthCodeClient,this.correlationId),this.performanceClient.setPreQueueTime(Q.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(e,t,r)];case 1:return n=o.sent(),[2,new Gr(n,this.performanceClient)]}}))}))},t.prototype.getClientConfiguration=function(e,t,r){return X(this,void 0,void 0,(function(){var n,o;return Z(this,(function(i){switch(i.label){case 0:return this.performanceClient.addQueueMeasurement(Q.StandardInteractionClientGetClientConfiguration,this.correlationId),this.logger.verbose("getClientConfiguration called",this.correlationId),this.performanceClient.setPreQueueTime(Q.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),[4,this.getDiscoveredAuthority(t,r)];case 1:return n=i.sent(),o=this.config.system.loggerOptions,[2,{authOptions:{clientId:this.config.auth.clientId,authority:n,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:o.loggerCallback,piiLoggingEnabled:o.piiLoggingEnabled,logLevel:o.logLevel,correlationId:this.correlationId},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:e,libraryInfo:{sku:ot.MSAL_SKU,version:"2.37.0",cpu:pe.EMPTY_STRING,os:pe.EMPTY_STRING},telemetry:this.config.telemetry}]}}))}))},t.prototype.validateAndExtractStateFromHash=function(e,t,r){if(this.logger.verbose("validateAndExtractStateFromHash called",r),!e.state)throw St.createHashDoesNotContainStateError();var n=mr.extractBrowserRequestState(this.browserCrypto,e.state);if(!n)throw St.createUnableToParseStateError();if(n.interactionType!==t)throw St.createStateInteractionTypeMismatchError();return this.logger.verbose("Returning state from hash",r),e.state},t.prototype.getDiscoveredAuthority=function(e,t){var r;return X(this,void 0,void 0,(function(){var n,o,i,a;return Z(this,(function(s){switch(s.label){case 0:return this.performanceClient.addQueueMeasurement(Q.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),this.logger.verbose("getDiscoveredAuthority called",this.correlationId),n=null===(r=this.performanceClient)||void 0===r?void 0:r.startMeasurement(Q.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),o={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},i=e||this.config.auth.authority,a=Vr.generateAuthority(i,t||this.config.auth.azureCloudOptions),this.logger.verbose("Creating discovered authority with configured authority",this.correlationId),this.performanceClient.setPreQueueTime(Q.AuthorityFactoryCreateDiscoveredInstance,this.correlationId),[4,Jr.createDiscoveredInstance(a,this.config.system.networkClient,this.browserStorage,o,this.logger,this.performanceClient,this.correlationId).then((function(e){return n.endMeasurement({success:!0}),e})).catch((function(e){throw n.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e}))];case 1:return[2,s.sent()]}}))}))},t.prototype.initializeAuthorizationRequest=function(e,t){return X(this,void 0,void 0,(function(){var r,n,o,i,a,s,c;return Z(this,(function(u){switch(u.label){case 0:return this.performanceClient.addQueueMeasurement(Q.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId),this.logger.verbose("initializeAuthorizationRequest called",this.correlationId),r=this.getRedirectUri(e.redirectUri),n={interactionType:t},o=dr.setRequestState(this.browserCrypto,e&&e.state||pe.EMPTY_STRING,n),this.performanceClient.setPreQueueTime(Q.InitializeBaseRequest,this.correlationId),a=[{}],[4,this.initializeBaseRequest(e)];case 1:return i=V.apply(void 0,[V.apply(void 0,a.concat([u.sent()])),{redirectUri:r,state:o,nonce:e.nonce||this.browserCrypto.createNewGuid(),responseMode:ye.FRAGMENT}]),(s=e.account||this.browserStorage.getActiveAccount())&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii("Setting validated request account: "+s.homeAccountId,this.correlationId),i.account=s),It.isEmpty(i.loginHint)&&!s&&(c=this.browserStorage.getLegacyLoginHint())&&(i.loginHint=c),[2,i]}}))}))},t}(Zr);
/*! @azure/msal-common v13.0.0 2023-05-01 */!function(e){e.USER_INTERACTION_REQUIRED="USER_INTERACTION_REQUIRED",e.USER_CANCEL="USER_CANCEL",e.NO_NETWORK="NO_NETWORK",e.TRANSIENT_ERROR="TRANSIENT_ERROR",e.PERSISTENT_ERROR="PERSISTENT_ERROR",e.DISABLED="DISABLED",e.ACCOUNT_UNAVAILABLE="ACCOUNT_UNAVAILABLE"}(Qr||(Qr={}));var en={code:"ContentError"},tn={code:"user_switch",desc:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."},rn={code:"tokens_not_found_in_internal_memory_cache",desc:"Tokens not cached in MSAL JS internal memory, please make the WAM request"},nn=function(e){function t(r,n,o){var i=e.call(this,r,n)||this;return Object.setPrototypeOf(i,t.prototype),i.name="NativeAuthError",i.ext=o,i}return j(t,e),t.prototype.isFatal=function(){if(this.ext&&this.ext.status&&(this.ext.status===Qr.PERSISTENT_ERROR||this.ext.status===Qr.DISABLED))return!0;switch(this.errorCode){case en.code:return!0;default:return!1}},t.createError=function(e,r,n){if(n&&n.status)switch(n.status){case Qr.ACCOUNT_UNAVAILABLE:return nt.createNativeAccountUnavailableError();case Qr.USER_INTERACTION_REQUIRED:return new nt(e,r);case Qr.USER_CANCEL:return St.createUserCancelledError();case Qr.NO_NETWORK:return St.createNoNetworkConnectivityError()}return new t(e,r,n)},t.createUserSwitchError=function(){return new t(tn.code,tn.desc)},t.createTokensNotFoundInCacheError=function(){return new t(rn.code,rn.desc)},t}(Ze),on=function(e){function t(t,r){return e.call(this,t,r)||this}return ne(t,e),t.prototype.acquireToken=function(e){var t,r,n,o,i,a,s;return ie(this,void 0,void 0,(function(){var c,u,l,d,h,p,f=this;return ae(this,(function(g){switch(g.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Q.RefreshTokenClientAcquireToken,e.correlationId),c=null===(r=this.performanceClient)||void 0===r?void 0:r.startMeasurement(Q.RefreshTokenClientAcquireToken,e.correlationId),this.logger.verbose("RefreshTokenClientAcquireToken called",e.correlationId),u=or.nowSeconds(),null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(Q.RefreshTokenClientExecuteTokenRequest,e.correlationId),[4,this.executeTokenRequest(e,this.authority)];case 1:return l=g.sent(),d=null===(o=l.headers)||void 0===o?void 0:o[ce.X_MS_HTTP_VERSION],null==c||c.addStaticFields({refreshTokenSize:(null===(i=l.body.refresh_token)||void 0===i?void 0:i.length)||0}),d&&(null==c||c.addStaticFields({httpVerToken:d})),h=null===(a=l.headers)||void 0===a?void 0:a[ce.X_MS_REQUEST_ID],(p=new Kr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(l.body),null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(Q.HandleServerTokenResponse,e.correlationId),[2,p.handleServerTokenResponse(l.body,this.authority,u,e,void 0,void 0,!0,e.forceCache,h).then((function(e){return null==c||c.endMeasurement({success:!0}),e})).catch((function(t){throw f.logger.verbose("Error in fetching refresh token",e.correlationId),null==c||c.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t}))]}}))}))},t.prototype.acquireTokenByRefreshToken=function(e){var t,r,n,o;return ie(this,void 0,void 0,(function(){var i,a;return ae(this,(function(s){if(!e)throw Vt.createEmptyTokenRequestError();if(null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Q.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw _t.createNoAccountInSilentRequestError();if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(Q.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),[2,this.acquireTokenWithCachedRefreshToken(e,!0)]}catch(t){if(i=t instanceof nt&&t.errorCode===rt.noTokensFoundError.code,a=t instanceof $e&&t.errorCode===Be&&t.subError===Fe,i||a)return null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(Q.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),[2,this.acquireTokenWithCachedRefreshToken(e,!1)];throw t}return null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(Q.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),[2,this.acquireTokenWithCachedRefreshToken(e,!1)]}))}))},t.prototype.acquireTokenWithCachedRefreshToken=function(e,t){var r,n,o;return ie(this,void 0,void 0,(function(){var i,a,s;return ae(this,(function(c){if(null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(Q.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),i=null===(n=this.performanceClient)||void 0===n?void 0:n.startMeasurement(Q.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),this.logger.verbose("RefreshTokenClientAcquireTokenWithCachedRefreshToken called",e.correlationId),!(a=this.cacheManager.getRefreshToken(e.account,t)))throw null==i||i.discardMeasurement(),nt.createNoTokensFoundError();return null==i||i.endMeasurement({success:!0}),s=oe(oe({},e),{refreshToken:a.secret,authenticationScheme:e.authenticationScheme||Ae.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:$t.HOME_ACCOUNT_ID}}),null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(Q.RefreshTokenClientAcquireToken,e.correlationId),[2,this.acquireToken(s)]}))}))},t.prototype.executeTokenRequest=function(e,t){var r,n,o;return ie(this,void 0,void 0,(function(){var i,a,s,c,u,l;return ae(this,(function(d){switch(d.label){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(Q.RefreshTokenClientExecuteTokenRequest,e.correlationId),i=null===(n=this.performanceClient)||void 0===n?void 0:n.startMeasurement(Q.RefreshTokenClientExecuteTokenRequest,e.correlationId),null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(Q.RefreshTokenClientCreateTokenRequestBody,e.correlationId),a=this.createTokenQueryParameters(e),s=gr.appendQueryString(t.tokenEndpoint,a),[4,this.createTokenRequestBody(e)];case 1:return c=d.sent(),u=this.createTokenRequestHeaders(e.ccsCredential),l={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},[2,this.executePostToTokenEndpoint(s,c,u,l).then((function(e){return null==i||i.endMeasurement({success:!0}),e})).catch((function(e){throw null==i||i.endMeasurement({success:!1}),e}))]}}))}))},t.prototype.createTokenRequestBody=function(e){var t,r,n;return ie(this,void 0,void 0,(function(){var o,i,a,s,c,u,l;return ae(this,(function(d){switch(d.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Q.RefreshTokenClientCreateTokenRequestBody,e.correlationId),o=e.correlationId,i=null===(r=this.performanceClient)||void 0===r?void 0:r.startMeasurement(Q.BaseClientCreateTokenRequestHeaders,o),(a=new Hr).addClientId(this.config.authOptions.clientId),a.addScopes(e.scopes),a.addGrantType(Ce.REFRESH_TOKEN_GRANT),a.addClientInfo(),a.addLibraryInfo(this.config.libraryInfo),a.addApplicationTelemetry(this.config.telemetry.application),a.addThrottling(),this.serverTelemetryManager&&a.addServerTelemetry(this.serverTelemetryManager),a.addCorrelationId(o),a.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&a.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(s=this.config.clientCredentials.clientAssertion,a.addClientAssertion(s.assertion),a.addClientAssertionType(s.assertionType)),e.authenticationScheme!==Ae.POP?[3,2]:(c=new Br(this.cryptoUtils,this.performanceClient),null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(Q.PopTokenGenerateCnf,e.correlationId),[4,c.generateCnf(e)]);case 1:return u=d.sent(),a.addPopToken(u.reqCnfString),[3,3];case 2:if(e.authenticationScheme===Ae.SSH){if(!e.sshJwk)throw null==i||i.endMeasurement({success:!1}),Vt.createMissingSshJwkError();a.addSshJwk(e.sshJwk)}d.label=3;case 3:if((!It.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&a.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case $t.HOME_ACCOUNT_ID:try{l=Zt(e.ccsCredential.credential),a.addCcsOid(l)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case $t.UPN:a.addCcsUpn(e.ccsCredential.credential)}return null==i||i.endMeasurement({success:!0}),[2,a.createQueryString()]}}))}))},t}(Dr),an=function(e){function t(t,r){return e.call(this,t,r)||this}return ne(t,e),t.prototype.acquireToken=function(e){return ie(this,void 0,void 0,(function(){var t;return ae(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.acquireCachedToken(e)];case 1:return[2,r.sent()];case 2:if((t=r.sent())instanceof _t&&t.errorCode===Et.tokenRefreshRequired.code)return[2,new on(this.config,this.performanceClient).acquireTokenByRefreshToken(e)];throw t;case 3:return[2]}}))}))},t.prototype.acquireCachedToken=function(e){var t,r,n,o;return ie(this,void 0,void 0,(function(){var i,a;return ae(this,(function(s){switch(s.label){case 0:if(!e)throw Vt.createEmptyTokenRequestError();if(e.forceRefresh)throw null===(t=this.serverTelemetryManager)||void 0===t||t.setCacheOutcome(Ue.FORCE_REFRESH),this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because forceRefresh is true."),_t.createRefreshRequiredError();if(!e.account)throw _t.createNoAccountInSilentRequestError();if(i=e.authority||this.authority.getPreferredCache(),!(a=this.cacheManager.readCacheRecord(e.account,e,i)).accessToken)throw null===(r=this.serverTelemetryManager)||void 0===r||r.setCacheOutcome(Ue.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),_t.createRefreshRequiredError();if(or.wasClockTurnedBack(a.accessToken.cachedAt)||or.isTokenExpired(a.accessToken.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw null===(n=this.serverTelemetryManager)||void 0===n||n.setCacheOutcome(Ue.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token is expired or will expire within "+this.config.systemOptions.tokenRenewalOffsetSeconds+" seconds."),_t.createRefreshRequiredError();if(a.accessToken.refreshOn&&or.isTokenExpired(a.accessToken.refreshOn,0))throw null===(o=this.serverTelemetryManager)||void 0===o||o.setCacheOutcome(Ue.REFRESH_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'."),_t.createRefreshRequiredError();return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,this.generateResultFromCacheRecord(a,e)];case 1:return[2,s.sent()]}}))}))},t.prototype.generateResultFromCacheRecord=function(e,t){return ie(this,void 0,void 0,(function(){var r,n;return ae(this,(function(o){switch(o.label){case 0:if(e.idToken&&(r=new tr(e.idToken.secret,this.config.cryptoInterface)),t.maxAge||0===t.maxAge){if(!(n=null==r?void 0:r.claims.auth_time))throw _t.createAuthTimeNotFoundError();tr.checkMaxAge(n,t.maxAge)}return[4,Kr.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,r)];case 1:return[2,o.sent()]}}))}))},t}(Dr),sn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return j(t,e),t.prototype.acquireToken=function(e){return X(this,void 0,void 0,(function(){var t,r,n,o,i;return Z(this,(function(a){switch(a.label){case 0:return t=this.performanceClient.startMeasurement(Q.SilentCacheClientAcquireToken,e.correlationId),r=this.initializeServerTelemetryManager(Ye.acquireTokenSilent_silentFlow),[4,this.createSilentFlowClient(r,e.authority,e.azureCloudOptions)];case 1:n=a.sent(),this.logger.verbose("Silent auth client created"),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,n.acquireCachedToken(e)];case 3:return o=a.sent(),t.endMeasurement({success:!0,fromCache:!0}),[2,o];case 4:throw(i=a.sent())instanceof St&&i.errorCode===wt.signingKeyNotFoundInStorage.code&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),t.endMeasurement({errorCode:i instanceof Ze&&i.errorCode||void 0,subErrorCode:i instanceof Ze&&i.subError||void 0,success:!1}),i;case 5:return[2]}}))}))},t.prototype.logout=function(){return Promise.reject(St.createSilentLogoutUnsupportedError())},t.prototype.createSilentFlowClient=function(e,t,r){return X(this,void 0,void 0,(function(){var n;return Z(this,(function(o){switch(o.label){case 0:return this.performanceClient.setPreQueueTime(Q.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(e,t,r)];case 1:return n=o.sent(),[2,new an(n,this.performanceClient)]}}))}))},t.prototype.initializeSilentRequest=function(e,t){return X(this,void 0,void 0,(function(){var r;return Z(this,(function(n){switch(n.label){case 0:return this.performanceClient.addQueueMeasurement(Q.InitializeSilentRequest,this.correlationId),this.performanceClient.setPreQueueTime(Q.InitializeBaseRequest,this.correlationId),r=[V({},e)],[4,this.initializeBaseRequest(e)];case 1:return[2,V.apply(void 0,[V.apply(void 0,r.concat([n.sent()])),{account:t,forceRefresh:e.forceRefresh||!1}])]}}))}))},t}($r),cn=function(e){function t(t,r,n,o,i,a,s,c,u,l,d,h){var p=e.call(this,t,r,n,o,i,a,c,u,h)||this;return p.apiId=s,p.accountId=l,p.nativeMessageHandler=u,p.nativeStorageManager=d,p.silentCacheClient=new sn(t,p.nativeStorageManager,n,o,i,a,c,u,h),p}return j(t,e),t.prototype.acquireToken=function(e){return X(this,void 0,void 0,(function(){var t,r,n,o,i,a,s;return Z(this,(function(c){switch(c.label){case 0:return this.logger.trace("NativeInteractionClient - acquireToken called."),t=this.performanceClient.startMeasurement(Q.NativeInteractionClientAcquireToken,e.correlationId),r=or.nowSeconds(),[4,this.initializeNativeRequest(e)];case 1:n=c.sent(),c.label=2;case 2:return c.trys.push([2,4,,5]),[4,this.acquireTokensFromCache(this.accountId,n)];case 3:return o=c.sent(),t.endMeasurement({success:!0,isNativeBroker:!1,fromCache:!0}),[2,o];case 4:return c.sent(),this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call"),[3,5];case 5:return i={method:Ke.GetToken,request:n},[4,this.nativeMessageHandler.sendMessage(i)];case 6:return a=c.sent(),s=this.validateNativeResponse(a),[2,this.handleNativeResponse(s,n,r).then((function(e){return t.endMeasurement({success:!0,isNativeBroker:!0,requestId:e.requestId}),e})).catch((function(e){throw t.endMeasurement({success:!1,errorCode:e.errorCode,subErrorCode:e.subError,isNativeBroker:!0}),e}))]}}))}))},t.prototype.createSilentCacheRequest=function(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:Jt.fromString(e.scope).asArray(),account:t,forceRefresh:!1}},t.prototype.acquireTokensFromCache=function(e,t){return X(this,void 0,void 0,(function(){var r,n;return Z(this,(function(o){switch(o.label){case 0:if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),_t.createNoAccountFoundError();if(!(r=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:e})))throw _t.createNoAccountFoundError();o.label=1;case 1:return o.trys.push([1,3,,4]),n=this.createSilentCacheRequest(t,r),[4,this.silentCacheClient.acquireToken(n)];case 2:return[2,o.sent()];case 3:throw o.sent();case 4:return[2]}}))}))},t.prototype.acquireTokenRedirect=function(e){return X(this,void 0,void 0,(function(){var t,r,n,o,i,a;return Z(this,(function(s){switch(s.label){case 0:return this.logger.trace("NativeInteractionClient - acquireTokenRedirect called."),[4,this.initializeNativeRequest(e)];case 1:t=s.sent(),r={method:Ke.GetToken,request:t},s.label=2;case 2:return s.trys.push([2,4,,5]),[4,this.nativeMessageHandler.sendMessage(r)];case 3:return n=s.sent(),this.validateNativeResponse(n),[3,5];case 4:if((o=s.sent())instanceof nn&&o.isFatal())throw o;return[3,5];case 5:return this.browserStorage.setTemporaryCache(We.NATIVE_REQUEST,JSON.stringify(t),!0),i={apiId:Ye.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},a=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri),[4,this.navigationClient.navigateExternal(a,i)];case 6:return s.sent(),[2]}}))}))},t.prototype.handleRedirectPromise=function(){return X(this,void 0,void 0,(function(){var e,t,r,n,o,i,a,s;return Z(this,(function(c){switch(c.label){case 0:if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(e=this.browserStorage.getCachedNativeRequest()))return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),[2,null];t=e.prompt,r=J(e,["prompt"]),t&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(We.NATIVE_REQUEST)),n={method:Ke.GetToken,request:r},o=or.nowSeconds(),c.label=1;case 1:return c.trys.push([1,3,,4]),this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker."),[4,this.nativeMessageHandler.sendMessage(n)];case 2:return i=c.sent(),this.validateNativeResponse(i),a=this.handleNativeResponse(i,r,o),this.browserStorage.setInteractionInProgress(!1),[2,a];case 3:throw s=c.sent(),this.browserStorage.setInteractionInProgress(!1),s;case 4:return[2]}}))}))},t.prototype.logout=function(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")},t.prototype.handleNativeResponse=function(e,t,r){return X(this,void 0,void 0,(function(){var n,o,i,a,s,c;return Z(this,(function(u){switch(u.label){case 0:if(this.logger.trace("NativeInteractionClient - handleNativeResponse called."),e.account.id!==t.accountId)throw nn.createUserSwitchError();return[4,this.getDiscoveredAuthority(t.authority)];case 1:return n=u.sent(),o=n.getPreferredCache(),i=this.createIdTokenObj(e),a=this.createHomeAccountIdentifier(e,i),s=this.createAccountEntity(e,a,i,o),[4,this.generateAuthenticationResult(e,t,i,s,n.canonicalAuthority,r)];case 2:return c=u.sent(),this.cacheAccount(s),this.cacheNativeTokens(e,t,a,i,c.accessToken,c.tenantId,r),[2,c]}}))}))},t.prototype.createIdTokenObj=function(e){return new tr(e.id_token||pe.EMPTY_STRING,this.browserCrypto)},t.prototype.createHomeAccountIdentifier=function(e,t){return er.generateHomeAccountId(e.client_info||pe.EMPTY_STRING,Bt.Default,this.logger,this.browserCrypto,t)},t.prototype.createAccountEntity=function(e,t,r,n){return er.createAccount(e.client_info,t,r,void 0,void 0,void 0,n,e.account.id)},t.prototype.generateScopes=function(e,t){return e.scope?Jt.fromString(e.scope):Jt.fromString(t.scope)},t.prototype.generatePopAccessToken=function(e,t){return X(this,void 0,void 0,(function(){var r,n;return Z(this,(function(o){switch(o.label){case 0:if(t.tokenType!==Ae.POP)return[3,2];if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),[2,e.shr];if(r=new Br(this.browserCrypto),n={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce},!t.keyId)throw _t.createKeyIdMissingError();return[4,r.signPopToken(e.access_token,t.keyId,n)];case 1:return[2,o.sent()];case 2:return[2,e.access_token]}}))}))},t.prototype.generateAuthenticationResult=function(e,t,r,n,o,i){return X(this,void 0,void 0,(function(){var a,s,c,u,l,d,h;return Z(this,(function(p){switch(p.label){case 0:return a=this.addTelemetryFromNativeResponse(e),s=e.scope?Jt.fromString(e.scope):Jt.fromString(t.scope),c=e.account.properties||{},u=c.UID||r.claims.oid||r.claims.sub||pe.EMPTY_STRING,l=c.TenantId||r.claims.tid||pe.EMPTY_STRING,[4,this.generatePopAccessToken(e,t)];case 1:return d=p.sent(),h=t.tokenType===Ae.POP?Ae.POP:Ae.BEARER,[2,{authority:o,uniqueId:u,tenantId:l,scopes:s.asArray(),account:n.getAccountInfo(),idToken:e.id_token,idTokenClaims:r.claims,accessToken:d,fromCache:!!a&&this.isResponseFromCache(a),expiresOn:new Date(1e3*Number(i+e.expires_in)),tokenType:h,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}]}}))}))},t.prototype.cacheAccount=function(e){var t=this;this.browserStorage.setAccount(e),this.browserStorage.removeAccountContext(e).catch((function(e){t.logger.error("Error occurred while removing account context from browser storage. "+e)}))},t.prototype.cacheNativeTokens=function(e,t,r,n,o,i,a){var s=Qt.createIdTokenEntity(r,t.authority,e.id_token||pe.EMPTY_STRING,t.clientId,n.claims.tid||pe.EMPTY_STRING);this.nativeStorageManager.setIdTokenCredential(s);var c=a+(t.tokenType===Ae.POP?pe.SHR_NONCE_VALIDITY:("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0),u=this.generateScopes(e,t),l=ir.createAccessTokenEntity(r,t.authority,o,t.clientId,i,u.printScopes(),c,0,this.browserCrypto);this.nativeStorageManager.setAccessTokenCredential(l)},t.prototype.addTelemetryFromNativeResponse=function(e){var t=this.getMATSFromResponse(e);return t?(this.performanceClient.addStaticFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null},t.prototype.validateNativeResponse=function(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw nn.createUnexpectedError("Response missing expected properties.")},t.prototype.getMATSFromResponse=function(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch(e){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null},t.prototype.isResponseFromCache=function(e){return void 0===e.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached},t.prototype.initializeNativeRequest=function(e){return X(this,void 0,void 0,(function(){var t,r,n,o,i,a,s,c,u,l=this;return Z(this,(function(d){switch(d.label){case 0:return this.logger.trace("NativeInteractionClient - initializeNativeRequest called"),t=e.authority||this.config.auth.authority,(r=new gr(t)).validateAsUri(),n=e.scopes,o=J(e,["scopes"]),(i=new Jt(n||[])).appendScopes(fe),a=function(){switch(l.apiId){case Ye.ssoSilent:case Ye.acquireTokenSilent_silentFlow:return l.logger.trace("initializeNativeRequest: silent request sets prompt to none"),ve.NONE}if(e.prompt)switch(e.prompt){case ve.NONE:case ve.CONSENT:case ve.LOGIN:return l.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw l.logger.trace("initializeNativeRequest: prompt = "+e.prompt+" is not compatible with native flow"),St.createNativePromptParameterNotSupportedError()}else l.logger.trace("initializeNativeRequest: prompt was not provided")},s=V(V({},o),{accountId:this.accountId,clientId:this.config.auth.clientId,authority:r.urlString,scope:i.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:a(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:V(V(V({},e.extraQueryParameters),e.tokenQueryParameters),{telemetry:st}),extendedExpiryToken:!1}),e.authenticationScheme!==Ae.POP?[3,2]:(c={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},[4,new Br(this.browserCrypto).generateCnf(c)]);case 1:u=d.sent(),s.reqCnf=u.reqCnfHash,s.keyId=u.kid,d.label=2;case 2:return[2,s]}}))}))},t}(Zr),un=function(){function e(e,t,r,n){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=n,this.resolvers=new Map,this.handshakeResolvers=new Map,this.responseId=0,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=r,this.handshakeEvent=r.startMeasurement(Q.NativeMessageHandlerHandshake)}return e.prototype.sendMessage=function(e){return X(this,void 0,void 0,(function(){var t,r=this;return Z(this,(function(n){return this.logger.trace("NativeMessageHandler - sendMessage called."),t={channel:it,extensionId:this.extensionId,responseId:this.responseId++,body:e},this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii("NativeMessageHandler - Sending request to browser extension: "+JSON.stringify(t)),this.messageChannel.port1.postMessage(t),[2,new Promise((function(e,n){r.resolvers.set(t.responseId,{resolve:e,reject:n})}))]}))}))},e.createProvider=function(t,r,n){return X(this,void 0,void 0,(function(){var o,i;return Z(this,(function(a){switch(a.label){case 0:t.trace("NativeMessageHandler - createProvider called."),a.label=1;case 1:return a.trys.push([1,3,,5]),[4,(o=new e(t,r,n,at)).sendHandshakeRequest()];case 2:return a.sent(),[2,o];case 3:return a.sent(),[4,(i=new e(t,r,n)).sendHandshakeRequest()];case 4:return a.sent(),[2,i];case 5:return[2]}}))}))},e.prototype.sendHandshakeRequest=function(){return X(this,void 0,void 0,(function(){var e,t=this;return Z(this,(function(r){return this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1),e={channel:it,extensionId:this.extensionId,responseId:this.responseId++,body:{method:Ke.HandshakeRequest}},this.handshakeEvent.addStaticFields({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=function(e){t.onChannelMessage(e)},window.postMessage(e,window.origin,[this.messageChannel.port2]),[2,new Promise((function(r,n){t.handshakeResolvers.set(e.responseId,{resolve:r,reject:n}),t.timeoutId=window.setTimeout((function(){window.removeEventListener("message",t.windowListener,!1),t.messageChannel.port1.close(),t.messageChannel.port2.close(),t.handshakeEvent.endMeasurement({extensionHandshakeTimedOut:!0,success:!1}),n(St.createNativeHandshakeTimeoutError()),t.handshakeResolvers.delete(e.responseId)}),t.handshakeTimeoutMs)}))]}))}))},e.prototype.onWindowMessage=function(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source===window){var t=e.data;if(t.channel&&t.channel===it&&(!t.extensionId||t.extensionId===this.extensionId)&&t.body.method===Ke.HandshakeRequest){this.logger.verbose(t.extensionId?"Extension with id: "+t.extensionId+" not installed":"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1);var r=this.handshakeResolvers.get(t.responseId);r&&(this.handshakeEvent.endMeasurement({success:!1,extensionInstalled:!1}),r.reject(St.createNativeExtensionNotInstalledError()))}}},e.prototype.onChannelMessage=function(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");var t=e.data,r=this.resolvers.get(t.responseId),n=this.handshakeResolvers.get(t.responseId);try{var o=t.body.method;if(o===Ke.Response){if(!r)return;var i=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii("NativeMessageHandler - Received response from browser extension: "+JSON.stringify(i)),"Success"!==i.status)r.reject(nn.createError(i.code,i.description,i.ext));else{if(!i.result)throw Ze.createUnexpectedError("Event does not contain result.");i.result.code&&i.result.description?r.reject(nn.createError(i.result.code,i.result.description,i.result.ext)):r.resolve(i.result)}this.resolvers.delete(t.responseId)}else if(o===Ke.HandshakeResponse){if(!n)return;clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose("NativeMessageHandler - Received HandshakeResponse from extension: "+this.extensionId),this.handshakeEvent.endMeasurement({extensionInstalled:!0,success:!0}),n.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(t){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii("Error parsing response from WAM Extension: "+t.toString()),this.logger.errorPii("Unable to parse "+e),r?r.reject(t):n&&n.reject(t)}},e.prototype.getExtensionId=function(){return this.extensionId},e.prototype.getExtensionVersion=function(){return this.extensionVersion},e.isNativeAvailable=function(e,t,r,n){if(t.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return t.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!r)return t.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(n)switch(n){case Ae.BEARER:case Ae.POP:return t.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0},e}(),ln=function(){function e(e,t,r,n,o){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.logger=n,this.performanceClient=o}return e.prototype.handleCodeResponseFromHash=function(e,t,r,n){return X(this,void 0,void 0,(function(){var o,i,a;return Z(this,(function(s){if(this.performanceClient.addQueueMeasurement(Q.HandleCodeResponseFromHash,this.authCodeRequest.correlationId),this.logger.verbose("InteractionHandler.handleCodeResponse called"),It.isEmpty(e))throw St.createEmptyHashError(e);if(o=this.browserStorage.generateStateKey(t),!(i=this.browserStorage.getTemporaryCache(o)))throw _t.createStateNotFoundError("Cached State");try{a=this.authModule.handleFragmentResponse(e,i)}catch(e){throw e instanceof $e&&e.subError===wt.userCancelledError.code?St.createUserCancelledError():e}return this.performanceClient.setPreQueueTime(Q.HandleCodeResponseFromServer,this.authCodeRequest.correlationId),[2,this.handleCodeResponseFromServer(a,t,r,n)]}))}))},e.prototype.handleCodeResponseFromServer=function(e,t,r,n,o){return void 0===o&&(o=!0),X(this,void 0,void 0,(function(){var i,a,s,c,u,l;return Z(this,(function(d){switch(d.label){case 0:if(this.performanceClient.addQueueMeasurement(Q.HandleCodeResponseFromServer,this.authCodeRequest.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),i=this.browserStorage.generateStateKey(t),!(a=this.browserStorage.getTemporaryCache(i)))throw _t.createStateNotFoundError("Cached State");return s=this.browserStorage.generateNonceKey(a),c=this.browserStorage.getTemporaryCache(s),this.authCodeRequest.code=e.code,e.cloud_instance_host_name?(this.performanceClient.setPreQueueTime(Q.UpdateTokenEndpointAuthority,this.authCodeRequest.correlationId),[4,this.updateTokenEndpointAuthority(e.cloud_instance_host_name,r,n)]):[3,2];case 1:d.sent(),d.label=2;case 2:return o&&(e.nonce=c||void 0),e.state=a,e.client_info?this.authCodeRequest.clientInfo=e.client_info:(u=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=u),this.performanceClient.setPreQueueTime(Q.AuthClientAcquireToken,this.authCodeRequest.correlationId),[4,this.authModule.acquireToken(this.authCodeRequest,e)];case 3:return l=d.sent(),this.browserStorage.cleanRequestByState(t),[2,l]}}))}))},e.prototype.updateTokenEndpointAuthority=function(e,t,r){return X(this,void 0,void 0,(function(){var n,o;return Z(this,(function(i){switch(i.label){case 0:return this.performanceClient.addQueueMeasurement(Q.UpdateTokenEndpointAuthority,this.authCodeRequest.correlationId),n="https://"+e+"/"+t.tenant+"/",[4,Jr.createDiscoveredInstance(n,r,this.browserStorage,t.options,this.logger,this.performanceClient,this.authCodeRequest.correlationId)];case 1:return o=i.sent(),this.authModule.updateAuthority(o),[2]}}))}))},e.prototype.checkCcsCredentials=function(){var e=this.browserStorage.getTemporaryCache(We.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch(t){this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii("Cache credential could not be parsed: "+e)}return null},e}(),dn=function(e){function t(t,r,n,o,i,a,s,c,u,l){var d=e.call(this,t,r,n,o,i,a,s,u,l)||this;return d.unloadWindow=d.unloadWindow.bind(d),d.nativeStorage=c,d}return j(t,e),t.prototype.acquireToken=function(e){try{var t=this.generatePopupName(e.scopes||fe,e.authority||this.config.auth.authority),r=e.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,t,r);this.logger.verbose("asyncPopup set to false, opening popup before acquiring token");var n=this.openSizedPopup("about:blank",t,r);return this.acquireTokenPopupAsync(e,t,r,n)}catch(e){return Promise.reject(e)}},t.prototype.logout=function(e){try{this.logger.verbose("logoutPopup called");var t=this.initializeLogoutRequest(e),r=this.generateLogoutPopupName(t),n=e&&e.authority,o=e&&e.mainWindowRedirectUri,i=(null==e?void 0:e.popupWindowAttributes)||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,r,i,n,void 0,o);this.logger.verbose("asyncPopup set to false, opening popup");var a=this.openSizedPopup("about:blank",r,i);return this.logoutPopupAsync(t,r,i,n,a,o)}catch(e){return Promise.reject(e)}},t.prototype.acquireTokenPopupAsync=function(e,t,r,n){return X(this,void 0,void 0,(function(){var o,i,a,s,c,u,l,d,h,p,f,g,m,v,y,C,T=this;return Z(this,(function(E){switch(E.label){case 0:return this.logger.verbose("acquireTokenPopupAsync called"),o=this.initializeServerTelemetryManager(Ye.acquireTokenPopup),this.performanceClient.setPreQueueTime(Q.StandardInteractionClientInitializeAuthorizationRequest,e.correlationId),[4,this.initializeAuthorizationRequest(e,Ve.Popup)];case 1:i=E.sent(),this.browserStorage.updateCacheEntries(i.state,i.nonce,i.authority,i.loginHint||pe.EMPTY_STRING,i.account||null),E.label=2;case 2:return E.trys.push([2,8,,9]),this.performanceClient.setPreQueueTime(Q.StandardInteractionClientInitializeAuthorizationCodeRequest,e.correlationId),[4,this.initializeAuthorizationCodeRequest(i)];case 3:return a=E.sent(),this.performanceClient.setPreQueueTime(Q.StandardInteractionClientCreateAuthCodeClient,e.correlationId),[4,this.createAuthCodeClient(o,i.authority,i.azureCloudOptions)];case 4:return s=E.sent(),this.logger.verbose("Auth code client created"),c=un.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme),u=void 0,c&&(u=this.performanceClient.startMeasurement(Q.FetchAccountIdWithNativeBroker,e.correlationId)),[4,s.getAuthCodeUrl(V(V({},i),{nativeBroker:c}))];case 5:return l=E.sent(),d=new ln(s,this.browserStorage,a,this.logger,this.performanceClient),h={popup:n,popupName:t,popupWindowAttributes:r},p=this.initiateAuthRequest(l,h),this.eventHandler.emitEvent(Nr.POPUP_OPENED,Ve.Popup,{popupWindow:p},null),[4,this.monitorPopupForHash(p)];case 6:if(f=E.sent(),g=gr.getDeserializedHash(f),m=this.validateAndExtractStateFromHash(g,Ve.Popup,i.correlationId),Ur.removeThrottle(this.browserStorage,this.config.auth.clientId,a),g.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),u&&u.endMeasurement({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw St.createNativeConnectionNotEstablishedError();return v=new cn(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ye.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,g.accountId,this.nativeStorage,i.correlationId),y=dr.parseRequestState(this.browserCrypto,m).userRequestState,[2,v.acquireToken(V(V({},i),{state:y,prompt:void 0})).finally((function(){T.browserStorage.cleanRequestByState(m)}))]}return[4,d.handleCodeResponseFromHash(f,m,s.authority,this.networkClient)];case 7:return[2,E.sent()];case 8:throw C=E.sent(),n&&n.close(),C instanceof Ze&&C.setCorrelationId(this.correlationId),o.cacheFailedRequest(C),this.browserStorage.cleanRequestByState(i.state),C;case 9:return[2]}}))}))},t.prototype.logoutPopupAsync=function(e,t,r,n,o,i){return X(this,void 0,void 0,(function(){var a,s,c,u,l,d,h;return Z(this,(function(p){switch(p.label){case 0:this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(Nr.LOGOUT_START,Ve.Popup,e),a=this.initializeServerTelemetryManager(Ye.logoutPopup),p.label=1;case 1:return p.trys.push([1,5,,6]),[4,this.clearCacheOnLogout(e.account)];case 2:return p.sent(),this.performanceClient.setPreQueueTime(Q.StandardInteractionClientCreateAuthCodeClient,e.correlationId),[4,this.createAuthCodeClient(a,n)];case 3:return s=p.sent(),this.logger.verbose("Auth code client created"),c=s.getLogoutUri(e),this.eventHandler.emitEvent(Nr.LOGOUT_SUCCESS,Ve.Popup,e),u=this.openPopup(c,{popupName:t,popupWindowAttributes:r,popup:o}),this.eventHandler.emitEvent(Nr.POPUP_OPENED,Ve.Popup,{popupWindow:u},null),[4,this.waitForLogoutPopup(u)];case 4:return p.sent(),i?(l={apiId:Ye.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},d=gr.getAbsoluteUrl(i,Ar.getCurrentUri()),this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii("Redirecting main window to: "+d),this.navigationClient.navigateInternal(d,l)):this.logger.verbose("No main window navigation requested"),[3,6];case 5:throw h=p.sent(),o&&o.close(),h instanceof Ze&&h.setCorrelationId(this.correlationId),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(Nr.LOGOUT_FAILURE,Ve.Popup,null,h),this.eventHandler.emitEvent(Nr.LOGOUT_END,Ve.Popup),a.cacheFailedRequest(h),h;case 6:return this.eventHandler.emitEvent(Nr.LOGOUT_END,Ve.Popup),[2]}}))}))},t.prototype.initiateAuthRequest=function(e,t){if(It.isEmpty(e))throw this.logger.error("Navigate url is empty"),St.createEmptyNavigationUriError();return this.logger.infoPii("Navigate to: "+e),this.openPopup(e,t)},t.prototype.monitorPopupForHash=function(e){var t=this;return new Promise((function(r,n){var o=t.config.system.windowHashTimeout/t.config.system.pollIntervalMilliseconds,i=0;t.logger.verbose("PopupHandler.monitorPopupForHash - polling started");var a=setInterval((function(){if(e.closed)return t.logger.error("PopupHandler.monitorPopupForHash - window closed"),t.cleanPopup(),clearInterval(a),void n(St.createUserCancelledError());var s=pe.EMPTY_STRING,c=pe.EMPTY_STRING;try{s=e.location.href,c=e.location.hash}catch(e){}It.isEmpty(s)||"about:blank"===s||(t.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),i++,c?(t.logger.verbose("PopupHandler.monitorPopupForHash - found hash in url"),clearInterval(a),t.cleanPopup(e),gr.hashContainsKnownProperties(c)?(t.logger.verbose("PopupHandler.monitorPopupForHash - hash contains known properties, returning."),r(c)):(t.logger.error("PopupHandler.monitorPopupForHash - found hash in url but it does not contain known properties. Check that your router is not changing the hash prematurely."),t.logger.errorPii("PopupHandler.monitorPopupForHash - hash found: "+c),n(St.createHashDoesNotContainKnownPropertiesError()))):i>o&&(t.logger.error("PopupHandler.monitorPopupForHash - unable to find hash in url, timing out"),clearInterval(a),n(St.createMonitorPopupTimeoutError())))}),t.config.system.pollIntervalMilliseconds)}))},t.prototype.waitForLogoutPopup=function(e){var t=this;return new Promise((function(r){t.logger.verbose("PopupHandler.waitForLogoutPopup - polling started");var n=setInterval((function(){e.closed&&(t.logger.error("PopupHandler.waitForLogoutPopup - window closed"),t.cleanPopup(),clearInterval(n),r());var o=pe.EMPTY_STRING;try{o=e.location.href}catch(e){}It.isEmpty(o)||"about:blank"===o||(t.logger.verbose("PopupHandler.waitForLogoutPopup - popup window is on same origin as caller, closing."),clearInterval(n),t.cleanPopup(e),r())}),t.config.system.pollIntervalMilliseconds)}))},t.prototype.openPopup=function(e,t){try{var r=void 0;if(t.popup?(r=t.popup,this.logger.verbosePii("Navigating popup window to: "+e),r.location.assign(e)):void 0===t.popup&&(this.logger.verbosePii("Opening popup window to: "+e),r=this.openSizedPopup(e,t.popupName,t.popupWindowAttributes)),!r)throw St.createEmptyWindowCreatedError();return r.focus&&r.focus(),this.currentWindow=r,window.addEventListener("beforeunload",this.unloadWindow),r}catch(e){throw this.logger.error("error opening popup "+e.message),this.browserStorage.setInteractionInProgress(!1),St.createPopupWindowError(e.toString())}},t.prototype.openSizedPopup=function(e,t,r){var n,o,i,a,s=window.screenLeft?window.screenLeft:window.screenX,c=window.screenTop?window.screenTop:window.screenY,u=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,l=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,d=null===(n=r.popupSize)||void 0===n?void 0:n.width,h=null===(o=r.popupSize)||void 0===o?void 0:o.height,p=null===(i=r.popupPosition)||void 0===i?void 0:i.top,f=null===(a=r.popupPosition)||void 0===a?void 0:a.left;return(!d||d<0||d>u)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),d=ot.POPUP_WIDTH),(!h||h<0||h>l)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),h=ot.POPUP_HEIGHT),(!p||p<0||p>l)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),p=Math.max(0,l/2-ot.POPUP_HEIGHT/2+c)),(!f||f<0||f>u)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),f=Math.max(0,u/2-ot.POPUP_WIDTH/2+s)),window.open(e,t,"width="+d+", height="+h+", top="+p+", left="+f+", scrollbars=yes")},t.prototype.unloadWindow=function(e){this.browserStorage.cleanRequestByInteractionType(Ve.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()},t.prototype.cleanPopup=function(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)},t.prototype.generatePopupName=function(e,t){return ot.POPUP_NAME_PREFIX+"."+this.config.auth.clientId+"."+e.join("-")+"."+t+"."+this.correlationId},t.prototype.generateLogoutPopupName=function(e){var t=e.account&&e.account.homeAccountId;return ot.POPUP_NAME_PREFIX+"."+this.config.auth.clientId+"."+t+"."+this.correlationId},t}($r),hn=function(e){function t(t,r,n,o,i,a){var s=e.call(this,t,r,n,o,a)||this;return s.browserCrypto=i,s}return j(t,e),t.prototype.initiateAuthRequest=function(e,t){return X(this,void 0,void 0,(function(){var r;return Z(this,(function(n){switch(n.label){case 0:return this.logger.verbose("RedirectHandler.initiateAuthRequest called"),It.isEmpty(e)?[3,7]:(t.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(We.ORIGIN_URI,t.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(We.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest,this.browserCrypto),this.logger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: "+e),r={apiId:Ye.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1},"function"!=typeof t.onRedirectNavigate?[3,4]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1===t.onRedirectNavigate(e)?[3,2]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),[4,t.navigationClient.navigateExternal(e,r)])));case 1:return n.sent(),[2];case 2:return this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation"),[2];case 3:return[3,6];case 4:return this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),[4,t.navigationClient.navigateExternal(e,r)];case 5:return n.sent(),[2];case 6:return[3,8];case 7:throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),St.createEmptyNavigationUriError();case 8:return[2]}}))}))},t.prototype.handleCodeResponseFromHash=function(e,t,r,n){return X(this,void 0,void 0,(function(){var o,i,a,s,c,u,l;return Z(this,(function(d){switch(d.label){case 0:if(this.logger.verbose("RedirectHandler.handleCodeResponse called"),It.isEmpty(e))throw St.createEmptyHashError(e);if(this.browserStorage.setInteractionInProgress(!1),o=this.browserStorage.generateStateKey(t),!(i=this.browserStorage.getTemporaryCache(o)))throw _t.createStateNotFoundError("Cached State");try{a=this.authModule.handleFragmentResponse(e,i)}catch(e){throw e instanceof $e&&e.subError===wt.userCancelledError.code?St.createUserCancelledError():e}return s=this.browserStorage.generateNonceKey(i),c=this.browserStorage.getTemporaryCache(s),this.authCodeRequest.code=a.code,a.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(a.cloud_instance_host_name,r,n)]:[3,2];case 1:d.sent(),d.label=2;case 2:return a.nonce=c||void 0,a.state=i,a.client_info?this.authCodeRequest.clientInfo=a.client_info:(u=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=u),[4,this.authModule.acquireToken(this.authCodeRequest,a)];case 3:return l=d.sent(),this.browserStorage.cleanRequestByState(t),[2,l]}}))}))},t}(ln),pn=function(e){function t(t,r,n,o,i,a,s,c,u,l){var d=e.call(this,t,r,n,o,i,a,s,u,l)||this;return d.nativeStorage=c,d}return j(t,e),t.prototype.acquireToken=function(e){return X(this,void 0,void 0,(function(){var t,r,n,o,i,a,s,c,u,l=this;return Z(this,(function(d){switch(d.label){case 0:return this.performanceClient.setPreQueueTime(Q.StandardInteractionClientInitializeAuthorizationRequest,e.correlationId),[4,this.initializeAuthorizationRequest(e,Ve.Redirect)];case 1:t=d.sent(),this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||pe.EMPTY_STRING,t.account||null),r=this.initializeServerTelemetryManager(Ye.acquireTokenRedirect),n=function(e){e.persisted&&(l.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),l.browserStorage.cleanRequestByState(t.state))},d.label=2;case 2:return d.trys.push([2,7,,8]),this.performanceClient.setPreQueueTime(Q.StandardInteractionClientInitializeAuthorizationCodeRequest,e.correlationId),[4,this.initializeAuthorizationCodeRequest(t)];case 3:return o=d.sent(),this.performanceClient.setPreQueueTime(Q.StandardInteractionClientCreateAuthCodeClient,e.correlationId),[4,this.createAuthCodeClient(r,t.authority,t.azureCloudOptions)];case 4:return i=d.sent(),this.logger.verbose("Auth code client created"),a=new hn(i,this.browserStorage,o,this.logger,this.browserCrypto,this.performanceClient),[4,i.getAuthCodeUrl(V(V({},t),{nativeBroker:un.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme)}))];case 5:return s=d.sent(),c=this.getRedirectStartPage(e.redirectStartPage),this.logger.verbosePii("Redirect start page: "+c),window.addEventListener("pageshow",n),[4,a.initiateAuthRequest(s,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:c,onRedirectNavigate:e.onRedirectNavigate})];case 6:return[2,d.sent()];case 7:throw(u=d.sent())instanceof Ze&&u.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",n),r.cacheFailedRequest(u),this.browserStorage.cleanRequestByState(t.state),u;case 8:return[2]}}))}))},t.prototype.handleRedirectPromise=function(e){return X(this,void 0,void 0,(function(){var t,r,n,o,i,a,s,c,u,l,d,h;return Z(this,(function(p){switch(p.label){case 0:t=this.initializeServerTelemetryManager(Ye.handleRedirectPromise),p.label=1;case 1:if(p.trys.push([1,10,,11]),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(r=this.getRedirectResponseHash(e||window.location.hash)))return this.logger.info("handleRedirectPromise did not detect a response hash as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(Ve.Redirect),[2,null];n=void 0;try{o=gr.getDeserializedHash(r),n=this.validateAndExtractStateFromHash(o,Ve.Redirect),this.logger.verbose("State extracted from hash")}catch(e){return this.logger.info("handleRedirectPromise was unable to extract state due to: "+e),this.browserStorage.cleanRequestByInteractionType(Ve.Redirect),[2,null]}return i=this.browserStorage.getTemporaryCache(We.ORIGIN_URI,!0)||pe.EMPTY_STRING,a=gr.removeHashFromUrl(i),s=gr.removeHashFromUrl(window.location.href),a===s&&this.config.auth.navigateToLoginRequestUrl?(this.logger.verbose("Current page is loginRequestUrl, handling hash"),[4,this.handleHash(r,n,t)]):[3,3];case 2:return c=p.sent(),i.indexOf("#")>-1&&Ar.replaceHash(i),[2,c];case 3:return this.config.auth.navigateToLoginRequestUrl?[3,4]:(this.logger.verbose("NavigateToLoginRequestUrl set to false, handling hash"),[2,this.handleHash(r,n,t)]);case 4:return Ar.isInIframe()&&!this.config.system.allowRedirectInIframe?[3,9]:(this.browserStorage.setTemporaryCache(We.URL_HASH,r,!0),u={apiId:Ye.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},l=!0,i&&"null"!==i?[3,6]:(d=Ar.getHomepage(),this.browserStorage.setTemporaryCache(We.ORIGIN_URI,d,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),[4,this.navigationClient.navigateInternal(d,u)]));case 5:return l=p.sent(),[3,8];case 6:return this.logger.verbose("Navigating to loginRequestUrl: "+i),[4,this.navigationClient.navigateInternal(i,u)];case 7:l=p.sent(),p.label=8;case 8:if(!l)return[2,this.handleHash(r,n,t)];p.label=9;case 9:return[2,null];case 10:throw(h=p.sent())instanceof Ze&&h.setCorrelationId(this.correlationId),t.cacheFailedRequest(h),this.browserStorage.cleanRequestByInteractionType(Ve.Redirect),h;case 11:return[2]}}))}))},t.prototype.getRedirectResponseHash=function(e){if(this.logger.verbose("getRedirectResponseHash called"),gr.hashContainsKnownProperties(e))return Ar.clearHash(window),this.logger.verbose("Hash contains known properties, returning response hash"),e;var t=this.browserStorage.getTemporaryCache(We.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(We.URL_HASH)),this.logger.verbose("Hash does not contain known properties, returning cached hash"),t},t.prototype.handleHash=function(e,t,r){return X(this,void 0,void 0,(function(){var n,o,i,a,s,c,u=this;return Z(this,(function(l){switch(l.label){case 0:if(n=this.browserStorage.getCachedRequest(t,this.browserCrypto),this.logger.verbose("handleHash called, retrieved cached request"),(o=gr.getDeserializedHash(e)).accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw St.createNativeConnectionNotEstablishedError();return i=new cn(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ye.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,o.accountId,this.browserStorage,n.correlationId),a=dr.parseRequestState(this.browserCrypto,t).userRequestState,[2,i.acquireToken(V(V({},n),{state:a,prompt:void 0})).finally((function(){u.browserStorage.cleanRequestByState(t)}))]}if(!(s=this.browserStorage.getCachedAuthority(t)))throw St.createNoCachedAuthorityError();return this.performanceClient.setPreQueueTime(Q.StandardInteractionClientCreateAuthCodeClient,n.correlationId),[4,this.createAuthCodeClient(r,s)];case 1:return c=l.sent(),this.logger.verbose("Auth code client created"),Ur.removeThrottle(this.browserStorage,this.config.auth.clientId,n),[4,new hn(c,this.browserStorage,n,this.logger,this.browserCrypto,this.performanceClient).handleCodeResponseFromHash(e,t,c.authority,this.networkClient)];case 2:return[2,l.sent()]}}))}))},t.prototype.logout=function(e){return X(this,void 0,void 0,(function(){var t,r,n,o,i,a;return Z(this,(function(s){switch(s.label){case 0:this.logger.verbose("logoutRedirect called"),t=this.initializeLogoutRequest(e),r=this.initializeServerTelemetryManager(Ye.logout),s.label=1;case 1:return s.trys.push([1,10,,11]),this.eventHandler.emitEvent(Nr.LOGOUT_START,Ve.Redirect,e),[4,this.clearCacheOnLogout(t.account)];case 2:return s.sent(),n={apiId:Ye.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},this.performanceClient.setPreQueueTime(Q.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(r,e&&e.authority)];case 3:return o=s.sent(),this.logger.verbose("Auth code client created"),i=o.getLogoutUri(t),this.eventHandler.emitEvent(Nr.LOGOUT_SUCCESS,Ve.Redirect,t),e&&"function"==typeof e.onRedirectNavigate?!1===e.onRedirectNavigate(i)?[3,5]:(this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(i,n)]):[3,7];case 4:return s.sent(),[2];case 5:this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation"),s.label=6;case 6:return[3,9];case 7:return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(i,n)];case 8:return s.sent(),[2];case 9:return[3,11];case 10:throw(a=s.sent())instanceof Ze&&a.setCorrelationId(this.correlationId),r.cacheFailedRequest(a),this.eventHandler.emitEvent(Nr.LOGOUT_FAILURE,Ve.Redirect,null,a),this.eventHandler.emitEvent(Nr.LOGOUT_END,Ve.Redirect),a;case 11:return this.eventHandler.emitEvent(Nr.LOGOUT_END,Ve.Redirect),[2]}}))}))},t.prototype.getRedirectStartPage=function(e){var t=e||window.location.href;return gr.getAbsoluteUrl(t,Ar.getCurrentUri())},t}($r),fn=function(e){function t(t,r,n,o,i,a){var s=e.call(this,t,r,n,o,a)||this;return s.navigateFrameWait=i.navigateFrameWait,s.pollIntervalMilliseconds=i.pollIntervalMilliseconds,s}return j(t,e),t.prototype.initiateAuthRequest=function(e){return X(this,void 0,void 0,(function(){return Z(this,(function(t){switch(t.label){case 0:if(this.performanceClient.addQueueMeasurement(Q.SilentHandlerInitiateAuthRequest,this.authCodeRequest.correlationId),It.isEmpty(e))throw this.logger.info("Navigate url is empty"),St.createEmptyNavigationUriError();return this.navigateFrameWait?(this.performanceClient.setPreQueueTime(Q.SilentHandlerLoadFrame,this.authCodeRequest.correlationId),[4,this.loadFrame(e)]):[3,2];case 1:return[2,t.sent()];case 2:return[2,this.loadFrameSync(e)]}}))}))},t.prototype.monitorIframeForHash=function(e,t){var r=this;return this.performanceClient.addQueueMeasurement(Q.SilentHandlerMonitorIframeForHash,this.authCodeRequest.correlationId),new Promise((function(n,o){t<Pr&&r.logger.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower ("+t+"ms) than the default ("+Pr+"ms). This may result in timeouts.");var i=window.performance.now()+t,a=setInterval((function(){if(window.performance.now()>i)return r.removeHiddenIframe(e),clearInterval(a),void o(St.createMonitorIframeTimeoutError());var t=pe.EMPTY_STRING,s=e.contentWindow;try{t=s?s.location.href:pe.EMPTY_STRING}catch(e){}if(!It.isEmpty(t)){var c=s?s.location.hash:pe.EMPTY_STRING;return gr.hashContainsKnownProperties(c)?(r.removeHiddenIframe(e),clearInterval(a),void n(c)):void 0}}),r.pollIntervalMilliseconds)}))},t.prototype.loadFrame=function(e){var t=this;return this.performanceClient.addQueueMeasurement(Q.SilentHandlerLoadFrame,this.authCodeRequest.correlationId),new Promise((function(r,n){var o=t.createHiddenIframe();setTimeout((function(){o?(o.src=e,r(o)):n("Unable to load iframe")}),t.navigateFrameWait)}))},t.prototype.loadFrameSync=function(e){var t=this.createHiddenIframe();return t.src=e,t},t.prototype.createHiddenIframe=function(){var e=document.createElement("iframe");return e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(e),e},t.prototype.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},t}(ln),gn=function(e){function t(t,r,n,o,i,a,s,c,u,l,d){var h=e.call(this,t,r,n,o,i,a,c,l,d)||this;return h.apiId=s,h.nativeStorage=u,h}return j(t,e),t.prototype.acquireToken=function(e){return X(this,void 0,void 0,(function(){var t,r,n,o,i;return Z(this,(function(a){switch(a.label){case 0:if(this.performanceClient.addQueueMeasurement(Q.SilentIframeClientAcquireToken,e.correlationId),this.logger.verbose("acquireTokenByIframe called"),t=this.performanceClient.startMeasurement(Q.SilentIframeClientAcquireToken,e.correlationId),It.isEmpty(e.loginHint)&&It.isEmpty(e.sid)&&(!e.account||It.isEmpty(e.account.username))&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request."),e.prompt&&e.prompt!==ve.NONE&&e.prompt!==ve.NO_SESSION)throw t.endMeasurement({success:!1}),St.createSilentPromptValueError(e.prompt);return this.performanceClient.setPreQueueTime(Q.StandardInteractionClientInitializeAuthorizationRequest,e.correlationId),[4,this.initializeAuthorizationRequest(V(V({},e),{prompt:e.prompt||ve.NONE}),Ve.Silent)];case 1:r=a.sent(),this.browserStorage.updateCacheEntries(r.state,r.nonce,r.authority,r.loginHint||pe.EMPTY_STRING,r.account||null),n=this.initializeServerTelemetryManager(this.apiId),a.label=2;case 2:return a.trys.push([2,5,,6]),this.performanceClient.setPreQueueTime(Q.StandardInteractionClientCreateAuthCodeClient,e.correlationId),[4,this.createAuthCodeClient(n,r.authority,r.azureCloudOptions)];case 3:return o=a.sent(),this.logger.verbose("Auth code client created"),this.performanceClient.setPreQueueTime(Q.SilentIframeClientTokenHelper,e.correlationId),[4,this.silentTokenHelper(o,r).then((function(e){return t.endMeasurement({success:!0,fromCache:!1,requestId:e.requestId}),e}))];case 4:return[2,a.sent()];case 5:throw(i=a.sent())instanceof Ze&&i.setCorrelationId(this.correlationId),n.cacheFailedRequest(i),this.browserStorage.cleanRequestByState(r.state),t.endMeasurement({errorCode:i instanceof Ze&&i.errorCode||void 0,subErrorCode:i instanceof Ze&&i.subError||void 0,success:!1}),i;case 6:return[2]}}))}))},t.prototype.logout=function(){return Promise.reject(St.createSilentLogoutUnsupportedError())},t.prototype.silentTokenHelper=function(e,t){return X(this,void 0,void 0,(function(){var r,n,o,i,a,s,c,u,l,d=this;return Z(this,(function(h){switch(h.label){case 0:return this.performanceClient.addQueueMeasurement(Q.SilentIframeClientTokenHelper,t.correlationId),this.performanceClient.setPreQueueTime(Q.StandardInteractionClientInitializeAuthorizationCodeRequest,t.correlationId),[4,this.initializeAuthorizationCodeRequest(t)];case 1:return r=h.sent(),this.performanceClient.setPreQueueTime(Q.GetAuthCodeUrl,t.correlationId),[4,e.getAuthCodeUrl(V(V({},t),{nativeBroker:un.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)}))];case 2:return n=h.sent(),o=new fn(e,this.browserStorage,r,this.logger,this.config.system,this.performanceClient),this.performanceClient.setPreQueueTime(Q.SilentHandlerInitiateAuthRequest,t.correlationId),[4,o.initiateAuthRequest(n)];case 3:return i=h.sent(),this.performanceClient.setPreQueueTime(Q.SilentHandlerMonitorIframeForHash,t.correlationId),[4,o.monitorIframeForHash(i,this.config.system.iframeHashTimeout)];case 4:if(a=h.sent(),s=gr.getDeserializedHash(a),c=this.validateAndExtractStateFromHash(s,Ve.Silent,r.correlationId),s.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw St.createNativeConnectionNotEstablishedError();return u=new cn(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,s.accountId,this.browserStorage,this.correlationId),l=dr.parseRequestState(this.browserCrypto,c).userRequestState,[2,u.acquireToken(V(V({},t),{state:l,prompt:t.prompt||ve.NONE})).finally((function(){d.browserStorage.cleanRequestByState(c)}))]}return this.performanceClient.setPreQueueTime(Q.HandleCodeResponseFromHash,t.correlationId),[2,o.handleCodeResponseFromHash(a,c,e.authority,this.networkClient)]}}))}))},t}($r),mn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return j(t,e),t.prototype.acquireToken=function(e){return X(this,void 0,void 0,(function(){var t,r,n,o,i,a=this;return Z(this,(function(s){switch(s.label){case 0:return this.performanceClient.addQueueMeasurement(Q.SilentRefreshClientAcquireToken,e.correlationId),this.performanceClient.setPreQueueTime(Q.InitializeBaseRequest,e.correlationId),r=[V({},e)],[4,this.initializeBaseRequest(e)];case 1:return t=V.apply(void 0,r.concat([s.sent()])),n=this.performanceClient.startMeasurement(Q.SilentRefreshClientAcquireToken,t.correlationId),o=this.initializeServerTelemetryManager(Ye.acquireTokenSilent_silentFlow),[4,this.createRefreshTokenClient(o,t.authority,t.azureCloudOptions)];case 2:return i=s.sent(),this.logger.verbose("Refresh token client created"),this.performanceClient.setPreQueueTime(Q.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),[2,i.acquireTokenByRefreshToken(t).then((function(e){return n.endMeasurement({success:!0,fromCache:e.fromCache,requestId:e.requestId}),e})).catch((function(e){throw e instanceof Ze&&e.setCorrelationId(a.correlationId),o.cacheFailedRequest(e),n.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e}))]}}))}))},t.prototype.logout=function(){return Promise.reject(St.createSilentLogoutUnsupportedError())},t.prototype.createRefreshTokenClient=function(e,t,r){return X(this,void 0,void 0,(function(){var n;return Z(this,(function(o){switch(o.label){case 0:return this.performanceClient.setPreQueueTime(Q.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(e,t,r)];case 1:return n=o.sent(),[2,new on(n,this.performanceClient)]}}))}))},t}($r),vn=function(){function e(e,t,r,n){this.isBrowserEnvironment="undefined"!=typeof window,this.config=e,this.storage=t,this.logger=r,this.cryptoObj=n}return e.prototype.loadExternalTokens=function(e,t,r){if(this.logger.info("TokenCache - loadExternalTokens called"),!t.id_token)throw St.createUnableToLoadTokenError("Please ensure server response includes id token.");var n,o,i=new tr(t.id_token,this.cryptoObj);if(e.account){var a=this.loadAccount(i,e.account.environment,void 0,void 0,e.account.homeAccountId);n=new xr(a,this.loadIdToken(i,a.homeAccountId,e.account.environment,e.account.tenantId),this.loadAccessToken(e,t,a.homeAccountId,e.account.environment,e.account.tenantId,r),this.loadRefreshToken(e,t,a.homeAccountId,e.account.environment))}else{if(!e.authority)throw St.createUnableToLoadTokenError("Please provide a request with an account or a request with authority.");var s=Vr.generateAuthority(e.authority,e.azureCloudOptions),c={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache};if(o=new Vr(s,this.config.system.networkClient,this.storage,c,this.logger),r.clientInfo){this.logger.trace("TokenCache - homeAccountId from options");a=this.loadAccount(i,o.hostnameAndPort,r.clientInfo,o.authorityType);n=new xr(a,this.loadIdToken(i,a.homeAccountId,o.hostnameAndPort,o.tenant),this.loadAccessToken(e,t,a.homeAccountId,o.hostnameAndPort,o.tenant,r),this.loadRefreshToken(e,t,a.homeAccountId,o.hostnameAndPort))}else{if(!t.client_info)throw St.createUnableToLoadTokenError("Please provide clientInfo in the response or options.");this.logger.trace("TokenCache - homeAccountId from response");a=this.loadAccount(i,o.hostnameAndPort,t.client_info,o.authorityType);n=new xr(a,this.loadIdToken(i,a.homeAccountId,o.hostnameAndPort,o.tenant),this.loadAccessToken(e,t,a.homeAccountId,o.hostnameAndPort,o.tenant,r),this.loadRefreshToken(e,t,a.homeAccountId,o.hostnameAndPort))}}return this.generateAuthenticationResult(e,i,n,o)},e.prototype.loadAccount=function(e,t,r,n,o){var i;if(o?i=o:void 0!==n&&r&&(i=er.generateHomeAccountId(r,n,this.logger,this.cryptoObj,e)),!i)throw St.createUnableToLoadTokenError("Unexpected missing homeAccountId");var a=r?er.createAccount(r,i,e,void 0,void 0,void 0,t):er.createGenericAccount(i,e,void 0,void 0,void 0,t);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading account"),this.storage.setAccount(a),a;throw St.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e.prototype.loadIdToken=function(e,t,r,n){var o=Qt.createIdTokenEntity(t,r,e.rawToken,this.config.auth.clientId,n);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading id token"),this.storage.setIdTokenCredential(o),o;throw St.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e.prototype.loadAccessToken=function(e,t,r,n,o,i){if(!t.access_token)return this.logger.verbose("TokenCache - No access token provided for caching"),null;if(!t.expires_in)throw St.createUnableToLoadTokenError("Please ensure server response includes expires_in value.");if(!i.extendedExpiresOn)throw St.createUnableToLoadTokenError("Please provide an extendedExpiresOn value in the options.");var a=new Jt(e.scopes).printScopes(),s=i.expiresOn||t.expires_in+(new Date).getTime()/1e3,c=i.extendedExpiresOn,u=ir.createAccessTokenEntity(r,n,t.access_token,this.config.auth.clientId,o,a,s,c,this.cryptoObj);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading access token"),this.storage.setAccessTokenCredential(u),u;throw St.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e.prototype.loadRefreshToken=function(e,t,r,n){if(!t.refresh_token)return this.logger.verbose("TokenCache - No refresh token provided for caching"),null;var o=ar.createRefreshTokenEntity(r,n,t.refresh_token,this.config.auth.clientId);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading refresh token"),this.storage.setRefreshTokenCredential(o),o;throw St.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e.prototype.generateAuthenticationResult=function(e,t,r,n){var o,i,a,s,c=pe.EMPTY_STRING,u=[],l=null;(null==r?void 0:r.accessToken)&&(c=r.accessToken.secret,u=Jt.fromString(r.accessToken.target).asArray(),l=new Date(1e3*Number(r.accessToken.expiresOn)),s=new Date(1e3*Number(r.accessToken.extendedExpiresOn)));var d=(null==t?void 0:t.claims.oid)||(null==t?void 0:t.claims.sub)||pe.EMPTY_STRING,h=(null==t?void 0:t.claims.tid)||pe.EMPTY_STRING;return{authority:n?n.canonicalAuthority:pe.EMPTY_STRING,uniqueId:d,tenantId:h,scopes:u,account:(null==r?void 0:r.account)?r.account.getAccountInfo():null,idToken:t?t.rawToken:pe.EMPTY_STRING,idTokenClaims:t?t.claims:{},accessToken:c,fromCache:!0,expiresOn:l,correlationId:e.correlationId||pe.EMPTY_STRING,requestId:pe.EMPTY_STRING,extExpiresOn:s,familyId:pe.EMPTY_STRING,tokenType:(null===(o=null==r?void 0:r.accessToken)||void 0===o?void 0:o.tokenType)||pe.EMPTY_STRING,state:pe.EMPTY_STRING,cloudGraphHostName:(null===(i=null==r?void 0:r.account)||void 0===i?void 0:i.cloudGraphHostName)||pe.EMPTY_STRING,msGraphHost:(null===(a=null==r?void 0:r.account)||void 0===a?void 0:a.msGraphHost)||pe.EMPTY_STRING,code:void 0,fromNativeBroker:!1}},e}(),yn=function(e){function t(t){var r=e.call(this,t)||this;return r.includeRedirectUri=!1,r}return j(t,e),t}(Gr),Cn=function(e){function t(t,r,n,o,i,a,s,c,u,l){var d=e.call(this,t,r,n,o,i,a,c,u,l)||this;return d.apiId=s,d}return j(t,e),t.prototype.acquireToken=function(e){return X(this,void 0,void 0,(function(){var t,r,n,o,i,a;return Z(this,(function(s){switch(s.label){case 0:if(this.logger.trace("SilentAuthCodeClient.acquireToken called"),!e.code)throw St.createAuthCodeRequiredError();return this.performanceClient.setPreQueueTime(Q.StandardInteractionClientInitializeAuthorizationRequest,e.correlationId),[4,this.initializeAuthorizationRequest(e,Ve.Silent)];case 1:t=s.sent(),this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||pe.EMPTY_STRING,t.account||null),r=this.initializeServerTelemetryManager(this.apiId),s.label=2;case 2:return s.trys.push([2,4,,5]),n=V(V({},t),{code:e.code}),this.performanceClient.setPreQueueTime(Q.StandardInteractionClientGetClientConfiguration,e.correlationId),[4,this.getClientConfiguration(r,t.authority)];case 3:return o=s.sent(),i=new yn(o),this.logger.verbose("Auth code client created"),[2,new fn(i,this.browserStorage,n,this.logger,this.config.system,this.performanceClient).handleCodeResponseFromServer({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t.state,i.authority,this.networkClient,!1)];case 4:throw(a=s.sent())instanceof Ze&&a.setCorrelationId(this.correlationId),r.cacheFailedRequest(a),this.browserStorage.cleanRequestByState(t.state),a;case 5:return[2]}}))}))},t.prototype.logout=function(){return Promise.reject(St.createSilentLogoutUnsupportedError())},t}($r),Tn=function(){function e(t,r){this.correlationId=r,this.measureName=e.makeMeasureName(t,r),this.startMark=e.makeStartMark(t,r),this.endMark=e.makeEndMark(t,r)}return e.makeMeasureName=function(e,t){return"msal.measure."+e+"."+t},e.makeStartMark=function(e,t){return"msal.start."+e+"."+t},e.makeEndMark=function(e,t){return"msal.end."+e+"."+t},e.supportsBrowserPerformance=function(){return"undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.mark&&"function"==typeof window.performance.measure&&"function"==typeof window.performance.clearMarks&&"function"==typeof window.performance.clearMeasures&&"function"==typeof window.performance.getEntriesByName},e.flushMeasurements=function(t,r){if(e.supportsBrowserPerformance())try{r.forEach((function(r){var n=e.makeMeasureName(r.name,t);window.performance.getEntriesByName(n,"measure").length>0&&(window.performance.clearMeasures(n),window.performance.clearMarks(e.makeStartMark(n,t)),window.performance.clearMarks(e.makeEndMark(n,t)))}))}catch(e){}},e.prototype.startMeasurement=function(){if(e.supportsBrowserPerformance())try{window.performance.mark(this.startMark)}catch(e){}},e.prototype.endMeasurement=function(){if(e.supportsBrowserPerformance())try{window.performance.mark(this.endMark),window.performance.measure(this.measureName,this.startMark,this.endMark)}catch(e){}},e.prototype.flushMeasurement=function(){if(e.supportsBrowserPerformance())try{var t=window.performance.getEntriesByName(this.measureName,"measure");if(t.length>0){var r=t[0].duration;return window.performance.clearMeasures(this.measureName),window.performance.clearMarks(this.startMark),window.performance.clearMarks(this.endMark),r}}catch(e){}return null},e}(),En=function(e){function t(t,r,n,o,i,a,s){var c=e.call(this,t,r,n,o,i,a)||this;return c.browserCrypto=new Ot(c.logger,s),c.guidGenerator=new vt(c.browserCrypto),c}return j(t,e),t.prototype.startPerformanceMeasuremeant=function(e,t){return new Tn(e,t)},t.prototype.generateId=function(){return this.guidGenerator.generateGuid()},t.prototype.getPageVisibility=function(){var e;return(null===(e=document.visibilityState)||void 0===e?void 0:e.toString())||null},t.prototype.deleteIncompleteSubMeasurements=function(e){var t=this.eventsByCorrelationId.get(e.event.correlationId),r=t&&t.eventId===e.event.eventId,n=[];r&&(null==t?void 0:t.incompleteSubMeasurements)&&t.incompleteSubMeasurements.forEach((function(e){n.push(V({},e))})),n.length>0&&Tn.flushMeasurements(e.event.correlationId,n)},t.prototype.supportsBrowserPerformanceNow=function(){return"undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.now},t.prototype.startMeasurement=function(t,r){var n=this,o=this.getPageVisibility(),i=e.prototype.startMeasurement.call(this,t,r);return V(V({},i),{endMeasurement:function(e){var t=i.endMeasurement(V({startPageVisibility:o,endPageVisibility:n.getPageVisibility()},e));return n.deleteIncompleteSubMeasurements(i),t},discardMeasurement:function(){i.discardMeasurement(),n.deleteIncompleteSubMeasurements(i),i.measurement.flushMeasurement()}})},t.prototype.setPreQueueTime=function(e,t){if(this.supportsBrowserPerformanceNow())if(t){var r=this.preQueueTimeByCorrelationId.get(t);r&&(this.logger.trace("BrowserPerformanceClient: Incomplete pre-queue "+r.name+" found",t),this.addQueueMeasurement(r.name,t,void 0,!0)),this.preQueueTimeByCorrelationId.set(t,{name:e,time:window.performance.now()})}else this.logger.trace("BrowserPerformanceClient: correlationId for "+e+" not provided, unable to set telemetry queue time");else this.logger.trace("BrowserPerformanceClient: window performance API not available, unable to set telemetry queue time for "+e)},t.prototype.addQueueMeasurement=function(t,r,n,o){if(this.supportsBrowserPerformanceNow())if(r){var i=e.prototype.getPreQueueTime.call(this,t,r);if(i){var a=window.performance.now(),s=n||e.prototype.calculateQueuedTime.call(this,i,a);return e.prototype.addQueueMeasurement.call(this,t,r,s,o)}}else this.logger.trace("BrowserPerformanceClient: correlationId for "+t+" not provided, unable to add queue measurement");else this.logger.trace("BrowserPerformanceClient: window performance API not available, unable to add queue measurement for "+t)},t}(Kt),_n=function(e){function t(t){var r=e.call(this,t)||this;return r.astsAsyncMeasurement=void 0,r.activeSilentTokenRequests=new Map,r.trackPageVisibility=r.trackPageVisibility.bind(r),r}return j(t,e),t.prototype.loginRedirect=function(e){return X(this,void 0,void 0,(function(){var t;return Z(this,(function(r){return t=this.getRequestCorrelationId(e),this.logger.verbose("loginRedirect called",t),[2,this.acquireTokenRedirect(V({correlationId:t},e||ut))]}))}))},t.prototype.loginPopup=function(e){var t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup(V({correlationId:t},e||ut))},t.prototype.acquireTokenSilent=function(e){return X(this,void 0,void 0,(function(){var t,r,n,o,i,a,s,c=this;return Z(this,(function(u){if(t=this.getRequestCorrelationId(e),(r=this.performanceClient.startMeasurement(Q.AcquireTokenSilent,t)).addStaticFields({cacheLookupPolicy:e.cacheLookupPolicy}),this.preflightBrowserEnvironmentCheck(Ve.Silent),this.logger.verbose("acquireTokenSilent called",t),!(n=e.account||this.getActiveAccount()))throw St.createNoAccountError();return o={clientId:this.config.auth.clientId,authority:e.authority||pe.EMPTY_STRING,scopes:e.scopes,homeAccountIdentifier:n.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},i=JSON.stringify(o),void 0===(a=this.activeSilentTokenRequests.get(i))?(this.logger.verbose("acquireTokenSilent called for the first time, storing active request",t),this.performanceClient.setPreQueueTime(Q.AcquireTokenSilentAsync,t),s=this.acquireTokenSilentAsync(V(V({},e),{correlationId:t}),n).then((function(t){return c.activeSilentTokenRequests.delete(i),r.addStaticFields({accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length}),r.endMeasurement({success:!0,fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker,cacheLookupPolicy:e.cacheLookupPolicy,requestId:t.requestId}),t})).catch((function(e){throw c.activeSilentTokenRequests.delete(i),r.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})),this.activeSilentTokenRequests.set(i,s),[2,s]):(this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",t),r.discardMeasurement(),[2,a])}))}))},t.prototype.trackPageVisibility=function(){this.astsAsyncMeasurement&&(this.logger.info("Perf: Visibility change detected"),this.astsAsyncMeasurement.increment({visibilityChangeCount:1}))},t.prototype.acquireTokenSilentAsync=function(e,t){var r;return X(this,void 0,void 0,(function(){var n,o,i,a,s,c=this;return Z(this,(function(u){switch(u.label){case 0:return this.performanceClient.addQueueMeasurement(Q.AcquireTokenSilentAsync,e.correlationId),this.eventHandler.emitEvent(Nr.ACQUIRE_TOKEN_START,Ve.Silent,e),this.astsAsyncMeasurement=this.performanceClient.startMeasurement(Q.AcquireTokenSilentAsync,e.correlationId),null===(r=this.astsAsyncMeasurement)||void 0===r||r.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibility),un.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&t.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),o=V(V({},e),{account:t}),n=this.acquireTokenNative(o,Ye.acquireTokenSilent_silentFlow).catch((function(t){return X(c,void 0,void 0,(function(){return Z(this,(function(r){if(t instanceof nn&&t.isFatal())return this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,[2,this.createSilentIframeClient(e.correlationId).acquireToken(e)];throw t}))}))})),[3,3]):[3,1];case 1:return this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),i=this.createSilentCacheClient(e.correlationId),this.performanceClient.setPreQueueTime(Q.InitializeSilentRequest,e.correlationId),[4,i.initializeSilentRequest(e,t)];case 2:a=u.sent(),s=V(V({},e),{cacheLookupPolicy:e.cacheLookupPolicy||lt.Default}),this.performanceClient.setPreQueueTime(Q.AcquireTokenFromCache,a.correlationId),n=this.acquireTokenFromCache(i,a,s).catch((function(t){if(s.cacheLookupPolicy===lt.AccessToken)throw t;return Ar.blockReloadInHiddenIframes(),c.eventHandler.emitEvent(Nr.ACQUIRE_TOKEN_NETWORK_START,Ve.Silent,a),c.performanceClient.setPreQueueTime(Q.AcquireTokenByRefreshToken,a.correlationId),c.acquireTokenByRefreshToken(a,s).catch((function(t){var r=t instanceof $e,n=t instanceof nt,o=t.errorCode===ot.INVALID_GRANT_ERROR;if((!r||!o||n||s.cacheLookupPolicy===lt.AccessTokenAndRefreshToken||s.cacheLookupPolicy===lt.RefreshToken)&&s.cacheLookupPolicy!==lt.Skip)throw t;return c.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",e.correlationId),c.performanceClient.setPreQueueTime(Q.AcquireTokenBySilentIframe,a.correlationId),c.acquireTokenBySilentIframe(a)}))})),u.label=3;case 3:return[2,n.then((function(e){var t;return c.eventHandler.emitEvent(Nr.ACQUIRE_TOKEN_SUCCESS,Ve.Silent,e),null===(t=c.astsAsyncMeasurement)||void 0===t||t.endMeasurement({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e})).catch((function(e){var t;throw c.eventHandler.emitEvent(Nr.ACQUIRE_TOKEN_FAILURE,Ve.Silent,null,e),null===(t=c.astsAsyncMeasurement)||void 0===t||t.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})).finally((function(){document.removeEventListener("visibilitychange",c.trackPageVisibility)}))]}}))}))},t}(function(){function e(e){var t,r,n,o,i,a,s,c,u,l,d,h,p,f,g;this.isBrowserEnvironment="undefined"!=typeof window,this.config=(t=e,r=this.isBrowserEnvironment,n=t.auth,o=t.cache,i=t.system,a=t.telemetry,s={clientId:pe.EMPTY_STRING,authority:""+pe.DEFAULT_AUTHORITY,knownAuthorities:[],cloudDiscoveryMetadata:pe.EMPTY_STRING,authorityMetadata:pe.EMPTY_STRING,redirectUri:pe.EMPTY_STRING,postLogoutRedirectUri:pe.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:hr.AAD,azureCloudOptions:{azureCloudInstance:pr.None,tenant:pe.EMPTY_STRING},skipAuthorityMetadataCache:!1},c={cacheLocation:Ge.SessionStorage,temporaryCacheLocation:Ge.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!(!o||o.cacheLocation!==Ge.LocalStorage)},u={loggerCallback:function(){},logLevel:Ht.Info,piiLoggingEnabled:!1},l=V(V({},yr),{loggerOptions:u,networkClient:r?Ar.getBrowserNetworkClient():Sr,navigationClient:new Rr,loadFrameTimeout:0,windowHashTimeout:(null==i?void 0:i.loadFrameTimeout)||6e4,iframeHashTimeout:(null==i?void 0:i.loadFrameTimeout)||Pr,navigateFrameWait:r&&Ar.detectIEOrEdge()?500:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:(null==i?void 0:i.nativeBrokerHandshakeTimeout)||2e3,pollIntervalMilliseconds:ot.DEFAULT_POLL_INTERVAL_MS,cryptoOptions:{useMsrCrypto:!1,entropy:void 0}}),d=V(V({},i),{loggerOptions:(null==i?void 0:i.loggerOptions)||u}),h={application:{appName:pe.EMPTY_STRING,appVersion:pe.EMPTY_STRING}},{auth:V(V({},s),n),cache:V(V({},c),o),system:V(V({},l),d),telemetry:V(V({},h),a)}),this.initialized=!1,this.logger=new Ft(this.config.system.loggerOptions,"@azure/msal-browser","2.37.0"),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.isBrowserEnvironment?new En(this.config.auth.clientId,this.config.auth.authority,this.logger,"@azure/msal-browser","2.37.0",this.config.telemetry.application,this.config.system.cryptoOptions):new zt(this.config.auth.clientId,this.config.auth.authority,this.logger,"@azure/msal-browser","2.37.0",this.config.telemetry.application),this.browserCrypto=this.isBrowserEnvironment?new xt(this.logger,this.performanceClient,this.config.system.cryptoOptions):Wt,this.eventHandler=new Or(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new vr(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger):(p=this.config.auth.clientId,f=this.logger,g={cacheLocation:Ge.MemoryStorage,temporaryCacheLocation:Ge.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1},new vr(p,g,Wt,f));var m={cacheLocation:Ge.MemoryStorage,temporaryCacheLocation:Ge.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1};this.nativeInternalStorage=new vr(this.config.auth.clientId,m,this.browserCrypto,this.logger),this.tokenCache=new vn(this.config,this.browserStorage,this.logger,this.browserCrypto),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}return e.prototype.initialize=function(){return X(this,void 0,void 0,(function(){var e,t,r,n;return Z(this,(function(o){switch(o.label){case 0:if(this.logger.trace("initialize called"),this.initialized)return this.logger.info("initialize has already been called, exiting early."),[2];if(e=this.config.system.allowNativeBroker,t=this.performanceClient.startMeasurement(Q.InitializeClientApplication),this.eventHandler.emitEvent(Nr.INITIALIZE_START),!e)return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),r=this,[4,un.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)];case 2:return r.nativeExtensionProvider=o.sent(),[3,4];case 3:return n=o.sent(),this.logger.verbose(n),[3,4];case 4:return this.initialized=!0,this.eventHandler.emitEvent(Nr.INITIALIZE_END),t.endMeasurement({allowNativeBroker:e,success:!0}),[2]}}))}))},e.prototype.handleRedirectPromise=function(e){return X(this,void 0,void 0,(function(){var t,r,n,o,i,a,s,c,u=this;return Z(this,(function(l){return this.logger.verbose("handleRedirectPromise called"),Ar.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),t=this.getAllAccounts(),this.isBrowserEnvironment?(r=e||pe.EMPTY_STRING,void 0===(n=this.redirectResponse.get(r))?(this.eventHandler.emitEvent(Nr.HANDLE_REDIRECT_START,Ve.Redirect),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise"),o=this.browserStorage.getCachedNativeRequest(),i=void 0,o&&un.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e?(this.logger.trace("handleRedirectPromise - acquiring token from native platform"),a=new cn(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ye.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,o.accountId,this.nativeInternalStorage,o.correlationId),i=a.handleRedirectPromise()):(this.logger.trace("handleRedirectPromise - acquiring token from web flow"),s=this.browserStorage.getTemporaryCache(We.CORRELATION_ID,!0)||pe.EMPTY_STRING,c=this.createRedirectClient(s),i=c.handleRedirectPromise(e)),n=i.then((function(e){e&&(t.length<u.getAllAccounts().length?(u.eventHandler.emitEvent(Nr.LOGIN_SUCCESS,Ve.Redirect,e),u.logger.verbose("handleRedirectResponse returned result, login success")):(u.eventHandler.emitEvent(Nr.ACQUIRE_TOKEN_SUCCESS,Ve.Redirect,e),u.logger.verbose("handleRedirectResponse returned result, acquire token success")));return u.eventHandler.emitEvent(Nr.HANDLE_REDIRECT_END,Ve.Redirect),e})).catch((function(e){throw t.length>0?u.eventHandler.emitEvent(Nr.ACQUIRE_TOKEN_FAILURE,Ve.Redirect,null,e):u.eventHandler.emitEvent(Nr.LOGIN_FAILURE,Ve.Redirect,null,e),u.eventHandler.emitEvent(Nr.HANDLE_REDIRECT_END,Ve.Redirect),e})),this.redirectResponse.set(r,n)):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),[2,n]):(this.logger.verbose("handleRedirectPromise returns null, not browser environment"),[2,null])}))}))},e.prototype.acquireTokenRedirect=function(e){return X(this,void 0,void 0,(function(){var t,r,n,o,i,a=this;return Z(this,(function(s){return t=this.getRequestCorrelationId(e),this.logger.verbose("acquireTokenRedirect called",t),this.preflightBrowserEnvironmentCheck(Ve.Redirect),(r=this.getAllAccounts().length>0)?this.eventHandler.emitEvent(Nr.ACQUIRE_TOKEN_START,Ve.Redirect,e):this.eventHandler.emitEvent(Nr.LOGIN_START,Ve.Redirect,e),this.nativeExtensionProvider&&this.canUseNative(e)?(o=new cn(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ye.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId),n=o.acquireTokenRedirect(e).catch((function(t){if(t instanceof nn&&t.isFatal())return a.nativeExtensionProvider=void 0,a.createRedirectClient(e.correlationId).acquireToken(e);if(t instanceof nt)return a.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),a.createRedirectClient(e.correlationId).acquireToken(e);throw a.browserStorage.setInteractionInProgress(!1),t}))):(i=this.createRedirectClient(e.correlationId),n=i.acquireToken(e)),[2,n.catch((function(e){throw r?a.eventHandler.emitEvent(Nr.ACQUIRE_TOKEN_FAILURE,Ve.Redirect,null,e):a.eventHandler.emitEvent(Nr.LOGIN_FAILURE,Ve.Redirect,null,e),e}))]}))}))},e.prototype.acquireTokenPopup=function(e){var t=this,r=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(Q.AcquireTokenPopup,r);try{this.logger.verbose("acquireTokenPopup called",r),this.preflightBrowserEnvironmentCheck(Ve.Popup)}catch(e){return Promise.reject(e)}var o,i=this.getAllAccounts();(i.length>0?this.eventHandler.emitEvent(Nr.ACQUIRE_TOKEN_START,Ve.Popup,e):this.eventHandler.emitEvent(Nr.LOGIN_START,Ve.Popup,e),this.canUseNative(e))?o=this.acquireTokenNative(e,Ye.acquireTokenPopup).then((function(e){return t.browserStorage.setInteractionInProgress(!1),n.endMeasurement({success:!0,isNativeBroker:!0,requestId:e.requestId}),e})).catch((function(r){if(r instanceof nn&&r.isFatal())return t.nativeExtensionProvider=void 0,t.createPopupClient(e.correlationId).acquireToken(e);if(r instanceof nt)return t.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),t.createPopupClient(e.correlationId).acquireToken(e);throw t.browserStorage.setInteractionInProgress(!1),r})):o=this.createPopupClient(e.correlationId).acquireToken(e);return o.then((function(e){return i.length<t.getAllAccounts().length?t.eventHandler.emitEvent(Nr.LOGIN_SUCCESS,Ve.Popup,e):t.eventHandler.emitEvent(Nr.ACQUIRE_TOKEN_SUCCESS,Ve.Popup,e),n.addStaticFields({accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),n.endMeasurement({success:!0,requestId:e.requestId}),e})).catch((function(e){return i.length>0?t.eventHandler.emitEvent(Nr.ACQUIRE_TOKEN_FAILURE,Ve.Popup,null,e):t.eventHandler.emitEvent(Nr.LOGIN_FAILURE,Ve.Popup,null,e),n.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),Promise.reject(e)}))},e.prototype.trackPageVisibilityWithMeasurement=function(){var e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))},e.prototype.ssoSilent=function(e){var t;return X(this,void 0,void 0,(function(){var r,n,o,i,a=this;return Z(this,(function(s){return r=this.getRequestCorrelationId(e),n=V(V({},e),{prompt:e.prompt,correlationId:r}),this.preflightBrowserEnvironmentCheck(Ve.Silent),this.ssoSilentMeasurement=this.performanceClient.startMeasurement(Q.SsoSilent,r),null===(t=this.ssoSilentMeasurement)||void 0===t||t.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",r),this.eventHandler.emitEvent(Nr.SSO_SILENT_START,Ve.Silent,n),this.canUseNative(n)?o=this.acquireTokenNative(n,Ye.ssoSilent).catch((function(e){if(e instanceof nn&&e.isFatal())return a.nativeExtensionProvider=void 0,a.createSilentIframeClient(n.correlationId).acquireToken(n);throw e})):(i=this.createSilentIframeClient(n.correlationId),o=i.acquireToken(n)),[2,o.then((function(e){var t,r;return a.eventHandler.emitEvent(Nr.SSO_SILENT_SUCCESS,Ve.Silent,e),null===(t=a.ssoSilentMeasurement)||void 0===t||t.addStaticFields({accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),null===(r=a.ssoSilentMeasurement)||void 0===r||r.endMeasurement({success:!0,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e})).catch((function(e){var t;throw a.eventHandler.emitEvent(Nr.SSO_SILENT_FAILURE,Ve.Silent,null,e),null===(t=a.ssoSilentMeasurement)||void 0===t||t.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})).finally((function(){document.removeEventListener("visibilitychange",a.trackPageVisibilityWithMeasurement)}))]}))}))},e.prototype.acquireTokenByCode=function(e){return X(this,void 0,void 0,(function(){var t,r,n,o,i=this;return Z(this,(function(a){t=this.getRequestCorrelationId(e),this.preflightBrowserEnvironmentCheck(Ve.Silent),this.logger.trace("acquireTokenByCode called",t),this.eventHandler.emitEvent(Nr.ACQUIRE_TOKEN_BY_CODE_START,Ve.Silent,e),r=this.performanceClient.startMeasurement(Q.AcquireTokenByCode,e.correlationId);try{if(e.code&&e.nativeAccountId)throw St.createSpaCodeAndNativeAccountIdPresentError();if(e.code)return n=e.code,(o=this.hybridAuthCodeResponses.get(n))?(this.logger.verbose("Existing acquireTokenByCode request found",e.correlationId),r.discardMeasurement()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),o=this.acquireTokenByCodeAsync(V(V({},e),{correlationId:t})).then((function(e){return i.eventHandler.emitEvent(Nr.ACQUIRE_TOKEN_BY_CODE_SUCCESS,Ve.Silent,e),i.hybridAuthCodeResponses.delete(n),r.addStaticFields({accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),r.endMeasurement({success:!0,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e})).catch((function(e){throw i.hybridAuthCodeResponses.delete(n),i.eventHandler.emitEvent(Nr.ACQUIRE_TOKEN_BY_CODE_FAILURE,Ve.Silent,null,e),r.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})),this.hybridAuthCodeResponses.set(n,o)),[2,o];if(e.nativeAccountId){if(this.canUseNative(e,e.nativeAccountId))return[2,this.acquireTokenNative(e,Ye.acquireTokenByCode,e.nativeAccountId).catch((function(e){throw e instanceof nn&&e.isFatal()&&(i.nativeExtensionProvider=void 0),e}))];throw St.createUnableToAcquireTokenFromNativePlatformError()}throw St.createAuthCodeOrNativeAccountIdRequiredError()}catch(e){throw this.eventHandler.emitEvent(Nr.ACQUIRE_TOKEN_BY_CODE_FAILURE,Ve.Silent,null,e),r.endMeasurement({errorCode:e instanceof Ze&&e.errorCode||void 0,subErrorCode:e instanceof Ze&&e.subError||void 0,success:!1}),e}return[2]}))}))},e.prototype.acquireTokenByCodeAsync=function(e){var t;return X(this,void 0,void 0,(function(){var r=this;return Z(this,(function(n){switch(n.label){case 0:return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(Q.AcquireTokenByCodeAsync,e.correlationId),null===(t=this.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),[4,this.createSilentAuthCodeClient(e.correlationId).acquireToken(e).then((function(e){var t;return null===(t=r.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.endMeasurement({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e})).catch((function(e){var t;throw null===(t=r.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})).finally((function(){document.removeEventListener("visibilitychange",r.trackPageVisibilityWithMeasurement)}))];case 1:return[2,n.sent()]}}))}))},e.prototype.acquireTokenFromCache=function(e,t,r){return X(this,void 0,void 0,(function(){return Z(this,(function(n){switch(this.performanceClient.addQueueMeasurement(Q.AcquireTokenFromCache,t.correlationId),r.cacheLookupPolicy){case lt.Default:case lt.AccessToken:case lt.AccessTokenAndRefreshToken:return[2,e.acquireToken(t)];default:throw _t.createRefreshRequiredError()}return[2]}))}))},e.prototype.acquireTokenByRefreshToken=function(e,t){return X(this,void 0,void 0,(function(){var r;return Z(this,(function(n){switch(this.performanceClient.addQueueMeasurement(Q.AcquireTokenByRefreshToken,e.correlationId),t.cacheLookupPolicy){case lt.Default:case lt.AccessTokenAndRefreshToken:case lt.RefreshToken:case lt.RefreshTokenAndNetwork:return r=this.createSilentRefreshClient(e.correlationId),this.performanceClient.setPreQueueTime(Q.SilentRefreshClientAcquireToken,e.correlationId),[2,r.acquireToken(e)];default:throw _t.createRefreshRequiredError()}return[2]}))}))},e.prototype.acquireTokenBySilentIframe=function(e){return X(this,void 0,void 0,(function(){var t;return Z(this,(function(r){return this.performanceClient.addQueueMeasurement(Q.AcquireTokenBySilentIframe,e.correlationId),t=this.createSilentIframeClient(e.correlationId),this.performanceClient.setPreQueueTime(Q.SilentIframeClientAcquireToken,e.correlationId),[2,t.acquireToken(e)]}))}))},e.prototype.logout=function(e){return X(this,void 0,void 0,(function(){var t;return Z(this,(function(r){return t=this.getRequestCorrelationId(e),this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),[2,this.logoutRedirect(V({correlationId:t},e))]}))}))},e.prototype.logoutRedirect=function(e){return X(this,void 0,void 0,(function(){var t;return Z(this,(function(r){return t=this.getRequestCorrelationId(e),this.preflightBrowserEnvironmentCheck(Ve.Redirect),[2,this.createRedirectClient(t).logout(e)]}))}))},e.prototype.logoutPopup=function(e){try{var t=this.getRequestCorrelationId(e);return this.preflightBrowserEnvironmentCheck(Ve.Popup),this.createPopupClient(t).logout(e)}catch(e){return Promise.reject(e)}},e.prototype.getAllAccounts=function(){return this.logger.verbose("getAllAccounts called"),this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]},e.prototype.getAccountByUsername=function(e){if(this.logger.trace("getAccountByUsername called"),!e)return this.logger.warning("getAccountByUsername: No username provided"),null;var t=this.browserStorage.getAccountInfoFilteredBy({username:e});return t?(this.logger.verbose("getAccountByUsername: Account matching username found, returning"),this.logger.verbosePii("getAccountByUsername: Returning signed-in accounts matching username: "+e),t):(this.logger.verbose("getAccountByUsername: No matching account found, returning null"),null)},e.prototype.getAccountByHomeId=function(e){if(this.logger.trace("getAccountByHomeId called"),!e)return this.logger.warning("getAccountByHomeId: No homeAccountId provided"),null;var t=this.browserStorage.getAccountInfoFilteredBy({homeAccountId:e});return t?(this.logger.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),this.logger.verbosePii("getAccountByHomeId: Returning signed-in accounts matching homeAccountId: "+e),t):(this.logger.verbose("getAccountByHomeId: No matching account found, returning null"),null)},e.prototype.getAccountByLocalId=function(e){if(this.logger.trace("getAccountByLocalId called"),!e)return this.logger.warning("getAccountByLocalId: No localAccountId provided"),null;var t=this.browserStorage.getAccountInfoFilteredBy({localAccountId:e});return t?(this.logger.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),this.logger.verbosePii("getAccountByLocalId: Returning signed-in accounts matching localAccountId: "+e),t):(this.logger.verbose("getAccountByLocalId: No matching account found, returning null"),null)},e.prototype.setActiveAccount=function(e){this.browserStorage.setActiveAccount(e)},e.prototype.getActiveAccount=function(){return this.browserStorage.getActiveAccount()},e.prototype.preflightBrowserEnvironmentCheck=function(e,t){if(void 0===t&&(t=!0),this.logger.verbose("preflightBrowserEnvironmentCheck started"),Ar.blockNonBrowserEnvironment(this.isBrowserEnvironment),Ar.blockRedirectInIframe(e,this.config.system.allowRedirectInIframe),Ar.blockReloadInHiddenIframes(),Ar.blockAcquireTokenInPopups(),Ar.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),e===Ve.Redirect&&this.config.cache.cacheLocation===Ge.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw Nt.createInMemoryRedirectUnavailableError();e!==Ve.Redirect&&e!==Ve.Popup||this.preflightInteractiveRequest(t)},e.prototype.preflightInteractiveRequest=function(e){this.logger.verbose("preflightInteractiveRequest called, validating app environment"),Ar.blockReloadInHiddenIframes(),e&&this.browserStorage.setInteractionInProgress(!0)},e.prototype.acquireTokenNative=function(e,t,r){return X(this,void 0,void 0,(function(){return Z(this,(function(n){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw St.createNativeConnectionNotEstablishedError();return[2,new cn(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,r||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e)]}))}))},e.prototype.canUseNative=function(e,t){if(this.logger.trace("canUseNative called"),!un.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case ve.NONE:case ve.CONSENT:case ve.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace("canUseNative: prompt = "+e.prompt+" is not compatible with native flow, returning false"),!1}return!(!t&&!this.getNativeAccountId(e))||(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1)},e.prototype.getNativeAccountId=function(e){var t=e.account||this.browserStorage.getAccountInfoByHints(e.loginHint,e.sid)||this.getActiveAccount();return t&&t.nativeAccountId||""},e.prototype.createPopupClient=function(e){return new dn(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},e.prototype.createRedirectClient=function(e){return new pn(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},e.prototype.createSilentIframeClient=function(e){return new gn(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ye.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},e.prototype.createSilentCacheClient=function(e){return new sn(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)},e.prototype.createSilentRefreshClient=function(e){return new mn(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)},e.prototype.createSilentAuthCodeClient=function(e){return new Cn(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ye.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)},e.prototype.addEventCallback=function(e){return this.eventHandler.addEventCallback(e)},e.prototype.removeEventCallback=function(e){this.eventHandler.removeEventCallback(e)},e.prototype.addPerformanceCallback=function(e){return this.performanceClient.addPerformanceCallback(e)},e.prototype.removePerformanceCallback=function(e){return this.performanceClient.removePerformanceCallback(e)},e.prototype.enableAccountStorageEvents=function(){this.eventHandler.enableAccountStorageEvents()},e.prototype.disableAccountStorageEvents=function(){this.eventHandler.disableAccountStorageEvents()},e.prototype.getTokenCache=function(){return this.tokenCache},e.prototype.getLogger=function(){return this.logger},e.prototype.setLogger=function(e){this.logger=e},e.prototype.initializeWrapperLibrary=function(e,t){this.browserStorage.setWrapperMetadata(e,t)},e.prototype.setNavigationClient=function(e){this.navigationClient=e},e.prototype.getConfiguration=function(){return this.config},e.prototype.getRequestCorrelationId=function(e){return(null==e?void 0:e.correlationId)?e.correlationId:this.isBrowserEnvironment?this.browserCrypto.createNewGuid():pe.EMPTY_STRING},e}()),In=r(17),wn=r(1),Sn=r(2),bn=r(6),kn=Sn.d,An=Sn.b.freeze,Rn=(Sn.b.seal,Sn.b.keys),Pn=String[Sn.k],Nn=Pn.trim,Mn=Pn.endsWith,On=Pn.startsWith,Un=Date[Sn.k].toISOString,qn=Array.isArray,Ln=Sn.f.toString,Hn=Sn.e.toString,Dn=Hn.call(Sn.b),xn=/-([a-z])/g,Bn=/([^\w\d_$])/g,Fn=/^(\d+[\w\d_$])/,Kn=Object.getPrototypeOf;function Gn(e,t){return typeof e===t}function zn(e){return void 0===e||typeof e===Sn.l}function Wn(e){return null===e||zn(e)}function jn(e){return!Wn(e)}function Qn(e,t){return!(!e||!Sn.e.call(e,t))}function Yn(e){return!(!e||typeof e!==Sn.j)}function Vn(e){return!(!e||typeof e!==Sn.h)}function Jn(e){var t=e;return t&&oo(t)&&(t=(t=(t=t.replace(xn,(function(e,t){return t.toUpperCase()}))).replace(Bn,"_")).replace(Fn,(function(e,t){return"_"+t}))),t}function Xn(e,t){if(e)for(var r in e)Sn.e.call(e,r)&&t.call(e,r,e[r])}function Zn(e,t){var r=!1;return e&&t&&!(r=e===t)&&(r=Mn?e.endsWith(t):function(e,t){var r=!1,n=t?t.length:0,o=e?e.length:0;if(n&&o&&o>=n&&!(r=e===t)){for(var i=o-1,a=n-1;a>=0;a--){if(e[i]!=t[a])return!1;i--}r=!0}return r}(e,t)),r}function $n(e,t){var r=!1;return e&&t&&!(r=e===t)&&(r=On?e.startsWith(t):function(e,t){var r=!1,n=t?t.length:0;if(e&&n&&e.length>=n&&!(r=e===t)){for(var o=0;o<n;o++)if(e[o]!==t[o])return!1;r=!0}return r}(e,t)),r}function eo(e,t){return!(!e||!t)&&-1!==e.indexOf(t)}function to(e){return!(!e||"[object Date]"!==Ln.call(e))}var ro=qn||function(e){return!(!e||"[object Array]"!==Ln.call(e))};function no(e){return!(!e||"[object Error]"!==Ln.call(e))}function oo(e){return"string"==typeof e}function io(e){return"number"==typeof e}function ao(e){return"boolean"==typeof e}function so(e){var t=!1;if(e&&"object"==typeof e){var r=Kn?Kn(e):function(e){if(e){if(Kn)return Kn(e);var t=e.__proto__||e[Sn.k]||e.constructor;if(t)return t}return null}(e);r?(r.constructor&&Sn.e.call(r,"constructor")&&(r=r.constructor),t=typeof r===Sn.h&&Hn.call(r)===Dn):t=!0}return t}function co(e){if(e)return Un?e.toISOString():function(e){if(e&&e.getUTCFullYear){var t=function(e){var t=String(e);return 1===t.length&&(t="0"+t),t};return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}(e)}function uo(e,t,r){var n=e.length;try{for(var o=0;o<n&&(!(o in e)||-1!==t.call(r||e,e[o],o,e));o++);}catch(e){}}function lo(e,t,r){if(e){if(e.indexOf)return e.indexOf(t,r);var n=e.length,o=r||0;try{for(var i=Math.max(o>=0?o:n-Math.abs(o),0);i<n;i++)if(i in e&&e[i]===t)return i}catch(e){}}return-1}function ho(e,t,r){var n;if(e){if(e.map)return e.map(t,r);var o=e.length,i=r||e;n=new Array(o);try{for(var a=0;a<o;a++)a in e&&(n[a]=t.call(i,e[a],e))}catch(e){}}return n}function po(e,t,r){var n;if(e){if(e.reduce)return e.reduce(t,r);var o=e.length,i=0;if(arguments.length>=3)n=arguments[2];else{for(;i<o&&!(i in e);)i++;n=e[i++]}for(;i<o;)i in e&&(n=t(n,e[i],i,e)),i++}return n}function fo(e){return e&&(e=Nn&&e.trim?e.trim():e.replace?e.replace(/^\s+|(?=\s)\s+$/g,""):e),e}var go=!{toString:null}.propertyIsEnumerable("toString"),mo=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];function vo(e){var t=typeof e;if(t===Sn.h||t===Sn.j&&null!==e||Object(bn.c)("objKeys called on non-object"),!go&&Rn)return Rn(e);var r=[];for(var n in e)e&&Sn.e.call(e,n)&&r.push(n);if(go)for(var o=mo.length,i=0;i<o;i++)e&&Sn.e.call(e,mo[i])&&r.push(mo[i]);return r}function yo(e,t,r,n){if(kn)try{var o={enumerable:!0,configurable:!0};return r&&(o.get=r),n&&(o.set=n),kn(e,t,o),!0}catch(e){}return!1}function Co(e){return e}function To(e){return An&&Xn(e,(function(e,t){(ro(t)||Yn(t))&&An(t)})),Eo(e)}var Eo=An||Co;function _o(){var e=Date;return e.now?e.now():(new e).getTime()}function Io(e){return no(e)?e.name:""}function wo(e,t,r,n,o){var i=r;return e&&((i=e[t])===r||o&&!o(i)||n&&!n(r)||(i=r,e[t]=i)),i}function So(e,t,r){var n;return e?!(n=e[t])&&Wn(n)&&(n=zn(r)?{}:r,e[t]=n):n=zn(r)?{}:r,n}function bo(e,t){return Wn(e)?t:e}function ko(e){return!!e}function Ao(e){throw new Error(e)}function Ro(e,t){var r=null,n=null;return Vn(e)?r=e:n=e,function(){var e=arguments;if(r&&(n=r()),n)return n[t].apply(n,e)}}function Po(e,t,r,n,o){e&&t&&r&&(!1!==o||zn(e[t]))&&(e[t]=Ro(r,n))}function No(e,t,r,n){return e&&t&&Yn(e)&&ro(r)&&uo(r,(function(r){oo(r)&&Po(e,r,t,r,n)})),e}function Mo(e){return e&&Sn.a&&(e=Object(Sn.b)(Object(Sn.a)({},e))),e}function Oo(e,t,r,n,o,i){var a=arguments,s=a[0]||{},c=a.length,u=!1,l=1;for(c>0&&ao(s)&&(u=s,s=a[l]||{},l++),Yn(s)||(s={});l<c;l++){var d=a[l],h=ro(d),p=Yn(d);for(var f in d){var g=h&&f in d||p&&Sn.e.call(d,f);if(g){var m=d[f],v=void 0;if(u&&m&&((v=ro(m))||so(m))){var y=s[f];v?ro(y)||(y=[]):so(y)||(y={}),m=Oo(u,y,m)}void 0!==m&&(s[f]=m)}}}return s}var Uo=null,qo=function(){function e(t,r,n){var o,i=this,a=!1;(i.start=_o(),i.name=t,i.isAsync=n,i.isChildEvt=function(){return!1},Vn(r))&&(a=yo(i,"payload",(function(){return!o&&Vn(r)&&(o=r(),r=null),o})));i.getCtx=function(t){return t?t===e.ParentContextKey||t===e.ChildrenContextKey?i[t]:(i.ctx||{})[t]:null},i.setCtx=function(t,r){if(t)if(t===e.ParentContextKey)i[t]||(i.isChildEvt=function(){return!0}),i[t]=r;else if(t===e.ChildrenContextKey)i[t]=r;else{(i.ctx=i.ctx||{})[t]=r}},i.complete=function(){var t=0,n=i.getCtx(e.ChildrenContextKey);if(ro(n))for(var o=0;o<n.length;o++){var s=n[o];s&&(t+=s.time)}i.time=_o()-i.start,i.exTime=i.time-t,i.complete=function(){},!a&&Vn(r)&&(i.payload=r())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),Lo=function(){function e(t){this.ctx={},Object(wn.a)(e,this,(function(e){e.create=function(e,t,r){return new qo(e,t,r)},e.fire=function(e){e&&(e.complete(),t&&Vn(t.perfEvent)&&t.perfEvent(e))},e.setCtx=function(t,r){t&&((e.ctx=e.ctx||{})[t]=r)},e.getCtx=function(t){return(e.ctx||{})[t]}}))}return e.__ieDyn=1,e}();function Ho(e,t,r,n,o){if(e){var i=e;if(i.getPerfMgr&&(i=i.getPerfMgr()),i){var a=void 0,s=i.getCtx("CoreUtils.doPerf");try{if(a=i.create(t(),n,o)){if(s&&a.setCtx&&(a.setCtx(qo.ParentContextKey,s),s.getCtx&&s.setCtx)){var c=s.getCtx(qo.ChildrenContextKey);c||(c=[],s.setCtx(qo.ChildrenContextKey,c)),c.push(a)}return i.setCtx("CoreUtils.doPerf",a),r(a)}}catch(e){a&&a.setCtx&&a.setCtx("exception",e)}finally{a&&i.fire(a),i.setCtx("CoreUtils.doPerf",s)}}}return r()}var Do=null,xo=null,Bo=!1,Fo=null,Ko=null;function Go(e,t){var r=!1;if(e){try{if(!(r=t in e)){var n=e[Sn.k];n&&(r=t in n)}}catch(e){}if(!r)try{r=!zn((new e)[t])}catch(e){}}return r}function zo(e){var t=Object(bn.a)();return t&&t[e]?t[e]:"window"===e&&Wo()?window:null}function Wo(){return Boolean(typeof window===Sn.j&&window)}function jo(){return Wo()?window:zo("window")}function Qo(){return Boolean(typeof document===Sn.j&&document)}function Yo(){return Qo()?document:zo("document")}function Vo(){return Boolean(typeof navigator===Sn.j&&navigator)}function Jo(){return Vo()?navigator:zo("navigator")}function Xo(e){if(e&&Bo){var t=zo("__mockLocation");if(t)return t}return typeof location===Sn.j&&location?location:zo("location")}function Zo(){return zo("performance")}function $o(){return Boolean(typeof JSON===Sn.j&&JSON||null!==zo("JSON"))}function ei(){return $o()?JSON||zo("JSON"):null}function ti(){var e=Jo();return!(!e||!e.product)&&"ReactNative"===e.product}function ri(){var e=Jo();if(e&&(e.userAgent!==xo||null===Do)){var t=((xo=e.userAgent)||"").toLowerCase();Do=eo(t,"msie")||eo(t,"trident/")}return Do}function ni(e){var t=Object[Sn.k].toString.call(e),r="";return"[object Error]"===t?r="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e.name+"'":$o()&&(r=ei().stringify(e)),t+r}function oi(){return null===Ko&&(Ko=Vo()&&Boolean(Jo().sendBeacon)),Ko}function ii(e){var t=!1;try{t=!!zo("fetch");var r=zo("Request");t&&e&&r&&(t=Go(r,"keepalive"))}catch(e){}return t}function ai(){return null===Fo&&(Fo=typeof XDomainRequest!==Sn.l)&&si()&&(Fo=Fo&&!Go(zo("XMLHttpRequest"),"withCredentials")),Fo}function si(){var e=!1;try{e=!!zo("XMLHttpRequest")}catch(e){}return e}var ci,ui=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],li=null;function di(e,t){return function(){var r=arguments,n=hi(t);if(n){var o=n.listener;o&&o[e]&&o[e].apply(o,r)}}}function hi(e){var t,r=li;return r||!0===e.disableDbgExt||(r=li||((t=zo("Microsoft"))&&(li=t.ApplicationInsights),li)),r?r.ChromeDbgExt:null}function pi(e){return e?'"'+e.replace(/\"/g,"")+'"':""}function fi(e,t){var r=typeof console!==Sn.l?console:zo("console");if(r){var n="log";r[e]&&(n=e),Vn(r[n])&&r[n](t)}}var gi=function(){function e(e,t,r,n){void 0===r&&(r=!1);this.messageId=e,this.message=(r?"AI: ":"AI (Internal): ")+e;var o="";$o()&&(o=ei().stringify(n));var i=(t?" message:"+pi(t):"")+(n?" props:"+pi(o):"");this.message+=i}return e.dataType="MessageData",e}();function mi(e,t){return(e||{}).logger||new vi(t)}var vi=function(){function e(t){this.identifier="DiagnosticLogger",this.queue=[];var r,n,o,i,a=0,s={};Object(wn.a)(e,this,(function(e){function c(t,r){if(!(a>=o)){var i=!0,c="AITR_"+r.messageId;if(s[c]?i=!1:s[c]=!0,i&&(t<=n&&(e.queue.push(r),a++,u(1===t?"error":"warn",r)),a===o)){var l="Internal events throttle limit per PageView reached for this app.",d=new gi(23,l,!1);e.queue.push(d),1===t?e.errorToConsole(l):e.warnToConsole(l)}}}function u(e,r){var n=hi(t||{});n&&n.diagLog&&n.diagLog(e,r)}!function(e){r=bo(e.loggingLevelConsole,0),n=bo(e.loggingLevelTelemetry,1),o=bo(e.maxMessageLimit,25),i=bo(e.enableDebug,bo(e.enableDebugExceptions,!1))}(t||{}),e.consoleLoggingLevel=function(){return r},e.telemetryLoggingLevel=function(){return n},e.maxInternalMessageLimit=function(){return o},e.enableDebugExceptions=function(){return i},e.throwInternal=function(t,n,o,a,l){void 0===l&&(l=!1);var d=new gi(n,o,l,a);if(i)throw ni(d);var h=1===t?"errorToConsole":"warnToConsole";if(zn(d.message))u("throw"+(1===t?"Critical":"Warning"),d);else{if(l){var p=+d.messageId;!s[p]&&r>=t&&(e[h](d.message),s[p]=!0)}else r>=t&&e[h](d.message);c(t,d)}},e.warnToConsole=function(e){fi("warn",e),u("warning",e)},e.errorToConsole=function(e){fi("error",e),u("error",e)},e.resetInternalMessageCount=function(){a=0,s={}},e.logInternalMessage=c}))}return e.__ieDyn=1,e}();function yi(e){return e||new vi}function Ci(e,t,r,n,o,i){void 0===i&&(i=!1),yi(e).throwInternal(t,r,n,o,i)}function Ti(e,t){yi(e).warnToConsole(t)}var Ei=!1,_i=123456789,Ii=987654321;function wi(e){e<0&&(e>>>=0),_i=123456789+e&4294967295,Ii=987654321-e&4294967295,Ei=!0}function Si(){try{var e=2147483647&_o();wi((4294967296*Math.random()^e)+e)}catch(e){}}function bi(e){return e>0?Math.floor(ki()/4294967295*(e+1))>>>0:0}function ki(e){var t=0,r=zo("crypto")||zo("msCrypto");return r&&r.getRandomValues&&(t=4294967295&r.getRandomValues(new Uint32Array(1))[0]),0===t&&ri()&&(Ei||Si(),t=4294967295&Ri()),0===t&&(t=Math.floor(4294967296*Math.random()|0)),e||(t>>>=0),t}function Ai(e){e?wi(e):Si()}function Ri(e){var t=((Ii=36969*(65535&Ii)+(Ii>>16)&4294967295)<<16)+(65535&(_i=18e3*(65535&_i)+(_i>>16)&4294967295))>>>0&4294967295|0;return e||(t>>>=0),t}function Pi(e){void 0===e&&(e=22);for(var t=ki()>>>0,r=0,n="";n.length<e;)r++,n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&t),t>>>=6,5===r&&(t=(ki()<<2&4294967295|3&t)>>>0,r=0);return n}var Ni=Sn.d,Mi="."+Pi(6),Oi=0;function Ui(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType}function qi(e,t){var r=t[e.id];if(!r){r={};try{Ui(t)&&(function(e,t,r){if(Ni)try{return Ni(e,t,{value:r,enumerable:!1,configurable:!0}),!0}catch(e){}return!1}(t,e.id,r)||(t[e.id]=r))}catch(e){}}return r}function Li(e,t){return void 0===t&&(t=!1),Jn(e+Oi+++(t?".2.8.16":"")+Mi)}function Hi(e){var t={id:Li("_aiData-"+(e||"")+".2.8.16"),accept:function(e){return Ui(e)},get:function(e,r,n,o){var i=e[t.id];return i?i[Jn(r)]:(o&&((i=qi(t,e))[Jn(r)]=n),n)},kill:function(e,t){if(e&&e[t])try{delete e[t]}catch(e){}}};return t}var Di=null,xi=null,Bi=null,Fi=Yo(),Ki={},Gi={};function zi(e,t){var r=Yi._ckMgr||Gi._ckMgr;return r||(r=Yi._ckMgr=Yi(e,t),Gi._ckMgr=r),r}function Wi(e){return!e||e.isEnabled()}function ji(e,t){return!!(t&&e&&ro(e.ignoreCookies))&&-1!==e.ignoreCookies.indexOf(t)}function Qi(e,t){var r;if(e)r=e.getCookieMgr();else if(t){var n=t.cookieCfg;r=n._ckMgr?n._ckMgr:Yi(t)}return r||(r=zi(t,(e||{}).logger)),r}function Yi(e,t){var r,n=function(e){var t=e.cookieCfg=e.cookieCfg||{};if(wo(t,"domain",e.cookieDomain,jn,Wn),wo(t,"path",e.cookiePath||"/",null,Wn),Wn(t.enabled)){var r=void 0;zn(e.isCookieUseDisabled)||(r=!e.isCookieUseDisabled),zn(e.disableCookiesUsage)||(r=!e.disableCookiesUsage),t.enabled=r}return t}(e||Gi),o=n.path||"/",i=n.domain,a=!1!==n.enabled,s=((r={isEnabled:function(){var e=a&&Vi(t),r=Gi._ckMgr;return e&&r&&s!==r&&(e=Wi(r)),e}}).setEnabled=function(e){a=!1!==e},r.set=function(e,t,r,a,c){var u=!1;if(Wi(s)&&!function(e,t){return!!(t&&e&&ro(e.blockedCookies)&&-1!==e.blockedCookies.indexOf(t))||ji(e,t)}(n,e)){var l={},d=fo(t||""),h=d.indexOf(";");if(-1!==h&&(d=fo(t.substring(0,h)),l=Ji(t.substring(h+1))),wo(l,"domain",a||i,ko,zn),!Wn(r)){var p=ri();if(zn(l.expires)){var f=_o()+1e3*r;if(f>0){var g=new Date;g.setTime(f),wo(l,"expires",Xi(g,p?"toGMTString":"toUTCString")||Xi(g,p?"toGMTString":"toUTCString")||"",ko)}}p||wo(l,"max-age",""+r,null,zn)}var m=Xo();m&&"https:"===m.protocol&&(wo(l,"secure",null,null,zn),null===xi&&(xi=!ta((Jo()||{}).userAgent)),xi&&wo(l,"SameSite","None",null,zn)),wo(l,"path",c||o,null,zn),(n.setCookie||ea)(e,Zi(d,l)),u=!0}return u},r.get=function(e){var t="";return Wi(s)&&!ji(n,e)&&(t=(n.getCookie||$i)(e)),t},r.del=function(e,t){var r=!1;return Wi(s)&&(r=s.purge(e,t)),r},r.purge=function(e,r){var o,i=!1;if(Vi(t)){var a=((o={}).path=r||"/",o.expires="Thu, 01 Jan 1970 00:00:01 GMT",o);ri()||(a["max-age"]="0"),(n.delCookie||ea)(e,Zi("",a)),i=!0}return i},r);return s._ckMgr=s,s}function Vi(e){if(null===Di){Di=!1;try{Di=void 0!==(Fi||{}).cookie}catch(t){Ci(e,2,68,"Cannot access document.cookie - "+Io(t),{exception:ni(t)})}}return Di}function Ji(e){var t={};e&&e.length&&uo(fo(e).split(";"),(function(e){if(e=fo(e||"")){var r=e.indexOf("=");-1===r?t[e]=null:t[fo(e.substring(0,r))]=fo(e.substring(r+1))}}));return t}function Xi(e,t){return Vn(e[t])?e[t]():null}function Zi(e,t){var r=e||"";return Xn(t,(function(e,t){r+="; "+e+(Wn(t)?"":"="+t)})),r}function $i(e){var t="";if(Fi){var r=Fi.cookie||"";Bi!==r&&(Ki=Ji(r),Bi=r),t=fo(Ki[e]||"")}return t}function ea(e,t){Fi&&(Fi.cookie=e+"="+t)}function ta(e){return!!oo(e)&&(!(!eo(e,"CPU iPhone OS 12")&&!eo(e,"iPad; CPU OS 12"))||(!!(eo(e,"Macintosh; Intel Mac OS X 10_14")&&eo(e,"Version/")&&eo(e,"Safari"))||(!(!eo(e,"Macintosh; Intel Mac OS X 10_14")||!Zn(e,"AppleWebKit/605.1.15 (KHTML, like Gecko)"))||(!(!eo(e,"Chrome/5")&&!eo(e,"Chrome/6"))||(!(!eo(e,"UnrealEngine")||eo(e,"Chrome"))||!(!eo(e,"UCBrowser/12")&&!eo(e,"UCBrowser/11")))))))}var ra=Li("aiEvtPageHide"),na=Li("aiEvtPageShow"),oa=/\.[\.]+/g,ia=/[\.]+$/,aa=1,sa=Hi("events"),ca=/^([^.]*)(?:\.(.+)|)/;function ua(e){return e&&e.replace?e.replace(/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,""):e}function la(e,t){var r;if(t){var n="";ro(t)?(n="",uo(t,(function(e){(e=ua(e))&&("."!==e[0]&&(e="."+e),n+=e)}))):n=ua(t),n&&("."!==n[0]&&(n="."+n),e=(e||"")+n)}var o=ca.exec(e||"")||[];return(r={}).type=o[1],r.ns=(o[2]||"").replace(oa,".").replace(ia,"").split(".").sort().join("."),r}function da(e,t,r){void 0===r&&(r=!0);var n=sa.get(e,"events",{},r),o=n[t];return o||(o=n[t]=[]),o}function ha(e,t,r,n){e&&t&&t.type&&(e.removeEventListener?e.removeEventListener(t.type,r,n):e.detachEvent&&e.detachEvent("on"+t.type,r))}function pa(e,t,r,n){for(var o=t.length;o--;){var i=t[o];i&&(r.ns&&r.ns!==i.evtName.ns||n&&!n(i)||(ha(e,i.evtName,i.handler,i.capture),t.splice(o,1)))}}function fa(e,t){return t?la("xx",ro(t)?[e].concat(t):[e,t]).ns.split("."):e}function ga(e,t,r,n,o){var i;void 0===o&&(o=!1);var a=!1;if(e)try{var s=la(t,n);if((a=function(e,t,r,n){var o=!1;return e&&t&&t.type&&r&&(e.addEventListener?(e.addEventListener(t.type,r,n),o=!0):e.attachEvent&&(e.attachEvent("on"+t.type,r),o=!0)),o}(e,s,r,o))&&sa.accept(e)){var c=((i={guid:aa++,evtName:s}).handler=r,i.capture=o,i);da(e,s.type).push(c)}}catch(e){}return a}function ma(e,t,r,n,o){if(void 0===o&&(o=!1),e)try{var i=la(t,n),a=!1;!function(e,t,r){if(t.type)pa(e,da(e,t.type),t,r);else{var n=sa.get(e,"events",{});Xn(n,(function(n,o){pa(e,o,t,r)})),0===vo(n).length&&sa.kill(e,"events")}}(e,i,(function(e){return!((!i.ns||r)&&e.handler!==r)&&(a=!0,!0)})),a||ha(e,i,r,o)}catch(e){}}function va(e,t,r){var n=!1,o=jo();o&&(n=ga(o,e,t,r),n=ga(o.body,e,t,r)||n);var i=Yo();return i&&(n=ga(i,e,t,r)||n),n}function ya(e,t,r,n){var o=!1;return t&&e&&e.length>0&&uo(e,(function(e){e&&(r&&-1!==lo(r,e)||(o=va(e,t,n)||o))})),o}function Ca(e,t,r){e&&ro(e)&&uo(e,(function(e){e&&function(e,t,r){var n=jo();n&&(ma(n,e,t,r),ma(n.body,e,t,r));var o=Yo();o&&ma(o,e,t,r)}(e,t,r)}))}function Ta(e,t,r){return function(e,t,r,n){var o=!1;return t&&e&&ro(e)&&!(o=ya(e,t,r,n))&&r&&r.length>0&&(o=ya(e,t,null,n)),o}(["beforeunload","unload","pagehide"],e,t,r)}var Ea,_a=null;Sn.l;function Ia(){var e=Sa();return e.substring(0,8)+"-"+e.substring(8,12)+"-"+e.substring(12,16)+"-"+e.substring(16,20)+"-"+e.substring(20)}function wa(){var e=Zo();return e&&e.now?e.now():_o()}function Sa(){for(var e,t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],r="",n=0;n<4;n++)r+=t[15&(e=ki())]+t[e>>4&15]+t[e>>8&15]+t[e>>12&15]+t[e>>16&15]+t[e>>20&15]+t[e>>24&15]+t[e>>28&15];var o=t[8+(3&ki())|0];return r.substr(0,8)+r.substr(9,4)+"4"+r.substr(13,3)+o+r.substr(16,3)+r.substr(19,12)}var ba={_canUseCookies:void 0,isTypeof:Gn,isUndefined:zn,isNullOrUndefined:Wn,hasOwnProperty:Qn,isFunction:Vn,isObject:Yn,isDate:to,isArray:ro,isError:no,isString:oo,isNumber:io,isBoolean:ao,toISOString:co,arrForEach:uo,arrIndexOf:lo,arrMap:ho,arrReduce:po,strTrim:fo,objCreate:bn.b,objKeys:vo,objDefineAccessors:yo,addEventHandler:va,dateNow:_o,isIE:ri,disableCookies:function(){ka().setEnabled(!1)},newGuid:Ia,perfNow:wa,newId:Pi,randomValue:bi,random32:ki,mwcRandomSeed:Ai,mwcRandom32:Ri,generateW3CId:Sa};function ka(e,t){var r=zi(e,t),n=ba._canUseCookies;return null===_a&&(_a=[],Ea=n,yo(ba,"_canUseCookies",(function(){return Ea}),(function(e){Ea=e,uo(_a,(function(t){t.setEnabled(e)}))}))),-1===lo(_a,r)&&_a.push(r),ao(n)&&r.setEnabled(n),ao(Ea)&&r.setEnabled(Ea),r}var Aa="00000000000000000000000000000000";function Ra(e,t,r){return!(!e||e.length!==t||e===r)&&!!e.match(/^[\da-f]*$/i)}function Pa(e){return Ra(e,32,Aa)}function Na(e){return Ra(e,16,"0000000000000000")}var Ma=Hi("plugin");function Oa(e){return Ma.get(e,"state",{},!0)}function Ua(e,t){for(var r,n=[],o=null,i=e.getNext();i;){var a=i.getPlugin();if(a){o&&Vn(o.setNextPlugin)&&Vn(a.processTelemetry)&&o.setNextPlugin(a);(Vn(a.isInitialized)?a.isInitialized():(r=Oa(a)).isInitialized)||n.push(a),o=a,i=i.getNext()}}uo(n,(function(n){var o=e.core();n.initialize(e.getCfg(),o,t,e.getNext()),r=Oa(n),n.core||r.core||(r.core=o),r.isInitialized=!0,delete r.teardown}))}function qa(e){return e.sort((function(e,t){var r=0;if(t){var n=Vn(t.processTelemetry);Vn(e.processTelemetry)?r=n?e.priority-t.priority:1:n&&(r=-1)}else r=e?1:-1;return r}))}var La=0;function Ha(e,t,r,n){var o=null,i=[];null!==n&&(o=n?function(e,t,r){for(;e;){if(e.getPlugin()===r)return e;e=e.getNext()}return Fa([r],t.config||{},t)}(e,r,n):e);var a={_next:function(){var e=o;if(o=e?e.getNext():null,!e){var t=i;t&&t.length>0&&(uo(t,(function(e){try{e.func.call(e.self,e.args)}catch(e){Ci(r.logger,2,73,"Unexpected Exception during onComplete - "+ni(e))}})),i=[])}return e},ctx:{core:function(){return r},diagLog:function(){return mi(r,t)},getCfg:function(){return t},getExtCfg:s,getConfig:function(e,r,n){void 0===n&&(n=!1);var o,i=s(e,null);i&&!Wn(i[r])?o=i[r]:t&&!Wn(t[r])&&(o=t[r]);return Wn(o)?n:o},hasNext:function(){return!!o},getNext:function(){return o},setNext:function(e){o=e},iterate:function(e){var t;for(;t=a._next();){var r=t.getPlugin();r&&e(r)}},onComplete:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];e&&i.push({func:e,self:zn(t)?a.ctx:t,args:r})}}};function s(e,r,n){var o;if(void 0===r&&(r={}),void 0===n&&(n=0),t){var i=t.extensionConfig;i&&e&&(o=i[e])}if(o){if(Yn(r)&&0!==n){var a=Oo(!0,r,o);t&&2===n&&Xn(r,(function(e){if(Wn(a[e])){var r=t[e];Wn(r)||(a[e]=r)}})),o=a}}else o=r;return o}return a}function Da(e,t,r,n){var o=Ha(e,t,r,n),i=o.ctx;return i.processNext=function(e){var t=o._next();return t&&t.processTelemetry(e,i),!t},i.createNew=function(e,n){return void 0===e&&(e=null),ro(e)&&(e=Fa(e,t,r,n)),Da(e||i.getNext(),t,r,n)},i}function xa(e,t,r){var n=t.config||{},o=Ha(e,n,t,r),i=o.ctx;return i.processNext=function(e){var t=o._next();return t&&t.unload(i,e),!t},i.createNew=function(e,r){return void 0===e&&(e=null),ro(e)&&(e=Fa(e,n,t,r)),xa(e||i.getNext(),t,r)},i}function Ba(e,t,r){var n=t.config||{},o=Ha(e,n,t,r).ctx;return o.processNext=function(e){return o.iterate((function(t){Vn(t.update)&&t.update(o,e)}))},o.createNew=function(e,r){return void 0===e&&(e=null),ro(e)&&(e=Fa(e,n,t,r)),Ba(e||o.getNext(),t,r)},o}function Fa(e,t,r,n){var o=null,i=!n;if(ro(e)&&e.length>0){var a=null;uo(e,(function(e){if(i||n!==e||(i=!0),i&&e&&Vn(e.processTelemetry)){var s=function(e,t,r){var n,o=null,i=Vn(e.processTelemetry),a=Vn(e.setNextPlugin);n=e?e.identifier+"-"+e.priority+"-"+La++:"Unknown-0-"+La++;var s={getPlugin:function(){return e},getNext:function(){return o},processTelemetry:function(t,r){u(r=r||c(),(function(r){if(!e||!i)return!1;var n=Oa(e);if(n.teardown||n.disabled)return!1;a&&e.setNextPlugin(o);return e.processTelemetry(t,r),!0}),"processTelemetry",(function(){return{item:t}}),!t.sync)||r.processNext(t)},unload:function(t,r){u(t,(function(){var n=!1;if(e){var o=Oa(e),i=e.core||o.core;!e||i&&i!==t.core()||o.teardown||(o.core=null,o.teardown=!0,o.isInitialized=!1,e.teardown&&!0===e.teardown(t,r)&&(n=!0))}return n}),"unload",(function(){}),r.isAsync)||t.processNext(r)},update:function(t,r){u(t,(function(){var n=!1;if(e){var o=Oa(e),i=e.core||o.core;!e||i&&i!==t.core()||o.teardown||e.update&&!0===e.update(t,r)&&(n=!0)}return n}),"update",(function(){}),!1)||t.processNext(r)},_id:n,_setNext:function(e){o=e}};function c(){var n;return e&&Vn(e._getTelCtx)&&(n=e._getTelCtx()),n||(n=Da(s,t,r)),n}function u(t,r,i,a,s){var c=!1,u=e?e.identifier:"TelemetryPluginChain",l=t._hasRun;return l||(l=t._hasRun={}),t.setNext(o),e&&Ho(t.core(),(function(){return u+":"+i}),(function(){l[n]=!0;try{var e=o?o._id:"";e&&(l[e]=!1),c=r(t)}catch(e){var a=!o||l[o._id];a&&(c=!0),o&&a||Ci(t.diagLog(),1,73,"Plugin ["+u+"] failed during "+i+" - "+ni(e)+", run flags: "+ni(l))}}),a,s),c}return Eo(s)}(e,t,r);o||(o=s),a&&a._setNext(s),a=s}}))}return n&&!o?Fa([n],t,r):o}function Ka(e,t,r){t&&ro(t)&&t.length>0&&(uo(t=t.sort((function(e,t){return e.priority-t.priority})),(function(e){e.priority<500&&Ao("Channel has invalid priority - "+e.identifier)})),e.push({queue:Eo(t),chain:Fa(t,r.config,r)}))}function Ga(){var e=[];return{add:function(t){t&&e.push(t)},run:function(t,r){uo(e,(function(e){try{e(t,r)}catch(e){Ci(t.diagLog(),2,73,"Unexpected error calling unload handler - "+ni(e))}})),e=[]}}}var za=function(){function e(){var t,r,n,o,i,a=this;function s(e){void 0===e&&(e=null);var t=e;if(!t){var o=r||Da(null,{},a.core);t=n&&n.getPlugin?o.createNew(null,n.getPlugin):o.createNew(null,n)}return t}function c(e,t,o){e&&wo(e,"extensionConfig",[],null,Wn),!o&&t&&(o=t.getProcessTelContext().getNext());var i=n;n&&n.getPlugin&&(i=n.getPlugin()),a.core=t,r=Da(o,e,t,i)}function u(){t=!1,a.core=null,r=null,n=null,i=[],o=Ga()}u(),Object(wn.a)(e,a,(function(e){e.initialize=function(e,r,n,o){c(e,r,o),t=!0},e.teardown=function(t,r){var a,s=e.core;if(s&&(!t||s===t.core())){var c,l=!1,d=t||xa(null,s,n&&n.getPlugin?n.getPlugin():n),h=r||((a={reason:0}).isAsync=!1,a);return e._doTeardown&&!0===e._doTeardown(d,h,p)?c=!0:p(),c}function p(){if(!l){l=!0,o.run(d,r);var e=i;i=[],uo(e,(function(e){e.rm()})),!0===c&&d.processNext(h),u()}}},e.update=function(t,r){var o=e.core;if(o&&(!t||o===t.core())){var i,a=!1,s=t||Ba(null,o,n&&n.getPlugin?n.getPlugin():n),u=r||{reason:0};return e._doUpdate&&!0===e._doUpdate(s,u,l)?i=!0:l(),i}function l(){a||(a=!0,c(s.getCfg(),s.core(),s.getNext()))}},e._addHook=function(e){e&&(ro(e)?i=i.concat(e):i.push(e))},Po(e,"_addUnloadCb",(function(){return o}),"add")})),a.diagLog=function(e){return s(e).diagLog()},a.isInitialized=function(){return t},a.setInitialized=function(e){t=e},a.setNextPlugin=function(e){n=e},a.processNext=function(e,t){t?t.processNext(e):n&&Vn(n.processTelemetry)&&n.processTelemetry(e,null)},a._getTelCtx=s}return e.__ieDyn=1,e}(),Wa=function(e){function t(){var r,n,o=e.call(this)||this;function i(){r=0,n=[]}return o.identifier="TelemetryInitializerPlugin",o.priority=199,i(),Object(wn.a)(t,o,(function(e,t){e.addTelemetryInitializer=function(e){var t={id:r++,fn:e};return n.push(t),{remove:function(){uo(n,(function(e,r){if(e.id===t.id)return n.splice(r,1),-1}))}}},e.processTelemetry=function(t,r){for(var o=!1,i=n.length,a=0;a<i;++a){var s=n[a];if(s)try{if(!1===s.fn.apply(null,[t])){o=!0;break}}catch(e){Ci(r.diagLog(),1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+Io(e),{exception:ni(e)},!0)}}o||e.processNext(t,r)},e._doTeardown=function(){i()}})),o}return Object(In.a)(t,e),t.__ieDyn=1,t}(za),ja={loggingLevelConsole:1};function Qa(e,t){return new Lo(t)}function Ya(e,t){var r=!1;return uo(t,(function(t){if(t===e)return r=!0,-1})),r}var Va=function(){function e(){var t,r,n,o,i,a,s,c,u,l,d,h,p,f,g,m,v,y,C,T,E=0,_=!1;Object(wn.a)(e,this,(function(e){function I(r){if(!E&&!_&&(r||e.logger&&e.logger.queue.length>0)){var n=bo(t.diagnosticLogInterval);n&&n>0||(n=1e4),E=setInterval((function(){clearInterval(E),E=0,P()}),n)}return E}function w(){r=!1,t=Oo(!0,{},ja),e.config=t,e.logger=new vi(t),e._extensions=[],g=new Wa,n=[],o=null,i=null,a=null,s=null,c=null,l=null,u=[],d=null,h=null,p=null,f=!1,m=null,v=Li("AIBaseCore",!0),y=Ga(),T=null}function S(){var r=Da(A(),t,e);return r.onComplete(I),r}function b(r){var n=function(e,t,r){var n,o=[],i={};return uo(r,(function(r){(Wn(r)||Wn(r.initialize))&&Ao("Plugins must provide initialize method");var n=r.priority,a=r.identifier;r&&n&&(Wn(i[n])?i[n]=a:Ti(e,"Two extensions have same priority #"+n+" - "+i[n]+", "+a)),(!n||n<t)&&o.push(r)})),(n={all:r}).core=o,n}(e.logger,500,u);l=n.core,c=null;var o=n.all;if(p=Eo(function(e,t,r){var n=[];if(e&&uo(e,(function(e){return Ka(n,e,r)})),t){var o=[];uo(t,(function(e){e.priority>500&&o.push(e)})),Ka(n,o,r)}return n}(h,o,e)),d){var i=lo(o,d);-1!==i&&o.splice(i,1),-1!==(i=lo(l,d))&&l.splice(i,1),d._setQueue(p)}else d=function(e,t){function r(){return Da(null,t.config,t,null)}function n(e,t,r,n){var o=e?e.length+1:1;function i(){0===--o&&(n&&n(),n=null)}o>0&&uo(e,(function(e){if(e&&e.queue.length>0){var n=e.chain,a=t.createNew(n);a.onComplete(i),r(a)}else o--})),i()}var o=!1;return{identifier:"ChannelControllerPlugin",priority:500,initialize:function(t,r,n,i){o=!0,uo(e,(function(e){e&&e.queue.length>0&&Ua(Da(e.chain,t,r),n)}))},isInitialized:function(){return o},processTelemetry:function(t,o){n(e,o||r(),(function(e){e.processNext(t)}),(function(){o.processNext(t)}))},update:function(t,r){var o=r||{reason:0};return n(e,t,(function(e){e.processNext(o)}),(function(){t.processNext(o)})),!0},pause:function(){n(e,r(),(function(e){e.iterate((function(e){e.pause&&e.pause()}))}),null)},resume:function(){n(e,r(),(function(e){e.iterate((function(e){e.resume&&e.resume()}))}),null)},teardown:function(t,r){var i=r||{reason:0,isAsync:!1};return n(e,t,(function(e){e.processNext(i)}),(function(){t.processNext(i),o=!1})),!0},getChannel:function(t){var r=null;return e&&e.length>0&&uo(e,(function(e){if(e&&e.queue.length>0&&(uo(e.queue,(function(e){if(e.identifier===t)return r=e,-1})),r))return-1})),r},flush:function(t,o,i,a){var s=1,c=!1,u=null;function l(){s--,c&&0===s&&(u&&(clearTimeout(u),u=null),o&&o(c),o=null)}return a=a||5e3,n(e,r(),(function(e){e.iterate((function(e){if(e.flush){s++;var r=!1;e.flush(t,(function(){r=!0,l()}),i)||r||(t&&null==u?u=setTimeout((function(){u=null,l()}),a):l())}}))}),(function(){c=!0,l()})),!0},_setQueue:function(t){e=t}}}(p,e);o.push(d),l.push(d),e._extensions=qa(o),d.initialize(t,e,o),Ua(S(),o),e._extensions=Eo(qa(l||[])).slice(),r&&function(t){var r=Ba(A(),e);r.onComplete(I),e._updateHook&&!0===e._updateHook(r,t)||r.processNext(t)}(r)}function k(t){var r,n=null,o=null;return uo(e._extensions,(function(e){if(e.identifier===t&&e!==d&&e!==g)return o=e,-1})),!o&&d&&(o=d.getChannel(t)),o&&((r={plugin:o}).setEnabled=function(e){Oa(o).disabled=!e},r.isEnabled=function(){var e=Oa(o);return!e.teardown&&!e.disabled},r.remove=function(e,t){var r;void 0===e&&(e=!0);var n=[o],i=((r={reason:1}).isAsync=e,r);R(n,i,(function(e){e&&b({reason:32,removed:n}),t&&t(e)}))},n=r),n}function A(){if(!c){var r=(l||[]).slice();-1===lo(r,g)&&r.push(g),c=Fa(qa(r),t,e)}return c}function R(r,n,o){if(r&&r.length>0){var i=xa(Fa(r,t,e),e);i.onComplete((function(){var e=!1,t=[];uo(u,(function(n,o){Ya(n,r)?e=!0:t.push(n)})),u=t;var n=[];h&&(uo(h,(function(t,o){var i=[];uo(t,(function(t){Ya(t,r)?e=!0:i.push(t)})),n.push(i)})),h=n),o&&o(e),I()})),i.processNext(n)}else o(!1)}function P(){if(e.logger&&e.logger.queue){var r=e.logger.queue.slice(0);e.logger.queue.length=0,uo(r,(function(r){var n,o=((n={}).name=m||"InternalMessageId: "+r.messageId,n.iKey=bo(t.instrumentationKey),n.time=co(new Date),n.baseType=gi.dataType,n.baseData={message:r.message},n);e.track(o)}))}}function N(e,t,r,n){return d?d.flush(e,t,r||6,n):(t&&t(!1),!0)}function M(t){var r=e.logger;r?(Ci(r,2,73,t),I()):Ao(t)}w(),e.isInitialized=function(){return r},e.initialize=function(n,i,s,c){f&&Ao("SDK is still unloading..."),e.isInitialized()&&Ao("Core should not be initialized more than once"),t=n||{},e.config=t,Wn(n.instrumentationKey)&&Ao("Please provide instrumentation key"),o=c,e._notificationManager=c,function(){var e=bo(t.disableDbgExt);!0===e&&C&&(o.removeNotificationListener(C),C=null);o&&!C&&!0!==e&&(C=function(e){if(!ci){ci={};for(var t=0;t<ui.length;t++)ci[ui[t]]=di(ui[t],e)}return ci}(t),o.addNotificationListener(C))}(),function(){var e=bo(t.enablePerfMgr);!e&&a&&(a=null);e&&So(t,"createPerfMgr",Qa)}(),So(t,"extensionConfig",{}).NotificationManager=o,s&&(e.logger=s);var l=So(t,"extensions",[]);(u=[]).push.apply(u,Object(In.b)(Object(In.b)([],i,!1),l,!1)),h=So(t,"channels",[]),b(null),p&&0!==p.length||Ao("No channels available"),r=!0,e.releaseQueue()},e.getTransmissionControls=function(){var e=[];return p&&uo(p,(function(t){e.push(t.queue)})),Eo(e)},e.track=function(r){r.iKey=r.iKey||t.instrumentationKey,r.time=r.time||co(new Date),r.ver=r.ver||"4.0",!f&&e.isInitialized()?S().processNext(r):n.push(r)},e.getProcessTelContext=S,e.getNotifyMgr=function(){var t;return o||(o=Object(bn.b)(((t={}).addNotificationListener=function(e){},t.removeNotificationListener=function(e){},t.eventsSent=function(e){},t.eventsDiscarded=function(e,t){},t.eventsSendRequest=function(e,t){},t)),e._notificationManager=o),o},e.addNotificationListener=function(e){o&&o.addNotificationListener(e)},e.removeNotificationListener=function(e){o&&o.removeNotificationListener(e)},e.getCookieMgr=function(){return s||(s=Yi(t,e.logger)),s},e.setCookieMgr=function(e){s=e},e.getPerfMgr=function(){if(!i&&!a&&bo(t.enablePerfMgr)){var r=bo(t.createPerfMgr);Vn(r)&&(a=r(e,e.getNotifyMgr()))}return i||a||Uo},e.setPerfMgr=function(e){i=e},e.eventCnt=function(){return n.length},e.releaseQueue=function(){if(r&&n.length>0){var e=n;n=[],uo(e,(function(e){S().processNext(e)}))}},e.pollInternalLogs=function(e){return m=e||null,_=!1,E&&(clearInterval(E),E=null),I(!0)},e.stopPollingInternalLogs=function(){_=!0,E&&(clearInterval(E),E=0,P())},No(e,(function(){return g}),["addTelemetryInitializer"]),e.unload=function(t,n,o){var i;void 0===t&&(t=!0),r||Ao("SDK is not initialized"),f&&Ao("SDK is still unloading...");var a=((i={reason:50}).isAsync=t,i.flushComplete=!1,i),s=xa(A(),e);function c(t){a.flushComplete=t,f=!0,y.run(s,a),e.stopPollingInternalLogs(),s.processNext(a)}s.onComplete((function(){w(),n&&n(a)}),e),P(),N(t,c,6,o)||c(!1)},e.getPlugin=k,e.addPlugin=function(e,t,r,n){if(!e)return n&&n(!1),void M("Plugins must provide initialize method");var o=k(e.identifier);if(o&&!t)return n&&n(!1),void M("Plugin ["+e.identifier+"] is already loaded!");var i={reason:16};function a(t){u.push(e),i.added=[e],b(i),n&&n(!0)}if(o){var s=[o.plugin];R(s,{reason:2,isAsync:!!r},(function(e){e?(i.removed=s,i.reason|=32,a()):n&&n(!1)}))}else a()},e.evtNamespace=function(){return v},e.flush=N,e.getTraceCtx=function(e){var t,r;return T||(r={},T={getName:function(){return r.name},setName:function(e){t&&t.setName(e),r.name=e},getTraceId:function(){return r.traceId},setTraceId:function(e){t&&t.setTraceId(e),Pa(e)&&(r.traceId=e)},getSpanId:function(){return r.spanId},setSpanId:function(e){t&&t.setSpanId(e),Na(e)&&(r.spanId=e)},getTraceFlags:function(){return r.traceFlags},setTraceFlags:function(e){t&&t.setTraceFlags(e),r.traceFlags=e}}),T},e.setTraceCtx=function(e){T=e||null},Po(e,"addUnloadCb",(function(){return y}),"add")}))}return e.__ieDyn=1,e}();function Ja(e,t,r,n){uo(e,(function(e){if(e&&e[t])if(r)setTimeout((function(){return n(e)}),0);else try{n(e)}catch(e){}}))}var Xa,Za=function(){function e(t){this.listeners=[];var r=!!(t||{}).perfEvtsSendAll;Object(wn.a)(e,this,(function(e){e.addNotificationListener=function(t){e.listeners.push(t)},e.removeNotificationListener=function(t){for(var r=lo(e.listeners,t);r>-1;)e.listeners.splice(r,1),r=lo(e.listeners,t)},e.eventsSent=function(t){Ja(e.listeners,"eventsSent",!0,(function(e){e.eventsSent(t)}))},e.eventsDiscarded=function(t,r){Ja(e.listeners,"eventsDiscarded",!0,(function(e){e.eventsDiscarded(t,r)}))},e.eventsSendRequest=function(t,r){Ja(e.listeners,"eventsSendRequest",r,(function(e){e.eventsSendRequest(t,r)}))},e.perfEvent=function(t){t&&(!r&&t.isChildEvt()||Ja(e.listeners,"perfEvent",!1,(function(e){t.isAsync?setTimeout((function(){return e.perfEvent(t)}),0):e.perfEvent(t)})))}}))}return e.__ieDyn=1,e}(),$a=function(e){function t(){var r=e.call(this)||this;return Object(wn.a)(t,r,(function(e,t){function r(t){var r=e.getNotifyMgr();r&&r.eventsDiscarded([t],2)}e.initialize=function(e,r,n,o){t.initialize(e,r,n||new vi(e),o||new Za(e))},e.track=function(n){Ho(e.getPerfMgr(),(function(){return"AppInsightsCore:track"}),(function(){null===n&&(r(n),Ao("Invalid telemetry item")),function(e){Wn(e.name)&&(r(e),Ao("telemetry name required"))}(n),t.track(n)}),(function(){return{item:n}}),!n.sync)}})),r}return Object(In.a)(t,e),t.__ieDyn=1,t}(Va),es=((Xa={})[0]=0,Xa[2]=6,Xa[1]=1,Xa[3]=7,Xa[4098]=6,Xa[4097]=1,Xa[4099]=7,Xa);Boolean(Yo()),Boolean(jo());function ts(e){return!(""===e||Wn(e))}function rs(e){if(e){var t=e.indexOf("-");if(t>-1)return e.substring(0,t)}return""}function ns(e){return!!(e&&io(e)&&e>=1&&e<=4)}function os(e,t,r){if(!t&&!ts(t)||"string"!=typeof e)return null;var n=typeof t;if("string"===n||"number"===n||"boolean"===n||ro(t))t={value:t};else if("object"!==n||Sn.e.call(t,"value")){if(Wn(t.value)||""===t.value||!oo(t.value)&&!io(t.value)&&!ao(t.value)&&!ro(t.value))return null}else t={value:r?JSON.stringify(t):t};if(ro(t.value)&&!ds(t.value))return null;if(!Wn(t.kind)){if(ro(t.value)||!ls(t.kind))return null;t.value=t.value.toString()}return t}function is(e,t,r){var n=-1;if(!zn(e))if(t>0&&(32===t?n=8192:t<=13&&(n=t<<5)),function(e){if(e>=0&&e<=9)return!0;return!1}(r))-1===n&&(n=0),n|=r;else{var o=es[ps(e)]||-1;-1!==n&&-1!==o?n|=o:6===o&&(n=o)}return n}function as(e,t,r){var n;return void 0===r&&(r=!0),e&&(n=e.get(t),r&&n&&decodeURIComponent&&(n=decodeURIComponent(n))),n||""}function ss(e){void 0===e&&(e="D");var t=Ia();return"B"===e?t="{"+t+"}":"P"===e?t="("+t+")":"N"===e&&(t=t.replace(/-/g,"")),t}function cs(e,t,r,n,o){var i={},a=!1,s=0,c=arguments.length,u=Object[Sn.k],l=arguments;for("[object Boolean]"===u.toString.call(l[0])&&(a=l[0],s++);s<c;s++){Xn(e=l[s],(function(e,t){a&&t&&Yn(t)?ro(t)?(i[e]=i[e]||[],uo(t,(function(t,r){t&&Yn(t)?i[e][r]=cs(!0,i[e][r],t):i[e][r]=t}))):i[e]=cs(!0,i[e],t):i[e]=t}))}return i}var us=wa;function ls(e){return 0===e||e>0&&e<=13||32===e}function ds(e){return e.length>0}function hs(e,t){var r=e;r.timings=r.timings||{},r.timings.processTelemetryStart=r.timings.processTelemetryStart||{},r.timings.processTelemetryStart[t]=us()}function ps(e){var t=0;if(null!=e){var r=typeof e;"string"===r?t=1:"number"===r?t=2:"boolean"===r?t=3:r===Sn.j&&(t=4,ro(e)?(t=4096,e.length>0&&(t|=ps(e[0]))):Sn.e.call(e,"value")&&(t=8192|ps(e.value)))}return t}Sn.l,Sn.j,Sn.l,bn.b;var fs=function(e){function t(){var r=e.call(this)||this;return r.pluginVersionStringArr=[],Object(wn.a)(t,r,(function(e,t){e.logger&&e.logger.queue||(e.logger=new vi({loggingLevelConsole:1})),e.initialize=function(r,n,o,i){Ho(e,(function(){return"AppInsightsCore.initialize"}),(function(){var a=e.pluginVersionStringArr;if(r){r.endpointUrl||(r.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/");var s=r.propertyStorageOverride;!s||s.getProperty&&s.setProperty||Ao("Invalid property storage override passed."),r.channels&&uo(r.channels,(function(e){e&&uo(e,(function(e){if(e.identifier&&e.version){var t=e.identifier+"="+e.version;a.push(t)}}))}))}e.getWParam=function(){return"undefined"!=typeof document||r.enableWParam?0:-1},n&&uo(n,(function(e){if(e&&e.identifier&&e.version){var t=e.identifier+"="+e.version;a.push(t)}})),e.pluginVersionString=a.join(";"),e.pluginVersionStringArr=a;try{t.initialize(r,n,o,i),e.pollInternalLogs("InternalLog")}catch(t){var c=e.logger,u=ni(t);-1!==u.indexOf("channels")&&(u+="\n - Channels must be provided through config.channels only!"),Ci(c,1,514,"SDK Initialization Failed - no telemetry will be sent: "+u)}}),(function(){return{config:r,extensions:n,logger:o,notificationManager:i}}))},e.track=function(r){Ho(e,(function(){return"AppInsightsCore.track"}),(function(){var n=r;if(n){n.timings=n.timings||{},n.timings.trackStart=us(),ns(n.latency)||(n.latency=1);var o=n.ext=n.ext||{};o.sdk=o.sdk||{},o.sdk.ver="1DS-Web-JS-3.2.14";var i=n.baseData=n.baseData||{};i.properties=i.properties||{};var a=i.properties;a.version=a.version||e.pluginVersionString||""}t.track(n)}),(function(){return{item:r}}),!r.sync)}})),r}return Object(In.a)(t,e),t.__ieDyn=1,t}($a);function gs(e){var t={};return Xn(e,(function(e,r){t[e]=r[1],t[r[0]]=r[1]})),To(t)}Sn.k;var ms,vs=gs({UserExt:[0,"user"],DeviceExt:[1,"device"],TraceExt:[2,"trace"],WebExt:[3,"web"],AppExt:[4,"app"],OSExt:[5,"os"],SdkExt:[6,"sdk"],IntWebExt:[7,"intweb"],UtcExt:[8,"utc"],LocExt:[9,"loc"],CloudExt:[10,"cloud"],DtExt:[11,"dt"]}),ys=gs({id:[0,"id"],ver:[1,"ver"],appName:[2,"name"],locale:[3,"locale"],expId:[4,"expId"],env:[5,"env"]}),Cs=gs({domain:[0,"domain"],browser:[1,"browser"],browserVer:[2,"browserVer"],screenRes:[3,"screenRes"],userConsent:[4,"userConsent"],consentDetails:[5,"consentDetails"]}),Ts=gs({locale:[0,"locale"],localId:[1,"localId"],id:[2,"id"]}),Es=gs({osName:[0,"name"],ver:[1,"ver"]}),_s=gs({ver:[0,"ver"],seq:[1,"seq"],installId:[2,"installId"],epoch:[3,"epoch"]}),Is=gs({msfpc:[0,"msfpc"],anid:[1,"anid"],serviceName:[2,"serviceName"]}),ws=gs({popSample:[0,"popSample"],eventFlags:[1,"eventFlags"]}),Ss=gs({tz:[0,"tz"]}),bs=gs({sessionId:[0,"sesId"]}),ks=gs({localId:[0,"localId"],deviceClass:[1,"deviceClass"],make:[2,"make"],model:[3,"model"]}),As=gs({role:[0,"role"],roleInstance:[1,"roleInstance"],roleVer:[2,"roleVer"]}),Rs=gs({traceId:[0,"traceID"],traceName:[1,"name"],parentId:[2,"parentID"]}),Ps=gs({traceId:[0,"traceId"],spanId:[1,"spanId"],traceFlags:[2,"traceFlags"]});function Ns(){return void 0===ms&&(ms=!!Os(0)),ms}function Ms(){return Ns()?Os(0):null}function Os(e){var t,r,n=null;try{var o=Object(bn.a)();if(!o)return null;r=new Date,(n=0===e?o.localStorage:o.sessionStorage)&&Vn(n.setItem)&&(n.setItem(r,r),t=n.getItem(r)!==r,n.removeItem(r),t&&(n=null))}catch(e){n=null}return n}function Us(){return this.getId()}function qs(e){this.setId(e)}var Ls=function(){function e(){Object(wn.a)(e,this,(function(e){e.setId=function(t){e.customId=t},e.getId=function(){return oo(e.customId)?e.customId:e.automaticId}}))}return e._staticInit=void yo(e.prototype,"id",Us,qs),e}(),Hs=function(){function e(t,r){var n,o,i=mi(t),a=Qi(t);Object(wn.a)(e,this,(function(t){var s,c={sessionRenewalMs:(s=r).sessionRenewalMs&&function(){return s.sessionRenewalMs},sessionExpirationMs:s.sessionExpirationMs&&function(){return s.sessionExpirationMs},cookieDomain:s.cookieDomain&&function(){return s.cookieDomain},namePrefix:s.namePrefix&&function(){return s.namePrefix},sessionAsGuid:function(){return s.sessionAsGuid},idLength:function(){return s.idLength?s.idLength:22}};function u(e){var r=t.automaticSession,n=e.split("|");n.length>0&&r.setId(n[0]);try{if(n.length>1){var o=+n[1];r.acquisitionDate=+new Date(o),r.acquisitionDate=r.acquisitionDate>0?r.acquisitionDate:0}if(n.length>2){var a=+n[2];r.renewalDate=+new Date(a),r.renewalDate=r.renewalDate>0?r.renewalDate:0}}catch(e){Ci(i,1,510,"Error parsing ai_session cookie, session will be reset: "+e)}0===r.renewalDate&&Ci(i,2,517,"AI session renewal date is 0, session will be reset.")}function l(){var e=t.automaticSession,r=(new Date).getTime(),n=t.config.sessionAsGuid();!zn(n)&&n?ao(n)?e.setId(ss()):e.setId(ss(n)):e.setId(Pi(c&&c.idLength?c.idLength():22)),e.acquisitionDate=r,e.renewalDate=r,d(e.getId(),e.acquisitionDate,e.renewalDate),Ns()||Ci(i,2,505,"Browser does not support local storage. Session durations will be inaccurate.")}function d(e,r,i){var s=r+t.config.sessionExpirationMs(),c=i+t.config.sessionRenewalMs(),u=new Date,l=[e,r,i];s<c?u.setTime(s):u.setTime(c);var d=t.config.cookieDomain?t.config.cookieDomain():null;a.set(o(),l.join("|")+";expires="+u.toUTCString(),null,d),n=(new Date).getTime()}Vn(r.sessionExpirationMs)||(c.sessionExpirationMs=function(){return e.acquisitionSpan}),Vn(r.sessionRenewalMs)||(c.sessionRenewalMs=function(){return e.renewalSpan}),t.config=c,o=function(){return t.config.namePrefix&&t.config.namePrefix()?"ai_session"+t.config.namePrefix():"ai_session"},t.automaticSession=new Ls,t.update=function(){t.automaticSession.getId()||function(){var e=a.get(o());if(e&&Vn(e.split))u(e);else{var r=function(e,t){var r=Ms();if(null!==r)try{return r.getItem(t)}catch(t){ms=!1,Ci(e,1,503,"Browser failed read of local storage. "+t)}return null}(i,o());r&&u(r)}t.automaticSession.getId()||l()}();var r=t.automaticSession,s=t.config,c=(new Date).getTime(),h=c-r.acquisitionDate>s.sessionExpirationMs(),p=c-r.renewalDate>s.sessionRenewalMs();if(h||p)l();else{(!n||c-n>e.cookieUpdateInterval)&&(r.renewalDate=c,d(r.getId(),r.acquisitionDate,r.renewalDate))}},t.backup=function(){var e,r,n,a=t.automaticSession;e=a.getId(),r=a.acquisitionDate,n=a.renewalDate,function(e,t,r){var n=Ms();if(null!==n)try{n.setItem(t,r)}catch(t){ms=!1,Ci(e,1,504,"Browser failed write to local storage. "+t)}}(i,o(),[e,r,n].join("|"))}}))}return e.acquisitionSpan=864e5,e.renewalSpan=18e5,e.cookieUpdateInterval=6e4,e}(),Ds=["AX","EX","SF","CS","CF","CT","CU","DC","DF","H5","HL","WS","WP"];function xs(e,t){void 0===t&&(t=Ds);var r=null;if(e)for(var n=e.split(","),o=0;o<n.length;o++)Bs(n[o],t)&&(r?r+=","+n[o]:r=n[o]);return r}function Bs(e,t){if(void 0===t&&(t=Ds),!e||e.length<4)return!1;for(var r=!1,n=e.substring(0,3).toString().toUpperCase(),o=0;o<t.length;o++)if(t[o]+":"===n&&e.length<=256){r=!0;break}return r}function Fs(){return this.getExpId()}var Ks=function(){function e(t,r){var n=null,o=Ds.slice(0),i=Qi(r),a=t;Object(wn.a)(e,this,(function(e){if(Qo()){var r=Yo().documentElement;r&&(e.locale=r.lang)}function s(e){e!==n&&(n=xs(e,o))}e.env=t.env?t.env:function(e){var t,r={},n=Yo();if(n){t=n&&n.querySelectorAll("meta");for(var o=0;o<t.length;o++){var i=t[o];if(i.name)if(0===i.name.toLowerCase().indexOf(e)){var a=i.name.replace(e,"");r[a]=i.content}}}return r}("awa-").env,e.getExpId=function(){return a.expId?(s(a.expId),n):(s(as(i,"Treatments")),n)}}))}return e.validateAppExpId=xs,e._staticInit=void yo(e.prototype,"expId",Fs),e}(),Gs=function(){},zs=function(){};function Ws(){return this.getMsfpc()}function js(){return this.getAnid()}var Qs=function(){function e(t,r){var n=Qi(r);Object(wn.a)(e,this,(function(e){t.serviceName&&(e.serviceName=t.serviceName),e.getMsfpc=function(){return as(n,"MSFPC")},e.getAnid=function(){return as(n,"ANON").slice(0,34)}}))}var t;return e._staticInit=(yo(t=e.prototype,"msfpc",Ws),void yo(t,"anid",js)),e}(),Ys=function(){var e=(new Date).getTimezoneOffset(),t=e%60,r=(e-t)/60,n="+";r>0&&(n="-"),r=Math.abs(r),t=Math.abs(t),this.tz=n+(r<10?"0"+r:r.toString())+":"+(t<10?"0"+t:t.toString())},Vs={WIN:/(windows|win32)/i,WINRT:/ arm;/i,WINPHONE:/windows\sphone\s\d+\.\d+/i,OSX:/(macintosh|mac os x)/i,IOS:/(ipad|iphone|ipod)(?=.*like mac os x)/i,LINUX:/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,ANDROID:/android/i,CROS:/CrOS/i},Js={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},Xs=[{r:Vs.WINPHONE,os:"Windows Phone"},{r:Vs.WINRT,os:"Windows RT"},{r:Vs.WIN,os:"Windows"},{r:Vs.IOS,os:"iOS"},{r:Vs.ANDROID,os:"Android"},{r:Vs.LINUX,os:"Linux"},{r:Vs.CROS,os:"Chrome OS"},{s:"x11",os:"Unix"},{s:"blackberry",os:"BlackBerry"},{s:"symbian",os:"Symbian"},{s:"nokia",os:"Nokia"},{r:Vs.OSX,os:"Mac OS X"}];function Zs(e,t){return"Windows"===t?$s(e,"Windows NT"):"Android"===t?$s(e,t):"Mac OS X"===t?function(e){var t=e.match(new RegExp("Mac OS X ([\\d,_,.]+)"));if(t){var r=t[1].replace(/_/g,".");if(r){var n=ec(r);return n?r.split(n)[0]:r}}return"Unknown"}(e):"iOS"===t?function(e){var t=e.match(new RegExp("OS ([\\d,_,.]+)"));if(t){var r=t[1].replace(/_/g,".");if(r){var n=ec(r);return n?r.split(n)[0]:r}}return"Unknown"}(e):"Unknown"}function $s(e,t){var r=e.match(new RegExp(t+" ([\\d,.]+)"));return r?Js[r[1]]?Js[r[1]]:r[1]:"Unknown"}function ec(e){return e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null}var tc=function(e){if(e.populateOperatingSystemInfo){var t=Jo()||{},r=e.userAgent||t.userAgent||"",n=e.userAgentData||t.userAgentData||{};if(r){var o=function(e){for(var t=0;t<Xs.length;t++){var r=Xs[t];if(r.r&&e.match(r.r))return r.os;if(r.s&&-1!==e.indexOf(r.s))return r.os}return"Unknown"}(r.toLowerCase());this.name=o,this.ver=Zs(r,o)}this.name&&"Unknown"!==this.name||!oo(n.platform)||(this.name=n.platform)}},rc="MicrosoftApplicationsTelemetryDeviceId";var nc=function(){function e(t,r){var n=0;Object(wn.a)(e,this,(function(e){var o=t.propertyStorageOverride;e.seq=n,e.epoch=ki(!1).toString();var i=Qi(r,t);if(i.isEnabled()||o){var a=function(e,t,r){return t?t.getProperty(r)||"":as(e,r)}(i,o,rc);a||(a=Ia()),function(e,t,r,n){t?t.setProperty(r,n):e.set(r,n,31536e3)}(i,o,rc,a),e.installId=a}else i.purge(rc);e.getSequenceId=function(){return++n}}))}return e.__ieDyn=1,e}(),oc=function(e,t,r,n){if(this.traceId=t||Sa(),e.enableDistributedTracing&&!r&&(r=Sa().substring(0,16)),this.parentId=r,e.enableApplicationInsightsTrace){this.name=n;var o=Xo();o&&o.pathname&&(this.name=o.pathname)}};function ic(){return this.getLocalId()}function ac(e){this.setLocalId(e)}var sc=function(){function e(t,r,n){var o,i=r,a=Qi(n,t);Object(wn.a)(e,this,(function(r){if(a&&a.isEnabled()&&(h(),i.enableApplicationInsightsUser)){var n=as(a,e.userCookieName);if(n){var s=n.split(e.cookieSeparator);s.length>0&&(r.id=s[0])}if(!r.id){r.id=Pi(t&&!zn(t.idLength)?t.idLength:22);var c=co(new Date);r.accountAcquisitionDate=c;var u=[r.id,c],l=i.cookieDomain?i.cookieDomain:void 0;a.set(e.userCookieName,u.join(e.cookieSeparator),31536e3,l)}}if("undefined"!=typeof navigator){var d=navigator;r.locale=d.userLanguage||d.language}function h(){if(!i.hashIdentifiers&&!i.dropIdentifiers){var e=as(a,"MUID");e&&(o="t:"+e)}return o}r.getLocalId=function(){return o||h()},r.setLocalId=function(e){o=e}}))}return e.cookieSeparator="|",e.userCookieName="ai_user",e._staticInit=void yo(e.prototype,"localId",ic,ac),e}(),cc=function(e){this.popSample=100,this.eventFlags=0,e.hashIdentifiers&&(this.eventFlags=1048576|this.eventFlags),e.dropIdentifiers&&(this.eventFlags=2097152|this.eventFlags),e.scrubIpOnly&&(this.eventFlags=4194304|this.eventFlags)},uc=["Required","Analytics","SocialMedia","Advertising"],lc=[{ua:"OPR/",b:"Opera"},{ua:"PhantomJS",b:"PhantomJS"},{ua:"Edge",b:"Edge"},{ua:"Edg/",b:"Edge"},{ua:"Electron",b:"Electron"},{ua:"Chrome",b:"Chrome"},{ua:"Trident",b:"MSIE"},{ua:"MSIE ",b:"MSIE"},{ua:"Firefox",b:"Firefox"},{ua:"Safari",b:"Safari"},{ua:"SkypeShell",b:"SkypeShell"}],dc=[{br:"Microsoft Edge",b:"Edge"},{br:"Google Chrome",b:"Chrome"},{br:"Opera",b:"Opera"}];function hc(e,t){return t.indexOf(e)>-1}function pc(e,t){for(var r=0;r<t.length;r++)if(e==t[r].brand)return t[r].version;return null}function fc(e,t){return"MSIE"===t?function(e){var t=e.match(new RegExp("MSIE ([\\d,.]+)"));if(t)return t[1];var r=e.match(new RegExp("rv:([\\d,.]+)"));if(r)return r[1]}(e):function(e,t){"Safari"===e?e="Version":"Edge"===e&&hc("Edg/",t)&&(e="Edg");var r=t.match(new RegExp(e+"/([\\d,.]+)"));if(r)return r[1];if("Opera"===e&&(r=t.match(new RegExp("OPR/([\\d,.]+)"))))return r[1];return"Unknown"}(t,e)}function gc(){return this.getUserConsent()}var mc=function(){function e(t,r){var n=Qi(r),o=t||{};Object(wn.a)(e,this,(function(e){var t=Xo();if(t){var r=t.hostname;r&&(e.domain="file:"===t.protocol?"local":r)}if(o.populateBrowserInfo){var i=o.userAgent,a=(o.userAgentData||{}).brands,s=Jo();s&&(i=i||s.userAgent||"",a=a||(s.userAgentData||{}).brands),function(t,r){if(ro(r))try{for(var n=0;n<dc.length;n++){var o=pc(dc[n].br,r);if(o)return e.browser=dc[n].b,void(e.browserVer=o)}}catch(e){}if(t){var i=function(e){if(e)for(var t=0;t<lc.length;t++){if(hc(lc[t].ua,e))return lc[t].b}return"Unknown"}(t);e.browser=i,e.browserVer=fc(t,i)}}(i,a);var c=function(){var e={h:0,w:0},t=jo();return t&&t.screen&&(e.h=screen.height,e.w=screen.width),e}();e.screenRes=c.w+"X"+c.h}zn(o.gpcDataSharingOptIn)?e.gpcDataSharingOptIn=null:e.gpcDataSharingOptIn=o.gpcDataSharingOptIn,e.getUserConsent=function(){return o.userConsented||!!as(n,o.userConsentCookieName||"MSCC")},e.getUserConsentDetails=function(){var t=null;try{var r=o.callback;if(r&&r.userConsentDetails){var n=r.userConsentDetails();if(n){t=o.disableConsentDetailsSanitize?n:{};for(var i=0;i<uc.length;i++){var a=uc[i];t[a]=n[a]||!1}}}var s=e.gpcDataSharingOptIn;return null!==s&&((t=t||{}).GPC_DataSharingOptIn=!!s),t?JSON.stringify(t):null}catch(e){}},yo(e,"userConsent",e.getUserConsent)}))}return e._staticInit=void yo(e.prototype,"userConsent",gc),e}();function vc(e,t,r,n,o){var i=t.ext[vs[e]];if(i)try{Xn(n,(function(e,t){if(oo(t)||io(t)||ao(t)){var n=i[r[e]];!o&&(n||oo(n)||io(n)||ao(n))&&(t=n),i[r[e]]=t}}))}catch(e){}return i}var yc=function(){function e(t,r,n){Object(wn.a)(e,this,(function(e){e.app=new Ks(r,n),e.cloud=new Gs,e.user=new sc(t,r,n),e.os=new tc(r),e.web=new mc(r,n);var o=new nc(t,n),i=new Qs(r,n),a=new cc(r);e.loc=new Ys,e.device=new zs;var s=new Hs(n,r);e.session=new Ls;var c,u,l,d=(c=new oc(r),u=f(),l=c||{},{getName:function(){return l.name},setName:function(e){u&&u.setName(e),l.name=e},getTraceId:function(){return l.traceId},setTraceId:function(e){u&&u.setTraceId(e),Pa(e)&&(l.traceId=e)},getSpanId:function(){return l.parentId},setSpanId:function(e){u&&u.setSpanId(e),Na(e)&&(l.parentId=e)},getTraceFlags:function(){return l.traceFlags},setTraceFlags:function(e){u&&u.setTraceFlags(e),l.traceFlags=e}}),h=!(r||{}).eventContainExtFields;function p(){var t=e.session;if(t&&oo(t.customId))return t.customId;s.update();var r=s.automaticSession;if(r){var n=r.getId();n&&oo(n)&&(t.automaticId=n)}return t.automaticId}function f(){var e=d;return n&&n.getTraceCtx&&(e=n.getTraceCtx(!1)||d),e}e.getTraceCtx=function(){return d},e.getSessionId=p,e.applyApplicationContext=function(t){var r,n=e.app;vc(4,t,ys,((r={})[0]=n.id,r[1]=n.ver,r[2]=n.name,r[3]=n.locale,r[4]=n.getExpId(),r[5]=n.env,r),h)},e.applyUserContext=function(t){var r,n=e.user;vc(0,t,Ts,((r={})[1]=n.getLocalId(),r[0]=n.locale,r[2]=n.id,r),h)},e.applyWebContext=function(t){var r,n=e.web;vc(3,t,Cs,((r={})[0]=n.domain,r[1]=n.browser,r[2]=n.browserVer,r[3]=n.screenRes,r[5]=n.getUserConsentDetails(),r[4]=n.getUserConsent(),r),h)},e.applyOsContext=function(t){var r,n=e.os;vc(5,t,Es,((r={})[0]=n.name,r[1]=n.ver,r),h)},e.applySdkContext=function(e){var t;vc(6,e,_s,((t={})[2]=o.installId,t[1]=o.getSequenceId(),t[3]=o.epoch,t),h)},e.applyIntWebContext=function(e){var t;vc(7,e,Is,((t={})[0]=i.getMsfpc(),t[1]=i.getAnid(),t[2]=i.serviceName,t),h)},e.applyUtcContext=function(e){var t,r=((t={})[0]=a.popSample,t);a.eventFlags>0&&(r[1]=a.eventFlags),vc(8,e,ws,r,h)},e.applyLocContext=function(t){var r;vc(9,t,Ss,((r={})[0]=e.loc.tz,r),h)},e.applySessionContext=function(e){var t;vc(4,e,bs,((t={})[0]=p(),t),h)},e.applyDeviceContext=function(t){var r,n=e.device;vc(1,t,ks,((r={})[0]=n.localId,r[2]=n.make,r[3]=n.model,r[1]=n.deviceClass,r),h)},e.applyCloudContext=function(t){var r,n=e.cloud;vc(10,t,As,((r={})[0]=n.role,r[1]=n.roleInstance,r[2]=n.roleVer,r),h)},e.applyAITraceContext=function(e){var t;if(r.enableApplicationInsightsTrace){var n=f();n&&vc(2,e,Rs,((t={})[0]=n.getTraceId(),t[1]=n.getName(),t[2]=n.getSpanId(),t),!1)}},e.applyDistributedTraceContext=function(e){var t,r=f();if(r){var n=((t={})[0]=r.getTraceId(),t[1]=r.getSpanId(),t),o=r.getTraceFlags();Wn(o)||(n[2]=o),vc(11,e,Ps,n,!1)}}}))}return e.__ieDyn=1,e}();var Cc,Tc=[vs[4],vs[0],vs[3],vs[5],vs[6],vs[7],vs[8],vs[9],vs[1],vs[2],vs[11],vs[10]],Ec=function(e){function t(){var r,n,o,i=e.call(this)||this;return i.identifier="SystemPropertiesCollector",i.priority=3,i.version="3.2.14",Object(wn.a)(t,i,(function(e,t){function i(){r=null,n={}}i(),e.initialize=function(n,i,a){t.initialize(n,i,a),o=e._getTelCtx().getExtCfg(e.identifier),r=new yc(n,o,i),i&&i.setTraceCtx&&i.setTraceCtx(r.getTraceCtx())},e.processTelemetry=function(t,i){hs(t,e.identifier),i=e._getTelCtx(i);var a,s,c=t.ext=t.ext?t.ext:{};t.data=t.data?t.data:{},uo(Tc,(function(e){c[e]=c[e]||{}})),r&&(r.applyUtcContext(t),r.applyApplicationContext(t),r.applyUserContext(t),r.applyWebContext(t),r.applyOsContext(t),r.applySdkContext(t),r.applyIntWebContext(t),r.applyLocContext(t),r.applySessionContext(t),r.applyDeviceContext(t),o.enableApplicationInsightsTrace&&r.applyAITraceContext(t),o.enableDistributedTracing&&r.applyDistributedTraceContext(t),r.applyCloudContext(t)),uo(vo(c),(function(e){0===vo(c[e]).length&&delete c[e]})),a=n,s=t.data,a&&Xn(a,(function(e,t){s[e]||(s[e]=t)})),e.processNext(t,i)},e.getPropertiesContext=function(){return r},e.setProperty=function(e,t){n[e]=t},e._doTeardown=function(e,t){var n=(e||{}).core();if(n&&n.getTraceCtx&&r){var o=n.getTraceCtx(!1);o&&o===r.getTraceCtx()&&n.setTraceCtx(null)}i()}})),i}return Object(In.a)(t,e),t.__ieDyn=1,t}(za),_c=(Cc={},Xn({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5},(function(e,t){Cc[e]=t,Cc[t]=e})),To(Cc));function Ic(e){var t=(e.ext||{}).intweb;return t&&ts(t.msfpc)?t.msfpc:null}function wc(e){for(var t=null,r=0;null===t&&r<e.length;r++)t=Ic(e[r]);return t}var Sc=function(){function e(t,r){var n=r?[].concat(r):[],o=wc(n);this.iKey=function(){return t},this.Msfpc=function(){return o||""},this.count=function(){return n.length},this.events=function(){return n},this.addEvent=function(e){return!!e&&(n.push(e),o||(o=Ic(e)),!0)},this.split=function(r,i){var a;if(r<n.length){var s=n.length-r;Wn(i)||(s=i<s?i:s),a=n.splice(r,s),o=wc(n)}return new e(t,a)}}return e.create=function(t,r){return new e(t,r)},e}(),bc=function(){function e(){var t=!0,r=!0,n=!0,o="use-collector-delta",i=!1;Object(wn.a)(e,this,(function(e){e.allowRequestSending=function(){return t},e.firstRequestSent=function(){n&&(n=!1,i||(t=!1))},e.shouldAddClockSkewHeaders=function(){return r},e.getClockSkewHeaderValue=function(){return o},e.setClockSkew=function(e){i||(e?(o=e,r=!0,i=!0):r=!1,t=!0)}}))}return e.__ieDyn=1,e}(),kc=function(){function e(){var t={};Object(wn.a)(e,this,(function(e){e.setKillSwitchTenants=function(e,r){if(e&&r)try{var n=function(e){var t=[];return e&&uo(e,(function(e){t.push(fo(e))})),t}(e.split(","));if("this-request-only"===r)return n;for(var o=1e3*parseInt(r,10),i=0;i<n.length;++i)t[n[i]]=_o()+o}catch(e){return[]}return[]},e.isTenantKilled=function(e){var r=t,n=fo(e);return void 0!==r[n]&&r[n]>_o()||(delete r[n],!1)}}))}return e.__ieDyn=1,e}();function Ac(e){var t,r=Math.floor(1200*Math.random())+2400;return t=Math.pow(2,e)*r,Math.min(t,6e5)}var Rc,Pc=Math.min(2e6,65e3),Nc=/\./,Mc=function(){function e(t,r,n,o){var i=!!o,a=r,s={};Object(wn.a)(e,this,(function(e){function r(e,t,o,c,u,l,d){Xn(e,(function(e,h){var p=null;if(h||ts(h)){var f=o,g=e,m=u,v=t;if(i&&!c&&Nc.test(e)){var y=e.split("."),C=y.length;if(C>1){m&&(m=m.slice());for(var T=0;T<C-1;T++){var E=y[T];v=v[E]=v[E]||{},f+="."+E,m&&m.push(E)}g=y[C-1]}}if(p=!(c&&function(e,t){var r=s[e];return void 0===r&&(e.length>=7&&(r=$n(e,"ext.metadata")||$n(e,"ext.web")),s[e]=r),r}(f))&&a&&a.handleField(f,g)?a.value(f,g,h,n):os(g,h,n)){var _=p.value;if(v[g]=_,l&&l(m,g,p),d&&"object"==typeof _&&!ro(_)){var I=m;I&&(I=I.slice()).push(g),r(h,_,f+"."+g,c,I,l,d)}}}}))}e.createPayload=function(e,t,r,n,o,i){return{apiKeys:[],payloadBlob:"",overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:e,isTeardown:t,isSync:r,isBeacon:n,sendType:i,sendReason:o}},e.appendPayload=function(r,n,o){var i=r&&n&&!r.overflow;return i&&Ho(t,(function(){return"Serializer:appendPayload"}),(function(){for(var t=n.events(),i=r.payloadBlob,a=r.numEvents,s=!1,c=[],u=[],l=r.isBeacon,d=l?65e3:3984588,h=l?Pc:2e6,p=0,f=0;p<t.length;){var g=t[p];if(g){if(a>=o){r.overflow=n.split(p);break}var m=e.getEventBlob(g);if(m&&m.length<=h){var v=m.length;if(i.length+v>d){r.overflow=n.split(p);break}i&&(i+="\n"),i+=m,++f>20&&(i.substr(0,1),f=0),s=!0,a++}else m?c.push(g):u.push(g),t.splice(p,1),p--}p++}if(c&&c.length>0&&r.sizeExceed.push(Sc.create(n.iKey(),c)),u&&u.length>0&&r.failedEvts.push(Sc.create(n.iKey(),u)),s){r.batches.push(n),r.payloadBlob=i,r.numEvents=a;var y=n.iKey();-1===lo(r.apiKeys,y)&&r.apiKeys.push(y)}}),(function(){return{payload:r,theBatch:{iKey:n.iKey(),evts:n.events()},max:o}})),i},e.getEventBlob=function(e){try{return Ho(t,(function(){return"Serializer.getEventBlob"}),(function(){var t={};t.name=e.name,t.time=e.time,t.ver=e.ver,t.iKey="o:"+rs(e.iKey);var n={},o=e.ext;o&&(t.ext=n,Xn(o,(function(e,t){r(t,n[e]={},"ext."+e,!0,null,null,!0)})));var i=t.data={};i.baseType=e.baseType;var a=i.baseData={};return r(e.baseData,a,"baseData",!1,["baseData"],(function(e,t,r){Oc(n,e,t,r)}),!0),r(e.data,i,"data",!1,[],(function(e,t,r){Oc(n,e,t,r)}),!0),JSON.stringify(t)}),(function(){return{item:e}}))}catch(e){return null}}}))}return e.__ieDyn=1,e}();function Oc(e,t,r,n){if(n&&e){var o=is(n.value,n.kind,n.propertyType);if(o>-1){var i=e.metadata;i||(i=e.metadata={f:{}});var a=i.f;if(a||(a=i.f={}),t)for(var s=0;s<t.length;s++){var c=t[s];a[c]||(a[c]={f:{}});var u=a[c].f;u||(u=a[c].f={}),a=u}a=a[r]={},ro(n.value)?a.a={t:o}:a.t=o}}}var Uc=((Rc={})[1]="requeue",Rc[100]="requeue",Rc[200]="sent",Rc[8004]="drop",Rc[8003]="drop",Rc),qc={},Lc={};function Hc(e,t,r){qc[e]=t,!1!==r&&(Lc[t]=e)}function Dc(e){try{return e.responseText}catch(e){}return""}function xc(e,t){var r=!1;if(e&&t){var n=vo(e);if(n&&n.length>0)for(var o=t.toLowerCase(),i=0;i<n.length;i++){var a=n[i];if(a&&Qn(t,a)&&a.toLowerCase()===o){r=!0;break}}}return r}function Bc(e,t,r,n){t&&r&&r.length>0&&(n&&qc[t]?(e.hdrs[qc[t]]=r,e.useHdrs=!0):e.url+="&"+t+"="+r)}function Fc(e,t){return t&&(io(t)?e=[t].concat(e):ro(t)&&(e=t.concat(e))),e}Hc("AuthMsaDeviceTicket","AuthMsaDeviceTicket",!1),Hc("client-version","client-version"),Hc("client-id","Client-Id"),Hc("apikey","apikey"),Hc("time-delta-to-apply-millis","time-delta-to-apply-millis"),Hc("upload-time","upload-time"),Hc("AuthXToken","AuthXToken");var Kc=function(){function e(t,r,n,o,i){this._responseHandlers=[];var a,s,c,u,l,d,h,p,f,g,m="?cors=true&"+"content-type".toLowerCase()+"=application/x-json-stream",v=new kc,y=!1,C=new bc,T=!1,E=0,_=!0,I=[],w={},S=[],b=null,k=!1,A=!1,R=!1;Object(wn.a)(e,this,(function(e){var P=!0;function N(e,t){for(var r=0,n=null,o=0;null==n&&o<e.length;)1===(r=e[o])?ai()?n=M:si()&&(n=U):2===r&&ii(t)&&(!t||t&&!p)?n=O:T&&3===r&&oi()&&(n=L),o++;return n?{_transport:r,_isSync:t,sendPOST:n}:null}function M(e,t,r){var n=new XDomainRequest;n.open("POST",e.urlString),e.timeout&&(n.timeout=e.timeout),n.onload=function(){var e=Dc(n);q(t,200,{},e),Y(e)},n.onerror=function(){q(t,400,{})},n.ontimeout=function(){q(t,500,{})},n.onprogress=function(){},r?n.send(e.data):i.set((function(){n.send(e.data)}),0)}function O(e,t,r){var n,o=e.urlString,a=!1,s=!1,c=((n={body:e.data,method:"POST"}).Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,n);r&&(c.keepalive=!0,2===e._sendReason&&(a=!0,g&&(o+="&NoResponseBody=true"))),P&&(c.credentials="include"),e.headers&&vo(e.headers).length>0&&(c.headers=e.headers),fetch(o,c).then((function(e){var r={},n="",o=e.headers;o&&o.forEach((function(e,t){r[t]=e})),e.body&&e.text().then((function(e){n=e})),s||(s=!0,q(t,e.status,r,n),Y(n))})).catch((function(e){s||(s=!0,q(t,0,{}))})),a&&!s&&(s=!0,q(t,200,{})),!s&&e.timeout>0&&i.set((function(){s||(s=!0,q(t,500,{}))}),e.timeout)}function U(e,t,r){var n=e.urlString;function o(e,t,r){if(!e[r]&&t&&t.getResponseHeader){var n=t.getResponseHeader(r);n&&(e[r]=fo(n))}return e}function i(e){var t={};return e.getAllResponseHeaders?t=function(e){var t={};if(oo(e)){uo(fo(e).split(/[\r\n]+/),(function(e){if(e){var r=e.indexOf(": ");if(-1!==r){var n=fo(e.substring(0,r)).toLowerCase(),o=fo(e.substring(r+1));t[n]=o}else t[fo(e)]=1}}))}return t}(e.getAllResponseHeaders()):(t=o(t,e,"time-delta-millis"),t=o(t,e,"kill-duration"),t=o(t,e,"kill-duration-seconds")),t}function a(e,r){q(t,e.status,i(e),r)}r&&e.disableXhrSync&&(r=!1);var s=function(e,t,r,n,o,i){function a(e,t,r){try{e[t]=r}catch(e){}}void 0===n&&(n=!1),void 0===o&&(o=!1);var s=new XMLHttpRequest;return n&&a(s,"Microsoft_ApplicationInsights_BypassAjaxInstrumentation",n),r&&a(s,"withCredentials",r),s.open(e,t,!o),r&&a(s,"withCredentials",r),!o&&i&&a(s,"timeout",i),s}("POST",n,P,!0,r,e.timeout);Xn(e.headers,(function(e,t){s.setRequestHeader(e,t)})),s.onload=function(){var e=Dc(s);a(s,e),Y(e)},s.onerror=function(){a(s)},s.ontimeout=function(){a(s)},s.send(e.data)}function q(e,t,r,n){try{e(t,r,n)}catch(e){Ci(s,2,518,ni(e))}}function L(e,t,r){var n=200,o=e._thePayload,i=e.urlString+(g?"&NoResponseBody=true":"");try{var a=Jo();if(!a.sendBeacon(i,e.data))if(o){var c=[];uo(o.batches,(function(e){if(c&&e&&e.count()>0){for(var t=e.events(),r=0;r<t.length;r++)if(!a.sendBeacon(i,b.getEventBlob(t[r]))){c.push(e.split(r));break}}else c.push(e.split(0))})),V(c,8003,o.sendType,!0)}else n=0}catch(e){Ti(s,"Failed to send telemetry using sendBeacon API. Ex:"+ni(e)),n=0}finally{q(t,n,{},"")}}function H(e){return 2===e||3===e}function D(e){return A&&H(e)&&(e=2),e}function x(){return!y&&E<r}function B(){var e=S;return S=[],e}function F(e,t,r){var n=!1;return e&&e.length>0&&!y&&c[t]&&b&&(n=0!==t||x()&&(r>0||C.allowRequestSending())),n}function K(e){var t={};return e&&uo(e,(function(e,r){t[r]={iKey:e.iKey(),evts:e.events()}})),t}function G(e,r,n,o,i){if(e&&0!==e.length)if(y)V(e,1,o);else{o=D(o);try{var a=e,l=0!==o;Ho(u,(function(){return"HttpManager:_sendBatches"}),(function(a){a&&(e=e.slice(0));for(var s=[],u=null,d=us(),h=c[o]||(l?c[1]:c[0]),p=h&&h._transport,g=f&&(A||H(o)||3===p||h._isSync&&2===p);F(e,o,r);){var m=e.shift();m&&m.count()>0&&(v.isTenantKilled(m.iKey())?s.push(m):(u=u||b.createPayload(r,n,l,g,i,o),b.appendPayload(u,m,t)?null!==u.overflow&&(e=[u.overflow].concat(e),u.overflow=null,j(u,d,us(),i),d=us(),u=null):(j(u,d,us(),i),d=us(),e=[m].concat(e),u=null)))}u&&j(u,d,us(),i),e.length>0&&(S=e.concat(S)),V(s,8004,o)}),(function(){return{batches:K(a),retryCount:r,isTeardown:n,isSynchronous:l,sendReason:i,useSendBeacon:H(o),sendType:o}}),!l)}catch(e){Ci(s,2,48,"Unexpected Exception sending batch: "+ni(e))}}}function z(e,t){var r={url:m,hdrs:{},useHdrs:!1};t?(r.hdrs=cs(r.hdrs,w),r.useHdrs=vo(r.hdrs).length>0):Xn(w,(function(e,t){Lc[e]?Bc(r,Lc[e],t,!1):(r.hdrs[e]=t,r.useHdrs=!0)})),Bc(r,"client-id","NO_AUTH",t),Bc(r,"client-version","1DS-Web-JS-3.2.14",t);var n="";uo(e.apiKeys,(function(e){n.length>0&&(n+=","),n+=e})),Bc(r,"apikey",n,t),Bc(r,"upload-time",_o().toString(),t);var o=function(e){for(var t=0;t<e.batches.length;t++){var r=e.batches[t].Msfpc();if(r)return encodeURIComponent(r)}return""}(e);if(ts(o)&&(r.url+="&ext.intweb.msfpc="+o),C.shouldAddClockSkewHeaders()&&Bc(r,"time-delta-to-apply-millis",C.getClockSkewHeaderValue(),t),u.getWParam){var i=u.getWParam();i>=0&&(r.url+="&w="+i)}for(var a=0;a<I.length;a++)r.url+="&"+I[a].name+"="+I[a].value;return r}function W(e,t,r){e[t]=e[t]||{},e[t][a.identifier]=r}function j(t,r,o,i){if(t&&t.payloadBlob&&t.payloadBlob.length>0){var l=!!e.sendHook,f=c[t.sendType];!H(t.sendType)&&t.isBeacon&&2===t.sendReason&&(f=c[2]||c[3]||f);var g=R;(t.isBeacon||3===f._transport)&&(g=!1);var m=z(t,g);g=g||m.useHdrs;var y=us();Ho(u,(function(){return"HttpManager:_doPayloadSend"}),(function(){for(var c=0;c<t.batches.length;c++)for(var T=t.batches[c].events(),I=0;I<T.length;I++){var w=T[I];if(k){var S=w.timings=w.timings||{};W(S,"sendEventStart",y),W(S,"serializationStart",r),W(S,"serializationCompleted",o)}w.sendAttempt>0?w.sendAttempt++:w.sendAttempt=1}V(t.batches,1e3+(i||0),t.sendType,!0);var b={data:t.payloadBlob,urlString:m.url,headers:m.hdrs,_thePayload:t,_sendReason:i,timeout:d,disableXhrSync:h,disableFetchKeepAlive:p};g&&(xc(b.headers,"cache-control")||(b.headers["cache-control"]="no-cache, no-store"),xc(b.headers,"content-type")||(b.headers["content-type"]="application/x-json-stream"));var R=null;f&&(R=function(r){C.firstRequestSent();var o=function(r,o){!function(t,r,o,i){var s=9e3,c=null,u=!1,l=!1;try{var d=!0;if(typeof t!==Sn.l){if(r){C.setClockSkew(r["time-delta-millis"]);var h=r["kill-duration"]||r["kill-duration-seconds"];uo(v.setKillSwitchTenants(r["kill-tokens"],h),(function(e){uo(o.batches,(function(t){if(t.iKey()===e){c=c||[];var r=t.split(0);o.numEvents-=r.count(),c.push(r)}}))}))}if(200==t||204==t)return void(s=200);((f=t)>=300&&f<500&&408!=f&&429!=f||501==f||505==f||o.numEvents<=0)&&(d=!1),s=9e3+t%1e3}if(d){s=100;var p=o.retryCnt;0===o.sendType&&(p<n?(u=!0,Q((function(){0===o.sendType&&E--,G(o.batches,p+1,o.isTeardown,A?2:o.sendType,5)}),A,Ac(p))):(l=!0,A&&(s=8001)))}}finally{u||(C.setClockSkew(),function(t,r,n,o){try{o&&a._backOffTransmission(),200===r&&(o||t.isSync||a._clearBackOff(),function(e){if(k){var t=us();uo(e,(function(e){var r,n;e&&e.count()>0&&(r=e.events(),n=t,k&&uo(r,(function(e){W(e.timings=e.timings||{},"sendEventCompleted",n)})))}))}}(t.batches)),V(t.batches,r,t.sendType,!0)}finally{0===t.sendType&&(E--,5!==n&&e.sendQueuedRequests(t.sendType,n))}}(o,s,i,l)),V(c,8004,o.sendType)}var f}(r,o,t,i)},c=t.isTeardown||t.isSync;try{f.sendPOST(r,o,c),e.sendListener&&e.sendListener(b,r,c,t.isBeacon)}catch(e){Ti(s,"Unexpected exception sending payload. Ex:"+ni(e)),q(o,0,{})}}),Ho(u,(function(){return"HttpManager:_doPayloadSend.sender"}),(function(){if(R)if(0===t.sendType&&E++,l&&!t.isBeacon&&3!==f._transport){var r={data:b.data,urlString:b.urlString,headers:cs({},b.headers),timeout:b.timeout,disableXhrSync:b.disableXhrSync,disableFetchKeepAlive:b.disableFetchKeepAlive},n=!1;Ho(u,(function(){return"HttpManager:_doPayloadSend.sendHook"}),(function(){try{e.sendHook(r,(function(e){n=!0,_||e._thePayload||(e._thePayload=e._thePayload||b._thePayload,e._sendReason=e._sendReason||b._sendReason),R(e)}),t.isSync||t.isTeardown)}catch(e){n||R(b)}}))}else R(b)}))}),(function(){return{thePayload:t,serializationStart:r,serializationCompleted:o,sendReason:i}}),t.isSync)}t.sizeExceed&&t.sizeExceed.length>0&&V(t.sizeExceed,8003,t.sendType),t.failedEvts&&t.failedEvts.length>0&&V(t.failedEvts,8002,t.sendType)}function Q(e,t,r){t?e():i.set(e,r)}function Y(t){var r=e._responseHandlers;try{for(var n=0;n<r.length;n++)try{r[n](t)}catch(e){Ci(s,1,519,"Response handler failed: "+e)}if(t){var o=JSON.parse(t);ts(o.webResult)&&ts(o.webResult.msfpc)&&l.set("MSFPC",o.webResult.msfpc,31536e3)}}catch(e){}}function V(e,t,r,n){if(e&&e.length>0&&o){var i=o[function(e){var t=Uc[e];ts(t)||(t="oth",e>=9e3&&e<=9999?t="rspFail":e>=8e3&&e<=8999?t="drop":e>=1e3&&e<=1999&&(t="send"));return t}(t)];if(i){var a=0!==r;Ho(u,(function(){return"HttpManager:_sendBatchesNotification"}),(function(){Q((function(){try{i.call(o,e,t,a,r)}catch(e){Ci(s,1,74,"send request notification failed: "+e)}}),n||a,0)}),(function(){return{batches:K(e),reason:t,isSync:a,sendSync:n,sendType:r}}),!a)}}}e.initialize=function(e,t,r,n,o){var i;o||(o={}),m=e+m,R=!!zn(o.avoidOptions)||!o.avoidOptions,u=t,l=t.getCookieMgr(),k=!u.config.disableEventTimings;var v=!!u.config.enableCompoundKey;s=(a=r).diagLog();var y=o.valueSanitizer,C=o.stringifyObjects;zn(o.enableCompoundKey)||(v=!!o.enableCompoundKey),d=o.xhrTimeout,h=!!o.disableXhrSync,p=!!o.disableFetchKeepAlive,g=!1!==o.addNoResponse,T=!ti(),b=new Mc(u,y,C,v),Wn(o.useSendBeacon)||(T=!!o.useSendBeacon);var E=n,I=o.alwaysUseXhrOverride?n:null,w=o.alwaysUseXhrOverride?n:null,S=[3,2];if(!n){_=!1;var A=Xo();A&&A.protocol&&"file:"===A.protocol.toLowerCase()&&(P=!1);var M=[];ti()?(M=[2,1],S=[2,1,3]):M=[1,2,3],(n=N(M=Fc(M,o.transports),!1))||Ti(s,"No available transport to send events"),E=N(M,!0)}I||(I=N(S=Fc(S,o.unloadTransports),!0)),f=!_&&(T&&oi()||!p&&ii(!0)),(i={})[0]=n,i[1]=E||N([1,2,3],!0),i[2]=I||E||N([1],!0),i[3]=w||N([2,3],!0)||E||N([1],!0),c=i},e._getDbgPlgTargets=function(){return[c[0],v,b,c]},e.addQueryStringParameter=function(e,t){for(var r=0;r<I.length;r++)if(I[r].name===e)return void(I[r].value=t);I.push({name:e,value:t})},e.addHeader=function(e,t){w[e]=t},e.canSendRequest=function(){return x()&&C.allowRequestSending()},e.sendQueuedRequests=function(e,t){zn(e)&&(e=0),A&&(e=D(e),t=2),F(S,e,0)&&G(B(),0,!1,e,t||0)},e.isCompletelyIdle=function(){return!y&&0===E&&0===S.length},e.setUnloading=function(e){A=e},e.addBatch=function(e){if(e&&e.count()>0){if(v.isTenantKilled(e.iKey()))return!1;S.push(e)}return!0},e.teardown=function(){S.length>0&&G(B(),0,!0,2,2)},e.pause=function(){y=!0},e.resume=function(){y=!1,e.sendQueuedRequests(0,4)},e.sendSynchronousBatch=function(e,t,r){e&&e.count()>0&&(Wn(t)&&(t=1),A&&(t=D(t),r=2),G([e],0,!1,t,r||0))}}))}return e.__ieDyn=1,e}();function Gc(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return setTimeout(e,t,r)}function zc(e){clearTimeout(e)}function Wc(e,t){return{set:e||Gc,clear:t||zc}}var jc,Qc,Yc,Vc,Jc=function(e){function t(){var r,n=e.call(this)||this;n.identifier="PostChannel",n.priority=1011,n.version="3.2.14";var o,i,a,s,c,u,l,d=!1,h=[],p=null,f=!1,g=0,m=500,v=0,y=1e4,C={},T="REAL_TIME",E=null,_=null,I=0,w=0,S={},b=-1,k=!0,A=!1,R=6,P=2;return Object(wn.a)(t,n,(function(e,t){function n(e){"beforeunload"!==(e||jo().event).type&&(A=!0,i.setUnloading(A)),x(2,2)}function N(e){A=!1,i.setUnloading(A)}function M(e,t){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=1),e.ext&&e.ext.trace&&delete e.ext.trace,e.ext&&e.ext.user&&e.ext.user.id&&delete e.ext.user.id,k&&(e.ext=Mo(e.ext),e.baseData&&(e.baseData=Mo(e.baseData)),e.data&&(e.data=Mo(e.data))),e.sync)if(I||f)e.latency=3,e.sync=!1;else if(i)return k&&(e=Mo(e)),void i.sendSynchronousBatch(Sc.create(e.iKey,[e]),!0===e.sync?1:e.sync,3);var r=e.latency,n=v,o=y;4===r&&(n=g,o=m);var a=!1;if(n<o)a=!K(e,t);else{var s=1,c=20;4===r&&(s=4,c=1),a=!0,function(e,t,r,n){for(;r<=t;){var o=B(e,t,!0);if(o&&o.count()>0){var i=o.split(0,n),a=i.count();if(a>0)return 4===r?g-=a:v-=a,V("eventsDiscarded",[i],_c.QueueFull),!0}r++}return G(),!1}(e.iKey,e.latency,s,c)&&(a=!K(e,t))}a&&Y("eventsDiscarded",[e],_c.QueueFull)}function O(e,t,r){var n=z(e,t,r);return i.sendQueuedRequests(t,r),n}function U(){return v>0}function q(){if(b>=0&&z(b,0,c)&&i.sendQueuedRequests(0,c),g>0&&!_&&!f){var e=C[T][2];e>=0&&(_=H((function(){_=null,O(4,0,1),q()}),e))}var t=C[T][1];!E&&!p&&t>=0&&!f&&(U()?E=H((function(){E=null,O(0===w?3:1,0,1),w++,w%=2,q()}),t):w=0)}function L(){r=null,d=!1,h=[],p=null,f=!1,g=0,m=500,v=0,y=1e4,C={},T="REAL_TIME",E=null,_=null,I=0,w=0,o=null,S={},a=void 0,s=0,b=-1,c=null,k=!0,A=!1,R=6,P=2,u=null,l=Wc(),i=new Kc(500,2,1,{requeue:j,send:J,sent:X,drop:Z,rspFail:$,oth:ee},l),W(),S[4]={batches:[],iKeyMap:{}},S[3]={batches:[],iKeyMap:{}},S[2]={batches:[],iKeyMap:{}},S[1]={batches:[],iKeyMap:{}},te()}function H(e,t){0===t&&I&&(t=1);var r=1e3;return I&&(r=Ac(I-1)),l.set(e,t*r)}function D(){return null!==E&&(l.clear(E),E=null,w=0,!0)}function x(e,t){D(),p&&(l.clear(p),p=null),f||O(1,e,t)}function B(e,t,r){var n=S[t];n||(n=S[t=1]);var o=n.iKeyMap[e];return!o&&r&&(o=Sc.create(e),n.batches.push(o),n.iKeyMap[e]=o),o}function F(t,r){i.canSendRequest()&&!I&&(a>0&&v>a&&(r=!0),r&&null==p&&e.flush(t,null,20))}function K(e,t){k&&(e=Mo(e));var r=e.latency,n=B(e.iKey,r,!0);return!!n.addEvent(e)&&(4!==r?(v++,t&&0===e.sendAttempt&&F(!e.sync,s>0&&n.count()>=s)):g++,!0)}function G(){for(var e=0,t=0,r=function(r){var n=S[r];n&&n.batches&&uo(n.batches,(function(n){4===r?e+=n.count():t+=n.count()}))},n=1;n<=4;n++)r(n);v=t,g=e}function z(t,r,n){var o=!1,a=0===r;return!a||i.canSendRequest()?Ho(e.core,(function(){return"PostChannel._queueBatches"}),(function(){for(var e=[],r=4;r>=t;){var n=S[r];n&&n.batches&&n.batches.length>0&&(uo(n.batches,(function(t){i.addBatch(t)?o=o||t&&t.count()>0:e=e.concat(t.events()),4===r?g-=t.count():v-=t.count()})),n.batches=[],n.iKeyMap={}),r--}e.length>0&&Y("eventsDiscarded",e,_c.KillSwitch),o&&b>=t&&(b=-1,c=0)}),(function(){return{latency:t,sendType:r,sendReason:n}}),!a):(b=b>=0?Math.min(b,t):t,c=Math.max(c,n)),o}function W(){(C={}).REAL_TIME=[2,1,0],C.NEAR_REAL_TIME=[6,3,0],C.BEST_EFFORT=[18,9,0]}function j(t,r){var n=[],o=R;A&&(o=P),uo(t,(function(t){t&&t.count()>0&&uo(t.events(),(function(t){t&&(t.sync&&(t.latency=4,t.sync=!1),t.sendAttempt<o?(hs(t,e.identifier),M(t,!1)):n.push(t))}))})),n.length>0&&Y("eventsDiscarded",n,_c.NonRetryableStatus),A&&x(2,2)}function Q(t,r){var n=e._notificationManager||{},o=n[t];if(o)try{o.apply(n,r)}catch(r){Ci(e.diagLog(),1,74,t+" notification failed: "+r)}}function Y(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];t&&t.length>0&&Q(e,[t].concat(r))}function V(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];t&&t.length>0&&uo(t,(function(t){t&&t.count()>0&&Q(e,[t.events()].concat(r))}))}function J(e,t,r){e&&e.length>0&&Q("eventsSendRequest",[t>=1e3&&t<=1999?t-1e3:0,!0!==r])}function X(e,t){V("eventsSent",e,t),q()}function Z(e,t){V("eventsDiscarded",e,t>=8e3&&t<=8999?t-8e3:_c.Unknown)}function $(e){V("eventsDiscarded",e,_c.NonRetryableStatus),q()}function ee(e,t){V("eventsDiscarded",e,_c.Unknown),q()}function te(){s=r&&r.disableAutoBatchFlushLimit?0:Math.max(1500,y/6)}L(),e._getDbgPlgTargets=function(){return[i]},e.initialize=function(s,c,d){Ho(c,(function(){return"PostChannel:initialize"}),(function(){var h=c;t.initialize(s,c,d);try{c.addUnloadCb;u=fa(Li(e.identifier),c.evtNamespace&&c.evtNamespace());var p=e._getTelCtx();s.extensionConfig[e.identifier]=s.extensionConfig[e.identifier]||{},r=p.getExtCfg(e.identifier),l=Wc(r.setTimeoutOverride,r.clearTimeoutOverride),k=!r.disableOptimizeObj&&!!zo("chrome"),function(e){var t=e.getWParam;e.getWParam=function(){var e=0;return r.ignoreMc1Ms0CookieProcessing&&(e|=2),e|t()}}(h),r.eventsLimitInMem>0&&(y=r.eventsLimitInMem),r.immediateEventLimit>0&&(m=r.immediateEventLimit),r.autoFlushEventsLimit>0&&(a=r.autoFlushEventsLimit),io(r.maxEventRetryAttempts)&&(R=r.maxEventRetryAttempts),io(r.maxUnloadEventRetryAttempts)&&(P=r.maxUnloadEventRetryAttempts),te(),r.httpXHROverride&&r.httpXHROverride.sendPOST&&(o=r.httpXHROverride),ts(s.anonCookieName)&&i.addQueryStringParameter("anoncknm",s.anonCookieName),i.sendHook=r.payloadPreprocessor,i.sendListener=r.payloadListener;var f=r.overrideEndpointUrl?r.overrideEndpointUrl:s.endpointUrl;e._notificationManager=c.getNotifyMgr(),i.initialize(f,e.core,e,o,r);var g=s.disablePageUnloadEvents||[];Ta(n,g,u),function e(t,r,n){var o=fa(ra,n),i=ya(["pagehide"],t,r,o);return r&&-1!==lo(r,"visibilitychange")||(i=ya(["visibilitychange"],(function(e){var r=Yo();t&&r&&"hidden"===r.visibilityState&&t(e)}),r,o)||i),!i&&r&&(i=e(t,null,n)),i}(n,g,u),function e(t,r,n){var o=fa(na,n),i=ya(["pageshow"],t,r,o);return!(i=ya(["visibilitychange"],(function(e){var r=Yo();t&&r&&"visible"===r.visibilityState&&t(e)}),r,o)||i)&&r&&(i=e(t,null,n)),i}(N,s.disablePageShowEvents,u)}catch(t){throw e.setInitialized(!1),t}}),(function(){return{coreConfig:s,core:c,extensions:d}}))},e.processTelemetry=function(t,n){hs(t,e.identifier);var o=(n=e._getTelCtx(n)).getExtCfg(e.identifier),i=!!r.disableTelemetry;o&&(i=i||!!o.disableTelemetry);var a=t;i||d||(r.overrideInstrumentationKey&&(a.iKey=r.overrideInstrumentationKey),o&&o.overrideInstrumentationKey&&(a.iKey=o.overrideInstrumentationKey),M(a,!0),A?x(2,2):q()),e.processNext(a,n)},e._doTeardown=function(e,t){x(2,2),d=!0,i.teardown(),Ca(["beforeunload","unload","pagehide"],null,u),function(e,t){var r=fa(ra,t);Ca(["pagehide"],e,r),Ca(["visibilitychange"],null,r)}(null,u),function(e,t){var r=fa(na,t);Ca(["pageshow"],e,r),Ca(["visibilitychange"],null,r)}(null,u),L()},e.setEventQueueLimits=function(e,t){y=e>0?e:1e4,a=t>0?t:0,te();var r=v>e;if(!r&&s>0)for(var n=1;!r&&n<=3;n++){var o=S[n];o&&o.batches&&uo(o.batches,(function(e){e&&e.count()>=s&&(r=!0)}))}F(!0,r)},e.pause=function(){D(),f=!0,i.pause()},e.resume=function(){f=!1,i.resume(),q()},e.addResponseHandler=function(e){i._responseHandlers.push(e)},e._loadTransmitProfiles=function(e){D(),W(),T="REAL_TIME",q(),Xn(e,(function(e,t){var r=t.length;if(r>=2){var n=r>2?t[2]:0;if(t.splice(0,r-2),t[1]<0&&(t[0]=-1),t[1]>0&&t[0]>0){var o=t[0]/t[1];t[0]=Math.ceil(o)*t[1]}n>=0&&t[1]>=0&&n>t[1]&&(n=t[1]),t.push(n),C[e]=t}}))},e.flush=function(e,t,r){if(void 0===e&&(e=!0),!f)if(r=r||1,e)null==p?(D(),z(1,0,r),p=H((function(){p=null,function e(t,r){O(1,0,r),G(),function e(t){i.isCompletelyIdle()?t():p=H((function(){p=null,e(t)}),.25)}((function(){t&&t(),h.length>0?p=H((function(){p=null,e(h.shift(),r)}),0):(p=null,q())}))}(t,r)}),0)):h.push(t);else{var n=D();O(1,1,r),null!=t&&t(),n&&q()}},e.setMsaAuthTicket=function(e){i.addHeader("AuthMsaDeviceTicket",e)},e.hasEvents=U,e._setTransmitProfile=function(e){T!==e&&void 0!==C[e]&&(D(),T=e,q())},e._backOffTransmission=function(){I<4&&(I++,D(),q())},e._clearBackOff=function(){I&&(I=0,D(),q())},yo(e,"_setTimeoutOverride",(function(){return l.set}),(function(e){l=Wc(e,l.clear)})),yo(e,"_clearTimeoutOverride",(function(){return l.clear}),(function(e){l=Wc(l.set,e)}))})),n}return Object(In.a)(t,e),t.__ieDyn=1,t}(za),Xc=function(e){function t(){var r,n,o=e.call(this)||this;return Object(wn.a)(t,o,(function(e,t){e.initialize=function(e,i){var a=o;Ho(o,(function(){return"ApplicationInsights:initialize"}),(function(){r=new Jc;var o=[n=new Ec];i&&(o=o.concat(i)),e||Ao("You must provide a config object!");var s=e.channels;if(s&&s.length>0){for(var c=!1,u=0;u<s[0].length;u++)if(s[0][u].identifier===r.identifier){c=!0;break}c||s[0].push(r)}else e.channels=[[r]];var l=e.extensionConfig=e.extensionConfig||[];l[r.identifier]=l[r.identifier]||e&&e.channelConfiguration||{},l[n.identifier]=l[n.identifier]||e&&e.propertyConfiguration||{};try{t.initialize(e,o)}catch(e){Ci(a.logger,1,514,"Failed to initialize SDK."+ni(e))}}),(function(){return{config:e,extensions:i}}))},e.getPropertyManager=function(){return n},e.getPostChannel=function(){return r}})),o}return Object(In.a)(t,e),t.__ieDyn=1,t}(fs),Zc=function(){function e(t,r){this.logger=t,this.isSampled=!(null==r?void 0:r.disabled)&&this.calculateSampling(null==r?void 0:r.samplingPercentage),this.logger.verbose("PerformanceTelemetryReporter: Sampled for 1p telemetry: "+this.isSampled.toString()),this.eventsToEmit=(null==r?void 0:r.eventsToEmit)||[Q.AcquireTokenSilent,Q.SsoSilent,Q.AcquireTokenByCode],this.logger.verbose("PerformanceTelemetryReporter: Events to be tracked include : "+this.eventsToEmit),this.logger.verbose("PerformanceTelemetryReporter: Events passed in the PerformanceTelemetryConfiguration are: "+(null==r?void 0:r.eventsToEmit));var n={instrumentationKey:e.instrumentationKey,extensions:[]};this.appInsights=new Xc,this.appInsights.initialize(n,[]),this.logger.verbose("PerformanceTelemetryReporter: Initialized")}return e.prototype.calculateSampling=function(t){return 0===t?(this.logger.verbose(" PerformanceTelemetryReporter: No sampling rate configured."),!1):(this.logger.verbose("PerformanceTelemetryReporter: Configured sampling rate = "+t+" "),this.logger.verbose("PerformanceTelemetryReporter: DEFAULT sampling rate = "+e.DEFAULT_SAMPLING_RATE),Math.random()<=(t||e.DEFAULT_SAMPLING_RATE))},e.prototype.sendCustomEvent=function(e){var t=B(B({},e),{appName:void 0}),r={name:e.name,data:t};this.logger.verbose("PerformanceTelemetryReporter: Sending "+r.name+" for tracking"),this.appInsights.track(r)},e.prototype.canSendEvent=function(t){var r,n=!this.eventsToEmit||(null===(r=this.eventsToEmit)||void 0===r?void 0:r.indexOf(t.name))>-1,o=e.DEFAULT_ALLOWED_CLOUDS.some((function(e){return 0===t.authority.indexOf(e.toString())}));return this.isSampled&&n&&o},e.prototype.getPerformanceTelemetryCallback=function(){var e=this;this.logger.trace("PerformanceTelemetryReporter: Attaching callback to send custom metrics.");return this.logger.verbose(" PerformanceTelemetryReporter: Returning callback as telemetry emitted."),function(t){t.forEach((function(t){e.canSendEvent(t)?(e.logger.verbose("PerformanceTelemetryReporter: Emitting telemetry for "+t.name,t.correlationId),e.sendCustomEvent(t)):e.logger.verbose("PerformanceTelemetryReporter: Skipping telemetry for "+t.name,t.correlationId)}))}},e.DEFAULT_SAMPLING_RATE=.1,e.DEFAULT_ALLOWED_CLOUDS=[pr.AzurePublic,pr.AzurePpe],e.instrumentationKey="d634483c08244c1ca09af2b2d952c92e-ab2bba03-2ba3-49d8-a82c-ef6da750d8ab-7725",e}(),$c=function(e){function t(t,r){var n=e.call(this,t)||this,o=new Zc(n.getLogger(),null==r?void 0:r.performanceTelemetryConfiguration);return n.addPerformanceCallback(o.getPerformanceTelemetryCallback()),n}return x(t,e),t}(_n);!function(e){e.HANDSHAKE_REQUEST="BrokerHandshakeRequest",e.HANDSHAKE_RESPONSE="BrokerHandshakeResponse",e.AUTH_REQUEST="BrokerAuthRequest",e.REDIRECT_RESPONSE="BrokerRedirectResponse",e.HANDLE_REDIRECT_REQUEST="BrokerHandleRedirectRequest",e.AUTH_RESULT="BrokerAuthResult"}(jc||(jc={})),function(e){e.BROKER_RESPONSE="broker.response"}(Qc||(Qc={})),function(e){e.BROKER_CLIENT_ID="brk_client_id",e.BROKER_REDIRECT_URI="brk_redirect_uri"}(Yc||(Yc={})),function(e){e.BROKER_AUTH_ERROR_NAME="BrokerAuthError",e.INTERACTION_REQ_ERROR_NAME="InteractionRequiredAuthError",e.SERVER_ERROR_NAME="ServerError",e.CLIENT_AUTH_ERR_NAME="ClientAuthError",e.CLIENT_CONFIG_ERROR_NAME="ClientConfigurationError",e.BROWSER_AUTH_ERROR_NAME="BrowserAuthError",e.BROWSER_CONFIG_ERROR_NAME="BrowserConfigurationError",e.AUTH_ERROR_NAME="AuthError"}(Vc||(Vc={}));var eu="plain",tu="S256",ru=function(){function e(e){this.messageType=e}return e.validateMessage=function(e){if(!e.data||!e.data.messageType)return null;switch(e.data.messageType){case jc.HANDSHAKE_REQUEST:case jc.HANDSHAKE_RESPONSE:case jc.HANDLE_REDIRECT_REQUEST:case jc.AUTH_REQUEST:case jc.AUTH_RESULT:case jc.REDIRECT_RESPONSE:return e;default:return null}},e}(),nu=function(e){function t(t,r){var n=e.call(this,jc.HANDSHAKE_REQUEST)||this;return n.embeddedClientId=t,n.version=r,n}return x(t,e),t.validate=function(e){return e.data&&e.data.messageType===jc.HANDSHAKE_REQUEST&&e.data.embeddedClientId&&e.data.version?new t(e.data.embeddedClientId,e.data.version):null},t}(ru),ou={code:"no_tokens_to_cache",desc:"The broker did not have any tokens for the client to cache."},iu={code:"no_embedded_app",desc:"The embedded application object was not created. Please ensure you have configured your application correctly for an embedded application: https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/broker-v2/lib/msal-browser/docs/broker.md#brokered-application-configuration"},au={code:"broker_response_invalid",desc:"The broker response did not have the expected values."},su={code:"broker_request_incomplete",desc:"The brokered request did not have the expected values."},cu={code:"broker_popup_will_redirect",desc:"The request for a brokered popup requires a redirect by the broker. If your app does not perform the redirect, please check the broker's logs."},uu={code:"broker_timeout",desc:"Message broker timed out."},lu={code:"broker_handshake_timeout",desc:"Broker handshake response timed out."},du={code:"invalid_broker_message",desc:"messageType for broker message is invalid"},hu={code:"untrusted_broker_error",desc:"The given broker origin is not trusted."},pu={code:"no_trusted_brokers_provided",desc:"No trusted brokers provided."},fu={code:"brokering_disabled",desc:"Brokering is not enabled for the client application. Please check logs to see if handshake was performed."},gu=function(e){function t(r,n){var o=e.call(this,r,n)||this;return Object.setPrototypeOf(o,t.prototype),o.name=Vc.BROKER_AUTH_ERROR_NAME,o}return x(t,e),t.createNoTokensToCacheError=function(){return new t(ou.code,""+ou.desc)},t.createNoEmbeddedAppError=function(){return new t(iu.code,iu.desc)},t.createBrokerResponseInvalidError=function(){return new t(au.code,""+au.desc)},t.createBrokerRequestIncompleteError=function(){return new t(su.code,""+su.desc)},t.createBrokerPopupRequestRedirectingError=function(){return new t(cu.code,cu.desc)},t.createNoTrustedBrokersProvidedError=function(){return new St(pu.code,pu.desc)},t.createBrokeringDisabledError=function(e){return new St(fu.code,fu.desc+" Inner Error: "+e)},t.createMessageBrokerTimeoutError=function(){return new St(uu.code,uu.desc)},t.createMessageBrokerHandshakeTimeoutError=function(){return new St(lu.code,lu.desc)},t.createInvalidBrokerMessageError=function(){return new St(du.code,du.desc)},t.createUntrustedBrokerError=function(){return new St(hu.code,hu.desc)},t}(St),mu=function(e){function t(t,r){var n=e.call(this,jc.HANDSHAKE_RESPONSE)||this;return n.version=t,n.brokerOrigin=r,n}return x(t,e),t.validate=function(e,r){var n=ru.validateMessage(e);if(r&&n&&n.data.messageType===jc.HANDSHAKE_RESPONSE&&n.data.version){if(r.filter((function(t){return It.matchPattern(t,e.origin)})).length<=0)throw gu.createUntrustedBrokerError();return new t(n.data.version,n.origin)}return null},t}(ru),vu=function(e){function t(t,r,n,o){var i=e.call(this,jc.AUTH_REQUEST)||this;return i.embeddedClientId=t,i._embeddedAppOrigin=o,i.interactionType=r,i.request=n,i}return x(t,e),Object.defineProperty(t.prototype,"embeddedAppOrigin",{get:function(){return this._embeddedAppOrigin},enumerable:!1,configurable:!0}),t.validate=function(e){return e.data&&e.data.messageType===jc.AUTH_REQUEST&&e.data.embeddedClientId&&e.data.interactionType&&e.data.request?new t(e.data.embeddedClientId,e.data.interactionType,e.data.request,e.origin):null},t}(ru),yu=function(e){function t(){return e.call(this,jc.REDIRECT_RESPONSE)||this}return x(t,e),t.validate=function(e){return e.data&&e.data.messageType===jc.REDIRECT_RESPONSE?new t:null},t}(ru),Cu=function(e){function t(t,r,n){var o=e.call(this,jc.AUTH_RESULT)||this;return o.interactionType=t,o.result=r,o.errorPayload=o.generateErrorPayload(n),o}return x(t,e),t.prototype.generateErrorPayload=function(e){return e?B({},e):void 0},t.validate=function(e){return e.data&&e.data.messageType===jc.AUTH_RESULT&&e.data.interactionType&&(e.data.result||e.data.errorPayload)?new t(e.data.interactionType,e.data.result,e.data.errorPayload):null},t.detectError=function(e){switch(e.name){case Vc.INTERACTION_REQ_ERROR_NAME:return new nt(e.errorCode,e.errorMessage,e.subError);case Vc.SERVER_ERROR_NAME:return new $e(e.errorCode,e.errorMessage,e.subError);case Vc.CLIENT_AUTH_ERR_NAME:return new _t(e.errorCode,e.errorMessage);case Vc.CLIENT_CONFIG_ERROR_NAME:return new Vt(e.errorCode,e.errorMessage);case Vc.BROWSER_AUTH_ERROR_NAME:return new St(e.errorCode,e.errorMessage);case Vc.BROWSER_CONFIG_ERROR_NAME:return new Nt(e.errorCode,e.errorMessage);case Vc.BROKER_AUTH_ERROR_NAME:return new gu(e.errorCode,e.errorMessage);case Vc.AUTH_ERROR_NAME:return new Ze(e.errorCode,e.errorMessage,e.subError);default:return Ze.createUnexpectedError("Unknown error: "+JSON.stringify(e))}},t.processBrokerResponseMessage=function(e,r){var n=t.validate(e);return t.processBrokerResponse(n,r)},t.processBrokerResponse=function(e,r){if(!e)return null;if(e.errorPayload)throw t.detectError(e.errorPayload);if(!e.result||!e.result.tokensToCache)throw gu.createBrokerResponseInvalidError();var n=new ir,o=new Qt,i=new er,a=e.result.tokensToCache,s={accessToken:rr.toObject(a.accessToken,n),idToken:rr.toObject(a.idToken,o),account:rr.toObject(a.account,i),refreshToken:null,appMetadata:null};return r.saveCacheRecord(s),delete e.result.tokensToCache,B({},e.result)},t}(ru),Tu=function(e){function t(t,r){var n=e.call(this,jc.HANDLE_REDIRECT_REQUEST)||this;return n.embeddedClientId=t,n.version=r,n}return x(t,e),t.validate=function(e){return e.data&&e.data.messageType===jc.HANDLE_REDIRECT_REQUEST&&e.data.embeddedClientId&&e.data.version?new t(e.data.embeddedClientId,e.data.version):null},t}(ru);
/*! @azure/msal-browser-1p v2.37.0 2023-05-02 */
function Eu(e){var t=e.brokerOptions,r={preferredInteractionType:null,brokerRedirectParams:{},actAsBroker:!1,allowBrokering:!1,trustedBrokerDomains:[],brokerHandshakeTimeout:(null==t?void 0:t.brokerHandshakeTimeout)||2e3,brokerMessageTimeout:(null==t?void 0:t.brokerMessageTimeout)||6e3,brokerInteractionTimeout:(null==t?void 0:t.brokerInteractionTimeout)||3e5};return{brokerOptions:B(B({},r),t)}}
/*! @azure/msal-browser-1p v2.37.0 2023-05-02 */var _u,Iu=function(){function e(){}return e.validateRedirectUri=function(e){if(It.isEmpty(e))throw Vt.createRedirectUriEmptyError()},e.validatePrompt=function(e){var t=[];for(var r in ve)t.push(ve[r]);if(t.indexOf(e)<0)throw Vt.createInvalidPromptError(e)},e.validateClaims=function(e){try{JSON.parse(e)}catch(e){throw Vt.createInvalidClaimsRequestError()}},e.validateCodeChallengeParams=function(e,t){if(It.isEmpty(e)||It.isEmpty(t))throw Vt.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)},e.validateCodeChallengeMethod=function(e){if([eu,tu].indexOf(e)<0)throw Vt.createInvalidCodeChallengeMethodError()},e.sanitizeEQParams=function(e,t){return e?(t.forEach((function(t,r){e[r]&&delete e[r]})),e):{}},e}(),wu=function(){function e(){this.parameters=new Map}return e.prototype.addResponseTypeCode=function(){this.parameters.set(de.RESPONSE_TYPE,encodeURIComponent(pe.CODE_RESPONSE_TYPE))},e.prototype.addResponseMode=function(e){this.parameters.set(de.RESPONSE_MODE,encodeURIComponent(e||ye.QUERY))},e.prototype.addScopes=function(e,t){void 0===t&&(t=!0);var r=t?z(e||[],fe):e||[],n=new Jt(r);this.parameters.set(de.SCOPE,encodeURIComponent(n.printScopes()))},e.prototype.addClientId=function(e){this.parameters.set(de.CLIENT_ID,encodeURIComponent(e))},e.prototype.addBrokerClientId=function(e){this.parameters.set(Yc.BROKER_CLIENT_ID,encodeURIComponent(e))},e.prototype.addRedirectUri=function(e,t){if(Iu.validateRedirectUri(e),t){var r=this.buildRedirectUri(e,t);this.parameters.set(de.REDIRECT_URI,encodeURIComponent(r))}else this.parameters.set(de.REDIRECT_URI,encodeURIComponent(e))},e.prototype.buildRedirectUri=function(e,t){return"brk-"+t+"://"+new gr(e).getUrlComponents().HostNameAndPort},e.prototype.addBrokerRedirectUri=function(e){this.parameters.set(Yc.BROKER_REDIRECT_URI,encodeURIComponent(e))},e.prototype.addPostLogoutRedirectUri=function(e){Iu.validateRedirectUri(e),this.parameters.set(de.POST_LOGOUT_URI,encodeURIComponent(e))},e.prototype.addIdTokenHint=function(e){this.parameters.set(de.ID_TOKEN_HINT,encodeURIComponent(e))},e.prototype.addDomainHint=function(e){this.parameters.set(me.DOMAIN_HINT,encodeURIComponent(e))},e.prototype.addLoginHint=function(e){this.parameters.set(me.LOGIN_HINT,encodeURIComponent(e))},e.prototype.addCcsUpn=function(e){this.parameters.set(ce.CCS_HEADER,encodeURIComponent("UPN:"+e))},e.prototype.addCcsOid=function(e){this.parameters.set(ce.CCS_HEADER,encodeURIComponent("Oid:"+e.uid+"@"+e.utid))},e.prototype.addSid=function(e){this.parameters.set(me.SID,encodeURIComponent(e))},e.prototype.addClaims=function(e,t){var r=this.addClientCapabilitiesToClaims(e,t);Iu.validateClaims(r),this.parameters.set(de.CLAIMS,encodeURIComponent(r))},e.prototype.addCorrelationId=function(e){this.parameters.set(de.CLIENT_REQUEST_ID,encodeURIComponent(e))},e.prototype.addLibraryInfo=function(e){this.parameters.set(de.X_CLIENT_SKU,e.sku),this.parameters.set(de.X_CLIENT_VER,e.version),this.parameters.set(de.X_CLIENT_OS,e.os),this.parameters.set(de.X_CLIENT_CPU,e.cpu)},e.prototype.addPrompt=function(e){Iu.validatePrompt(e),this.parameters.set(""+de.PROMPT,encodeURIComponent(e))},e.prototype.addState=function(e){It.isEmpty(e)||this.parameters.set(de.STATE,encodeURIComponent(e))},e.prototype.addNonce=function(e){this.parameters.set(de.NONCE,encodeURIComponent(e))},e.prototype.addCodeChallengeParams=function(e,t){if(Iu.validateCodeChallengeParams(e,t),!e||!t)throw Vt.createInvalidCodeChallengeParamsError();this.parameters.set(de.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(de.CODE_CHALLENGE_METHOD,encodeURIComponent(t))},e.prototype.addAuthorizationCode=function(e){this.parameters.set(de.CODE,encodeURIComponent(e))},e.prototype.addDeviceCode=function(e){this.parameters.set(de.DEVICE_CODE,encodeURIComponent(e))},e.prototype.addRefreshToken=function(e){this.parameters.set(de.REFRESH_TOKEN,encodeURIComponent(e))},e.prototype.addCodeVerifier=function(e){this.parameters.set(de.CODE_VERIFIER,encodeURIComponent(e))},e.prototype.addClientSecret=function(e){this.parameters.set(de.CLIENT_SECRET,encodeURIComponent(e))},e.prototype.addClientAssertion=function(e){this.parameters.set(de.CLIENT_ASSERTION,encodeURIComponent(e))},e.prototype.addClientAssertionType=function(e){this.parameters.set(de.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))},e.prototype.addOboAssertion=function(e){this.parameters.set(de.OBO_ASSERTION,encodeURIComponent(e))},e.prototype.addRequestTokenUse=function(e){this.parameters.set(de.REQUESTED_TOKEN_USE,encodeURIComponent(e))},e.prototype.addGrantType=function(e){this.parameters.set(de.GRANT_TYPE,encodeURIComponent(e))},e.prototype.addClientInfo=function(){this.parameters.set(de.CLIENT_INFO,"1")},e.prototype.addExtraQueryParameters=function(e){var t=this;Iu.sanitizeEQParams(e,this.parameters),Object.keys(e).forEach((function(r){t.parameters.set(r,e[r])}))},e.prototype.addClientCapabilitiesToClaims=function(e,t){var r;if(e)try{r=JSON.parse(e)}catch(e){throw Vt.createInvalidClaimsRequestError()}else r={};return t&&t.length>0&&(r.hasOwnProperty(he.ACCESS_TOKEN)||(r[he.ACCESS_TOKEN]={}),r[he.ACCESS_TOKEN][he.XMS_CC]={values:t}),JSON.stringify(r)},e.prototype.addUsername=function(e){this.parameters.set(Pe.username,e)},e.prototype.addPassword=function(e){this.parameters.set(Pe.password,e)},e.prototype.addPopToken=function(e){It.isEmpty(e)||(this.parameters.set(de.TOKEN_TYPE,Ae.POP),this.parameters.set(de.REQ_CNF,encodeURIComponent(e)))},e.prototype.addSshJwk=function(e){It.isEmpty(e)||(this.parameters.set(de.TOKEN_TYPE,Ae.SSH),this.parameters.set(de.REQ_CNF,encodeURIComponent(e)))},e.prototype.addServerTelemetry=function(e){this.parameters.set(de.X_CLIENT_CURR_TELEM,e.generateCurrentRequestHeaderValue()),this.parameters.set(de.X_CLIENT_LAST_TELEM,e.generateLastRequestHeaderValue())},e.prototype.addThrottling=function(){this.parameters.set(de.X_MS_LIB_CAPABILITY,xe)},e.prototype.addLogoutHint=function(e){this.parameters.set(de.LOGOUT_HINT,encodeURIComponent(e))},e.prototype.createQueryString=function(){var e=new Array;return this.parameters.forEach((function(t,r){e.push(r+"="+t)})),e.join("&")},e}(),Su=function(e,t,r,n,o){this.account=e||null,this.idToken=t||null,this.accessToken=r||null,this.refreshToken=n||null,this.appMetadata=o||null},bu=function(){function e(e,t,r,n,o,i){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=n,this.serializableCache=o,this.persistencePlugin=i,this.homeAccountIdentifier=""}return e.prototype.validateServerAuthorizationCodeResponse=function(e,t,r){if(!e.state||!t)throw e.state?_t.createStateNotFoundError("Cached State"):_t.createStateNotFoundError("Server State");if(decodeURIComponent(e.state)!==decodeURIComponent(t))throw _t.createStateMismatchError();if(e.error||e.error_description||e.suberror){if(nt.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new nt(e.error||pe.EMPTY_STRING,e.error_description,e.suberror);throw new $e(e.error||pe.EMPTY_STRING,e.error_description,e.suberror)}e.client_info&&Xt(e.client_info,r)},e.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if(nt.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new nt(e.error,e.error_description,e.suberror);var t=e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id;throw new $e(e.error,t,e.suberror)}},e.prototype.handleServerTokenResponse=function(t,r,n,o,i,a,s){return F(this,void 0,void 0,(function(){var c,u,l,d,h;return K(this,(function(p){switch(p.label){case 0:if(t.id_token&&(c=new tr(t.id_token||pe.EMPTY_STRING,this.cryptoObj),i&&!It.isEmpty(i.nonce)&&c.claims.nonce!==i.nonce))throw _t.createNonceMismatchError();this.homeAccountIdentifier=er.generateHomeAccountId(t.client_info||pe.EMPTY_STRING,r.authorityType,this.logger,this.cryptoObj,c),i&&i.state&&(u=dr.parseRequestState(this.cryptoObj,i.state)),t.key_id=t.key_id||o.sshKid||void 0,l=this.generateCacheRecord(t,r,n,o,c,a,i),p.label=1;case 1:return p.trys.push([1,,5,8]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),d=new Fr(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(d)]):[3,3];case 2:p.sent(),p.label=3;case 3:return!s||!l.account||(h=l.account.generateAccountKey(),this.cacheStorage.getAccount(h))?[4,this.cacheStorage.saveCacheRecord(l)]:(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,e.generateAuthenticationResult(this.cryptoObj,r,l,!1,o,c,u)]);case 4:return p.sent(),[3,8];case 5:return this.persistencePlugin&&this.serializableCache&&d?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(d)]):[3,7];case 6:p.sent(),p.label=7;case 7:return[7];case 8:return[2,e.generateAuthenticationResult(this.cryptoObj,r,l,!1,o,c,u,t.spa_code)]}}))}))},e.prototype.handleBrokeredServerTokenResponse=function(t,r,n,o,i,a,s){return F(this,void 0,void 0,(function(){var c,u,l,d,h;return K(this,(function(p){switch(p.label){case 0:if(t.id_token&&(c=new tr(t.id_token||pe.EMPTY_STRING,this.cryptoObj),a&&!It.isEmpty(a.nonce)&&c.claims.nonce!==a.nonce))throw _t.createNonceMismatchError();return this.homeAccountIdentifier=er.generateHomeAccountId(t.client_info||pe.EMPTY_STRING,r.authorityType,this.logger,this.cryptoObj,c),a&&a.state&&(u=dr.parseRequestState(this.cryptoObj,a.state)),(l=this.generateCacheRecord(t,r,n,o,c,s,a,o.embeddedAppClientId)).refreshToken&&this.cacheStorage.setRefreshTokenCredential(l.refreshToken),l.account&&this.cacheStorage.setAccount(l.account),l.refreshToken=null,[4,e.generateAuthenticationResult(this.cryptoObj,r,l,!1,o,c,u)];case 1:return d=p.sent(),h=this.generateResponseThumbprint(r,o.scopes,o.embeddedAppClientId,i),[2,B(B({},d),{tokensToCache:l,responseThumbprint:h})]}}))}))},e.prototype.generateCacheRecord=function(e,t,r,n,o,i,a,s){var c,u,l=t.getPreferredCache();if(It.isEmpty(l))throw _t.createInvalidCacheEnvironmentError();!It.isEmpty(e.id_token)&&o&&(c=Qt.createIdTokenEntity(this.homeAccountIdentifier,l,e.id_token||pe.EMPTY_STRING,s||this.clientId,o.claims.tid||pe.EMPTY_STRING),u=this.generateAccountEntity(e,o,t,i,a));var d=null;if(!It.isEmpty(e.access_token)){var h=e.scope?Jt.fromString(e.scope):new Jt(n.scopes||[]),p=("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,f=("string"==typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,g=("string"==typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,m=r+p,v=m+f,y=g&&g>0?r+g:void 0;d=ir.createAccessTokenEntity(this.homeAccountIdentifier,l,e.access_token||pe.EMPTY_STRING,s||this.clientId,o?o.claims.tid||pe.EMPTY_STRING:t.tenant,h.printScopes(),m,v,this.cryptoObj,y,e.token_type,i,e.key_id,n.claims,n.requestedClaimsHash)}var C=null;It.isEmpty(e.refresh_token)||(C=ar.createRefreshTokenEntity(this.homeAccountIdentifier,l,e.refresh_token||pe.EMPTY_STRING,this.clientId,e.foci,i));var T=null;return It.isEmpty(e.foci)||(T=sr.createAppMetadataEntity(s||this.clientId,l,e.foci)),new Su(u,c,d,C,T)},e.prototype.generateAccountEntity=function(e,t,r,n,o){var i=r.authorityType,a=o?o.cloud_graph_host_name:"",s=o?o.msgraph_host:"";if(i===Bt.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),er.createGenericAccount(this.homeAccountIdentifier,t,r,n,a,s);if(It.isEmpty(e.client_info)&&"AAD"===r.protocolMode)throw _t.createClientInfoEmptyError();return e.client_info?er.createAccount(e.client_info,this.homeAccountIdentifier,t,r,n,a,s):er.createGenericAccount(this.homeAccountIdentifier,t,r,n,a,s)},e.generateAuthenticationResult=function(e,t,r,n,o,i,a,s){var c,u,l;return F(this,void 0,void 0,(function(){var d,h,p,f,g,m,v,y,C,T,E;return K(this,(function(_){switch(_.label){case 0:if(d="",h=[],p=null,g=pe.EMPTY_STRING,!r.accessToken)return[3,4];if(r.accessToken.tokenType!==Ae.POP||!r.accessToken.keyId)return[3,2];if(m=new Br(e),v=r.accessToken,y=v.secret,!(C=v.keyId))throw _t.createKeyIdMissingError();return[4,m.signPopToken(y,C,o)];case 1:return d=_.sent(),[3,3];case 2:d=r.accessToken.secret,_.label=3;case 3:h=Jt.fromString(r.accessToken.target).asArray(),p=new Date(1e3*Number(r.accessToken.expiresOn)),f=new Date(1e3*Number(r.accessToken.extendedExpiresOn)),_.label=4;case 4:return r.appMetadata&&(g="1"===r.appMetadata.familyId?"1":pe.EMPTY_STRING),T=(null==i?void 0:i.claims.oid)||(null==i?void 0:i.claims.sub)||pe.EMPTY_STRING,E=(null==i?void 0:i.claims.tid)||pe.EMPTY_STRING,[2,{authority:t.canonicalAuthority,uniqueId:T,tenantId:E,scopes:h,account:r.account?r.account.getAccountInfo():null,idToken:i?i.rawToken:pe.EMPTY_STRING,idTokenClaims:i?i.claims:{},accessToken:d,fromCache:n,expiresOn:p,correlationId:o.correlationId,extExpiresOn:f,familyId:g,tokenType:(null===(c=r.accessToken)||void 0===c?void 0:c.tokenType)||pe.EMPTY_STRING,state:a?a.userRequestState:pe.EMPTY_STRING,cloudGraphHostName:(null===(u=r.account)||void 0===u?void 0:u.cloudGraphHostName)||pe.EMPTY_STRING,msGraphHost:(null===(l=r.account)||void 0===l?void 0:l.msGraphHost)||pe.EMPTY_STRING,code:s}]}}))}))},e.prototype.generateResponseThumbprint=function(e,t,r,n){var o={authority:e.canonicalAuthority,clientId:r,scopes:t};return n+"."+this.cryptoObj.base64Encode(JSON.stringify(o))},e}(),ku=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x(t,e),t.prototype.getAuthCodeUrl=function(e){return F(this,void 0,void 0,(function(){var t;return K(this,(function(r){return t=this.createBrokerAuthCodeUrlQueryString(e),[2,gr.appendQueryString(this.authority.authorizationEndpoint,t)]}))}))},t.prototype.acquireToken=function(e,t){return F(this,void 0,void 0,(function(){var r,n,o;return K(this,(function(i){switch(i.label){case 0:if(this.logger.verbose("in acquireToken call"),!e||It.isEmpty(e.code))throw _t.createTokenRequestCannotBeMadeError();return r=or.nowSeconds(),[4,this.executeBrokerTokenRequest(this.authority,e)];case 1:return n=i.sent(),(o=new bu(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(n.body),e.embeddedAppClientId?[3,3]:[4,o.handleServerTokenResponse(n.body,this.authority,r,e,t)];case 2:return[2,i.sent()];case 3:return[4,o.handleBrokeredServerTokenResponse(n.body,this.authority,r,e,e.redirectUri,t)];case 4:return[2,i.sent()]}}))}))},t.prototype.executeBrokerTokenRequest=function(e,t){return F(this,void 0,void 0,(function(){var r,n,o,i,a,s,c;return K(this,(function(u){switch(u.label){case 0:return r={clientId:this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},[4,this.createBrokerTokenRequestBody(t)];case 1:if(n=u.sent(),o=this.createBrokerTokenQueryParameters(t),i=void 0,t.clientInfo)try{a=Xt(t.clientInfo,this.cryptoUtils),i={credential:a.uid+"."+a.utid,type:$t.HOME_ACCOUNT_ID}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}return s=this.createTokenRequestHeaders(i||t.ccsCredential),c=It.isEmpty(o)?e.tokenEndpoint:e.tokenEndpoint+"?"+o,[2,this.executePostToTokenEndpoint(c,n,s,r)]}}))}))},t.prototype.createBrokerAuthCodeUrlQueryString=function(e){var t=new wu;t.addClientId(e.embeddedAppClientId);var r=z(e.scopes||[],e.extraScopesToConsent||[]);t.addScopes(r),t.addRedirectUri(e.redirectUri,this.config.authOptions.clientId);var n=e.correlationId||this.config.cryptoInterface.createNewGuid();if(t.addCorrelationId(n),t.addResponseMode(e.responseMode),t.addResponseTypeCode(),t.addLibraryInfo(this.config.libraryInfo),t.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&t.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&t.addPrompt(e.prompt),e.domainHint&&t.addDomainHint(e.domainHint),e.prompt!==ve.SELECT_ACCOUNT)if(e.sid&&e.prompt===ve.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),t.addSid(e.sid);else if(e.account){var o=this.extractSidFromAccount(e.account);if(o&&e.prompt===ve.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),t.addSid(o);try{var i=Zt(e.account.homeAccountId);t.addCcsOid(i)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),t.addLoginHint(e.loginHint),t.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),t.addLoginHint(e.account.username);try{i=Zt(e.account.homeAccountId);t.addCcsOid(i)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),t.addLoginHint(e.loginHint),t.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return e.nonce&&t.addNonce(e.nonce),e.state&&t.addState(e.state),(!It.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.addBrokerClientId(this.config.authOptions.clientId),t.addBrokerRedirectUri(e.brokerRedirectUri),t.createQueryString()},t.prototype.createBrokerTokenQueryParameters=function(e){var t=new wu;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()},t.prototype.createBrokerTokenRequestBody=function(e){return F(this,void 0,void 0,(function(){var t,r,n,o,i,a;return K(this,(function(s){switch(s.label){case 0:return(t=new wu).addClientId(e.embeddedAppClientId),t.addRedirectUri(e.redirectUri,this.config.authOptions.clientId),t.addScopes(e.scopes),t.addAuthorizationCode(e.code),t.addLibraryInfo(this.config.libraryInfo),t.addThrottling(),this.serverTelemetryManager&&t.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&t.addCodeVerifier(e.codeVerifier),t.addGrantType("authorization_code"),t.addClientInfo(),e.authenticationScheme===Ae.POP&&e.resourceRequestMethod&&e.resourceRequestUri?[4,new Br(this.cryptoUtils).generateCnf(e)]:[3,2];case 1:return r=s.sent(),t.addPopToken(r.reqCnfString),[3,3];case 2:if(e.authenticationScheme===Ae.SSH){if(!e.sshJwk)throw Vt.createMissingSshJwkError();t.addSshJwk(e.sshJwk)}s.label=3;case 3:if(n=e.correlationId||this.config.cryptoInterface.createNewGuid(),t.addCorrelationId(n),(!It.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),o=void 0,e.clientInfo)try{i=Xt(e.clientInfo,this.cryptoUtils),o={credential:i.uid+"."+i.utid,type:$t.HOME_ACCOUNT_ID}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}else o=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&o)switch(o.type){case $t.HOME_ACCOUNT_ID:try{i=Zt(o.credential),t.addCcsOid(i)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case $t.UPN:t.addCcsUpn(o.credential)}return e.tokenBodyParameters&&t.addExtraQueryParameters(e.tokenBodyParameters),!e.enableSpaAuthorizationCode||e.tokenBodyParameters&&e.tokenBodyParameters[de.RETURN_SPA_CODE]||t.addExtraQueryParameters(((a={})[de.RETURN_SPA_CODE]="1",a)),t.addBrokerClientId(this.config.authOptions.clientId),t.addBrokerRedirectUri(e.brokerRedirectUri),[2,t.createQueryString()]}}))}))},t.prototype.extractSidFromAccount=function(e){return e.idTokenClaims&&e.idTokenClaims.sid||null},t}(Gr),Au=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x(t,e),t.prototype.acquireToken=function(e){return F(this,void 0,void 0,(function(){var t,r,o,i,a,s,c,u;return K(this,(function(l){switch(l.label){case 0:return[4,this.initializeBrokeredRequest(e,Ve.Redirect)];case 1:t=l.sent(),this.browserStorage.setRedirectRequestContext(t.embeddedAppClientId),this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||"",t.account||null),r=this.initializeServerTelemetryManager(Ye.acquireTokenRedirect),l.label=2;case 2:return l.trys.push([2,7,,8]),[4,this.initializeAuthorizationCodeRequest(t)];case 3:return o=l.sent(),[4,this.createAuthCodeClient(r,t.authority)];case 4:return i=l.sent(),this.logger.verbose("Auth code client created"),a=new n.RedirectHandler(i,this.browserStorage,o,this.logger,this.browserCrypto,this.performanceClient),[4,i.getAuthCodeUrl(t)];case 5:return s=l.sent(),c=this.getRedirectStartPage(e.redirectStartPage),this.logger.verbosePii("Redirect start page: "+c),[4,a.initiateAuthRequest(s,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:c,onRedirectNavigate:e.onRedirectNavigate})];case 6:return[2,l.sent()];case 7:throw(u=l.sent())instanceof Ze&&u.setCorrelationId(this.correlationId),r.cacheFailedRequest(u),this.browserStorage.cleanRequestByState(t.state),u;case 8:return[2]}}))}))},t.prototype.createAuthCodeClient=function(e,t){return F(this,void 0,void 0,(function(){var r;return K(this,(function(n){switch(n.label){case 0:return[4,this.getClientConfiguration(e,t)];case 1:return r=n.sent(),[2,new ku(r)]}}))}))},t.prototype.initializeBrokeredRequest=function(e,t){return F(this,void 0,void 0,(function(){var r,n,o,i,a,s,c,u,l;return K(this,(function(d){switch(d.label){case 0:return this.logger.verbose("initializeBrokeredRequest called"),r=pe.EMPTY_STRING,e.state&&(n=dr.parseRequestState(this.browserCrypto,e.state),r=n&&n.userRequestState||""),o=e.authority||this.config.auth.authority,i=new Jt(e.scopes||[]),a={interactionType:t,brokeredClientId:e.embeddedAppClientId,brokeredReqAuthority:o,brokeredReqScopes:i.printScopes()},s=dr.setRequestState(this.browserCrypto,r,a),(c=e.account||this.browserStorage.getActiveAccount())&&(this.logger.verbose("Setting validated request account"),this.logger.verbosePii("Setting validated request account: "+c)),u=e.nonce||this.browserCrypto.createNewGuid(),this.browserStorage.setInteractionInProgress(!0),l=[{}],[4,this.initializeBaseRequest(e)];case 1:return[2,B.apply(void 0,[B.apply(void 0,l.concat([d.sent()])),{account:c||void 0,state:s,nonce:u,responseMode:ye.FRAGMENT,authority:o,correlationId:this.correlationId,scopes:z(e&&e.scopes||[]),redirectUri:this.getRedirectUri(e.redirectUri),brokerRedirectUri:e.brokerRedirectUri,embeddedAppClientId:e.embeddedAppClientId}])]}}))}))},t}(n.RedirectClient),Ru=function(){function e(){}return e.setRequestState=function(t,r,n,o){var i=e.generateLibraryState(t,n,o);return It.isEmpty(r)?i:""+i+pe.RESOURCE_DELIM+r},e.generateLibraryState=function(e,t,r){if(!e)throw _t.createNoCryptoObjectError("generateLibraryState");var n={id:r||e.createNewGuid()};t&&(n.meta=t);var o=JSON.stringify(n);return e.base64Encode(o)},e.parseRequestState=function(e,t){if(!e)throw _t.createNoCryptoObjectError("parseRequestState");if(It.isEmpty(t))throw _t.createInvalidStateError(t,"Null, undefined or empty state");try{var r=t.split(pe.RESOURCE_DELIM),n=r[0],o=r.length>1?r.slice(1).join(pe.RESOURCE_DELIM):"",i=e.base64Decode(n),a=JSON.parse(i);return{userRequestState:It.isEmpty(o)?"":o,libraryState:a}}catch(e){throw _t.createInvalidStateError(t,e.message)}},e}(),Pu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x(t,e),t.prototype.acquireToken=function(e){return F(this,void 0,void 0,(function(){var t,r,n,o,i;return K(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,this.initializeBrokeredRequest(e,Ve.Popup)];case 1:return t=a.sent(),this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||"",t.account||null),r=this.generatePopupName(t.scopes,t.authority),n=e.popupWindowAttributes||{},this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true, acquiring token"),[2,this.acquireTokenPopupAsync(t,r,n)]):(this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),o=this.openSizedPopup("about:blank",r,n),[2,this.acquireTokenPopupAsync(t,r,n,o)]);case 2:return i=a.sent(),[2,Promise.reject(i)];case 3:return[2]}}))}))},t.prototype.createAuthCodeClient=function(e,t){return F(this,void 0,void 0,(function(){var r;return K(this,(function(n){switch(n.label){case 0:return[4,this.getClientConfiguration(e,t)];case 1:return r=n.sent(),[2,new ku(r)]}}))}))},t.prototype.initializeBrokeredRequest=function(e,t){return F(this,void 0,void 0,(function(){var r,n,o,i,a,s,c,u,l,d;return K(this,(function(h){switch(h.label){case 0:return this.logger.verbose("initializeBrokeredRequest called"),r=pe.EMPTY_STRING,n=pe.EMPTY_STRING,e.state&&(o=Ru.parseRequestState(this.browserCrypto,e.state),r=o&&o.userRequestState||pe.EMPTY_STRING,n=o&&o.libraryState.id||pe.EMPTY_STRING),i=e.authority||this.config.auth.authority,a=new Jt(e.scopes||[]),s={interactionType:t,brokeredClientId:e.embeddedAppClientId,brokeredReqAuthority:i,brokeredReqScopes:a.printScopes()},c=Ru.setRequestState(this.browserCrypto,r,s,n),(u=e.account||this.browserStorage.getActiveAccount())&&(this.logger.verbose("Setting validated request account"),this.logger.verbosePii("Setting validated request account: "+u)),l=e.nonce||this.browserCrypto.createNewGuid(),this.browserStorage.setInteractionInProgress(!0),d=[{}],[4,this.initializeBaseRequest(e)];case 1:return[2,B.apply(void 0,[B.apply(void 0,d.concat([h.sent()])),{account:u||void 0,state:c,nonce:l,responseMode:ye.FRAGMENT,authority:i,correlationId:this.correlationId,scopes:z(e&&e.scopes||[]),redirectUri:this.getRedirectUri(e.redirectUri),brokerRedirectUri:e.brokerRedirectUri,embeddedAppClientId:e.embeddedAppClientId}])]}}))}))},t}(n.PopupClient),Nu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x(t,e),t.prototype.acquireToken=function(t){return F(this,void 0,void 0,(function(){var r;return K(this,(function(n){switch(n.label){case 0:if(this.logger.verbose("acquireTokenByIframe called"),It.isEmpty(t.loginHint)&&It.isEmpty(t.sid)&&(!t.account||It.isEmpty(t.account.username))&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request."),t.prompt&&t.prompt!==ve.NONE)throw St.createSilentPromptValueError(t.prompt);return[4,this.initializeBrokeredRequest(B(B({},t),{prompt:ve.NONE}),Ve.Silent)];case 1:return r=n.sent(),[2,e.prototype.acquireToken.call(this,r)]}}))}))},t.prototype.createAuthCodeClient=function(e,t){return F(this,void 0,void 0,(function(){var r;return K(this,(function(n){switch(n.label){case 0:return[4,this.getClientConfiguration(e,t)];case 1:return r=n.sent(),[2,new ku(r)]}}))}))},t.prototype.initializeBrokeredRequest=function(e,t){return F(this,void 0,void 0,(function(){var r,n,o,i,a,s,c,u,l;return K(this,(function(d){switch(d.label){case 0:return this.logger.verbose("initializeBrokeredRequest called"),r=pe.EMPTY_STRING,e.state&&(n=dr.parseRequestState(this.browserCrypto,e.state),r=n&&n.userRequestState||""),o=e.authority||this.config.auth.authority,i=new Jt(e.scopes||[]),a={interactionType:t,brokeredClientId:e.embeddedAppClientId,brokeredReqAuthority:o,brokeredReqScopes:i.printScopes()},s=dr.setRequestState(this.browserCrypto,r,a),(c=e.account||this.browserStorage.getActiveAccount())&&(this.logger.verbose("Setting validated request account"),this.logger.verbosePii("Setting validated request account: "+c)),u=e.nonce||this.browserCrypto.createNewGuid(),l=[{}],[4,this.initializeBaseRequest(e)];case 1:return[2,B.apply(void 0,[B.apply(void 0,l.concat([d.sent()])),{account:c||void 0,state:s,nonce:u,responseMode:ye.FRAGMENT,authority:o,correlationId:this.correlationId,scopes:z(e&&e.scopes||[]),redirectUri:this.getRedirectUri(e.redirectUri)}])]}}))}))},t}(n.SilentIframeClient),Mu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x(t,e),t.prototype.acquireToken=function(e){return F(this,void 0,void 0,(function(){var t,r,n;return K(this,(function(o){switch(o.label){case 0:return t=or.nowSeconds(),[4,this.executeBrokerTokenRequest(e,this.authority)];case 1:return r=o.sent(),(n=new bu(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(r.body),e.embeddedAppClientId?[2,n.handleBrokeredServerTokenResponse(r.body,this.authority,t,e,e.embeddedAppRedirectUri)]:[2,n.handleServerTokenResponse(r.body,this.authority,t,e,void 0,void 0,!0)]}}))}))},t.prototype.acquireTokenByRefreshToken=function(e){return F(this,void 0,void 0,(function(){var t,r;return K(this,(function(n){if(!e)throw Vt.createEmptyTokenRequestError();if(!e.account)throw _t.createNoAccountInSilentRequestError();if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return[2,this.acquireBrokerTokenWithCachedRefreshToken(e,!0)]}catch(n){if(t=n instanceof nt&&n.errorCode===rt.noTokensFoundError.code,r=n instanceof $e&&n.errorCode===Be&&n.subError===Fe,t||r)return[2,this.acquireBrokerTokenWithCachedRefreshToken(e,!1)];throw n}return[2,this.acquireBrokerTokenWithCachedRefreshToken(e,!1)]}))}))},t.prototype.executeBrokerTokenRequest=function(e,t){return F(this,void 0,void 0,(function(){var r,n,o,i,a;return K(this,(function(s){switch(s.label){case 0:return[4,this.createBrokerTokenRequestBody(e)];case 1:return r=s.sent(),n=this.createBrokerTokenQueryParameters(e),o=this.createTokenRequestHeaders(e.ccsCredential),i={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},a=gr.appendQueryString(t.tokenEndpoint,n),[2,this.executePostToTokenEndpoint(a,r,o,i)]}}))}))},t.prototype.acquireBrokerTokenWithCachedRefreshToken=function(e,t){return F(this,void 0,void 0,(function(){var r,n;return K(this,(function(o){if(!(r=this.cacheManager.getRefreshToken(e.account,t)))throw nt.createNoTokensFoundError();return n=B(B({},e),{refreshToken:r.secret}),[2,this.acquireToken(n)]}))}))},t.prototype.createBrokerTokenQueryParameters=function(e){var t=new wu;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()},t.prototype.createBrokerTokenRequestBody=function(e){return F(this,void 0,void 0,(function(){var t,r,n,o;return K(this,(function(i){switch(i.label){case 0:return(t=new wu).addClientId(e.embeddedAppClientId),t.addScopes(e.scopes),t.addGrantType("refresh_token"),t.addClientInfo(),t.addLibraryInfo(this.config.libraryInfo),t.addThrottling(),this.serverTelemetryManager&&t.addServerTelemetry(this.serverTelemetryManager),r=e.correlationId||this.config.cryptoInterface.createNewGuid(),t.addCorrelationId(r),t.addRefreshToken(e.refreshToken),e.authenticationScheme!==Ae.POP?[3,2]:[4,new Br(this.cryptoUtils).generateCnf(e)];case 1:return n=i.sent(),t.addPopToken(n.reqCnfString),[3,3];case 2:if(e.authenticationScheme===Ae.SSH){if(!e.sshJwk)throw Vt.createMissingSshJwkError();t.addSshJwk(e.sshJwk)}i.label=3;case 3:if((!It.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case $t.HOME_ACCOUNT_ID:try{o=Zt(e.ccsCredential.credential),t.addCcsOid(o)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case $t.UPN:t.addCcsUpn(e.ccsCredential.credential)}return t.addBrokerClientId(this.config.authOptions.clientId),t.addRedirectUri(e.embeddedAppRedirectUri,this.config.authOptions.clientId),[2,t.createQueryString()]}}))}))},t}(on),Ou=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x(t,e),t.prototype.acquireToken=function(e){return F(this,void 0,void 0,(function(){var t,r,n,o=this;return K(this,(function(i){switch(i.label){case 0:return t=B(B({},e),this.initializeBaseRequest(e)),r=this.initializeServerTelemetryManager(Ye.acquireTokenSilent_silentFlow),[4,this.createRefreshTokenClient(r,t.authority)];case 1:return n=i.sent(),this.logger.verbose("Refresh token client created"),[2,n.acquireTokenByRefreshToken(t).catch((function(e){throw e instanceof Ze&&e.setCorrelationId(o.correlationId),r.cacheFailedRequest(e),e}))]}}))}))},t.prototype.createRefreshTokenClient=function(e,t){return F(this,void 0,void 0,(function(){var r;return K(this,(function(n){switch(n.label){case 0:return[4,this.getClientConfiguration(e,t)];case 1:return r=n.sent(),[2,new Mu(r)]}}))}))},t}(n.SilentRefreshClient),Uu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x(t,e),t.prototype.generateBrokerResponseKey=function(e){return Qc.BROKER_RESPONSE+"."+e},t.prototype.getBrokerResponseByOrigin=function(e){var t=this.getMemoryKeys(),r=Qc.BROKER_RESPONSE+"."+e,n=t.filter((function(e){return e.indexOf(r)>=0}));return n.length<=0?null:(n.length>1&&this.logger.error("Too many responses found for the origin, sending back the first one found. You may need to call login/acquireTokenPopup/Silent() again."),this.getBrokerResponse(n[0]))},t.prototype.getBrokerResponseByThumbprint=function(e,t){var r=t+"."+this.cryptoImpl.base64Encode(JSON.stringify(e)),n=Qc.BROKER_RESPONSE+"."+r;return this.getBrokerResponse(n)},t.prototype.getBrokerResponse=function(e){var t=this.getMemoryCache(e);return t?(this.removeMemoryItem(e),t):null},t.prototype.removeMemoryItem=function(e){return this.internalStorage.removeItem(e),!0},t.prototype.getMemoryCache=function(e){var t=this.generateCacheKey(e),r=this.internalStorage.getItem(t);return r||null},t.prototype.setMemoryCache=function(e,t){var r=this.generateCacheKey(e);this.internalStorage.setItem(r,t)},t.prototype.getMemoryKeys=function(){return this.internalStorage.getKeys()},t}(n.BrowserCacheManager),qu=function(e){function t(t,r,n,o,i,a,s,c,u,l,d,h){var p=e.call(this,t,r,n,o,i,a,s,c,u,l,d,h)||this;return p.embeddedAppClientId="",p.embeddedAppOrigin="",p}return x(t,e),t.prototype.acquireToken=function(t){return F(this,void 0,void 0,(function(){var r;return K(this,(function(n){switch(n.label){case 0:return this.logger.verbose("Getting tokens from brokered native flow."),r=t,this.embeddedAppClientId=r.embeddedAppClientId,this.embeddedAppOrigin=r.embeddedAppRedirectUri,[4,e.prototype.acquireToken.call(this,r)];case 1:return[2,n.sent()]}}))}))},t.prototype.handleNativeResponse=function(t,r,n){var o;return F(this,void 0,void 0,(function(){var i,a,s,c,u,l,d,h;return K(this,(function(p){switch(p.label){case 0:return this.logger.trace("BrokerNativeInteractionClient - handleNativeResponse called"),a="",s=this.createIdTokenObj(t),c=this.createHomeAccountIdentifier(t,s),u=null===(o=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:r.accountId}))||void 0===o?void 0:o.homeAccountId,l=new bu(this.config.auth.clientId,this.browserStorage,this.browserCrypto,this.logger,null,null),[4,this.getDiscoveredAuthority(r.authority)];case 1:return d=p.sent(),c!==u||t.account.id===r.accountId?[3,3]:(this.logger.verbose("Getting tokens from brokered native flow."),[4,this.handleEmbeddedNativeResponse(t,r,c,s,n)]);case 2:return i=p.sent(),a=l.generateResponseThumbprint(d,Jt.fromString(t.scope).asArray(),this.embeddedAppClientId||r.embeddedAppClientId,this.embeddedAppOrigin||r.embeddedAppRedirectUri),[3,5];case 3:return[4,e.prototype.handleNativeResponse.call(this,t,r,n)];case 4:i=p.sent(),p.label=5;case 5:return h=l.generateCacheRecord(t,d,n,this.convertNativeRequestToBaseAuthRequest(r),s,void 0,void 0,this.embeddedAppClientId||r.embeddedAppClientId),[2,B(B({},i),{tokensToCache:h,responseThumbprint:a})]}}))}))},t.prototype.handleEmbeddedNativeResponse=function(e,t,r,n,o){return F(this,void 0,void 0,(function(){var i,a,s;return K(this,(function(c){switch(c.label){case 0:return[4,this.getDiscoveredAuthority(t.authority)];case 1:return i=c.sent(),a=i.getPreferredCache(),s=this.createAccountEntity(e,r,n,a),[4,this.generateAuthenticationResult(e,t,n,s,i.canonicalAuthority,o)];case 2:return[2,c.sent()]}}))}))},t.prototype.convertNativeRequestToBaseAuthRequest=function(e){var t=e.scope,r=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}(e,["scope"]),n=Jt.fromString(t);return B(B({},r),{scopes:n.asArray()})},t}(n.NativeInteractionClient);
/*! @azure/msal-browser-1p v2.37.0 2023-05-02 */!function(e){e.ExperimentalPublicClientApplicationInitializeBrokering="experimentalPublicClientApplicationInitializeBrokering",e.BrokerClientApplicationHandleBrokerHandshake="brokerClientApplicationHandleBrokerHandshake",e.BrokerClientApplicationBrokeredSSOSilentRequest="brokerClientApplicationBrokeredSSOSilentRequest",e.BrokerClientApplicationBrokeredSilentRequest="brokerClientApplicationBrokeredSilentRequest",e.EmbeddedClientApplicationSendSSOSilentRequest="embeddedClientApplicationSendSSOSilentRequest",e.EmbeddedClientApplicationSendPopupRequest="embeddedClientApplicationSendPopupRequest",e.EmbeddedClientApplicationSendRedirectRequest="embeddedClientApplicationSendRedirectRequest",e.EmbeddedClientApplicationHandleRedirectRequest="embeddedClientApplicationHandleRedirectRequest",e.EmbeddedClientApplicationSendSilentRefreshRequest="embeddedClientApplicationSendSilentRefreshRequest"}(_u||(_u={}));var Lu=new Set(["brokerInteractionTimeoutMs","brokerMessageTimeoutMs","brokerHandshakeTimeoutMs","brokerIframeTimeoutMs"]);function Hu(e,t,r){return e.startMeasurement(t,r)}function Du(e,t){e&&e.addStaticFields(function(e){var t,r;try{for(var n=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(Object.keys(e)),o=n.next();!o.done;o=n.next()){var i=o.value;Lu.has(i)&&"number"==typeof e[i]&&(e[i]=Math.floor(e[i]))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return e}
/*! @azure/msal-browser-1p v2.37.0 2023-05-02 */(t))}var xu,Bu,Fu=function(e){function t(t,r){var n=e.call(this,t)||this;return n.brokerStorage=new Uu(n.config.auth.clientId,n.config.cache,n.browserCrypto,n.logger),n.currentBrokerRedirectResponse=void 0,n.hybridAuthPromise=void 0,n.experimentalConfig=Eu(r),n}return x(t,e),t.prototype.handleRedirectPromise=function(e){return F(this,void 0,void 0,(function(){var t,r;return K(this,(function(o){switch(o.label){case 0:return t=this.handleBrokerRedirect(e),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(n.TemporaryCacheKeys.REDIRECT_CONTEXT)),this.currentBrokerRedirectResponse=this.waitForBrokeredResponse(t),[4,this.currentBrokerRedirectResponse];case 1:return r=o.sent(),this.currentBrokerRedirectResponse=void 0,[2,r&&!r.tokensToCache?r:null]}}))}))},t.prototype.getRequestContext=function(){return this.brokerStorage.getRedirectRequestContext()},t.prototype.handleBrokerRedirect=function(e){return F(this,void 0,void 0,(function(){var t,r,o,i,a,s,c,u,l=this;return K(this,(function(d){return this.eventHandler.emitEvent(Nr.HANDLE_REDIRECT_START,Ve.Redirect),this.logger.verbose("handleBrokerRedirect called"),t=this.getAllAccounts(),this.isBrowserEnvironment?(r=e||pe.EMPTY_STRING,void 0===(o=this.redirectResponse.get(r))?(this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise"),i=this.browserStorage.getCachedNativeRequest(),a=void 0,i&&n.NativeMessageHandler.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e?(this.logger.trace("handleRedirectPromise - acquiring token from native platform"),s=new qu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ye.ssoSilent,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(i),this.nativeInternalStorage,i.correlationId),a=s.handleRedirectPromise()):(c=this.browserStorage.getTemporaryCache(n.TemporaryCacheKeys.CORRELATION_ID,!0)||"",u=new Au(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,c),a=u.handleRedirectPromise(e)),o=a.then((function(e){e&&(t.length<l.getAllAccounts().length?(l.eventHandler.emitEvent(Nr.LOGIN_SUCCESS,Ve.Redirect,e),l.logger.verbose("handleRedirectResponse returned result, login success")):(l.eventHandler.emitEvent(Nr.ACQUIRE_TOKEN_SUCCESS,Ve.Redirect,e),l.logger.verbose("handleRedirectResponse returned result, acquire token success")));return l.eventHandler.emitEvent(Nr.HANDLE_REDIRECT_END,Ve.Redirect),e})).catch((function(e){throw t.length>0?l.eventHandler.emitEvent(Nr.ACQUIRE_TOKEN_FAILURE,Ve.Redirect,null,e):l.eventHandler.emitEvent(Nr.LOGIN_FAILURE,Ve.Redirect,null,e),l.eventHandler.emitEvent(Nr.HANDLE_REDIRECT_END,Ve.Redirect),e})),this.redirectResponse.set(r,o)):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),[2,o]):(this.logger.verbose("handleRedirectPromise returns null, not browser environment"),[2,null])}))}))},t.prototype.waitForBrokeredResponse=function(e){return F(this,void 0,void 0,(function(){var t;return K(this,(function(r){switch(r.label){case 0:return[4,e];case 1:if(t=r.sent()){if(!t.tokensToCache)return[2,t];this.brokerStorage.setMemoryCache(this.brokerStorage.generateBrokerResponseKey(t.responseThumbprint),JSON.stringify(t)),this.setActiveAccount(t.account)}return[2,null]}}))}))},t.prototype.listenForBrokerMessage=function(e){return F(this,void 0,void 0,(function(){return K(this,(function(t){return this.logger.verbose("listening for child broker messages."),window.addEventListener("message",this.handleBrokerMessage.bind(this)),e&&e.codeRequest&&(this.hybridAuthPromise=this.acquireTokenByCode(e.codeRequest)),[2,this.hybridAuthPromise]}))}))},t.prototype.handleBrokerMessage=function(e){return F(this,void 0,void 0,(function(){var t;return K(this,(function(r){switch(r.label){case 0:if(!(t=ru.validateMessage(e)))return[3,8];switch(t.data.messageType){case jc.HANDSHAKE_REQUEST:return[3,1];case jc.HANDLE_REDIRECT_REQUEST:return[3,3];case jc.AUTH_REQUEST:return[3,5]}return[3,7];case 1:return this.logger.verbose("Broker handshake request received"),[4,this.handleBrokerHandshake(t)];case 2:return[2,r.sent()];case 3:return this.logger.verbose("Broker handle redirect request received"),[4,this.handleBrokerRedirectResponse(t)];case 4:return[2,r.sent()];case 5:return this.logger.verbose("Broker auth request received"),[4,this.handleBrokerAuthRequest(t)];case 6:return[2,r.sent()];case 7:case 8:return[2]}}))}))},t.prototype.handleBrokerHandshake=function(e){return F(this,void 0,void 0,(function(){var t,r,n,o;return K(this,(function(i){switch(i.label){case 0:if(t=Hu(this.performanceClient,_u.BrokerClientApplicationHandleBrokerHandshake),r=nu.validate(e),this.logger.verbose("Broker handshake validated: "+JSON.stringify(r)),n=new mu("2.37.0",""),!this.hybridAuthPromise)return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.hybridAuthPromise];case 2:return i.sent(),[3,4];case 3:return o=i.sent(),this.logger.error("Broker could obtain tokens use authorization code initializer: "+o),[3,4];case 4:return e.source.postMessage(n,e.origin),t.endMeasurement({success:!0}),this.logger.verbose("Sending handshake response to "+e.origin),[2]}}))}))},t.prototype.handleBrokerRedirectResponse=function(e){return F(this,void 0,void 0,(function(){var t,r,n,o,i;return K(this,(function(a){switch(a.label){case 0:return Tu.validate(e)?(t=e.ports[0],this.currentBrokerRedirectResponse?[4,this.currentBrokerRedirectResponse]:[3,2]):[3,3];case 1:a.sent(),a.label=2;case 2:if(r=this.brokerStorage.getBrokerResponseByOrigin(this.getEmbeddedAppRedirectUri(e.origin)))return n=JSON.parse(r),o=e.ports[0],i=new Cu(Ve.Redirect,n),this.logger.verbosePii("Sending auth response"),o.postMessage(i),o.close(),[2];i=new Cu(Ve.Redirect,null),t.postMessage(i),t.close(),a.label=3;case 3:return[2]}}))}))},t.prototype.handleBrokerAuthRequest=function(e){return F(this,void 0,void 0,(function(){var t,r,n,o,i,a,s,c;return K(this,(function(u){switch(u.label){case 0:if(!(t=vu.validate(e)))return[3,3];if(!t.request.authority||!t.request.scopes)throw gu.createBrokerRequestIncompleteError();return Hu(this.performanceClient,Q.AcquireTokenByBroker,t.request.correlationId),this.logger.verbose("Broker auth request validated: "+t),this.currentBrokerRedirectResponse?[4,this.currentBrokerRedirectResponse]:[3,2];case 1:u.sent(),u.label=2;case 2:if(r={authority:t.request.authority,clientId:t.embeddedClientId,scopes:t.request.scopes},n=this.brokerStorage.getBrokerResponseByThumbprint(r,this.getEmbeddedAppRedirectUri(t.embeddedAppOrigin)))return o=JSON.parse(n),i=e.ports[0],a=new Cu(Ve.Redirect,o),this.logger.verbosePii("Sending auth response"),i.postMessage(a),i.close(),[2];switch(s=t.request.account||this.getActiveAccount(),t.interactionType){case Ve.Silent:return s?[2,this.brokeredSilentRequest(t,e.ports[0],s)]:[2,this.brokeredSsoSilentRequest(t,e.ports[0])];case Ve.Redirect:case Ve.Popup:default:return c=this.getInteractionType(t.interactionType),[2,this.interactiveBrokerRequest(c,t,e)]}u.label=3;case 3:return[2]}}))}))},t.prototype.getInteractionType=function(e){var t=this.experimentalConfig.brokerOptions.preferredInteractionType;return t||e},t.prototype.interactiveBrokerRequest=function(e,t,r){return F(this,void 0,void 0,(function(){return K(this,(function(n){switch(e){case Ve.Redirect:return[2,this.brokeredRedirectRequest(t,r.ports[0])];case Ve.Popup:return[2,this.brokeredPopupRequest(t,r.ports[0])];case Ve.Silent:return this.logger.error("Invalid code path. interactiveBrokerRequest() should only be called for interactive requests."),[2];case Ve.None:return this.logger.error("Broker is blocking interactive requests. Please attempt a silent request or sign into the broker first."),[2];default:return this.logger.error("Invalid code path. interactiveBrokerRequest() should only be called for interactive requests."),[2]}}))}))},t.prototype.brokeredRedirectRequest=function(e,t){var r,n;return F(this,void 0,void 0,(function(){var o,i,a,s,c,u,l;return K(this,(function(d){switch(d.label){case 0:this.logger.verbose("Brokered redirect request initiated."),d.label=1;case 1:return d.trys.push([1,5,,6]),o=new yu,t.postMessage(o),t.close(),this.logger.verbose("Sending redirect response: "+o),i=e.request,a=new Au(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,i.correlationId),i.redirectUri=e.embeddedAppOrigin,i.embeddedAppClientId=e.embeddedClientId,i.brokerRedirectUri=a.getRedirectUri(),i.redirectStartPage=null===(r=this.experimentalConfig.brokerOptions.brokerRedirectParams)||void 0===r?void 0:r.redirectStartPage,i.onRedirectNavigate=null===(n=this.experimentalConfig.brokerOptions.brokerRedirectParams)||void 0===n?void 0:n.onRedirectNavigate,s=i.account||this.getActiveAccount(),this.canUseNative(i,null==s?void 0:s.nativeAccountId)?(this.logger.verbose("Native flow available for broker."),i.embeddedAppRedirectUri=this.getEmbeddedAppRedirectUri(e.embeddedAppOrigin),(c=e.request).extraQueryParameters=B(B({},c.extraQueryParameters),{child_client_id:i.embeddedAppClientId,child_redirect_uri:i.embeddedAppRedirectUri}),c.redirectUri=Ar.getCurrentUri(),this.browserStorage.setRedirectRequestContext(i.embeddedAppClientId),this.browserStorage.setInteractionInProgress(!0),[4,this.acquireTokenByNative(c,Ye.acquireTokenRedirect)]):[3,3];case 2:return d.sent(),[3,4];case 3:return[2,a.acquireToken(i)];case 4:return[3,6];case 5:return u=d.sent(),l=new Cu(Ve.Redirect,null,u),this.logger.verbose("Found auth error in redirect: "+u),t.postMessage(l),t.close(),[3,6];case 6:return[2]}}))}))},t.prototype.brokeredPopupRequest=function(e,t){return F(this,void 0,void 0,(function(){var r,n,o,i,a,s,c;return K(this,(function(u){switch(u.label){case 0:this.logger.verbose("Brokered popup request initiated."),u.label=1;case 1:return u.trys.push([1,6,,7]),r=e.request,n=new Pu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,r.correlationId),r.redirectUri=e.embeddedAppOrigin,r.embeddedAppClientId=e.embeddedClientId,r.brokerRedirectUri=n.getRedirectUri(),o=void 0,i=r.account||this.getActiveAccount(),this.canUseNative(r,null==i?void 0:i.nativeAccountId)?(this.logger.verbose("Native flow available for broker."),r.embeddedAppRedirectUri=this.getEmbeddedAppRedirectUri(e.embeddedAppOrigin),(a=e.request).extraQueryParameters=B(B({},a.extraQueryParameters),{child_client_id:r.embeddedAppClientId,child_redirect_uri:r.embeddedAppRedirectUri}),a.redirectUri=Ar.getCurrentUri(),[4,this.acquireTokenByNative(a,Ye.acquireTokenPopup)]):[3,3];case 2:return o=u.sent(),[3,5];case 3:return[4,n.acquireToken(r)];case 4:o=u.sent(),u.label=5;case 5:return c=new Cu(Ve.Popup,o),this.logger.verbosePii("Sending auth response"),t.postMessage(c),t.close(),[3,7];case 6:return s=u.sent(),c=new Cu(Ve.Popup,null,s),this.logger.verbose("Found auth error in popup: "+s),t.postMessage(c),t.close(),[3,7];case 7:return[2]}}))}))},t.prototype.brokeredSsoSilentRequest=function(e,t){var r,n,o,i;return F(this,void 0,void 0,(function(){var a,s,c,u,l,d,h,p;return K(this,(function(f){switch(f.label){case 0:a=Hu(this.performanceClient,_u.BrokerClientApplicationBrokeredSSOSilentRequest,e.request.correlationId),this.logger.verbose("Brokered SSO Silent request initiated."),f.label=1;case 1:return f.trys.push([1,6,,7]),s=e.request,c=new Nu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ye.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,s.correlationId),s.redirectUri=e.embeddedAppOrigin,s.embeddedAppClientId=e.embeddedClientId,s.brokerRedirectUri=c.getRedirectUri(),u=void 0,l=s.account||this.getActiveAccount(),this.canUseNative(s,null==l?void 0:l.nativeAccountId)?(this.logger.verbose("Native flow available for broker."),s.embeddedAppRedirectUri=this.getEmbeddedAppRedirectUri(e.embeddedAppOrigin),(d=e.request).extraQueryParameters=B(B({},d.extraQueryParameters),{child_client_id:s.embeddedAppClientId,child_redirect_uri:s.embeddedAppRedirectUri}),d.redirectUri=Ar.getCurrentUri(),[4,this.acquireTokenByNative(d,Ye.ssoSilent)]):[3,3];case 2:return u=f.sent(),[3,5];case 3:return[4,c.acquireToken(s)];case 4:u=f.sent(),f.label=5;case 5:return p=new Cu(Ve.Silent,u),this.logger.verbosePii("Sending auth response"),t.postMessage(p),t.close(),a.endMeasurement({success:!0,fromCache:null===(r=p.result)||void 0===r?void 0:r.fromCache,accessTokenSize:null===(n=p.result)||void 0===n?void 0:n.accessToken.length,idTokenSize:null===(o=p.result)||void 0===o?void 0:o.idToken.length,requestId:null===(i=p.result)||void 0===i?void 0:i.requestId}),[3,7];case 6:return h=f.sent(),p=new Cu(Ve.Silent,null,h),this.logger.verbose("Found auth error in ssoSilent: "+h),t.postMessage(p),t.close(),a.endMeasurement({errorCode:h.errorCode,subErrorCode:h.subError,success:!1}),[3,7];case 7:return[2]}}))}))},t.prototype.brokeredSilentRequest=function(e,t,r){return F(this,void 0,void 0,(function(){var n,o,i,a,s,c,u,l;return K(this,(function(d){switch(d.label){case 0:n=Hu(this.performanceClient,_u.BrokerClientApplicationBrokeredSilentRequest,e.request.correlationId),this.logger.verbose("Brokered Silent request initiated."),d.label=1;case 1:return d.trys.push([1,6,,7]),(o=e.request).embeddedAppClientId=e.embeddedClientId,o.embeddedAppRedirectUri=e.embeddedAppOrigin,o.account||(o.account=r),i=void 0,this.canUseNative(o)?(this.logger.verbose("Native flow available for broker."),o.embeddedAppRedirectUri=this.getEmbeddedAppRedirectUri(e.embeddedAppOrigin),(a=e.request).extraQueryParameters=B(B({},a.extraQueryParameters),{child_client_id:o.embeddedAppClientId,child_redirect_uri:o.embeddedAppRedirectUri}),a.redirectUri=Ar.getCurrentUri(),[4,this.acquireTokenByNative(a,Ye.acquireTokenSilent_silentFlow)]):[3,3];case 2:return i=d.sent(),[3,5];case 3:return[4,this.acquireTokenByRefreshToken(o)];case 4:i=d.sent(),d.label=5;case 5:return(l=new Cu(Ve.Silent,i)).result&&l.result.tokensToCache?(this.logger.verbosePii("Sending auth response: "+JSON.stringify(l)),t.postMessage(l),t.close(),n.endMeasurement({success:!0,fromCache:l.result.fromCache,accessTokenSize:l.result.accessToken.length,idTokenSize:l.result.idToken.length,isNativeBroker:l.result.fromNativeBroker,requestId:l.result.requestId})):(s=gu.createNoTokensToCacheError(),c=new Cu(Ve.Silent,null,s),this.logger.verbose(""+s),t.postMessage(c),t.close(),n.endMeasurement({errorCode:s.errorCode,subErrorCode:s.subError,success:!1})),[3,7];case 6:return u=d.sent(),l=new Cu(Ve.Silent,null,u),this.logger.verbose("Found auth error in silent: "+u),t.postMessage(l),t.close(),n.endMeasurement({errorCode:u.errorCode,subErrorCode:u.subError,success:!1}),[3,7];case 7:return[2]}}))}))},t.prototype.acquireTokenByRefreshToken=function(e){return F(this,void 0,void 0,(function(){var t,r=this;return K(this,(function(o){return this.eventHandler.emitEvent(Nr.ACQUIRE_TOKEN_NETWORK_START,Ve.Silent,e),Ar.blockReloadInHiddenIframes(),[2,(t=new Ou(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e.correlationId)).acquireToken(e).catch((function(o){var i=o instanceof $e,a=o instanceof nt,s=o.errorCode===n.BrowserConstants.INVALID_GRANT_ERROR;if(i&&s&&!a)return r.logger.verbose("Refresh token expired or invalid, attempting acquire token by iframe",e.correlationId),new Nu(r.config,r.browserStorage,r.browserCrypto,r.logger,r.eventHandler,r.navigationClient,Ye.acquireTokenSilent_authCode,r.performanceClient,r.nativeInternalStorage,r.nativeExtensionProvider).acquireToken(B(B({},e),{brokerRedirectUri:t.getRedirectUri()}));throw o}))]}))}))},t.prototype.acquireTokenByNative=function(e,t,r){return F(this,void 0,void 0,(function(){var o,i=this;return K(this,(function(a){if(this.logger.trace("Brokered acquireTokenNative called"),!this.nativeExtensionProvider)throw St.createNativeConnectionNotEstablishedError();return o=new qu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ye.ssoSilent,this.performanceClient,this.nativeExtensionProvider,r||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId),t===Ye.acquireTokenRedirect?[2,o.acquireTokenRedirect(e)]:[2,o.acquireToken(e).catch((function(e){throw e instanceof n.NativeAuthError&&e.isFatal()&&(i.nativeExtensionProvider=void 0),e}))]}))}))},t.prototype.getEmbeddedAppRedirectUri=function(e){return(new wu).buildRedirectUri(e,this.config.auth.clientId)},t}($c);
/*! @azure/msal-browser-1p v2.37.0 2023-05-02 */!function(e){e.Interaction="brokerInteractionTimeoutMs",e.Message="brokerMessageTimeoutMs",e.Iframe="brokerIframeTimeoutMs"}(xu||(xu={})),function(e){e.Interaction="brokerInteractionTimedOut",e.Message="brokerMessageTimedOut",e.Iframe="brokerIframeTimedOut"}(Bu||(Bu={}));var Ku=function(){function e(e,t,r,n,o){this.brokerOpts=t,this.clientId=e,this.logger=r,this.browserStorage=n,this.brokerConnectionEstablished=!1,this.version="2.37.0",this.brokerOrigin=pe.EMPTY_STRING,this.performanceClient=o}return Object.defineProperty(e.prototype,"trustedBrokersProvided",{get:function(){return!!this.brokerOpts.trustedBrokerDomains&&this.brokerOpts.trustedBrokerDomains.length>=1},enumerable:!1,configurable:!0}),e.prototype.initiateHandshake=function(e){return F(this,void 0,void 0,(function(){var t,r;return K(this,(function(n){switch(n.label){case 0:if(!this.trustedBrokersProvided)throw gu.createNoTrustedBrokersProvidedError();n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.sendHandshakeRequest(e)];case 2:return t=n.sent(),this.brokerOrigin=t.brokerOrigin,this.brokerConnectionEstablished=!0,[3,4];case 3:return r=n.sent(),this.logger.error(r.message),this.brokerConnectionEstablished=!1,[3,4];case 4:return[2]}}))}))},e.prototype.preflightBrokerRequest=function(){return F(this,void 0,void 0,(function(){var e;return K(this,(function(t){switch(t.label){case 0:if(this.brokerConnectionEstablished)return[3,4];this.logger.verbose("Attempting handshake..."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.initiateHandshake(this.performanceEvent)];case 2:return t.sent(),[3,4];case 3:throw e=t.sent(),this.logger.error("Handshake rejected"),gu.createBrokeringDisabledError(e.message);case 4:return[2]}}))}))},e.prototype.sendSsoSilentRequest=function(e){return F(this,void 0,void 0,(function(){var t,r,n;return K(this,(function(o){switch(o.label){case 0:this.performanceEvent=Hu(this.performanceClient,_u.EmbeddedClientApplicationSendSSOSilentRequest,e.correlationId),o.label=1;case 1:return o.trys.push([1,4,,5]),[4,this.preflightBrokerRequest()];case 2:return o.sent(),[4,this.sendRequest(e,Ve.Silent,{type:xu.Iframe,error:Bu.Iframe,value:Pr})];case 3:if(t=o.sent(),!(r=Cu.processBrokerResponseMessage(t,this.browserStorage)))throw this.performanceEvent.endMeasurement({success:!1}),this.logger.errorPii("Broker response is empty in brokered ssoSilent request: "+JSON.stringify(r)),gu.createBrokerResponseInvalidError();return this.performanceEvent.endMeasurement({success:!0,fromCache:r.fromCache,accessTokenSize:r.accessToken.length,idTokenSize:r.idToken.length,isNativeBroker:r.fromNativeBroker,requestId:r.requestId}),[2,r];case 4:throw n=o.sent(),this.performanceEvent.endMeasurement({success:!1}),n;case 5:return[2]}}))}))},e.prototype.sendPopupRequest=function(e){return F(this,void 0,void 0,(function(){var t,r,n;return K(this,(function(o){switch(o.label){case 0:this.performanceEvent=Hu(this.performanceClient,_u.EmbeddedClientApplicationSendPopupRequest,e.correlationId),o.label=1;case 1:return o.trys.push([1,4,,5]),[4,this.preflightBrokerRequest()];case 2:return o.sent(),[4,this.sendRequest(e,Ve.Popup,{type:xu.Interaction,error:Bu.Interaction,value:this.brokerOpts.brokerInteractionTimeout})];case 3:if(t=o.sent(),!(r=Cu.processBrokerResponseMessage(t,this.browserStorage))){if(this.performanceEvent.endMeasurement({success:!1}),!yu.validate(t))throw this.logger.errorPii("Broker response is empty in brokered popup request: "+JSON.stringify(r)),gu.createBrokerResponseInvalidError();throw this.logger.verbose("popupRequest requires a redirect by the broker, this app will now redirect."),gu.createBrokerPopupRequestRedirectingError()}return this.performanceEvent.endMeasurement({success:!0,fromCache:r.fromCache,accessTokenSize:r.accessToken.length,idTokenSize:r.idToken.length,isNativeBroker:r.fromNativeBroker,requestId:r.requestId}),[2,r];case 4:throw n=o.sent(),this.performanceEvent.endMeasurement({success:!1}),n;case 5:return[2]}}))}))},e.prototype.sendRedirectRequest=function(e){return F(this,void 0,void 0,(function(){var t,r,n;return K(this,(function(o){switch(o.label){case 0:this.performanceEvent=Hu(this.performanceClient,_u.EmbeddedClientApplicationSendRedirectRequest,e.correlationId),o.label=1;case 1:return o.trys.push([1,4,,5]),[4,this.preflightBrokerRequest()];case 2:return o.sent(),[4,this.sendRequest(e,Ve.Redirect,{type:xu.Interaction,error:Bu.Interaction,value:this.brokerOpts.brokerInteractionTimeout})];case 3:if(t=o.sent(),!(r=yu.validate(t)))throw this.logger.errorPii("Broker response is not a redirect: "+JSON.stringify(r)),gu.createBrokerResponseInvalidError();return this.logger.verbose("Broker redirecting: "+r),this.performanceEvent.endMeasurement({success:!0}),[3,5];case 4:throw n=o.sent(),this.performanceEvent.endMeasurement({success:!1}),n;case 5:return[2]}}))}))},e.prototype.sendHandleRedirectRequest=function(){return F(this,void 0,void 0,(function(){var e,t,r,n;return K(this,(function(o){switch(o.label){case 0:this.performanceEvent=Hu(this.performanceClient,_u.EmbeddedClientApplicationHandleRedirectRequest),o.label=1;case 1:return o.trys.push([1,4,,5]),[4,this.preflightBrokerRequest()];case 2:return o.sent(),e=new Tu(this.clientId,this.version),[4,this.messageBroker(e,{type:xu.Message,error:Bu.Message,value:this.brokerOpts.brokerMessageTimeout})];case 3:return t=o.sent(),r=Cu.processBrokerResponseMessage(t,this.browserStorage),this.performanceEvent.endMeasurement({success:!0,fromCache:null==r?void 0:r.fromCache,accessTokenSize:null==r?void 0:r.accessToken.length,idTokenSize:null==r?void 0:r.idToken.length,isNativeBroker:null==r?void 0:r.fromNativeBroker}),[2,r];case 4:throw n=o.sent(),this.performanceEvent.endMeasurement({success:!1}),n;case 5:return[2]}}))}))},e.prototype.sendSilentRefreshRequest=function(e){return F(this,void 0,void 0,(function(){var t,r,n;return K(this,(function(o){switch(o.label){case 0:this.performanceEvent=Hu(this.performanceClient,_u.EmbeddedClientApplicationSendSilentRefreshRequest,e.correlationId),o.label=1;case 1:return o.trys.push([1,4,,5]),[4,this.preflightBrokerRequest()];case 2:return o.sent(),[4,this.sendRequest(e,Ve.Silent,{type:xu.Message,error:Bu.Message,value:this.brokerOpts.brokerMessageTimeout})];case 3:if(t=o.sent(),!(r=Cu.processBrokerResponseMessage(t,this.browserStorage)))throw this.logger.errorPii("Broker response is empty in brokered silent refresh request: "+JSON.stringify(r)),gu.createBrokerResponseInvalidError();return this.performanceEvent.endMeasurement({success:!0,fromCache:r.fromCache,accessTokenSize:r.accessToken.length,idTokenSize:r.idToken.length,isNativeBroker:r.fromNativeBroker}),[2,r];case 4:throw n=o.sent(),this.performanceEvent.endMeasurement({success:!1}),n;case 5:return[2]}}))}))},e.prototype.sendRequest=function(e,t,r){return F(this,void 0,void 0,(function(){var n;return K(this,(function(o){return n=new vu(this.clientId,t,e,pe.EMPTY_STRING),[2,this.messageBroker(n,r)]}))}))},e.prototype.sendHandshakeRequest=function(e){return F(this,void 0,void 0,(function(){var t=this;return K(this,(function(r){return[2,new Promise((function(r,n){var o,i=setTimeout((function(){t.logger.warning("Broker handshake timed out"),window.removeEventListener("message",a),Du(e,{brokerHandshakeTimedOut:!0}),n(gu.createMessageBrokerHandshakeTimeoutError())}),t.brokerOpts.brokerHandshakeTimeout);Du(e,{brokerHandshakeTimeoutMs:t.brokerOpts.brokerHandshakeTimeout});var a=function(e){try{var o=mu.validate(e,t.brokerOpts.trustedBrokerDomains);o?(clearTimeout(i),t.logger.verbose("Received handshake response: "+JSON.stringify(o)),window.removeEventListener("message",a),r(o)):(t.logger.warning("Message is not handshake response"),t.logger.verbosePii(""+JSON.stringify(e.data)))}catch(e){window.removeEventListener("message",a),n(e)}};window.addEventListener("message",a);var s=new nu(t.clientId,t.version);t.logger.verbose("Sending handshake request: "+s),null===(o=window.top)||void 0===o||o.postMessage(s,"*")}))]}))}))},e.prototype.messageBroker=function(e,t){return void 0===t&&(t={type:xu.Message,error:Bu.Message,value:this.brokerOpts.brokerMessageTimeout}),F(this,void 0,void 0,(function(){var r=this;return K(this,(function(n){return[2,new Promise((function(n,o){var i,a=setTimeout((function(){var e={};e[t.error.toString()]=!0,Du(r.performanceEvent,e),o(gu.createMessageBrokerTimeoutError())}),t.value),s={};s[t.type.toString()]=t.value,Du(r.performanceEvent,s);var c=r.messageChannel||new MessageChannel;c.port1.onmessage=function(e){r.logger.verbose("in messageBroker<T> w/ origin: "+e),clearTimeout(a),c.port1.close(),n(e)},null===(i=window.top)||void 0===i||i.postMessage(e,r.brokerOrigin,[c.port2])}))]}))}))},e.prototype.setMessageChannel=function(e){this.messageChannel=e},e}(),Gu=function(e){function t(t,r,n,o,i,a,s,c,u,l,d,h){var p=e.call(this,t,r,n,o,i,a,c,u,l)||this;return p.experimentalConfig=s,p.embeddedApp=d,p.broker=h,p}return x(t,e),t.prototype.acquireToken=function(){throw new Error("Method not implemented.")},t.prototype.acquireTokenPopup=function(e){return F(this,void 0,void 0,(function(){var t;return K(this,(function(r){switch(r.label){case 0:if(!this.embeddedApp)throw gu.createNoEmbeddedAppError();return[4,this.initializeAuthorizationRequest(e,Ve.Popup)];case 1:return t=r.sent(),[2,this.embeddedApp.sendPopupRequest(t)]}}))}))},t.prototype.ssoSilent=function(e){return F(this,void 0,void 0,(function(){var t,r;return K(this,(function(n){switch(n.label){case 0:if(!this.embeddedApp)throw gu.createNoEmbeddedAppError();return[4,this.initializeAuthorizationRequest(B(B({},e),{prompt:ve.NONE}),Ve.Silent)];case 1:t=n.sent(),n.label=2;case 2:return n.trys.push([2,4,,5]),[4,this.embeddedApp.sendSsoSilentRequest(t)];case 3:return[2,n.sent()];case 4:throw(r=n.sent())instanceof Ze&&r.setCorrelationId(this.correlationId),this.browserStorage.cleanRequestByState(t.state),r;case 5:return[2]}}))}))},t.prototype.acquireTokenByBrokerRefresh=function(e){return F(this,void 0,void 0,(function(){var t;return K(this,(function(r){switch(r.label){case 0:if(!this.embeddedApp)throw gu.createNoEmbeddedAppError();return[4,this.embeddedApp.sendSilentRefreshRequest(e)];case 1:return t=r.sent(),this.eventHandler.emitEvent(Nr.ACQUIRE_TOKEN_SUCCESS,Ve.Silent,t),[2,t]}}))}))},t.prototype.logout=function(){throw new Error("Method not implemented.")},t}(n.StandardInteractionClient),zu=function(e){function t(t,r,n){var o=e.call(this,t,n)||this;return o.experimentalConfig=Eu(r),o}return x(t,e),t.prototype.initializeBrokering=function(e){return F(this,void 0,void 0,(function(){var t;return K(this,(function(r){switch(r.label){case 0:return this.isBrowserEnvironment?(t=Hu(this.performanceClient,_u.ExperimentalPublicClientApplicationInitializeBrokering),!this.experimentalConfig.brokerOptions.actAsBroker||Ar.isInIframe()?[3,3]:(this.experimentalConfig.brokerOptions.allowBrokering&&this.logger.verbose("Running in top frame and both actAsBroker, allowBrokering flags set to true. actAsBroker takes precedence."),this.broker=new Fu(this.config,this.experimentalConfig),this.logger.verbose("Acting as Broker"),this.logger.verbose("Initialize the extension for the new broker instance"),[4,this.broker.initialize()])):[2];case 1:return r.sent(),[4,this.broker.listenForBrokerMessage(e)];case 2:return r.sent(),t.endMeasurement({success:!0}),[3,5];case 3:return this.experimentalConfig.brokerOptions.allowBrokering?(this.embeddedApp=new Ku(this.config.auth.clientId,this.experimentalConfig.brokerOptions,this.logger,this.browserStorage,this.performanceClient),this.logger.verbose("Acting as child"),[4,this.embeddedApp.initiateHandshake(t)]):[3,5];case 4:r.sent(),t.endMeasurement({success:this.embeddedApp.brokerConnectionEstablished}),r.label=5;case 5:return[2]}}))}))},t.prototype.handleRedirectPromise=function(t){var r;return F(this,void 0,void 0,(function(){var n,o;return K(this,(function(i){switch(i.label){case 0:return n=null===(r=this.broker)||void 0===r?void 0:r.getRequestContext(),this.embeddedApp&&this.embeddedApp.brokerConnectionEstablished?[4,this.embeddedApp.sendHandleRedirectRequest()]:[3,2];case 1:return o=i.sent(),this.browserStorage.setInteractionInProgress(!1),[2,o];case 2:return this.broker&&n&&n!==this.config.auth.clientId?[2,this.broker.handleRedirectPromise(t)]:[2,e.prototype.handleRedirectPromise.call(this,t)];case 3:return[2]}}))}))},t.prototype.acquireTokenRedirect=function(t){var r;return F(this,void 0,void 0,(function(){return K(this,(function(n){if(null===(r=this.embeddedApp)||void 0===r?void 0:r.brokerConnectionEstablished)throw St.createRedirectInIframeError(Ar.isInIframe());return[2,e.prototype.acquireTokenRedirect.call(this,t)]}))}))},t.prototype.acquireTokenPopup=function(e){var t,r=this,o=Hu(this.performanceClient,Q.AcquireTokenPopup,e.correlationId);try{var i=!!(null===(t=this.embeddedApp)||void 0===t?void 0:t.brokerConnectionEstablished);if(this.preflightBrowserEnvironmentCheck(Ve.Popup,!i),this.logger.verbose("experimental acquireTokenPopup called",e.correlationId),i)return new Gu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.experimentalConfig,this.performanceClient,this.nativeExtensionProvider,e.correlationId,this.embeddedApp,this.broker).acquireTokenPopup(e).then((function(e){return Du(o,{accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),o.endMeasurement({success:!0,requestId:e.requestId}),e})).catch((function(e){return o.endMeasurement({success:!1,errorCode:e.errorCode,subErrorCode:e.subError}),Promise.reject(e)}));var a=this.getAllAccounts();a.length>0?this.eventHandler.emitEvent(Nr.ACQUIRE_TOKEN_START,Ve.Popup,e):this.eventHandler.emitEvent(Nr.LOGIN_START,Ve.Popup,e);var s=void 0;if(this.canUseNative(e))this.logger.verbose("Native popup flow activated"),s=this.acquireTokenNative(e,Ye.acquireTokenPopup).then((function(e){return r.browserStorage.setInteractionInProgress(!1),o.endMeasurement({success:!0,isNativeBroker:!0,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,requestId:e.requestId}),e})).catch((function(t){if(t instanceof n.NativeAuthError&&t.isFatal())return r.logger.verbose("Native Auth Error"),r.nativeExtensionProvider=void 0,r.createPopupClient(e.correlationId).acquireToken(e);if(t instanceof nt)return r.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),r.createPopupClient(e.correlationId).acquireToken(e);throw r.browserStorage.setInteractionInProgress(!1),t}));else s=new n.PopupClient(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e.correlationId).acquireToken(e);return s.then((function(e){return a.length<r.getAllAccounts().length?r.eventHandler.emitEvent(Nr.LOGIN_SUCCESS,Ve.Popup,e):r.eventHandler.emitEvent(Nr.ACQUIRE_TOKEN_SUCCESS,Ve.Popup,e),Du(o,{accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),o.endMeasurement({success:!0,requestId:e.requestId}),e})).catch((function(e){return a.length>0?r.eventHandler.emitEvent(Nr.ACQUIRE_TOKEN_FAILURE,Ve.Popup,null,e):r.eventHandler.emitEvent(Nr.LOGIN_FAILURE,Ve.Popup,null,e),o.endMeasurement({success:!1}),Promise.reject(e)}))}catch(e){return o.endMeasurement({success:!1}),Promise.reject(e)}},t.prototype.ssoSilent=function(e){return F(this,void 0,void 0,(function(){var t,r,o,i=this;return K(this,(function(a){this.preflightBrowserEnvironmentCheck(Ve.Silent),t=Hu(this.performanceClient,Q.SsoSilent,e.correlationId),this.logger.verbose("ssoSilent called",e.correlationId),this.eventHandler.emitEvent(Nr.SSO_SILENT_START,Ve.Silent,e);try{return this.embeddedApp&&this.embeddedApp.brokerConnectionEstablished?[2,new Gu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.experimentalConfig,this.performanceClient,this.nativeExtensionProvider,e.correlationId,this.embeddedApp,this.broker).ssoSilent(e).then((function(e){return t.endMeasurement({success:!0,requestId:e.requestId}),e})).catch((function(e){throw t.endMeasurement({success:!1,errorCode:e.errorCode,subErrorCode:e.subError}),e}))]:(r=void 0,this.canUseNative(e)?(this.logger.verbose("Native sso silent flow activated"),r=this.acquireTokenNative(e,Ye.ssoSilent).catch((function(t){if(t instanceof n.NativeAuthError&&t.isFatal())return i.logger.verbose("Native Auth Error"),i.nativeExtensionProvider=void 0,i.createSilentIframeClient(e.correlationId).acquireToken(e);throw t}))):(o=new n.SilentIframeClient(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ye.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e.correlationId),r=o.acquireToken(e)),[2,r.then((function(e){return i.eventHandler.emitEvent(Nr.SSO_SILENT_SUCCESS,Ve.Silent,e),t.addStaticFields({accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),t.endMeasurement({success:!0,fromCache:e.fromCache,requestId:e.requestId}),e})).catch((function(e){throw e}))])}catch(e){throw this.eventHandler.emitEvent(Nr.SSO_SILENT_FAILURE,Ve.Silent,null,e),t.endMeasurement({success:!1,errorCode:e.errorCode,subErrorCode:e.subError}),e}return[2]}))}))},t.prototype.acquireTokenSilentAsync=function(e,t){return F(this,void 0,void 0,(function(){var r,o,i,a,s,c=this;return K(this,(function(u){switch(u.label){case 0:return this.eventHandler.emitEvent(Nr.ACQUIRE_TOKEN_START,Ve.Silent,e),r=Hu(this.performanceClient,Q.AcquireTokenSilentAsync,e.correlationId),this.canUseNative(e)?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),i=B(B({},e),{account:t}),o=this.acquireTokenNative(i,Ye.acquireTokenSilent_silentFlow).catch((function(t){return F(c,void 0,void 0,(function(){return K(this,(function(r){if(t instanceof n.NativeAuthError&&t.isFatal())return this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,[2,this.createSilentIframeClient(e.correlationId).acquireToken(e)];throw t}))}))})),[3,3]):[3,1];case 1:return this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),[4,(a=new n.SilentCacheClient(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient)).initializeSilentRequest(e,t)];case 2:s=u.sent(),o=a.acquireToken(s).catch((function(){return F(c,void 0,void 0,(function(){return K(this,(function(t){return this.embeddedApp&&this.embeddedApp.brokerConnectionEstablished?[2,new Gu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.experimentalConfig,this.performanceClient,this.nativeExtensionProvider,e.correlationId,this.embeddedApp,this.broker).acquireTokenByBrokerRefresh(s)]:[2,this.acquireTokenByRefreshToken(s,e)]}))}))})),u.label=3;case 3:return[2,o.then((function(e){return c.eventHandler.emitEvent(Nr.ACQUIRE_TOKEN_SUCCESS,Ve.Silent,e),r.endMeasurement({success:!0,fromCache:e.fromCache,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e})).catch((function(e){throw c.eventHandler.emitEvent(Nr.ACQUIRE_TOKEN_FAILURE,Ve.Silent,null,e),r.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e}))]}}))}))},t.prototype.setActiveAccount=function(t){this.broker&&this.broker.setActiveAccount(t),e.prototype.setActiveAccount.call(this,t)},t}($c),Wu=function(){function e(){}return e.getInteractionStatusFromEvent=function(e,t){switch(e.eventType){case Nr.LOGIN_START:return Je.Login;case Nr.SSO_SILENT_START:return Je.SsoSilent;case Nr.ACQUIRE_TOKEN_START:if(e.interactionType===Ve.Redirect||e.interactionType===Ve.Popup)return Je.AcquireToken;break;case Nr.HANDLE_REDIRECT_START:return Je.HandleRedirect;case Nr.LOGOUT_START:return Je.Logout;case Nr.SSO_SILENT_SUCCESS:case Nr.SSO_SILENT_FAILURE:if(t&&t!==Je.SsoSilent)break;return Je.None;case Nr.LOGOUT_END:if(t&&t!==Je.Logout)break;return Je.None;case Nr.HANDLE_REDIRECT_END:if(t&&t!==Je.HandleRedirect)break;return Je.None;case Nr.LOGIN_SUCCESS:case Nr.LOGIN_FAILURE:case Nr.ACQUIRE_TOKEN_SUCCESS:case Nr.ACQUIRE_TOKEN_FAILURE:if(e.interactionType===Ve.Redirect||e.interactionType===Ve.Popup){if(t&&t!==Je.Login&&t!==Je.AcquireToken)break;return Je.None}}return null},e}(),ju=function(){function e(e,t){var r=t&&t.loggerOptions||{};this.logger=new Ft(r,"@azure/msal-browser","2.37.0"),this.cryptoOps=new xt(this.logger),this.popTokenGenerator=new Br(this.cryptoOps),this.shrParameters=e}return e.prototype.generatePublicKeyThumbprint=function(){return X(this,void 0,void 0,(function(){return Z(this,(function(e){switch(e.label){case 0:return[4,this.popTokenGenerator.generateKid(this.shrParameters)];case 1:return[2,e.sent().kid]}}))}))},e.prototype.signRequest=function(e,t,r){return X(this,void 0,void 0,(function(){return Z(this,(function(n){return[2,this.popTokenGenerator.signPayload(e,t,this.shrParameters,r)]}))}))},e.prototype.removeKeys=function(e){return X(this,void 0,void 0,(function(){return Z(this,(function(t){switch(t.label){case 0:return[4,this.cryptoOps.removeTokenBindingKey(e)];case 1:return[2,t.sent()]}}))}))},e}(),Qu={initialize:function(){return Promise.reject(Nt.createStubPcaInstanceCalledError())},acquireTokenPopup:function(){return Promise.reject(Nt.createStubPcaInstanceCalledError())},acquireTokenRedirect:function(){return Promise.reject(Nt.createStubPcaInstanceCalledError())},acquireTokenSilent:function(){return Promise.reject(Nt.createStubPcaInstanceCalledError())},acquireTokenByCode:function(){return Promise.reject(Nt.createStubPcaInstanceCalledError())},getAllAccounts:function(){return[]},getAccountByHomeId:function(){return null},getAccountByUsername:function(){return null},getAccountByLocalId:function(){return null},handleRedirectPromise:function(){return Promise.reject(Nt.createStubPcaInstanceCalledError())},loginPopup:function(){return Promise.reject(Nt.createStubPcaInstanceCalledError())},loginRedirect:function(){return Promise.reject(Nt.createStubPcaInstanceCalledError())},logout:function(){return Promise.reject(Nt.createStubPcaInstanceCalledError())},logoutRedirect:function(){return Promise.reject(Nt.createStubPcaInstanceCalledError())},logoutPopup:function(){return Promise.reject(Nt.createStubPcaInstanceCalledError())},ssoSilent:function(){return Promise.reject(Nt.createStubPcaInstanceCalledError())},addEventCallback:function(){return null},removeEventCallback:function(){},addPerformanceCallback:function(){return""},removePerformanceCallback:function(){return!1},enableAccountStorageEvents:function(){},disableAccountStorageEvents:function(){},getTokenCache:function(){throw Nt.createStubPcaInstanceCalledError()},getLogger:function(){throw Nt.createStubPcaInstanceCalledError()},setLogger:function(){},setActiveAccount:function(){},getActiveAccount:function(){return null},initializeWrapperLibrary:function(){},setNavigationClient:function(){},getConfiguration:function(){throw Nt.createStubPcaInstanceCalledError()}},Yu=function(){function e(e){this.headers=e}return e.prototype.getShrNonce=function(){var e=this.headers[ce.AuthenticationInfo];if(e){var t=this.parseChallenges(e);if(t.nextnonce)return t.nextnonce;throw Vt.createInvalidAuthenticationHeaderError(ce.AuthenticationInfo,"nextnonce challenge is missing.")}var r=this.headers[ce.WWWAuthenticate];if(r){var n=this.parseChallenges(r);if(n.nonce)return n.nonce;throw Vt.createInvalidAuthenticationHeaderError(ce.WWWAuthenticate,"nonce challenge is missing.")}throw Vt.createMissingNonceAuthenticationHeadersError()},e.prototype.parseChallenges=function(e){var t=e.indexOf(" "),r=e.substr(t+1).split(","),n={};return r.forEach((function(e){var t=e.split("="),r=t[0],o=t[1];n[r]=unescape(o.replace(/['"]+/g,pe.EMPTY_STRING))})),n},e}(),Vu="2.37.0",Ju=r(5);
/*! @azure/msal-browser-1p v2.37.0 2023-05-02 */function Xu(e){var t,r,n,o;return e.authorityType=E(e.authorityType),{upn:e.upn,authority:e.authority,idp:E(e.authorityType),appIds:null!==(t=e.appIds)&&void 0!==t?t:[],enableConsoleLogging:null!==(r=e.enableConsoleLogging)&&void 0!==r&&r,autoPopup:null!==(n=e.enablePopupFlash)&&void 0!==n&&n,enableUpnCheck:null===(o=!e.skipUpnCheck)||void 0===o||o}}var Zu=function(){function e(e,t,r,n,a,c,u){var l=this;if(this._timeoutId=0,this._isPrimary=!1,this._workerReadyToBrokerTokens=!1,this._workerUpns=[],this.receiveMessage=function(e){return L(l,void 0,void 0,(function(){var t,r,n;return H(this,(function(a){switch(a.label){case 0:if(!this._isWebWorker&&!this.isValidOrigin(e.origin))return[2,Promise.resolve(!0)];t=!0,r=JSON.parse(e.data),a.label=1;case 1:switch(a.trys.push([1,10,,11]),r.MessageId){case b.init:return[3,2];case b.tryGetToken:return[3,4];case b.tryLogin:return[3,6]}return[3,8];case 2:return[4,this.initMessageHandler(r.Values)];case 3:return a.sent(),[3,9];case 4:return[4,this.tryGetTokenMessageHandler(r.Values)];case 5:return a.sent(),[3,9];case 6:return[4,this.tryLoginMessageHandler(r.Values)];case 7:return a.sent(),[3,9];case 8:t=!1,M.ULS.sendTraceTag(509368346,o.msoulscat_Wac_OAuth,i.Info,"[SHARED-AUTH] Unsupported Message ID ".concat(r.MessageId)),a.label=9;case 9:return[3,11];case 10:return n=a.sent(),M.ULS.sendTraceTag(509368345,o.msoulscat_Wac_OAuth,i.Error,"[SHARED-AUTH] Caught error trying to process PostMessage ".concat(r.MessageId,": ").concat(I(n))),[3,11];case 11:return[2,t]}}))}))},this._authLibraryVersion=e,this._isWebWorker=t,this._interactive=r,this._validatedReplyUrl=c,this._allowedApps=n.toLocaleLowerCase().split(";"),this._allowedAudiences=a.toLocaleLowerCase().split(";"),this._interactive=!!r,globalThis.msal=s,t)if(this._parentChannel=c?new O(c.toString(),!0):new O("*",!1),window.SharedWorker&&u){var d=new SharedWorker(u,"SharedAuth Webworker").port;this._webWorkerChannel=new U(d),d.addEventListener("message",(function(e){l.onWorkerMessage(e)})),M.ULS.sendTraceTag(508302428,o.msoulscat_Wac_OAuth,i.Info,"[SHARED-AUTH] Attempting to connect to the web worker"),d.start(),this._workerConnectedPromise=new N;var h=new Promise((function(e,t){l._timeoutId=window.setTimeout((function(){t(new Error("Web worker timed out")),l.reportScriptLoaded(!1)}),5e3)}));Promise.race([this._workerConnectedPromise.promise,h]).then((function(){clearTimeout(l._timeoutId),l.reportScriptLoaded(!0)})).catch((function(e){return M.ULS.sendTraceTag(508302408,o.msoulscat_Wac_OAuth,i.Warning,"[SHARED-AUTH] WebWorker connection failed with ".concat(e.message))})),window.addEventListener("beforeunload",(function(){l.unregisterPrimary()}))}else this._isPrimary=!0,this.reportScriptLoaded(!0);else this._parentChannel=c?new O(c.toString(),!0):new O("",!1),r||this.reportScriptLoaded(!!(null==c?void 0:c.hostname))}return e.prototype.start=function(){window.addEventListener("message",this.receiveMessage)},e.prototype.init=function(e){var t,r;return L(this,void 0,void 0,(function(){var n,a,s;return H(this,(function(c){switch(c.label){case 0:n={},a=!1,c.label=1;case 1:return c.trys.push([1,3,4,5]),[4,Object(Ju.Load)(Xu(e),e.correlationId)];case 2:return n=c.sent(),a=!0,[3,5];case 3:return s=c.sent(),n=s,[3,5];case 4:return M.ULS.sendTraceTag(508354957,o.msoulscat_Wac_OAuth,i.Info,"[SHARED-AUTH] BrowserAuth Load result: [".concat((null!==(r=null===(t=null==n?void 0:n.Telemetry)||void 0===t?void 0:t.errorCode)&&void 0!==r?r:a)?"Success":"Failure","]")),[2,{response:n,isSuccess:a,interactive:!1}];case 5:return[2]}}))}))},e.prototype.tryGetToken=function(e){return L(this,void 0,void 0,(function(){var t,r,n;return H(this,(function(a){switch(a.label){case 0:t={},r=!1,a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,Object(Ju.GetToken)(e.target,e.appId,e.messageCorrelationId,!1,e.withPopup,_(e.appId),e.claims)];case 2:return t=a.sent(),r=!0,[3,5];case 3:return n=a.sent(),t=n,r=!1,[3,5];case 4:return M.ULS.sendTraceTag(508302407,o.msoulscat_Wac_OAuth,i.Info,"[SHARED-AUTH] Token fetch result: [".concat(r?"Success":"Failure","]")),[2,{response:t,messageCorrelationId:e.messageCorrelationId,isSuccess:r}];case 5:return[2]}}))}))},e.prototype.isValidOrigin=function(e){var t,r=new URL(e);return!(!(null===(t=this._validatedReplyUrl)||void 0===t?void 0:t.hostname)||0!==r.hostname.localeCompare(this._validatedReplyUrl.hostname))},e.prototype.isValidAudience=function(e,t){var r=this,n=e.trim().toLocaleLowerCase();if(this._allowedApps.indexOf(n)>=0)return!0;var o=t.trim().toLocaleLowerCase().split(" "),i=!0;return o.forEach((function(e){r._allowedAudiences.indexOf(e)<0&&"profile"!==e&&"openid"!==e&&(i=!1)})),i},e.prototype.reportScriptLoaded=function(e){this._validatedReplyUrl&&this._parentChannel.postToUntrustedParent(k.scriptLoaded,{Success:e,AuthLibrary:this._authLibraryVersion})},e.prototype.initMessageHandler=function(e){var t,r;return L(this,void 0,void 0,(function(){var n,a,s,c;return H(this,(function(u){switch(u.label){case 0:return this._isWebWorker?(this._authLibraryInitData=e,this._targetUpn=e.upn,!this._isPrimary&&this._workerReadyToBrokerTokens&&this._workerUpns.includes(this._targetUpn)?[3,2]:(M.ULS.sendTraceTag(508302427,o.msoulscat_Wac_OAuth,i.Info,"[SHARED-AUTH] Attempting to initialize as the primary"),[4,this.initMessageHandlerInternal()])):[3,4];case 1:return u.sent(),[3,3];case 2:M.ULS.sendTraceTag(508302426,o.msoulscat_Wac_OAuth,i.Info,"[SHARED-AUTH] Skipping initialization because we are a satellite"),n=this._authLibraryInitData.interactive,a=void 0,s=!0,this._parentChannel.postToUntrustedParent(k.scriptInitialized,{response:a,isSuccess:s,interactive:!!n}),u.label=3;case 3:return[3,9];case 4:M.ULS.sendTraceTag(508302425,o.msoulscat_Wac_OAuth,i.Info,"[SHARED-AUTH] Web worker not enabled, initializing using legacy code path"),n=e.interactive,a=void 0,s=!1,u.label=5;case 5:return u.trys.push([5,7,8,9]),[4,Object(Ju.Load)(Xu(e),e.correlationId)];case 6:return a=u.sent(),s=!0,[3,9];case 7:return c=u.sent(),a=c,[3,9];case 8:return M.ULS.sendTraceTag(508827149,o.msoulscat_Wac_OAuth,i.Info,"[SHARED-AUTH] BrowserAuth Load result: [".concat(null!==(r=null===(t=null==a?void 0:a.Telemetry)||void 0===t?void 0:t.errorCode)&&void 0!==r?r:"Success","]")),this._parentChannel.postToUntrustedParent(k.scriptInitialized,{response:a,isSuccess:s,interactive:!!n}),[7];case 9:return[2]}}))}))},e.prototype.initMessageHandlerInternal=function(){return L(this,void 0,void 0,(function(){var e,t,r,n;return H(this,(function(a){switch(a.label){case 0:if(!this._authLibraryInitData)return[2,Promise.reject()];e=this._authLibraryInitData.interactive,r=!1,a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,Object(Ju.Load)(Xu(this._authLibraryInitData),this._authLibraryInitData.correlationId)];case 2:return t=a.sent(),r=!0,M.ULS.sendTraceTag(508302424,o.msoulscat_Wac_OAuth,i.Info,"[SHARED-AUTH] Successfully initialized as the primary"),this.registerAsPrimary(),[3,5];case 3:return n=a.sent(),M.ULS.sendTraceTag(508302423,o.msoulscat_Wac_OAuth,i.Warning,"[SHARED-AUTH] Encountered an initialization error attempting to register as the primary"),t=n,[3,5];case 4:return this._parentChannel.postToUntrustedParent(k.scriptInitialized,{response:t,isSuccess:r,interactive:!!e}),[7];case 5:return[2]}}))}))},e.prototype.tryGetTokenMessageHandler=function(e,t){return L(this,void 0,void 0,(function(){var r,n,a,s,c=this;return H(this,(function(u){switch(u.label){case 0:return this.isValidAudience(e.appId,e.target)?!this._isWebWorker||this._isPrimary?[3,1]:((n=e).upn=this._targetUpn,M.ULS.sendTraceTag(508302422,o.msoulscat_Wac_OAuth,i.Info,"[SHARED-AUTH] We are a satellite, attempt to get a token from the broker"),this.getTokenFromBroker(n),[3,8]):(M.ULS.sendTraceTag(508118087,o.msoulscat_Wac_OAuth,i.Warning,"[SHARED-AUTH] Invalid Audience requested: ".concat(e.appId," requested ").concat(e.target)),r={ErrorCode:"InvalidAudience",ErrorMessage:"The target provided is not allowed for the current application"},this._parentChannel.postTokenResponseDataToParent(k.getTokenResponse,{response:r,messageCorrelationId:e.messageCorrelationId,isSuccess:!1}),[2]);case 1:return this._isWebWorker?(M.ULS.sendTraceTag(508302421,o.msoulscat_Wac_OAuth,i.Info,"[SHARED-AUTH] We are the primary, attempt to fetch a token"),a=function(r){return L(c,void 0,void 0,(function(){var n,a;return H(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,Object(Ju.GetToken)(e.target,e.appId,e.messageCorrelationId,!1,e.withPopup,_(e.appId),e.claims)];case 1:return a=s.sent(),M.ULS.sendTraceTag(508302420,o.msoulscat_Wac_OAuth,i.Info,"[SHARED-AUTH] Successfully fetched token"),this.onGetTokenCompleted({response:a,messageCorrelationId:r.messageCorrelationId,isSuccess:!0},t),[3,3];case 2:return n=s.sent(),a=n,M.ULS.sendTraceTag(508302419,o.msoulscat_Wac_OAuth,i.Info,"[SHARED-AUTH] Encountered an error fetching token"),this.onGetTokenCompleted({response:a,messageCorrelationId:r.messageCorrelationId,isSuccess:!1},t),[3,3];case 3:return[2]}}))}))},e.withPopup&&this._interactive?[3,3]:[4,a(e)]):[3,5];case 2:return u.sent(),[3,4];case 3:this._activeTryGetTokenRequest=function(){return L(c,void 0,void 0,(function(){return H(this,(function(t){switch(t.label){case 0:return[4,a(e)];case 1:return t.sent(),this._activeInteractiveCorrelationId=this._activeTryGetTokenRequest=void 0,[2]}}))}))},u.label=4;case 4:return[3,8];case 5:return s=function(t){return L(c,void 0,void 0,(function(){var r,n;return H(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,Object(Ju.GetToken)(e.target,e.appId,void 0,!1,e.withPopup,_(e.appId),e.claims)];case 1:return n=a.sent(),M.ULS.sendTraceTag(508302418,o.msoulscat_Wac_OAuth,i.Info,"[SHARED-AUTH] Successfully fetched token (web worker disabled)"),this._parentChannel.postTokenResponseDataToParent(k.getTokenResponse,{response:n,messageCorrelationId:t.messageCorrelationId,isSuccess:!0}),[3,3];case 2:return r=a.sent(),n=r,M.ULS.sendTraceTag(508302417,o.msoulscat_Wac_OAuth,i.Info,"[SHARED-AUTH] Encountered an error fetching token (web worker disabled)"),this._parentChannel.postTokenResponseDataToParent(k.getTokenResponse,{response:n,messageCorrelationId:t.messageCorrelationId,isSuccess:!1}),[3,3];case 3:return[2]}}))}))},e.withPopup&&this._interactive?[3,7]:[4,s(e)];case 6:return u.sent(),[3,8];case 7:this._activeTryGetTokenRequest=function(){return L(c,void 0,void 0,(function(){return H(this,(function(t){switch(t.label){case 0:return[4,s(e)];case 1:return t.sent(),this._activeInteractiveCorrelationId=this._activeTryGetTokenRequest=void 0,[2]}}))}))},u.label=8;case 8:return[2]}}))}))},e.prototype.tryLoginMessageHandler=function(e){return L(this,void 0,void 0,(function(){var t=this;return H(this,(function(r){return M.ULS.sendTraceTag(508302416,o.msoulscat_Wac_OAuth,i.Info,"[SHARED-AUTH] Attempting login flow"),Object(Ju.GetApplication)(e.appId).loginPopup(e.claims).then((function(){return t.tryGetTokenMessageHandler(e)})).catch((function(){return M.ULS.sendTraceTag(508302415,o.msoulscat_Wac_OAuth,i.Info,"[SHARED-AUTH] Encountered an error in login flow"),Promise.reject()})).then((function(r){return t._parentChannel.postTokenResponseDataToParent(k.loginResponse,{response:r,messageCorrelationId:e.messageCorrelationId,isSuccess:!0})})).catch((function(r){return t._parentChannel.postTokenResponseDataToParent(k.loginResponse,{response:r,messageCorrelationId:e.messageCorrelationId,isSuccess:!1})})),[2]}))}))},e.prototype.onWorkerMessage=function(e){var t=JSON.parse(e.data);try{switch(t.MessageId){case R.registrationResponse:this.completeRegistration(t.Values);break;case R.brokerToken:this.brokerToken(t.Values,t.Routing.clientId);break;case R.tokenReady:this.onGetTokenCompleted(t.Values);break;case R.noPrimaryReady:this.handleNoPrimaryReady();break;default:M.ULS.sendTraceTag(508302414,o.msoulscat_Wac_OAuth,i.Warning,"[SHARED-AUTH] Unsupported Message ID from web worker ".concat(t.MessageId))}}catch(e){M.ULS.sendTraceTag(508354956,o.msoulscat_Wac_OAuth,i.Error,"Caught error trying to process PostMessage from worker ".concat(t.MessageId,": ").concat(I(e)))}},e.prototype.registerAsPrimary=function(){var e;this._clientId&&this._targetUpn&&(M.ULS.sendTraceTag(508302413,o.msoulscat_Wac_OAuth,i.Info,"[SHARED-AUTH] Attempting register as the primary with the web worker"),null===(e=this._webWorkerChannel)||void 0===e||e.postToWorker(A.registerPrimary,{clientId:this._clientId,upn:this._targetUpn}))},e.prototype.completeRegistration=function(e){var t;M.ULS.sendTraceTag(508302412,o.msoulscat_Wac_OAuth,i.Info,"[SHARED-AUTH] Connected to web worker; isPrimary: ".concat(e.thisFrameIsPrimary)),this._clientId=e.clientId,this._isPrimary=e.thisFrameIsPrimary,this._workerReadyToBrokerTokens=e.primaryRegistered,this._workerUpns=e.upnList,null===(t=this._workerConnectedPromise)||void 0===t||t.resolve()},e.prototype.getTokenFromBroker=function(e){var t;null===(t=this._webWorkerChannel)||void 0===t||t.postToWorker(A.getToken,e,this._clientId)},e.prototype.brokerToken=function(e,t){this.tryGetTokenMessageHandler(e,t).catch((function(e){return M.ULS.sendTraceTag(508354955,o.msoulscat_Wac_OAuth,i.Warning,"[SHARED-AUTH] Caught error trying to broker token to worker: ".concat(I(e)))}))},e.prototype.onGetTokenCompleted=function(e,t){var r;void 0!==t?null===(r=this._webWorkerChannel)||void 0===r||r.postToWorker(A.postToken,e,t):this._parentChannel.postTokenResponseDataToParent(k.getTokenResponse,e)},e.prototype.handleNoPrimaryReady=function(){M.ULS.sendTraceTag(508302411,o.msoulscat_Wac_OAuth,i.Info,"[SHARED-AUTH] Web worker indicated that no primary is ready, attempt to become the primary"),this.initMessageHandlerInternal().catch((function(e){return M.ULS.sendTraceTag(508302410,o.msoulscat_Wac_OAuth,i.Warning,"[SHARED-AUTH] Caught unexpected exception trying to initialize as the primary: ".concat(I(e)))}))},e.prototype.unregisterPrimary=function(){var e;void 0!==this._clientId&&void 0!==this._targetUpn&&this._isPrimary&&(M.ULS.sendTraceTag(508302409,o.msoulscat_Wac_OAuth,i.Info,"[SHARED-AUTH] Unregister as primary"),null===(e=this._webWorkerChannel)||void 0===e||e.postToWorker(A.unregisterPrimary,{clientId:this._clientId,upn:this._targetUpn}))},e}();!function(e){var t,r,n,a,s,c=!1,u="*",l=null!==(r=null===(t=document.getElementById("sharedauthscript"))||void 0===t?void 0:t.dataset.scriptload)&&void 0!==r?r:"Unknown";M.ULS.sendTraceTag(508302434,o.msoulscat_Wac_OAuth,i.Info,"[SHARED-AUTH] Script starting to execute");try{var d=T.searchParams.get("replyUrl"),h="1"===T.searchParams.get("standalone"),p=null===(n=document.getElementById("sharedauthscript"))||void 0===n?void 0:n.dataset.origin,f=null===(a=document.getElementById("sharedauthscript"))||void 0===a?void 0:a.dataset.allowedapps,g=null===(s=document.getElementById("sharedauthscript"))||void 0===s?void 0:s.dataset.allowedaudiences;if(d){if(p&&p.indexOf("@")<0){M.ULS.sendTraceTag(509368349,o.msoulscat_Wac_OAuth,i.Info,"[SHARED-AUTH] Initializing with a trusted replyUrl");var m=new URL(p);e(l,!1,null!=f?f:"",null!=g?g:"",m,void 0).start(),c=!0,u=m.origin,M.ULS.sendTraceTag(509368348,o.msoulscat_Wac_OAuth,i.Info,"[SHARED-AUTH] SharedAuthManager initialized successfully")}}else h?M.ULS.sendTraceTag(508302433,o.msoulscat_Wac_OAuth,i.Info,"[SHARED-AUTH] SharedAuthManager attempted to initialize in currently unsupported standalone mode"):M.ULS.sendTraceTag(508302432,o.msoulscat_Wac_OAuth,i.Info,"[SHARED-AUTH] SharedAuthManager initialized without either a trusted reply URL or standalone mode")}catch(e){M.ULS.sendTraceTag(509368347,o.msoulscat_Wac_OAuth,i.Error,"[SHARED-AUTH] Error during script initialization: ".concat(I(e)))}window.parent.postMessage(JSON.stringify(q(k.scriptLoaded,{Success:c,AuthLibrary:l})),u)}((function(e,t,r,n,o,i){return void 0===t&&(t=!1),new Zu(e,t,!1,r,n,o,i)}))},,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return s}));var n=r(2),o=r(6),i=((Object(o.a)()||{}).Symbol,(Object(o.a)()||{}).Reflect,n.a,function(e,t){return(i=n.b.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t[n.i](r)&&(e[r]=t[r])})(e,t)});function a(e,t){function r(){this.constructor=e}typeof t!==n.h&&null!==t&&Object(o.c)("Class extends value "+String(t)+" is not a constructor or null"),i(e,t),e[n.k]=null===t?Object(o.b)(t):(r[n.k]=t[n.k],new r)}function s(e,t){for(var r=0,n=t.length,o=e.length;r<n;r++,o++)e[o]=t[r];return e}}]);