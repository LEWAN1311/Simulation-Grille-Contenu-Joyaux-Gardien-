!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.FloodgateDynamicCampaign=t():e.FloodgateDynamicCampaign=t()}(self,(function(){return function(){var e={7222:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.IFloodgateHostPlatform=t.GovernedChannelType=t.ICampaignDefinitions=t.Api=void 0,i(n(7560),t),t.Api=n(7560),i(n(2783),t),i(n(8262),t),i(n(234),t);var o=n(9556);Object.defineProperty(t,"ICampaignDefinitions",{enumerable:!0,get:function(){return o.ICampaignDefinitions}});var s=n(8445);Object.defineProperty(t,"GovernedChannelType",{enumerable:!0,get:function(){return s.GovernedChannelType}}),i(n(3783),t);var a=n(9518);Object.defineProperty(t,"IFloodgateHostPlatform",{enumerable:!0,get:function(){return a.IFloodgateHostPlatform}}),i(n(7857),t),i(n(5333),t)},2377:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.EcsConfigType=void 0,(n=t.EcsConfigType||(t.EcsConfigType={}))[n.Default=0]="Default",n[n.User=1]="User"},4950:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActivityName=void 0;var n=function(){function e(){}return e.AppLaunch="AppLaunch",e.AppUsageTime="AppUsageTime",e.AppResume="AppResume",e}();t.ActivityName=n},7254:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},503:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8139:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2346:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RoamingSettingIdMap=void 0,t.RoamingSettingIdMap={CampaignStates:1258,GovernedChannelStates:1257,SurveyActivationStats:1259}},3455:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.FloodgateStorageProviderFileType=void 0,(n=t.FloodgateStorageProviderFileType||(t.FloodgateStorageProviderFileType={}))[n.FloodgateSettings=0]="FloodgateSettings",n[n.SurveyActivationStats=1]="SurveyActivationStats",n[n.SurveyEventActivityStats=2]="SurveyEventActivityStats",n[n.CampaignDefinitions=3]="CampaignDefinitions",n[n.CampaignStates=4]="CampaignStates",n[n.GovernedChannelStates=5]="GovernedChannelStates",n[n.TmsCache_MessageMetadata=6]="TmsCache_MessageMetadata",n[n.TmsCache_UserGovernance=7]="TmsCache_UserGovernance",n[n.TmsCache_CampaignContent=8]="TmsCache_CampaignContent",n[n.Tms_DynamicSettings=9]="Tms_DynamicSettings",n[n.LogLevelSettings=10]="LogLevelSettings",n[n.UserFacts=11]="UserFacts",n[n.DebugOverrides=12]="DebugOverrides",n[n.DynamicCampaignDefinitions=13]="DynamicCampaignDefinitions"},8024:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2584:function(e,t){"use strict";var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.GovernanceServiceClientState=t.GovernanceServiceSurveyType=void 0,(r=t.GovernanceServiceSurveyType||(t.GovernanceServiceSurveyType={}))[r.Unknown=0]="Unknown",r[r.Feedback=1]="Feedback",r[r.Nps=2]="Nps",r[r.Psat=4]="Psat",r[r.Bps=6]="Bps",r[r.Fps=8]="Fps",r[r.Nlqs=18]="Nlqs",r[r.GenericMessagingSurface=22]="GenericMessagingSurface",r[r.Intercept=24]="Intercept",(n=t.GovernanceServiceClientState||(t.GovernanceServiceClientState={}))[n.Disabled=0]="Disabled",n[n.InitializationFailed=1]="InitializationFailed",n[n.Enabled=2]="Enabled"},8653:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1803:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},6395:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3944:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8467:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.LAUNCHER_TYPE_DEFAULT=t.DOM_INTERCEPT_TAGNAME=t.DOM_NLQS_TAGNAME=t.DOM_FPS_TAGNAME=t.DOM_BPS_TAGNAME=t.DOM_PSAT_TAGNAME=t.DOM_NPS_TAGNAME=t.DOM_FEEDBACKSURVEY_TAGNAME=t.SurveyType=void 0,(n=t.SurveyType||(t.SurveyType={}))[n.Feedback=0]="Feedback",n[n.Nps=1]="Nps",n[n.Psat=2]="Psat",n[n.Bps=3]="Bps",n[n.Fps=4]="Fps",n[n.Nlqs=5]="Nlqs",n[n.Intercept=6]="Intercept",n[n.GenericMessagingSurface=12]="GenericMessagingSurface",t.DOM_FEEDBACKSURVEY_TAGNAME="FeedbackSurvey",t.DOM_NPS_TAGNAME="Nps",t.DOM_PSAT_TAGNAME="Psat",t.DOM_BPS_TAGNAME="Bps",t.DOM_FPS_TAGNAME="Fps",t.DOM_NLQS_TAGNAME="Nlqs",t.DOM_INTERCEPT_TAGNAME="Intercept",t.LAUNCHER_TYPE_DEFAULT="survey"},6294:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSON_SURVEYSPECIFICDATA_KEYNAME=t.JSON_SURVEYSTRINGS_KEYNAME=t.JSON_EXTENDEDMANIFESTDATA_KEYNAME=t.JSON_APPLICATION_KEYNAME=t.JSON_MULTIPLECHOICE_KEYNAME=t.JSON_QUESTION_KEYNAME=t.JSON_TITLE_KEYNAME=t.JSON_CVSURVEYPLATFORM_KEYNAME=t.JSON_CVSURVEYUIHOST_KEYNAME=t.JSON_CVSURVEYPRODUCTNAME_KEYNAME=t.JSON_RATINGOPTIONS_KEYNAME=t.JSON_CVSURVEYTHEME_KEYNAME=t.JSON_CVSURVEYFORMID_KEYNAME=t.JSON_CVSURVEY_KEYNAME=t.JSON_RATING_KEYNAME=t.JSON_COMMENT_KEYNAME=t.JSON_PROMPTNOTEXT_KEYNAME=t.JSON_PROMPTYESTEXT_KEYNAME=t.JSON_PROMPT_KEYNAME=t.JSON_INTERCEPTURL_KEYNAME=t.JSON_INTERCEPT_KEYNAME=t.DOM_MULTIPLECHOICE_TAGNAME=t.DOM_CVSURVEY_TAGNAME=t.DOM_RATING_TAGNAME=t.DOM_COMMENT_TAGNAME=t.DOM_PROMPT_TAGNAME=void 0,t.DOM_PROMPT_TAGNAME="Prompt",t.DOM_COMMENT_TAGNAME="Comment",t.DOM_RATING_TAGNAME="Rating",t.DOM_CVSURVEY_TAGNAME="CVSurvey",t.DOM_MULTIPLECHOICE_TAGNAME="MultipleChoice",t.JSON_INTERCEPT_KEYNAME="intercept",t.JSON_INTERCEPTURL_KEYNAME="url",t.JSON_PROMPT_KEYNAME="prompt",t.JSON_PROMPTYESTEXT_KEYNAME="yesButtonText",t.JSON_PROMPTNOTEXT_KEYNAME="noButtonText",t.JSON_COMMENT_KEYNAME="comment",t.JSON_RATING_KEYNAME="rating",t.JSON_CVSURVEY_KEYNAME="cvSurvey",t.JSON_CVSURVEYFORMID_KEYNAME="formId",t.JSON_CVSURVEYTHEME_KEYNAME="theme",t.JSON_RATINGOPTIONS_KEYNAME="options",t.JSON_CVSURVEYPRODUCTNAME_KEYNAME="productName",t.JSON_CVSURVEYUIHOST_KEYNAME="uiHost",t.JSON_CVSURVEYPLATFORM_KEYNAME="platform",t.JSON_TITLE_KEYNAME="title",t.JSON_QUESTION_KEYNAME="question",t.JSON_MULTIPLECHOICE_KEYNAME="multipleChoice",t.JSON_APPLICATION_KEYNAME="application",t.JSON_EXTENDEDMANIFESTDATA_KEYNAME="extendedManifestData",t.JSON_SURVEYSTRINGS_KEYNAME="surveyStrings",t.JSON_SURVEYSPECIFICDATA_KEYNAME="surveySpecificData"},7560:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(2783),t),i(n(4950),t),i(n(8467),t),i(n(6294),t),i(n(8139),t),i(n(2346),t),i(n(3455),t),i(n(8024),t),i(n(8653),t),i(n(3944),t),i(n(1803),t),i(n(6395),t),i(n(7254),t),i(n(503),t),i(n(2584),t),i(n(2377),t)},5753:function(e,t){"use strict";var n,r,i;Object.defineProperty(t,"__esModule",{value:!0}),t.BranchingTargetType=t.ConditionSourceType=t.ConditionType=void 0,(i=t.ConditionType||(t.ConditionType={})).Equals="Equals",i.NotEquals="NotEquals",i.GreaterThan="GreaterThan",i.GreaterThanOrEqual="GreaterThanOrEqual",i.LessThan="LessThan",i.LessThanOrEqual="LessThanOrEqual",(r=t.ConditionSourceType||(t.ConditionSourceType={})).Question="Question",r.Variable="Variable",(n=t.BranchingTargetType||(t.BranchingTargetType={})).Page="Page",n.Override="Override"},218:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.QuestionType=void 0,(n=t.QuestionType||(t.QuestionType={})).Comment="Comment",n.ContactMe="ContactMe",n.MultipleChoice="MultipleChoice",n.Label="Label",n.Rating="Rating",n.SingleSelect="SingleSelect",n.Likert="Likert"},1607:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.SurveySurfaceSize=void 0,(n=t.SurveySurfaceSize||(t.SurveySurfaceSize={})).Compact="Compact",n.Medium="Medium"},5767:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.IUxSchemaAdditionalCapabilitiesTypes=void 0,(n=t.IUxSchemaAdditionalCapabilitiesTypes||(t.IUxSchemaAdditionalCapabilitiesTypes={})).Email="email",n.Screenshot="screenshot",n.Diagnostics="diagnostics"},234:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(1607),t),i(n(218),t),i(n(5753),t),i(n(5767),t)},3783:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},9518:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.IFloodgateHostPlatform=void 0,(n=t.IFloodgateHostPlatform||(t.IFloodgateHostPlatform={})).Web="Web",n.Android="Android",n.Win32="Win32",n.iOS="iOS"},7857:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},9556:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ICampaignDefinitions=void 0;t.ICampaignDefinitions=function(){}},8445:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.GovernedChannelType=void 0,(n=t.GovernedChannelType||(t.GovernedChannelType={}))[n.Standard=0]="Standard",n[n.Urgent=1]="Urgent",n[n.Banner=2]="Banner",n[n.TeachingMessage=3]="TeachingMessage",n[n.BusinessBar=4]="BusinessBar",function(e){e.getDefault=function(){return e.Standard}}(t.GovernedChannelType||(t.GovernedChannelType={}))},8262:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2783:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.JSON_ID_KEYNAME=t.JSON_SURVEY_KEYNAME=t.DOM_ID_TAGNAME=t.DOM_TYPE_VALUE=t.DOM_TYPE_TAGNAME=t.SurveyInfoBusinessLevel=void 0,(n=t.SurveyInfoBusinessLevel||(t.SurveyInfoBusinessLevel={}))[n.None=0]="None",n[n.Critical=1]="Critical",t.DOM_TYPE_TAGNAME="Type",t.DOM_TYPE_VALUE="Survey",t.DOM_ID_TAGNAME="SurveyID",t.JSON_SURVEY_KEYNAME="survey",t.JSON_ID_KEYNAME="surveyId"},5333:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.AuthenticationType=void 0,(n=t.AuthenticationType||(t.AuthenticationType={}))[n.MSA=0]="MSA",n[n.AAD=1]="AAD",n[n.Unauthenticated=2]="Unauthenticated"},7378:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4540),i=function(){function e(){this._isAllowed=!1}return e.prototype.putBackgroundFetchAllowed=function(e){if(this._isAllowed=e,this.isBackgroundFetchAllowed()&&this._isAllowedDeferral){var t=this._isAllowedDeferral;this._isAllowedDeferral=void 0,t.resolve(void 0)}},e.prototype.isBackgroundFetchAllowed=function(){return this._isAllowed},e.prototype.waitForBackgroundFetchAllowed=function(){return this.isBackgroundFetchAllowed()?r.Resolved():(this._isAllowedDeferral||(this._isAllowedDeferral=r.Defer()),this._isAllowedDeferral.promise())},e}();t.default=i},848:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4540),i=function(){function e(){this._isActive=!1}return e.prototype.putAppActive=function(e){if(this._isActive=e,this.isAppActive()&&this._appActiveDeferral){var t=this._appActiveDeferral;this._appActiveDeferral=void 0,t.resolve(void 0)}},e.prototype.isAppActive=function(){return this._isActive},e.prototype.waitForAppActive=function(){return this.isAppActive()?r.Resolved():(this._appActiveDeferral||(this._appActiveDeferral=r.Defer()),this._appActiveDeferral.promise())},e}();t.default=i},8115:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7987),i=n(4540),o=n(4676),s=function(){function e(e){this._config=e,this.configUpdated=new r.default,this._cachedConfigs={}}return e.prototype.initialize=function(){return this.updateConfigsToFetch()},e.prototype.updateConfigsToFetch=function(){var e=this,t=this._config.getConfig(),n=t.databaseInterface,r=t.configsToFetch;if(!n)return i.Resolved();for(var o=[],s=function(t){if(a._cachedConfigs[t])return"continue";o.push(n.getData(t).then((function(n){n&&(e._cachedConfigs[t]=n)})).catch((function(){return i.Resolved()})))},a=this,c=0,u=r;c<u.length;c++)s(u[c]);return i.all(o).then((function(){o.length>0&&e.configUpdated.fire()}))},e.prototype.getEcsConfig=function(){return this._cachedConfigs[o.EcsConfigType.User]||this._cachedConfigs[o.EcsConfigType.Default]},e.prototype.getEcsConfigByType=function(e){return this._cachedConfigs[e]},e.prototype.putConfig=function(e){var t=this.getEcsConfig();this._cachedConfigs[e.configType]=e;var n=this.getEcsConfig();(n&&n.configType===e.configType||t&&n&&t.configType!==n.configType)&&this.configUpdated.fire();var r=this._config.getConfig().databaseInterface;return r?r.putData(e.configType,e):i.Resolved()},e}();t.default=s},8417:function(e,t){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.initialize=function(e){if(this._config)throw new Error("ECS Configuration already initialized");this._config=e},e.prototype.getConfig=function(){if(!this._config)throw new Error("ECS Configuration not yet initialized");return this._config},e.prototype.setConfigsToFetch=function(e){if(!this._config)throw new Error("ECS Configuration not yet initialized");this._config=n(n({},this._config),{configsToFetch:e})},e.prototype.setFetchTimeout=function(e){if(!this._config)throw new Error("ECS Configuration not yet initialized");this._config=n(n({},this._config),{fetchTimeout:e})},e}();t.default=r},945:function(e,t,n){"use strict";var r=n(7378),i=n(848),o=n(8115),s=n(8417);n(4676);var a=n(738),c=n(8808),u=n(9490),p=function(){function e(){this._allowBackgroundFetchData=new r.default,this._appActiveData=new i.default,this._config=new s.default,this._cache=new o.default(this._config),this._skypeTokenData=new c.default,this._telemetryManager=new u.default(this._cache),this._scheduler=new a.default(this._config,this._skypeTokenData,this._cache,this._appActiveData,this._allowBackgroundFetchData,this._telemetryManager),this.telemetryEventAdded=this._telemetryManager.telemetryEventAdded,this.configUpdated=this._cache.configUpdated}return e.prototype.initialize=function(e){var t=this;return this._config.initialize(e),this._skypeTokenData.putSkypeTokenData(e.initialSkypeTokenData),this._appActiveData.putAppActive(e.initialAppActiveState),this._cache.initialize().then((function(){t._scheduler.initialize()}))},e.prototype.dispose=function(){var e;(null===(e=this._config.getConfig().Killswitches)||void 0===e?void 0:e.isSkypeTokenDataLeakFixEnabled)&&this._scheduler.dispose()},e.prototype.getConfig=function(){return this._cache.getEcsConfig()},e.prototype.getConfigType=function(){var e=this._cache.getEcsConfig();if(e)return e.configType},e.prototype.requestUpdate=function(){this._scheduler.requestUpdate()},e.prototype.pause=function(){this._scheduler.pause()},e.prototype.resume=function(){this._scheduler.resume()},e.prototype.setAllowBackgroundFetch=function(e){this._allowBackgroundFetchData.putBackgroundFetchAllowed(e)},e.prototype.useSkypeToken=function(e,t){this._skypeTokenData.putSkypeTokenData({skypeToken:e,skypeTokenExpiration:t})},e.prototype.setAppActive=function(e){this._appActiveData.putAppActive(e)},e.prototype.setConfigsToFetch=function(e){var t=this;return this._config.setConfigsToFetch(e),this._cache.updateConfigsToFetch().then((function(){t._scheduler.updateConfigsToFetch()}))},e.prototype.setFetchTimeout=function(e){this._config.setFetchTimeout(e)},e}();t.ZP=p},4676:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),(n=t.EcsConfigType||(t.EcsConfigType={}))[n.Default=0]="Default",n[n.User=1]="User"},5991:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s,a,c=n(3221),u=n(4540),p=n(4676),f=n(8266),l=function(e){function t(t,n,r,i,o,s,a,c){var u=e.call(this,t)||this;u._config=n,u._skypeTokenData=r,u._appActiveData=i,u._allowBackgroundFetchData=o,u._etag=s,u._getUserConfig=a;var p=u._config.getConfig();if(u._apiPath=p.clientTeam?"/config/v1/"+p.clientName+"/"+p.clientVersion+"/"+p.clientTeam:"/config/v1/"+p.clientName+"/"+p.clientVersion,c){var f=Object.keys(c).map((function(e){return encodeURIComponent(e)+"="+encodeURIComponent(c[e].toString())}));f&&(u._apiPath+="?"+f.join("&"))}return u}return i(t,e),t.prototype._blockRequestUntil=function(e){var t=this;if(this._getUserConfig&&!this._skypeTokenData.isSkypeTokenValid()&&console.log("ECS - Delaying User config fetch until we have a valid SkypeToken"),!this._appActiveData.isAppActive()&&!this._allowBackgroundFetchData.isBackgroundFetchAllowed()){var n=this._getUserConfig?"User config":"config";console.log("ECS - Delaying "+n+" fetch until the app is active (or background fetch is allowed)")}return u.race([this._appActiveData.waitForAppActive(),this._allowBackgroundFetchData.waitForBackgroundFetchAllowed()]).then((function(){if(t._getUserConfig)return t._skypeTokenData.waitForValidSkypeToken()})).then((function(){a=Date.now()}))},t.prototype._getHeaders=function(){var e={};return this._etag&&(e["If-None-Match"]=this._etag),this._getUserConfig&&(e.Authorization=this._skypeTokenData.getSkypeToken()),e},t.prototype.getConfig=function(){var t=this._config.getConfig().fetchTimeout;return void 0!==t&&(t<0?t=0:t>0&&t<3e4&&(t=3e4)),e.prototype.performApiGetDetailed.call(this,this._apiPath,{timeout:t})},t}(c.GenericRestClient),h=function(){function e(e,t,n,r,i){this._config=e,this._skypeTokenData=t,this._appActiveData=n,this._allowBackgroundFetchData=r,this._telemetryManager=i,this._ecsFailureBackoffTimer=new c.ExponentialTime(1e3,3e5),this._cacheMaxAgeRegex=/.*max-age=(\d+).*/gi,this._serverIndex=NaN}return e.prototype.getConfig=function(e,t,n){var r=this,i=this._config.getConfig().hosts;if((isNaN(this._serverIndex)||this._serverIndex>i.length-1)&&(this._serverIndex=Math.floor(Math.random()*i.length)),!i||!i.length)return u.Rejected(new Error("no configuration service endpoint"));var s=u.Defer(),c=0,h=function(){var d=e&&e.eTag?e.eTag:void 0,_=new l(i[r._serverIndex],r._config,r._skypeTokenData,r._appActiveData,r._allowBackgroundFetchData,d,t,n);c++,_.getConfig().then((function(n){var l=n.headers.etag,h=n.headers.expires;n.body&&n.body.Headers&&(l||(l=n.body.Headers.ETag),h||(h=n.body.Headers.Expires));var _=r._calculateResponseTimeInfo(e);if(!l||!h)return console.warn("ECS - Service returned an empty ETag or Expiration header: "+JSON.stringify(n)),u.Rejected({timedOut:!1,responseParsingException:new Error("ECS Service returned empty ETag or Expiration header"),responseCode:n.statusCode});var y,g=new Date(r._calculateExpirationDate(n.headers)).getTime();if(304===n.statusCode&&e)(y=o({},e)).configType=t?p.EcsConfigType.User:p.EcsConfigType.Default,y.eTag=l,y.expiration=g,y.cacheUpdateTime=_.lastResponseTime,y.lastFetchTokenHash=r._skypeTokenData.getSkypeTokenHash(n.requestHeaders.Authorization);else{if("object"!=typeof n.body)return console.warn("ECS - Service returned invalid response "+JSON.stringify(n)),u.Rejected({timedOut:!1,responseParsingException:new Error("ECS Service returned invalid response body"),responseCode:n.statusCode});y={config:n.body,configType:t?p.EcsConfigType.User:p.EcsConfigType.Default,eTag:l,expiration:g,cacheUpdateTime:a,lastFetchTokenHash:r._skypeTokenData.getSkypeTokenHash(n.requestHeaders.Authorization),appVersion:r._config.getConfig().clientVersion}}r._telemetryManager.sendTelemetryEvent(new f.EcsConfigFetchResponse(_.fetchDelayMs,n.statusCode,c,r._skypeTokenData.isSkypeTokenValid(),i[r._serverIndex],_.fetchDurationValid,!!d,JSON.stringify(n).length,_.cacheAge,!(e&&e.expiration-Date.now()>0),a,_.lastResponseTime,t,l)),r._ecsFailureBackoffTimer.reset(),s.resolve(y)})).catch((function(n){var o={timedOut:n&&n.timedOut||!1,responseParseError:n&&n.responseParsingException,responseCode:n&&n.statusCode||0,message:r._getErrorMessage(n)};console.error("ECS - Service request failed to return a response (timedOut: "+o.timedOut+", responseParseError: "+o.responseParseError+")");var s=r._calculateResponseTimeInfo(e);r._telemetryManager.sendTelemetryEvent(new f.EcsConfigFetchResponse(s.fetchDelayMs,o.responseCode,c,r._skypeTokenData.isSkypeTokenValid(),i[r._serverIndex],s.fetchDurationValid,!!d,0,s.cacheAge,!(e&&e.expiration-Date.now()>0),a,s.lastResponseTime,t,void 0,o.timedOut,o.responseParseError,o.message));var u=r._config.getConfig().fetchAttemptMax;u&&c>u||setTimeout((function(){h()}),r._ecsFailureBackoffTimer.getTimeAndCalculateNext())}))};return h(),s.promise()},e.prototype._calculateExpirationDate=function(e){var t=Date.now()+1728e5;if(e.date&&e.expires){var n=new Date(e.date).getTime(),r=Date.now()-n,i=new Date(e.expires).getTime();return isNaN(i)?t:Math.min(t,i+r)}var o=this._cacheMaxAgeRegex.exec(e["cache-control"]);return this._cacheMaxAgeRegex.lastIndex=0,o&&2===o.length?Math.min(t,Date.now()+1e3*Number(o[1])):Date.now()+18e5},e.prototype._calculateResponseTimeInfo=function(e){var t=(s=Date.now())-a;return{lastResponseTime:s,fetchDelayMs:t,fetchDurationValid:!(t<0||t>31536e6),cacheAge:e?s-e.cacheUpdateTime:0}},e.prototype._getErrorMessage=function(e){if(e)return"string"==typeof e?e:"object"==typeof e&&(e.statusText||e.message)?e.statusText||e.message:void 0},e}();t.default=h},738:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4676),i=n(5991),o=function(){function e(e,t,n,o,s,a){var c=this;this._config=e,this._skypeTokenData=t,this._cache=n,this._isFetchingSettings={},this._pendingFetch={},this._pendingTimers={},this._subscriptionToken=null,this._paused=!1,this._fetchEcsSettingsIfNeeded=function(e){var t,n=c._config.getConfig(),i=c._cache.getEcsConfigByType(e);if(-1!==n.configsToFetch.indexOf(e)&&!c._isFetchingSettings[e])if(i||!c._pendingFetch[e]){var o=i?i.expiration-Date.now():-1;o<=0||i&&e===r.EcsConfigType.User&&c._skypeTokenData.isSkypeTokenValid()&&i.lastFetchTokenHash!==c._skypeTokenData.getSkypeTokenHash(c._skypeTokenData.getSkypeToken())?c._fetchSkypeEcsSettings(e):(null===(t=n.Killswitches)||void 0===t?void 0:t.isSkypeTokenDataLeakFixEnabled)?(c._pendingTimers[e]>0&&clearTimeout(c._pendingTimers[e]),c._pendingTimers[e]=window.setTimeout((function(){return c._fetchEcsSettingsIfNeeded(e)}),o)):window.setTimeout((function(){return c._fetchEcsSettingsIfNeeded(e)}),o)}else c._fetchSkypeEcsSettings(e)},this._fetchSkypeEcsSettings=function(e,t){void 0===t&&(t=!1),c._isFetchingSettings[e]||c._paused&&!t?c._pendingFetch[e]=!0:(c._pendingFetch[e]=!1,c._isFetchingSettings[e]=!0,c._config.getConfig().getEcsParameters().catch((function(){return console.warn("ECS - Failed to fetch ECS fetching parameters"),{}})).then((function(t){return c._ecsClient.getConfig(c._cache.getEcsConfig(),e===r.EcsConfigType.User,t)})).then((function(t){console.log("ECS - Config fetch complete"),c._isFetchingSettings[e]=!1,c._cache.putConfig(t),c._fetchEcsSettingsIfNeeded(e)})))},this._ecsClient=new i.default(this._config,this._skypeTokenData,o,s,a)}return e.prototype.initialize=function(){var e=this;this.updateConfigsToFetch(),this._subscriptionToken=this._skypeTokenData.skypeTokenChanged.subscribe((function(){return e._fetchEcsSettingsIfNeeded(r.EcsConfigType.User)}))},e.prototype.dispose=function(){var e,t,n=this._config.getConfig();if(null===(e=n.Killswitches)||void 0===e?void 0:e.isSkypeTokenDataLeakFixEnabled){for(var r=0,i=n.configsToFetch;r<i.length;r++){var o=i[r];clearTimeout(this._pendingTimers[o]),this._pendingTimers[o]=0}null===(t=this._subscriptionToken)||void 0===t||t.unsubscribe(),this._subscriptionToken=null,this._skypeTokenData.skypeTokenChanged.dispose()}},e.prototype.updateConfigsToFetch=function(){for(var e=this._config.getConfig(),t=0,n=e.configsToFetch;t<n.length;t++)(o=n[t])in this._isFetchingSettings||(this._isFetchingSettings[o]=!1),o in this._isFetchingSettings||(this._pendingFetch[o]=!1);for(var r=0,i=e.configsToFetch;r<i.length;r++){var o=i[r],s=this._cache.getEcsConfigByType(o);!s||s.appVersion&&s.appVersion!==e.clientVersion?this._fetchSkypeEcsSettings(o,!0):this._fetchEcsSettingsIfNeeded(o)}},e.prototype.requestUpdate=function(){for(var e=0,t=this._config.getConfig().configsToFetch;e<t.length;e++){var n=t[e];this._fetchSkypeEcsSettings(n)}},e.prototype.pause=function(){this._paused=!0},e.prototype.resume=function(){this._paused=!1;for(var e=0,t=this._config.getConfig().configsToFetch;e<t.length;e++){var n=t[e];this._fetchEcsSettingsIfNeeded(n)}},e}();t.default=o},8808:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7987),i=n(4540),o=function(){function e(){this.skypeTokenChanged=new r.default}return e.prototype.putSkypeTokenData=function(e){if(this._data=e,this.isSkypeTokenValid()&&this.skypeTokenChanged.fire(),this.isSkypeTokenValid()&&this._validSkypeTokenDeferral){var t=this._validSkypeTokenDeferral;this._validSkypeTokenDeferral=void 0,t.resolve(void 0)}},e.prototype.isSkypeTokenValid=function(){var e=this._data;return!!e&&!!e.skypeToken&&e.skypeTokenExpiration>Date.now()},e.prototype.getSkypeToken=function(){var e=this._data;if(!e||!e.skypeToken)throw new Error("No Skype Token provided");return e.skypeToken},e.prototype.getSkypeTokenHash=function(e){return void 0===e?0:e.split("").reduce((function(e,t){return(101*e+t.charCodeAt(0))%999727999}),e.length)},e.prototype.waitForValidSkypeToken=function(){return this.isSkypeTokenValid()?i.Resolved():(this._validSkypeTokenDeferral||(this._validSkypeTokenDeferral=i.Defer()),this._validSkypeTokenDeferral.promise())},e}();t.default=o},3950:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.getAttributes=function(){return{Source:"ecs_client"}},e}();t.TelemetryEventBase=n},8266:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n,r,i,o,s,a,c,u,p,f,l,h,d,_,y,g){var v=e.call(this)||this;return v._responseTime=t,v._responseCode=n,v._fetchAttempts=r,v._hasValidToken=i,v._serverEndpoint=o,v._fetchDurationValid=s,v._cacheAvailable=a,v._responseSize=c,v._configAge=u,v._configExpired=p,v._fetchStart=f,v._fetchEnd=l,v._isUserConfig=h,v._etag=d,v._timedOut=_,v._responseParsingException=y,v._errorMessage=g,v}return i(t,e),t.prototype.getEventName=function(){return"ecs_tsclient_fetch_config"},t.prototype.getAttributes=function(){var t=e.prototype.getAttributes.call(this);return t.fetch_delay_ms=this._responseTime,t.fetch_response_code=this._responseCode,t.fetch_attempts=this._fetchAttempts,t.authenticated_user=this._hasValidToken,t.url=this._serverEndpoint,t.fetch_duration_valid=this._fetchDurationValid,t.cache_available=this._cacheAvailable,t.response_size=this._responseSize,t.config_age=this._configAge,t.config_expired=this._configExpired,t.fetch_start=this._fetchStart,t.fetch_end=this._fetchEnd,t.is_user_config=this._isUserConfig,this._etag&&(t.fetched_etag=this._etag),void 0!==this._timedOut&&(t.fetch_timed_out=this._timedOut),this._responseParsingException&&(t.fetch_response_parsing_error=this._responseParsingException.message),this._errorMessage&&(t.fetch_error_message=this._errorMessage),t},t}(n(3950).TelemetryEventBase);t.EcsConfigFetchResponse=o},9490:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7987),i=function(){function e(e){this._cache=e,this.telemetryEventAdded=new r.default}return e.prototype.sendTelemetryEvent=function(t){var n=t.getEventName(),r=t.getAttributes(),i=!1,o=this._cache.getEcsConfig();if(o){if(e._containsEcsClientTelemetryConfig(o.config)){var s=o.config.ECSCONFIG;s&&s.ecsClientTelemetry&&(i=!!s.ecsClientTelemetry[n])}}else console.warn("No previously cached ECS telemetry config exists - fallback to sending event"),i=!0;i&&this.telemetryEventAdded.fire(n,r)},e._containsEcsClientTelemetryConfig=function(e){return!!e&&!!e.ECSCONFIG&&!!e.ECSCONFIG.ecsClientTelemetry},e}();t.default=i},7676:function(e,t,n){"use strict";var r=n(5277),i=n(8768),o=TypeError;e.exports=function(e){if(r(e))return e;throw new o(i(e)+" is not a function")}},5017:function(e,t,n){"use strict";var r=n(5277),i=String,o=TypeError;e.exports=function(e){if("object"==typeof e||r(e))return e;throw new o("Can't set "+i(e)+" as a prototype")}},6677:function(e,t,n){"use strict";var r=n(2280),i=n(1569),o=n(6385).f,s=r("unscopables"),a=Array.prototype;void 0===a[s]&&o(a,s,{configurable:!0,value:i(null)}),e.exports=function(e){a[s][e]=!0}},3875:function(e,t,n){"use strict";var r=n(2786),i=String,o=TypeError;e.exports=function(e){if(r(e))return e;throw new o(i(e)+" is not an object")}},7190:function(e,t,n){"use strict";var r=n(9580),i=n(2565),o=n(7046),s=function(e){return function(t,n,s){var a,c=r(t),u=o(c),p=i(s,u);if(e&&n!=n){for(;u>p;)if((a=c[p++])!=a)return!0}else for(;u>p;p++)if((e||p in c)&&c[p]===n)return e||p||0;return!e&&-1}};e.exports={includes:s(!0),indexOf:s(!1)}},9159:function(e,t,n){"use strict";var r=n(8697),i=r({}.toString),o=r("".slice);e.exports=function(e){return o(i(e),8,-1)}},3870:function(e,t,n){"use strict";var r=n(4792),i=n(1561),o=n(6012),s=n(6385);e.exports=function(e,t,n){for(var a=i(t),c=s.f,u=o.f,p=0;p<a.length;p++){var f=a[p];r(e,f)||n&&r(n,f)||c(e,f,u(t,f))}}},5115:function(e,t,n){"use strict";var r=n(9044);e.exports=!r((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},6145:function(e){"use strict";e.exports=function(e,t){return{value:e,done:t}}},5899:function(e,t,n){"use strict";var r=n(7493),i=n(6385),o=n(9199);e.exports=r?function(e,t,n){return i.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},9199:function(e){"use strict";e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},403:function(e,t,n){"use strict";var r=n(5277),i=n(6385),o=n(833),s=n(2359);e.exports=function(e,t,n,a){a||(a={});var c=a.enumerable,u=void 0!==a.name?a.name:t;if(r(n)&&o(n,u,a),a.global)c?e[t]=n:s(t,n);else{try{a.unsafe?e[t]&&(c=!0):delete e[t]}catch(e){}c?e[t]=n:i.f(e,t,{value:n,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return e}},2359:function(e,t,n){"use strict";var r=n(8363),i=Object.defineProperty;e.exports=function(e,t){try{i(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},7493:function(e,t,n){"use strict";var r=n(9044);e.exports=!r((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},3966:function(e){"use strict";var t="object"==typeof document&&document.all,n=void 0===t&&void 0!==t;e.exports={all:t,IS_HTMLDDA:n}},2750:function(e,t,n){"use strict";var r=n(8363),i=n(2786),o=r.document,s=i(o)&&i(o.createElement);e.exports=function(e){return s?o.createElement(e):{}}},2848:function(e){"use strict";e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},9189:function(e,t,n){"use strict";var r=n(2750)("span").classList,i=r&&r.constructor&&r.constructor.prototype;e.exports=i===Object.prototype?void 0:i},2647:function(e){"use strict";e.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},1197:function(e,t,n){"use strict";var r,i,o=n(8363),s=n(2647),a=o.process,c=o.Deno,u=a&&a.versions||c&&c.version,p=u&&u.v8;p&&(i=(r=p.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!i&&s&&(!(r=s.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=s.match(/Chrome\/(\d+)/))&&(i=+r[1]),e.exports=i},8869:function(e){"use strict";e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},9882:function(e,t,n){"use strict";var r=n(8363),i=n(6012).f,o=n(5899),s=n(403),a=n(2359),c=n(3870),u=n(6291);e.exports=function(e,t){var n,p,f,l,h,d=e.target,_=e.global,y=e.stat;if(n=_?r:y?r[d]||a(d,{}):(r[d]||{}).prototype)for(p in t){if(l=t[p],f=e.dontCallGetSet?(h=i(n,p))&&h.value:n[p],!u(_?p:d+(y?".":"#")+p,e.forced)&&void 0!==f){if(typeof l==typeof f)continue;c(l,f)}(e.sham||f&&f.sham)&&o(l,"sham",!0),s(n,p,l,e)}}},9044:function(e){"use strict";e.exports=function(e){try{return!!e()}catch(e){return!0}}},3996:function(e,t,n){"use strict";var r=n(9044);e.exports=!r((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},9611:function(e,t,n){"use strict";var r=n(3996),i=Function.prototype.call;e.exports=r?i.bind(i):function(){return i.apply(i,arguments)}},5316:function(e,t,n){"use strict";var r=n(7493),i=n(4792),o=Function.prototype,s=r&&Object.getOwnPropertyDescriptor,a=i(o,"name"),c=a&&"something"===function(){}.name,u=a&&(!r||r&&s(o,"name").configurable);e.exports={EXISTS:a,PROPER:c,CONFIGURABLE:u}},2575:function(e,t,n){"use strict";var r=n(8697),i=n(7676);e.exports=function(e,t,n){try{return r(i(Object.getOwnPropertyDescriptor(e,t)[n]))}catch(e){}}},8697:function(e,t,n){"use strict";var r=n(3996),i=Function.prototype,o=i.call,s=r&&i.bind.bind(o,o);e.exports=r?s:function(e){return function(){return o.apply(e,arguments)}}},2773:function(e,t,n){"use strict";var r=n(8363),i=n(5277),o=function(e){return i(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?o(r[e]):r[e]&&r[e][t]}},7219:function(e,t,n){"use strict";var r=n(7676),i=n(9903);e.exports=function(e,t){var n=e[t];return i(n)?void 0:r(n)}},8363:function(e,t,n){"use strict";var r=function(e){return e&&e.Math===Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||function(){return this}()||this||Function("return this")()},4792:function(e,t,n){"use strict";var r=n(8697),i=n(744),o=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return o(i(e),t)}},7505:function(e){"use strict";e.exports={}},7055:function(e,t,n){"use strict";var r=n(2773);e.exports=r("document","documentElement")},7548:function(e,t,n){"use strict";var r=n(7493),i=n(9044),o=n(2750);e.exports=!r&&!i((function(){return 7!==Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},8609:function(e,t,n){"use strict";var r=n(8697),i=n(9044),o=n(9159),s=Object,a=r("".split);e.exports=i((function(){return!s("z").propertyIsEnumerable(0)}))?function(e){return"String"===o(e)?a(e,""):s(e)}:s},6429:function(e,t,n){"use strict";var r=n(8697),i=n(5277),o=n(9415),s=r(Function.toString);i(o.inspectSource)||(o.inspectSource=function(e){return s(e)}),e.exports=o.inspectSource},821:function(e,t,n){"use strict";var r,i,o,s=n(2512),a=n(8363),c=n(2786),u=n(5899),p=n(4792),f=n(9415),l=n(466),h=n(7505),d="Object already initialized",_=a.TypeError,y=a.WeakMap;if(s||f.state){var g=f.state||(f.state=new y);g.get=g.get,g.has=g.has,g.set=g.set,r=function(e,t){if(g.has(e))throw new _(d);return t.facade=e,g.set(e,t),t},i=function(e){return g.get(e)||{}},o=function(e){return g.has(e)}}else{var v=l("state");h[v]=!0,r=function(e,t){if(p(e,v))throw new _(d);return t.facade=e,u(e,v,t),t},i=function(e){return p(e,v)?e[v]:{}},o=function(e){return p(e,v)}}e.exports={set:r,get:i,has:o,enforce:function(e){return o(e)?i(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!c(t)||(n=i(t)).type!==e)throw new _("Incompatible receiver, "+e+" required");return n}}}},5277:function(e,t,n){"use strict";var r=n(3966),i=r.all;e.exports=r.IS_HTMLDDA?function(e){return"function"==typeof e||e===i}:function(e){return"function"==typeof e}},6291:function(e,t,n){"use strict";var r=n(9044),i=n(5277),o=/#|\.prototype\./,s=function(e,t){var n=c[a(e)];return n===p||n!==u&&(i(t)?r(t):!!t)},a=s.normalize=function(e){return String(e).replace(o,".").toLowerCase()},c=s.data={},u=s.NATIVE="N",p=s.POLYFILL="P";e.exports=s},9903:function(e){"use strict";e.exports=function(e){return null==e}},2786:function(e,t,n){"use strict";var r=n(5277),i=n(3966),o=i.all;e.exports=i.IS_HTMLDDA?function(e){return"object"==typeof e?null!==e:r(e)||e===o}:function(e){return"object"==typeof e?null!==e:r(e)}},1178:function(e){"use strict";e.exports=!1},6681:function(e,t,n){"use strict";var r=n(2773),i=n(5277),o=n(2010),s=n(189),a=Object;e.exports=s?function(e){return"symbol"==typeof e}:function(e){var t=r("Symbol");return i(t)&&o(t.prototype,a(e))}},9952:function(e,t,n){"use strict";var r=n(7022).IteratorPrototype,i=n(1569),o=n(9199),s=n(878),a=n(4818),c=function(){return this};e.exports=function(e,t,n,u){var p=t+" Iterator";return e.prototype=i(r,{next:o(+!u,n)}),s(e,p,!1,!0),a[p]=c,e}},8150:function(e,t,n){"use strict";var r=n(9882),i=n(9611),o=n(1178),s=n(5316),a=n(5277),c=n(9952),u=n(2654),p=n(2412),f=n(878),l=n(5899),h=n(403),d=n(2280),_=n(4818),y=n(7022),g=s.PROPER,v=s.CONFIGURABLE,m=y.IteratorPrototype,T=y.BUGGY_SAFARI_ITERATORS,S=d("iterator"),E="keys",b="values",C="entries",O=function(){return this};e.exports=function(e,t,n,s,d,y,A){c(n,t,s);var k,x,M,D=function(e){if(e===d&&F)return F;if(!T&&e&&e in N)return N[e];switch(e){case E:case b:case C:return function(){return new n(this,e)}}return function(){return new n(this)}},P=t+" Iterator",w=!1,N=e.prototype,R=N[S]||N["@@iterator"]||d&&N[d],F=!T&&R||D(d),j="Array"===t&&N.entries||R;if(j&&(k=u(j.call(new e)))!==Object.prototype&&k.next&&(o||u(k)===m||(p?p(k,m):a(k[S])||h(k,S,O)),f(k,P,!0,!0),o&&(_[P]=O)),g&&d===b&&R&&R.name!==b&&(!o&&v?l(N,"name",b):(w=!0,F=function(){return i(R,this)})),d)if(x={values:D(b),keys:y?F:D(E),entries:D(C)},A)for(M in x)(T||w||!(M in N))&&h(N,M,x[M]);else r({target:t,proto:!0,forced:T||w},x);return o&&!A||N[S]===F||h(N,S,F,{name:d}),_[t]=F,x}},7022:function(e,t,n){"use strict";var r,i,o,s=n(9044),a=n(5277),c=n(2786),u=n(1569),p=n(2654),f=n(403),l=n(2280),h=n(1178),d=l("iterator"),_=!1;[].keys&&("next"in(o=[].keys())?(i=p(p(o)))!==Object.prototype&&(r=i):_=!0),!c(r)||s((function(){var e={};return r[d].call(e)!==e}))?r={}:h&&(r=u(r)),a(r[d])||f(r,d,(function(){return this})),e.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:_}},4818:function(e){"use strict";e.exports={}},7046:function(e,t,n){"use strict";var r=n(5108);e.exports=function(e){return r(e.length)}},833:function(e,t,n){"use strict";var r=n(8697),i=n(9044),o=n(5277),s=n(4792),a=n(7493),c=n(5316).CONFIGURABLE,u=n(6429),p=n(821),f=p.enforce,l=p.get,h=String,d=Object.defineProperty,_=r("".slice),y=r("".replace),g=r([].join),v=a&&!i((function(){return 8!==d((function(){}),"length",{value:8}).length})),m=String(String).split("String"),T=e.exports=function(e,t,n){"Symbol("===_(h(t),0,7)&&(t="["+y(h(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!s(e,"name")||c&&e.name!==t)&&(a?d(e,"name",{value:t,configurable:!0}):e.name=t),v&&n&&s(n,"arity")&&e.length!==n.arity&&d(e,"length",{value:n.arity});try{n&&s(n,"constructor")&&n.constructor?a&&d(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var r=f(e);return s(r,"source")||(r.source=g(m,"string"==typeof t?t:"")),e};Function.prototype.toString=T((function(){return o(this)&&l(this).source||u(this)}),"toString")},8300:function(e){"use strict";var t=Math.ceil,n=Math.floor;e.exports=Math.trunc||function(e){var r=+e;return(r>0?n:t)(r)}},1569:function(e,t,n){"use strict";var r,i=n(3875),o=n(7840),s=n(8869),a=n(7505),c=n(7055),u=n(2750),p=n(466)("IE_PROTO"),f=function(){},l=function(e){return"<script>"+e+"<\/script>"},h=function(e){e.write(l("")),e.close();var t=e.parentWindow.Object;return e=null,t},d=function(){try{r=new ActiveXObject("htmlfile")}catch(e){}var e,t;d="undefined"!=typeof document?document.domain&&r?h(r):((t=u("iframe")).style.display="none",c.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(l("document.F=Object")),e.close(),e.F):h(r);for(var n=s.length;n--;)delete d.prototype[s[n]];return d()};a[p]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(f.prototype=i(e),n=new f,f.prototype=null,n[p]=e):n=d(),void 0===t?n:o.f(n,t)}},7840:function(e,t,n){"use strict";var r=n(7493),i=n(1010),o=n(6385),s=n(3875),a=n(9580),c=n(667);t.f=r&&!i?Object.defineProperties:function(e,t){s(e);for(var n,r=a(t),i=c(t),u=i.length,p=0;u>p;)o.f(e,n=i[p++],r[n]);return e}},6385:function(e,t,n){"use strict";var r=n(7493),i=n(7548),o=n(1010),s=n(3875),a=n(383),c=TypeError,u=Object.defineProperty,p=Object.getOwnPropertyDescriptor;t.f=r?o?function(e,t,n){if(s(e),t=a(t),s(n),"function"==typeof e&&"prototype"===t&&"value"in n&&"writable"in n&&!n.writable){var r=p(e,t);r&&r.writable&&(e[t]=n.value,n={configurable:"configurable"in n?n.configurable:r.configurable,enumerable:"enumerable"in n?n.enumerable:r.enumerable,writable:!1})}return u(e,t,n)}:u:function(e,t,n){if(s(e),t=a(t),s(n),i)try{return u(e,t,n)}catch(e){}if("get"in n||"set"in n)throw new c("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},6012:function(e,t,n){"use strict";var r=n(7493),i=n(9611),o=n(1513),s=n(9199),a=n(9580),c=n(383),u=n(4792),p=n(7548),f=Object.getOwnPropertyDescriptor;t.f=r?f:function(e,t){if(e=a(e),t=c(t),p)try{return f(e,t)}catch(e){}if(u(e,t))return s(!i(o.f,e,t),e[t])}},7994:function(e,t,n){"use strict";var r=n(8794),i=n(8869).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},9612:function(e,t){"use strict";t.f=Object.getOwnPropertySymbols},2654:function(e,t,n){"use strict";var r=n(4792),i=n(5277),o=n(744),s=n(466),a=n(5115),c=s("IE_PROTO"),u=Object,p=u.prototype;e.exports=a?u.getPrototypeOf:function(e){var t=o(e);if(r(t,c))return t[c];var n=t.constructor;return i(n)&&t instanceof n?n.prototype:t instanceof u?p:null}},2010:function(e,t,n){"use strict";var r=n(8697);e.exports=r({}.isPrototypeOf)},8794:function(e,t,n){"use strict";var r=n(8697),i=n(4792),o=n(9580),s=n(7190).indexOf,a=n(7505),c=r([].push);e.exports=function(e,t){var n,r=o(e),u=0,p=[];for(n in r)!i(a,n)&&i(r,n)&&c(p,n);for(;t.length>u;)i(r,n=t[u++])&&(~s(p,n)||c(p,n));return p}},667:function(e,t,n){"use strict";var r=n(8794),i=n(8869);e.exports=Object.keys||function(e){return r(e,i)}},1513:function(e,t){"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,i=r&&!n.call({1:2},1);t.f=i?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},2412:function(e,t,n){"use strict";var r=n(2575),i=n(3875),o=n(5017);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=r(Object.prototype,"__proto__","set"))(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return i(n),o(r),t?e(n,r):n.__proto__=r,n}}():void 0)},7141:function(e,t,n){"use strict";var r=n(9611),i=n(5277),o=n(2786),s=TypeError;e.exports=function(e,t){var n,a;if("string"===t&&i(n=e.toString)&&!o(a=r(n,e)))return a;if(i(n=e.valueOf)&&!o(a=r(n,e)))return a;if("string"!==t&&i(n=e.toString)&&!o(a=r(n,e)))return a;throw new s("Can't convert object to primitive value")}},1561:function(e,t,n){"use strict";var r=n(2773),i=n(8697),o=n(7994),s=n(9612),a=n(3875),c=i([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=o.f(a(e)),n=s.f;return n?c(t,n(e)):t}},6411:function(e,t,n){"use strict";var r=n(9903),i=TypeError;e.exports=function(e){if(r(e))throw new i("Can't call method on "+e);return e}},878:function(e,t,n){"use strict";var r=n(6385).f,i=n(4792),o=n(2280)("toStringTag");e.exports=function(e,t,n){e&&!n&&(e=e.prototype),e&&!i(e,o)&&r(e,o,{configurable:!0,value:t})}},466:function(e,t,n){"use strict";var r=n(3580),i=n(4524),o=r("keys");e.exports=function(e){return o[e]||(o[e]=i(e))}},9415:function(e,t,n){"use strict";var r=n(8363),i=n(2359),o="__core-js_shared__",s=r[o]||i(o,{});e.exports=s},3580:function(e,t,n){"use strict";var r=n(1178),i=n(9415);(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.33.0",mode:r?"pure":"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.33.0/LICENSE",source:"https://github.com/zloirock/core-js"})},746:function(e,t,n){"use strict";var r=n(1197),i=n(9044),o=n(8363).String;e.exports=!!Object.getOwnPropertySymbols&&!i((function(){var e=Symbol("symbol detection");return!o(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},2565:function(e,t,n){"use strict";var r=n(4229),i=Math.max,o=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):o(n,t)}},9580:function(e,t,n){"use strict";var r=n(8609),i=n(6411);e.exports=function(e){return r(i(e))}},4229:function(e,t,n){"use strict";var r=n(8300);e.exports=function(e){var t=+e;return t!=t||0===t?0:r(t)}},5108:function(e,t,n){"use strict";var r=n(4229),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},744:function(e,t,n){"use strict";var r=n(6411),i=Object;e.exports=function(e){return i(r(e))}},1893:function(e,t,n){"use strict";var r=n(9611),i=n(2786),o=n(6681),s=n(7219),a=n(7141),c=n(2280),u=TypeError,p=c("toPrimitive");e.exports=function(e,t){if(!i(e)||o(e))return e;var n,c=s(e,p);if(c){if(void 0===t&&(t="default"),n=r(c,e,t),!i(n)||o(n))return n;throw new u("Can't convert object to primitive value")}return void 0===t&&(t="number"),a(e,t)}},383:function(e,t,n){"use strict";var r=n(1893),i=n(6681);e.exports=function(e){var t=r(e,"string");return i(t)?t:t+""}},8768:function(e){"use strict";var t=String;e.exports=function(e){try{return t(e)}catch(e){return"Object"}}},4524:function(e,t,n){"use strict";var r=n(8697),i=0,o=Math.random(),s=r(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+s(++i+o,36)}},189:function(e,t,n){"use strict";var r=n(746);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},1010:function(e,t,n){"use strict";var r=n(7493),i=n(9044);e.exports=r&&i((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},2512:function(e,t,n){"use strict";var r=n(8363),i=n(5277),o=r.WeakMap;e.exports=i(o)&&/native code/.test(String(o))},2280:function(e,t,n){"use strict";var r=n(8363),i=n(3580),o=n(4792),s=n(4524),a=n(746),c=n(189),u=r.Symbol,p=i("wks"),f=c?u.for||u:u&&u.withoutSetter||s;e.exports=function(e){return o(p,e)||(p[e]=a&&o(u,e)?u[e]:f("Symbol."+e)),p[e]}},4883:function(e,t,n){"use strict";var r=n(9580),i=n(6677),o=n(4818),s=n(821),a=n(6385).f,c=n(8150),u=n(6145),p=n(1178),f=n(7493),l="Array Iterator",h=s.set,d=s.getterFor(l);e.exports=c(Array,"Array",(function(e,t){h(this,{type:l,target:r(e),index:0,kind:t})}),(function(){var e=d(this),t=e.target,n=e.kind,r=e.index++;if(!t||r>=t.length)return e.target=void 0,u(void 0,!0);switch(n){case"keys":return u(r,!1);case"values":return u(t[r],!1)}return u([r,t[r]],!1)}),"values");var _=o.Arguments=o.Array;if(i("keys"),i("values"),i("entries"),!p&&f&&"values"!==_.name)try{a(_,"name",{value:"values"})}catch(e){}},8995:function(e,t,n){"use strict";var r=n(8363),i=n(2848),o=n(9189),s=n(4883),a=n(5899),c=n(2280),u=c("iterator"),p=c("toStringTag"),f=s.values,l=function(e,t){if(e){if(e[u]!==f)try{a(e,u,f)}catch(t){e[u]=f}if(e[p]||a(e,p,t),i[t])for(var n in s)if(e[n]!==s[n])try{a(e,n,s[n])}catch(t){e[n]=s[n]}}};for(var h in i)l(r[h]&&r[h].prototype,h);l(o,"DOMTokenList")},1903:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2066);t.DEFAULT_TIME_GROW_FACTOR=2.718281828459045,t.DEFAULT_TIME_JITTER=.11962656472;var i=function(){function e(e,n,i,o){void 0===i&&(i=t.DEFAULT_TIME_GROW_FACTOR),void 0===o&&(o=t.DEFAULT_TIME_JITTER),this._initialTime=e,this._maxTime=n,this._growFactor=i,this._jitterFactor=o,r.assert(this._initialTime>0,"Initial delay must be positive"),r.assert(this._maxTime>0,"Delay upper bound must be positive"),r.assert(this._growFactor>=0,"Ratio must be non-negative"),r.assert(this._jitterFactor>=0,"Jitter factor must be non-negative"),this.reset()}return e.prototype.reset=function(){this._incrementCount=0,this._currentTime=Math.round(this._initialTime*(1+Math.random()*this._jitterFactor))},e.prototype.getTime=function(){return this._currentTime},e.prototype.getIncrementCount=function(){return this._incrementCount},e.prototype.calculateNext=function(){var e=this._currentTime*this._growFactor;return e>this._maxTime&&(e=this._maxTime),this._jitterFactor<1e-5?this._currentTime=e:this._currentTime=Math.round(Math.random()*e*this._jitterFactor+e),this._currentTime<this._initialTime&&(this._currentTime=this._initialTime),this._currentTime>this._maxTime&&(this._currentTime=this._maxTime),this._incrementCount++,this._currentTime},e.prototype.getTimeAndCalculateNext=function(){var e=this.getTime();return this.calculateNext(),e},e}();t.ExponentialTime=i},86:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(2066),o=n(9130),s=function(){function e(e){this._defaultOptions={excludeEndpointUrl:!1,withCredentials:!1,retries:0},this._endpointUrl=e}return e.prototype._performApiCall=function(e,t,n,s){var a=this;void 0===s&&(s={});var c=r(r({},this._defaultOptions),s);n&&(c.sendData=n),c.eTag&&(c.augmentHeaders||(c.augmentHeaders={}),c.augmentHeaders["If-None-Match"]=c.eTag),c.contentType||(c.contentType=i.isString(c.sendData)?"form":"json");var u=c.excludeEndpointUrl?e:this._endpointUrl+e;return new o.SimpleWebRequest(t,u,c,(function(){return a._getHeaders(c)}),(function(){return a._blockRequestUntil(c)})).start().then((function(e){return a._processSuccessResponse(e),e}))},e.prototype._getHeaders=function(e){return{}},e.prototype._blockRequestUntil=function(e){},e.prototype._processSuccessResponse=function(e){},e.prototype.performApiGet=function(e,t){return this.performApiGetDetailed(e,t).then((function(e){return e.body}))},e.prototype.performApiGetDetailed=function(e,t){return this._performApiCall(e,"GET",void 0,t)},e.prototype.performApiPost=function(e,t,n){return this.performApiPostDetailed(e,t,n).then((function(e){return e.body}))},e.prototype.performApiPostDetailed=function(e,t,n){return this._performApiCall(e,"POST",t,n)},e.prototype.performApiPatch=function(e,t,n){return this.performApiPatchDetailed(e,t,n).then((function(e){return e.body}))},e.prototype.performApiPatchDetailed=function(e,t,n){return this._performApiCall(e,"PATCH",t,n)},e.prototype.performApiPut=function(e,t,n){return this.performApiPutDetailed(e,t,n).then((function(e){return e.body}))},e.prototype.performApiPutDetailed=function(e,t,n){return this._performApiCall(e,"PUT",t,n)},e.prototype.performApiDelete=function(e,t,n){return this.performApiDeleteDetailed(e,t,n).then((function(e){return e.body}))},e.prototype.performApiDeleteDetailed=function(e,t,n){return this._performApiCall(e,"DELETE",t,n)},e}();t.GenericRestClient=s},9792:function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(1903)),r(n(86)),r(n(9130))},9130:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s,a,c=n(4540),u=n(2066),p=n(1903);function f(e){return!!e&&0===e.indexOf("application/json")}function l(e,t){return t.canceled||!t.statusCode||t.statusCode>=400&&t.statusCode<600?a.DoNotRetry:a.RetryCountedWithBackoff}!function(e){e[e.DontCare=0]="DontCare",e[e.Low=1]="Low",e[e.Normal=2]="Normal",e[e.High=3]="High",e[e.Critical=4]="Critical"}(s=t.WebRequestPriority||(t.WebRequestPriority={})),function(e){e[e.DoNotRetry=0]="DoNotRetry",e[e.RetryUncountedImmediately=1]="RetryUncountedImmediately",e[e.RetryUncountedWithBackoff=2]="RetryUncountedWithBackoff",e[e.RetryCountedWithBackoff=3]="RetryCountedWithBackoff",e[e.PauseUntilResumed=4]="PauseUntilResumed"}(a=t.ErrorHandlingType||(t.ErrorHandlingType={})),t.DefaultOptions={priority:s.Normal},t.SimpleWebRequestOptions={MaxSimultaneousRequests:5,HungRequestCleanupIntervalMs:1e4,setTimeout:function(e,t){return setTimeout(e,t)},clearTimeout:function(e){return clearTimeout(e)}},t.DefaultErrorHandler=l;var h,d=[],_=[],y=[],g=0,v=0,m=function(){function e(e,n,r,i,s){this._action=e,this._url=n,this.options=r,this._getHeaders=i,this._blockRequestUntil=s,this._aborted=!1,this._timedOut=!1,this._paused=!1,this._created=Date.now(),this._finishHandled=!1,this._retryExponentialTime=new p.ExponentialTime(1e3,3e5),this._options=o(o({},t.DefaultOptions),r)}return e.prototype.getPriority=function(){return this._options.priority||s.DontCare},e.checkQueueProcessing=function(){for(var e=function(){var e=d.shift();_.push(e),(e._blockRequestUntil&&e._blockRequestUntil()||c.Resolved()).finally((function(){u.remove(_,e)})).then((function(){y.length<t.SimpleWebRequestOptions.MaxSimultaneousRequests&&!e._aborted?(y.push(e),T._scheduleHungRequestCleanupIfNeeded(),e._fire()):e._enqueue()}),(function(t){e._respond("_blockRequestUntil rejected: "+t)}))};d.length>0&&y.length<t.SimpleWebRequestOptions.MaxSimultaneousRequests;)e()},e._scheduleHungRequestCleanupIfNeeded=function(){y.length>0&&void 0===h?h=t.SimpleWebRequestOptions.setTimeout(this._hungRequestCleanupTimerCallback,t.SimpleWebRequestOptions.HungRequestCleanupIntervalMs):0===y.length&&h&&(t.SimpleWebRequestOptions.clearTimeout(h),h=void 0)},e.prototype._removeFromQueue=function(){u.remove(y,this),u.remove(d,this)},e.prototype._assertAndClean=function(e,t){e||(this._removeFromQueue(),console.error(t),u.assert(e,t))},e.prototype._fire=function(){var n=this;this._xhr=new XMLHttpRequest,this._xhrRequestHeaders={};var r=u.attempt((function(){n._xhr.open(n._action,n._url,!0)}));if(r)this._respond(r.toString());else{if(this._options.timeout){var i=v;3!==i&&(this._assertAndClean(!this._requestTimeoutTimer,"Double-fired requestTimeoutTimer"),this._requestTimeoutTimer=t.SimpleWebRequestOptions.setTimeout((function(){n._requestTimeoutTimer=void 0,n._timedOut=!0,n.abort()}),this._options.timeout)),(3===i||i<=1)&&(this._xhr.timeout=this._options.timeout,this._xhr.ontimeout=function(){v=3,3===i&&(n._timedOut=!0,n._aborted=!0,n._respond("TimedOut"))})}var o=g;3!==o?(0===o&&(g=1),this._xhr.onreadystatechange=function(){n._xhr&&(3!==n._xhr.readyState||!n._options.streamingDownloadProgress||n._aborted?4===n._xhr.readyState&&(0===o&&1===g&&t.SimpleWebRequestOptions.setTimeout((function(){3!==g&&(g=2)}),1e4),n._respond()):n._options.streamingDownloadProgress(n._xhr.responseText))}):this._options.streamingDownloadProgress&&(this._xhr.onreadystatechange=function(){n._xhr&&3===n._xhr.readyState&&n._options.streamingDownloadProgress&&!n._aborted&&n._options.streamingDownloadProgress(n._xhr.responseText)}),2!==o&&(this._xhr.onload=function(){g=3,3===o&&n._respond()},this._xhr.onerror=function(){g=3,3===o&&n._respond()}),this._xhr.onabort=function(){n._aborted=!0,n._respond("Aborted")},this._xhr.upload&&this._options.onProgress&&(this._xhr.upload.onprogress=this._options.onProgress);var s=this._options.acceptType||"json",a=this._options.customResponseType||e._getResponseType(s),c=u.attempt((function(){n._xhr.responseType=a}));if(c&&"json"!==a)throw c;T._setRequestHeader(this._xhr,this._xhrRequestHeaders,"Accept",e.mapContentType(s)),this._xhr.withCredentials=!!this._options.withCredentials;var p=this.getRequestHeaders(),f={};if(Object.keys(p).forEach((function(e){var t=p[e],r=e.toLowerCase();"content-type"!==r?"accept"!==r?(n._assertAndClean(!f[r],"Setting duplicate header key: "+f[r]+" and "+e),null!=t?(f[r]=!0,T._setRequestHeader(n._xhr,n._xhrRequestHeaders,e,t)):console.warn('Tried to set header "'+e+'" on request with "'+t+'" value, header will be dropped')):n._assertAndClean(!1,"Don't set Accept with options.headers -- use it with the options.acceptType property"):n._assertAndClean(!1,"Don't set Content-Type with options.headers -- use it with the options.contentType property")})),this._options.sendData){var l=e.mapContentType(this._options.contentType||"json");T._setRequestHeader(this._xhr,this._xhrRequestHeaders,"Content-Type",l);var h=e.mapBody(this._options.sendData,l);this._xhr.send(h)}else this._xhr.send()}},e._setRequestHeader=function(e,t,n,r){e.setRequestHeader(n,r),t[n]=r},e.mapContentType=function(e){return"json"===e?"application/json":"form"===e?"application/x-www-form-urlencoded":e},e.mapBody=function(e,t){if(f(t)){if(!u.isString(e))return JSON.stringify(e)}else if((o=t)&&0===o.indexOf("application/x-www-form-urlencoded")){if(!u.isString(e)&&u.isObject(e)){var n=e;return Object.keys(n).map((function(e){return encodeURIComponent(e)+(n[e]?"="+encodeURIComponent(n[e].toString()):"")})).join("&")}}else if(function(e){return!!e&&0===e.indexOf("multipart/form-data")}(t)){if(u.isObject(e)){var r=new FormData,i=e;return Object.keys(i).forEach((function(e){return r.append(e,i[e])})),r}u.assert(!1,"contentType multipart/form-data must include an object as sendData")}var o;return e},e.prototype.setUrl=function(e){this._url=e},e.prototype.setHeader=function(e,t){this._options.augmentHeaders||(this._options.augmentHeaders={}),t?this._options.augmentHeaders[e]=t:delete this._options.augmentHeaders[e]},e.prototype.getRequestHeaders=function(){var e={};return!this._getHeaders||this._options.overrideGetHeaders||this._options.headers||(e=o(o({},e),this._getHeaders())),this._options.overrideGetHeaders&&(e=o(o({},e),this._options.overrideGetHeaders)),this._options.headers&&(e=o(o({},e),this._options.headers)),this._options.augmentHeaders&&(e=o(o({},e),this._options.augmentHeaders)),e},e.prototype.getOptions=function(){return u.clone(this._options)},e.prototype.setPriority=function(e){this._options.priority!==e&&(this._options.priority=e,this._paused||this._xhr||(u.remove(d,this),this._enqueue()))},e.prototype.resumeRetrying=function(){this._paused?(this._paused=!1,this._enqueue()):u.assert(!1,"resumeRetrying() called but not paused!")},e.prototype._enqueue=function(){var t=this;if(!this._aborted&&!(y.indexOf(this)>=0||_.indexOf(this)>=0||d.indexOf(this)>=0)){var n=d.findIndex((function(e){return e.getPriority()===t.getPriority()&&e._created>t._created||e.getPriority()<t.getPriority()}));n>-1?d.splice(n,0,this):d.push(this),e.checkQueueProcessing()}},e._getResponseType=function(e){return"blob"===e?"arraybuffer":"text/xml"===e||"application/xml"===e?"document":"text/plain"===e?"text":"json"},e._hungRequestCleanupTimerCallback=function(){h=void 0,y.filter((function(e){return!(!e._xhr||4!==e._xhr.readyState||(console.warn("SimpleWebRequests found a completed XHR that hasn't invoked it's callback functions, manually responding"),0))})).forEach((function(e){e._respond()})),T._scheduleHungRequestCleanupIfNeeded()},e}();t.SimpleWebRequestBase=m;var T=function(e){function n(t,n,r,i,o){return e.call(this,t,n,r,i,o)||this}return i(n,e),n.prototype.abort=function(){this._aborted?u.assert(!1,"Already aborted "+this._action+" request to "+this._url):(this._aborted=!0,this._retryTimer&&(t.SimpleWebRequestOptions.clearTimeout(this._retryTimer),this._retryTimer=void 0),this._requestTimeoutTimer&&(t.SimpleWebRequestOptions.clearTimeout(this._requestTimeoutTimer),this._requestTimeoutTimer=void 0),this._deferred?(this._respond("Aborted"),this._xhr&&this._xhr.abort()):u.assert(!1,"Haven't even fired start() yet -- can't abort"))},n.prototype.start=function(){var e=this;return this._deferred?(u.assert(!1,"WebRequest already started"),c.Rejected("WebRequest already started")):(this._deferred=c.Defer(),this._deferred.onCancel((function(){e.abort()})),this._enqueue(),this._deferred.promise())},n.prototype._respond=function(e){var n=this;if(!this._finishHandled){this._finishHandled=!0,this._removeFromQueue(),this._retryTimer&&(t.SimpleWebRequestOptions.clearTimeout(this._retryTimer),this._retryTimer=void 0),this._requestTimeoutTimer&&(t.SimpleWebRequestOptions.clearTimeout(this._requestTimeoutTimer),this._requestTimeoutTimer=void 0);var r,i=0;if(this._xhr)try{i=this._xhr.status,r=this._xhr.statusText||e}catch(e){}else r=e||"Browser Error - Possible CORS or Connectivity Issue";var o,s,c={};if(this._xhr){if((this._xhr.getAllResponseHeaders()||"").split(/\r?\n/).forEach((function(e){if(0!==e.length){var t=e.indexOf(":");-1===t?c[e]="":c[e.substr(0,t).toLowerCase()]=e.substr(t+1).trim()}})),!c["content-type"]){var p=this._xhr.getResponseHeader("content-type");p&&(c["content-type"]=p)}if(o=this._xhr.response,c["content-type"]&&f(c["content-type"])&&(!o||!u.isObject(o))&&("text"===this._xhr.responseType||""===this._xhr.responseType)&&this._xhr.responseText)try{o=JSON.parse(this._xhr.responseText)}catch(e){s=e,console.warn("Failed to parse XHR JSON response")}}if(this._xhr&&4===this._xhr.readyState&&(i>=200&&i<300||304===i)){var h={url:this._xhr.responseURL||this._url,method:this._action,requestOptions:this._options,requestHeaders:this._xhrRequestHeaders||{},statusCode:i,statusText:r,headers:c,body:o,responseParsingException:s};this._deferred.resolve(h)}else{var d={url:(this._xhr?this._xhr.responseURL:void 0)||this._url,method:this._action,requestOptions:this._options,requestHeaders:this._xhrRequestHeaders||{},statusCode:i,statusText:r,headers:c,body:o,canceled:this._aborted,timedOut:this._timedOut,responseParsingException:s};this._options.augmentErrorResponse&&this._options.augmentErrorResponse(d);var _=this._options.customErrorHandler?this._options.customErrorHandler(this,d):l(0,d);_!==a.DoNotRetry&&(this._options.retries&&this._options.retries>0||_===a.PauseUntilResumed||_===a.RetryUncountedImmediately||_===a.RetryUncountedWithBackoff)?(_===a.RetryCountedWithBackoff&&this._options.retries--,this._requestTimeoutTimer&&(t.SimpleWebRequestOptions.clearTimeout(this._requestTimeoutTimer),this._requestTimeoutTimer=void 0),this._aborted=!1,this._timedOut=!1,this._finishHandled=!1,this._xhr&&(this._xhr.onabort=null,this._xhr.onerror=null,this._xhr.onload=null,this._xhr.onprogress=null,this._xhr.onreadystatechange=null,this._xhr.ontimeout=null,this._xhr=void 0,this._xhrRequestHeaders=void 0),_===a.PauseUntilResumed?this._paused=!0:_===a.RetryUncountedImmediately?this._enqueue():this._retryTimer=t.SimpleWebRequestOptions.setTimeout((function(){n._retryTimer=void 0,n._enqueue()}),this._retryExponentialTime.getTimeAndCalculateNext())):this._deferred.reject(d)}m.checkQueueProcessing()}},n}(m);t.SimpleWebRequest=T},2066:function(e,t){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.assert=function(e,t){if(!e)throw new Error(t)},t.isObject=function(e){return null!==e&&"object"==typeof e},t.isString=function(e){return"string"==typeof e},t.attempt=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];try{return e.apply(void 0,t)}catch(e){return new Error(e)}},t.remove=function(e,t){for(var n=e.length-1;n>=0;n--)e[n]===t&&e.splice(n,1)},t.clone=function(e){return Array.isArray(e)?e.map(t.clone):t.isObject(e)?Object.keys(e).reduce((function(r,i){var o;return n(n({},r),((o={})[i]=t.clone(e[i]),o))}),{}):e}},3221:function(e,t,n){e.exports=n(9792)},7987:function(e,t,n){"use strict";n.r(t),n.d(t,{SubscriptionToken:function(){return r}});var r=function(){function e(e,t){this._event=e,this._callback=t}return e.prototype.unsubscribe=function(){this._event.unsubscribe(this._callback)},e}(),i=function(){function e(e){void 0===e&&(e=!1);var t=this;this._allowStopPropagation=e,this.fire=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(var r=t._subscribers,i=r.length-1;i>=0;i--){var o=r[i].apply(null,e);if(t._allowStopPropagation&&o)return!0}return!1},this._subscribers=[]}return e.prototype.dispose=function(){this._subscribers=[]},e.prototype.subscribe=function(e){return this._subscribers=this._subscribers.concat(e),new r(this,e)},e.prototype.unsubscribe=function(e){this._subscribers=this._subscribers.filter((function(t){return t!==e}))},e}();t.default=i},4540:function(e,t){"use strict";function n(e){return null!=e&&"function"==typeof e.then}function r(e){return null!=e&&"function"==typeof e.cancel}function i(e,n){if(!t.config.catchExceptions)return e();try{return e()}catch(e){return n(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.config={exceptionsToConsole:!0,catchExceptions:!0,traceEnabled:!1,exceptionHandler:void 0,unhandledErrorHandler:function(e){throw e}},t.fromThenable=function(e){var t=p();return e.then((function(e){t.resolve(e)}),(function(e){t.reject(e)})),t.promise().thenAsync((function(e){return e}))};var o,s=[],a="undefined"!=typeof setImmediate;function c(e){s.push(e),1===s.length&&(a?setImmediate(u):setTimeout(u,0))}function u(){var e=s;s=[];for(var t=0;t<e.length;t++)e[t]()}function p(){return new o.SyncTask}function f(e){return(new o.SyncTask).resolve(e).promise()}function l(e){var t=p(),i=!1;return t.onCancel((function(t){e.forEach((function(e){r(e)&&o.SyncTask.cancelOtherInternal(e,t)}))})),e.forEach((function(e){n(e)?e.then((function(e){i||(i=!0,t.resolve(e))}),(function(e){i||(i=!0,t.reject(e))})):i||(i=!0,t.resolve(e))})),t.promise()}t.asyncCallback=c,function(e){var o=function(){function e(){this._completedSuccess=!1,this._completedFail=!1,this._traceEnabled=!1,this._cancelCallbacks=[],this._wasCanceled=!1,this._wasExplicitlyCanceled=!1,this._resolving=!1,this._storedCallbackSets=[],this._mustHandleError=!0}return e.prototype._addCallbackSet=function(t,n){var r=this,i=new e;return i.onCancel((function(e){t.wasCanceled=!0,t.cancelContext=e,r._cancelInternal(e)})),t.task=i,this._storedCallbackSets.push(t),n?this._mustHandleError=!1:i._mustHandleError=!1,this._resolving||(this._completedSuccess?this._resolveSuccesses():this._completedFail&&this._resolveFailures()),i.promise()},e.prototype.onCancel=function(e){return this._completedSuccess||this._completedFail||(this._wasCanceled?e(this._cancelContext):this._cancelCallbacks.push(e)),this},e.prototype.then=function(e,t){return this._addCallbackSet({successFunc:e,failFunc:t},!0)},e.prototype.thenAsync=function(e,t){return this._addCallbackSet({successFunc:e,failFunc:t,asyncCallback:!0},!0)},e.prototype.catch=function(e){return this._addCallbackSet({failFunc:e},!0)},e.prototype.always=function(e){return this._addCallbackSet({successFunc:e,failFunc:e},!0)},e.prototype.setTracingEnabled=function(e){return this._traceEnabled=e,this},e.prototype.finally=function(e){return this._addCallbackSet({successFunc:e,failFunc:e},!1),this},e.prototype.done=function(e){return this._addCallbackSet({successFunc:e},!1),this},e.prototype.fail=function(e){return this._addCallbackSet({failFunc:e},!1),this},e.prototype.resolve=function(e){return this._checkState(!0),this._completedSuccess=!0,this._storedResolution=e,this._cancelCallbacks=[],this._resolveSuccesses(),this},e.prototype.reject=function(t){return this._checkState(!1),this._completedFail=!0,this._storedErrResolution=t,this._cancelCallbacks=[],this._resolveFailures(),e._enforceErrorHandled(this),this},e.prototype._checkState=function(e){if(this._completedSuccess||this._completedFail){this._completeStack&&console.error(this._completeStack.message,this._completeStack.stack);var n="Failed to "+(e?"resolve":"reject")+": the task is already "+(this._completedSuccess?"resolved":"rejected");throw new Error(n)}(t.config.traceEnabled||this._traceEnabled)&&(this._completeStack=new Error("resolve"))},e._enforceErrorHandled=function(n){n._mustHandleError&&(e._rejectedTasks.push(n),e._enforceErrorHandledTimer||(e._enforceErrorHandledTimer=setTimeout((function(){e._enforceErrorHandledTimer=void 0;var n=e._rejectedTasks;e._rejectedTasks=[],n.forEach((function(e,n){e._mustHandleError&&t.config.unhandledErrorHandler(e._storedErrResolution)}))}),0)))},e.prototype.cancel=function(e){if(this._wasExplicitlyCanceled)throw new Error("Already Canceled");this._wasExplicitlyCanceled=!0,this._cancelInternal(e)},e.prototype._cancelInternal=function(e){var t=this;if(!this._wasCanceled){this._wasCanceled=!0,this._cancelContext=e;var n=this._cancelCallbacks;this._cancelCallbacks=[],n.length>0&&n.forEach((function(e){t._completedSuccess||t._completedFail||e(t._cancelContext)}))}},e.cancelOtherInternal=function(e,t){var n=e;n._storedCallbackSets&&n._cancelInternal?n._cancelInternal(t):e.cancel(t)},e.prototype.promise=function(){return this},e.prototype._resolveSuccesses=function(){var e=this;for(this._resolving=!0;this._storedCallbackSets.length;){var t=this._storedCallbackSets;this._storedCallbackSets=[],t.forEach((function(t){t.asyncCallback?c((function(){return e._resolveSuccessCallback(t)})):e._resolveSuccessCallback(t)}))}this._resolving=!1},e.prototype._resolveSuccessCallback=function(t){var o=this;t.successFunc?i((function(){var i=t.successFunc(o._storedResolution);r(i)&&(t.wasCanceled?e.cancelOtherInternal(i,t.cancelContext):t.task.onCancel((function(t){return e.cancelOtherInternal(i,t)}))),n(i)?i.then((function(e){t.task.resolve(e)}),(function(e){t.task.reject(e)})):t.task.resolve(i)}),(function(e){o._handleException(e,"SyncTask caught exception in success block: "+e.toString()),t.task.reject(e)})):t.task.resolve(this._storedResolution)},e.prototype._resolveFailures=function(){var e=this;for(this._resolving=!0;this._storedCallbackSets.length;){var t=this._storedCallbackSets;this._storedCallbackSets=[],t.forEach((function(t){t.asyncCallback?c((function(){return e._resolveFailureCallback(t)})):e._resolveFailureCallback(t)}))}this._resolving=!1},e.prototype._resolveFailureCallback=function(t){var o=this;t.failFunc?i((function(){var i=t.failFunc(o._storedErrResolution);r(i)&&(t.wasCanceled?e.cancelOtherInternal(i,t.cancelContext):t.task.onCancel((function(t){return e.cancelOtherInternal(i,t)}))),n(i)?i.then((function(e){t.task.resolve(e)}),(function(e){t.task.reject(e)})):t.task.resolve(i)}),(function(e){o._handleException(e,"SyncTask caught exception in failure block: "+e.toString()),t.task.reject(e)})):t.task.reject(this._storedErrResolution)},e.prototype._handleException=function(e,n){t.config.exceptionsToConsole&&console.error(n),t.config.exceptionHandler&&t.config.exceptionHandler(e)},e.prototype.toEs6Promise=function(){var e=this;return new Promise((function(t,n){return e.then(t,n)}))},e._rejectedTasks=[],e}();e.SyncTask=o}(o||(o={})),t.all=function(e){if(0===e.length)return f([]);var t,i=p(),s=e.length,a=Array(e.length);i.onCancel((function(t){e.forEach((function(e){r(e)&&o.SyncTask.cancelOtherInternal(e,t)}))}));var c=function(){0==--s&&(void 0!==t?i.reject(t):i.resolve(a))};return e.forEach((function(e,r){n(e)?e.then((function(e){a[r]=e,c()}),(function(e){void 0===t&&(t=void 0===e||e),c()})):(a[r]=e,c())})),i.promise()},t.Defer=p,t.Resolved=f,t.Rejected=function(e){return(new o.SyncTask).reject(e).promise()},t.race=l,t.raceTimer=function(e,t){var n=p(),r=setTimeout((function(){n.resolve({timedOut:!0})}),t);return l([e.then((function(e){return clearTimeout(r),{timedOut:!1,result:e}})),n.promise()])}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};return function(){"use strict";n.r(r),n.d(r,{Client:function(){return p},StorageProvider:function(){return s},default:function(){return p}}),n(8995);var e=n(7222),t=n(4540),i=n(7987),o=n(945);class s{constructor(e){this.hostStorageProvider=e}put(t){return this.hostStorageProvider.write(e.FloodgateStorageProviderFileType.DynamicCampaignDefinitions,JSON.stringify(t)),Promise.resolve()}pull(){let t;try{t=JSON.parse(this.hostStorageProvider.read(e.FloodgateStorageProviderFileType.DynamicCampaignDefinitions))}catch(e){t={}}return new Promise((e=>e(t)))}putData(e,n){return this.put(n),t.Resolved()}getData(e){return t.fromThenable(this.pull())}}const a=new Map;a.set("disableexperiments","true"),a.set("disablerollouts","false");var c={host:"https://config.edge.skype.com",clientName:"CHILL",clientVersion:"0.0.12",timeout:6e4,allowBackgroundFetch:!0,filters:a};let u;!function(e){e.EcsClientStartFailed="FloodgateCore_ECSClient_Start_Failed"}(u||(u={}));class p{constructor(n){var r,a;let u;if(this.telemetryEvents=new i.default,null==n.localStorageProvider)throw new Error("[Dynamic Campaign] - The Storage provider is not defined but it is a required field.");u=new s(n.localStorageProvider),n.filters=new Map([...Array.from(c.filters.entries()),...Array.from(null!==(r=null===(a=n.filters)||void 0===a?void 0:a.entries())&&void 0!==r?r:[])]),n.appName&&n.filters.set("Application",n.appName),n.appVersion&&n.filters.set("version",n.appVersion),n.language&&n.filters.set("language",n.language),n.filters.has("agents")&&(n.filters.has("agent")||n.filters.set("agent",n.filters.get("agents")),n.filters.delete("agents"));const p={...c,...n};this._skypeClientConfig={hosts:[p.host],clientName:p.clientName,clientVersion:p.clientVersion,configsToFetch:[e.EcsConfigType.Default],initialAppActiveState:!0,fetchTimeout:p.timeout,getEcsParameters:()=>{const e={};for(const t of p.filters.keys())e[t]=p.filters.get(t);return t.Resolved(e)},databaseInterface:u,fetchAttemptMax:n.fetchAttemptMax||10},this.ecsClient=new o.ZP,this.ecsClient.setAllowBackgroundFetch(p.allowBackgroundFetch),[].findIndex((e=>void 0===e))}async start(){try{this.ecsClient.telemetryEventAdded.subscribe(((e,t)=>{this.telemetryEvents.fire(e,t)})),await this.ecsClient.initialize(this._skypeClientConfig).toEs6Promise()}catch(e){this.telemetryEvents.fire(u.EcsClientStartFailed,{ErrorMessage:e})}}getConfig(){return this.ecsClient.getConfig()}queueManualRefresh(){this.ecsClient.requestUpdate()}pause(){this.ecsClient.pause()}resume(){this.ecsClient.resume()}}}(),r}()}));
//# sourceMappingURL=floodgate_ecs_client_es5.min.js.map