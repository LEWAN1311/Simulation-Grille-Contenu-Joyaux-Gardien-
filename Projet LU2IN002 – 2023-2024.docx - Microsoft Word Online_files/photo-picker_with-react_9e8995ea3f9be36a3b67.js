(window.webpackJsonpLpc=window.webpackJsonpLpc||[]).push([[245],{1647:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var o=n(1),a=n(3),i=n(82),r=function(t){function e(e){var n=t.call(this,e)||this;return n.state={isRendered:void 0===Object(i.a)()},n}return Object(o.__extends)(e,t),e.prototype.componentDidMount=function(){var t=this,e=this.props.delay;this._timeoutId=window.setTimeout((function(){t.setState({isRendered:!0})}),e)},e.prototype.componentWillUnmount=function(){this._timeoutId&&clearTimeout(this._timeoutId)},e.prototype.render=function(){return this.state.isRendered?a.Children.only(this.props.children):null},e.defaultProps={delay:0},e}(a.Component)},2037:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var o=n(1411),a=n(3),i=n(2),r=n(32),l=(Object(i.declareStringWithPlaceholders)("accessibility-utils-ui.accessibility-utils.positionInSet"));function s(t){var e=t.posInSet,n=t.setSize,i=t.onRenderDescribedElement,s=function(t,e){return Object(r.b)(l,{pos:t.toString(),size:e.toString()})}(e,n),c=Object(o.a)();return a.createElement(a.Fragment,null,a.createElement("div",{id:c,hidden:!0},s),i(c))}},2889:function(t,e,n){"use strict";n.r(e),n.d(e,"StandalonePhotoPicker",(function(){return Ye})),n.d(e,"PhotoPicker",(function(){return Te})),n.d(e,"PhotoPickerStore",(function(){return pt})),n.d(e,"initIcons",(function(){return _e}));var o=n(364),a=n.n(o),i=n(427),r=n.n(i),l=n(5),s=n.n(l),c=n(981),u=n(490),p=n(1280),d=n(3),m=n(70),g=n(69),h=n.n(g),f=n(51),b=n.n(f),v=n(133);function S(t,e){try{return e?t.toDataURL():t.toDataURL("image/jpeg")}catch(t){return console.error(t),""}}var y={1:[1,0,0,1,0,0],2:[-1,0,0,1,0,0],3:[-1,0,0,-1,0,0],4:[1,0,0,-1,0,0],5:[0,1,1,0,0,0],6:[0,1,-1,0,0,0],7:[0,-1,-1,0,0,0],8:[0,-1,1,0,0,0]},P=function(t){return t*Math.PI/180};function I(t,e,n,o,a,i){t.save(),t.translate(e/2,e/2),t.transform.apply(t,y[o]),t.rotate(P(n)),t.translate(-e/2,-e/2),i(t,a),t.restore()}function E(t,e,n,o){var a=P(o),i=y[n],r=i[0],l=i[2];return{x:(e=(t=(t-=128)*r+(e-=128)*i[1])*l+e*i[3])*Math.sin(a)+t*Math.cos(a)+128,y:e*Math.cos(a)-t*Math.sin(a)+128}}function C(t,e,n){return Math.min(n,Math.max(t,e))}var x=n(4);function O(t,e){void 0===e&&(e=null);var n="".concat("PhotoPicker").concat(t,"Action");return Object(x.a)(n,{featureName:"PhotoPicker",exportOptions:e?{exportType:"UserInteraction",exportName:e}:void 0})}var U=O("UploadedPhotoTooSmall"),R=O("CancelButtonClicked","PhotoPickerCancelButtonClicked"),w=O("CloseButtonClicked","PhotoPickerCloseButtonClickedAction"),A=O("DoneButtonClicked","PhotoPickerDoneButtonClickedAction"),k=O("UploadNewPhotoButtonClicked","PhotoPickerUploadNewPhotoButtonClickedAction"),L=O("ImageEditPaneDismissed","PhotoPickerImageEditPaneDismissed"),j=O("ImageUpdated"),N=O("LoadedCurrentImage"),D=O("LoadedEmptyImage"),B=O("LoadedNewImage"),T=O("SomethingWentWrong"),M=O("UploadStarted","PhotoPickerApplyButtonClicked"),_=O("UploadProgress"),z=O("UploadSucceeded"),W=O("WarningDismissed"),F=O("Keyboard"),H=O("ImageRotate"),G=O("Zoom"),Y=O("ImageLoaded"),K=O("DragStarted"),X=O("DragProgress"),Z=O("ResetEditCanvas"),V=O("EmptyImageRendered"),q=O("SetImageUpdated"),J=O("PhotoListImageSelected"),Q=O("NewImageUploaded"),$=O("PhotoListLoadPhotos");var tt=n(43),et=n.n(tt),nt=n(130),ot=n(10),at=n(48),it=n(47),rt=function(){return(rt=s.a||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},lt=function(t,e,n){if(n||2===arguments.length)for(var o,a=0,i=e.length;a<i;a++)!o&&a in e||(o||(o=Array.prototype.slice.call(e,0,a)),o[a]=e[a]);return t.concat(o||Array.prototype.slice.call(e))},st={xpos:0,ypos:0,absoluteScale:1,relativeScale:0,stepSize:.1,imageRotationAngle:0,orientation:1,maximumScale:1,naturalMin:0,naturalWidth:0,naturalHeight:0,moving:!1,lastMouseX:0,lastMouseY:0,zoomInDisabled:!0,zoomOutDisabled:!0,image:void 0,initialRender:!0,imageUpdated:!0},ct={photoPicker:{dataUrl:void 0,currentImageDataUrl:void 0,status:"READY",warning:void 0,show:!1,isUpdated:!1,uploadStart:0,uploadDuration:0,isUploadedPhotoTooSmall:!1},editCanvas:rt(rt({},st),{originalCanvasState:st}),photoList:{selectedIndex:0,imageUrls:[]}},ut=Object(m.combineReducers)({photoPicker:Object(at.a)().handleAction(R,dt).handleAction(w,dt).handleAction(A,dt).handleAction(L,dt).handleAction(W,(function(t){return Object(ot.j)(t,{status:"READY",warning:void 0})})).handleAction(N,(function(t,e){var n=e.payload.dataUrl;return Object(ot.j)(t,{dataUrl:t.dataUrl||n,currentImageDataUrl:t.currentImageDataUrl||n,isUpdated:!!e.payload.isSuggestedPhoto||!!e.payload.isPhotoListPresent})})).handleAction(B,(function(t,e){return Object(ot.j)(t,{dataUrl:e.payload.dataUrl,status:"READY",warning:void 0,isUpdated:e.payload.dataUrl!==t.currentImageDataUrl||!!e.payload.isPhotoListPresent,fileName:e.payload.fileName})})).handleAction(D,(function(t,e){return Object(ot.j)(t,{dataUrl:"",status:"READY",warning:void 0,isUpdated:!!t.currentImageDataUrl||!!e.payload.isPhotoListPresent,fileName:void 0})})).handleAction(M,(function(t,e){return Object(ot.j)(t,{status:"IN_PROGRESS",warning:void 0,uploadStart:e.payload.now,uploadDuration:0})})).handleAction(_,(function(t,e){return"IN_PROGRESS"===t.status?Object(ot.j)(t,{uploadDuration:e.payload.now-t.uploadStart}):t})).handleAction(z,(function(t,e){return Object(ot.j)(t,{currentImageDataUrl:e.payload.dataUrl,status:"SUCCESS",warning:void 0})})).handleAction(T,(function(t,e){return Object(ot.j)(t,{status:"SOMETHING_WENT_WRONG",warning:e.payload.warning})})).handleAction(j,(function(t){return Object(ot.j)(t,{isUpdated:!0})})).handleAction(U,(function(t,e){return Object(ot.j)(t,e.payload)})).done(ct.photoPicker),editCanvas:Object(at.a)().handleAction(Z,mt).handleAction(F,(function(t,e){return Object(ot.j)(t,e.payload)})).handleAction(G,(function(t,e){return Object(ot.j)(t,e.payload)})).handleAction(Y,(function(t,e){return Object(ot.j)(t,rt(rt({},e.payload),{originalCanvasState:t.originalCanvasState.initialRender?Object(ot.j)(t.originalCanvasState,e.payload):t.originalCanvasState}))})).handleAction(K,(function(t,e){return Object(ot.j)(t,e.payload)})).handleAction(X,(function(t,e){return Object(ot.j)(t,e.payload)})).handleAction(q,(function(t){return Object(ot.j)(t,{imageUpdated:!0})})).handleAction(V,(function(t){return Object(ot.j)(t,{initialRender:!1})})).handleAction(R,mt).handleAction(w,mt).handleAction(A,mt).handleAction(L,mt).handleAction(H,(function(t,e){return Object(ot.j)(t,e.payload)})).done(ct.editCanvas),photoList:Object(at.a)().handleAction(J,(function(t,e){return Object(ot.j)(t,e.payload)})).handleAction(D,(function(t){return Object(ot.j)(t,{selectedIndex:-1})})).handleAction(Q,(function(t,e){return Object(ot.j)(t,{selectedIndex:e.payload.selectedIndex,imageUrls:lt([e.payload.newImageUrl],t.imageUrls,!0)})})).handleAction($,(function(t,e){return Object(ot.j)(t,e.payload)})).handleAction(R,gt).handleAction(w,gt).handleAction(A,gt).handleAction(L,gt).done(ct.photoList)}),pt=Object(it.a)("PhotoPickerStore",ut,(function(t){return{getPhotoPickerState:function(){return t.photoPicker},getEditCanvasState:function(){return t.editCanvas},getPhotoListState:function(){return t.photoList}}}));function dt(t){return Object(ot.j)(t,{dataUrl:void 0,currentImageDataUrl:void 0,status:"READY",warning:void 0,isUpdated:!1,fileName:void 0})}function mt(t){return Object(ot.j)(t,ct.editCanvas)}function gt(t){return Object(ot.j)(t,ct.photoList)}var ht=["absoluteScale","imageRotationAngle","xpos","ypos"],ft=n(2289),bt=n(883),vt=n(1305),St=n(2567),yt=n(2034),Pt=n(120),It=n(14),Et=Object(Pt.c)((function(){return Object(It.db)({closeButton:{float:"right",marginTop:-20,marginRight:-20},removeButton:{marginLeft:"auto"}})})),Ct=function(t){var e=t.onClick,n=t.dataLogName,o=t.ariaLabel,a=t.title,i=Et();switch(t.buttonType){case"Primary":return d.createElement(ft.a,{disabled:t.disabled,onClick:e,"data-log-name":n,ariaLabel:o,title:a,componentRef:t.buttonRef},t.buttonLabel);case"Action":return d.createElement(bt.a,{className:i.removeButton,iconProps:{iconName:t.iconName},onClick:e,"data-log-name":n,disabled:t.disabled,title:a},t.buttonLabel);case"Icon":return d.createElement(vt.a,{content:a,styles:{root:i.closeButton}},d.createElement(St.a,{iconProps:{iconName:t.iconName},onClick:e,"data-log-name":n,ariaLabel:o}));case"Default":return d.createElement(yt.a,{onClick:e,"data-log-name":n,ariaLabel:o,title:a},t.buttonLabel);default:return t}},xt=n(772),Ot=n(2080),Ut=n(2940),Rt=Object(Pt.c)((function(t,e){return Object(It.db)({root:Object(It.eb)({margin:"7px 0",color:t.palette.neutralPrimary},null==e?void 0:e.root),text:Object(It.eb)(t.fonts.medium,null==e?void 0:e.text)})})),wt=function(t){var e=Rt(Object(xt.a)(),t.styles),n="UNKNOWN"===t.warning,o="IMAGE_TOO_SMALL_ERROR"===t.warning,a=n||o?Ot.a.error:Ot.a.warning,i=n?void 0:t.onDismiss;return d.createElement(Ut.a,{className:e.root,messageBarType:a,onDismiss:i,isMultiline:!0,"aria-live":"polite",styles:e,dismissButtonAriaLabel:t.dismissButtonAriaLabel},t.warningText)},At=n(2714),kt=n(2936),Lt=Object(Pt.c)((function(t,e){var n=t.palette;return Object(It.db)({modal:Object(It.eb)({width:512,maxWidth:512,margin:0,selectors:{"#lpc-photo-picker .ms-Button-icon":{display:"inline-block",minWidth:16,padding:"0px 4px",backgroundColor:"transparent"},"#lpc-photo-picker .ms-Slider-slideBox:focus":{outline:"transparent"},"#lpc-photo-picker .ms-Button--icon &hover":{color:n.themePrimary},"#lpc-photo-picker .ms-Button--icon &active":{color:n.themeDarker},"#lpc-photo-picker .ms-Button--primary &:not([disabled])":{backgroundColor:n.themePrimary},"#lpc-photo-picker .ms-Button--primary &:hover":{backgroundColor:n.themeDarkAlt},"#lpc-photo-picker .ms-Button--primary &:active":{backgroundColor:n.themeDark},"#lpc-photo-picker .ms-Button--default .ms-Button-label":{color:n.neutralDark},"#lpc-photo-picker .ms-Button--default &:hover":{backgroundColor:n.neutralLight},"#lpc-photo-picker .ms-Button--default &:active":{backgroundColor:n.neutralTertiaryAlt}}},null==e?void 0:e.modal),picker:Object(It.eb)(t.fonts.medium,{padding:32,overflow:"hidden"},null==e?void 0:e.root),header:Object(It.eb)(t.fonts.xLarge,{display:"flex",alignContent:"space-between",color:n.neutralPrimary,fontWeight:300,marginBottom:7,flexGrow:1},null==e?void 0:e.header),endActions:{marginTop:t.spacing.l1,alignItems:"center",display:"flex",selectors:{button:{marginRight:12,minWidth:62,padding:"0px 4px",fontSize:t.fonts.medium.fontSize,borderRadius:4}}},editCanvasAndPhotoListContainer:{display:"flex",padding:"0px 8px"}})})),jt=function(t){var e=t.hideTitleText,n=t.isComponentInline,o=t.titleText,a=t.closeIcon,i=t.infoBar,r=t.uploadPhoto,l=t.editCanvas,s=t.applyButton,c=t.cancelButton,u=t.removeButton,p=t.onDismiss,m=t.focusTrapRef,g=t.hideEndActions,h=t.imageEditorDescription,f=t.customUploadButton,b=t.photoList,v=t.styles,S=Lt(Object(xt.a)(),v),y=d.createElement(d.Fragment,null,!n&&a,!e&&d.createElement("div",{className:S.header,id:"dialogTitle",role:"heading","aria-level":1},o),i,r,d.createElement("div",{className:S.editCanvasAndPhotoListContainer},l,b),h,!g&&d.createElement("div",{className:S.endActions},s,c,u),f);return d.createElement(d.Fragment,null,n?d.createElement("div",{id:"lpc-photo-picker",className:S.picker},y):d.createElement(At.a,{className:"lpc_nested_popup",containerClassName:S.modal,isOpen:!0,onDismiss:p,titleAriaId:"dialogTitle"},d.createElement(kt.a,{id:"lpc-photo-picker",className:S.picker,componentRef:m,firstFocusableSelector:"photoPickerFirstFocusableSelector"},y)))},Nt=Object(Pt.c)((function(t,e){return Object(It.db)({fileInput:{display:"none"},button:Object(It.eb)({color:t.palette.themePrimary,padding:0,margin:"0 0 12px -4px"},null==e?void 0:e.button)})})),Dt=function(t){var e=Nt(Object(xt.a)(),t.styles),n=d.useRef(null);return d.createElement(d.Fragment,null,d.createElement("input",{role:"button",className:e.fileInput,type:"file",ref:n,onClick:function(t){return t.currentTarget.value=""},onChange:function(e){return e.currentTarget.files&&t.onFileSelected(e.currentTarget.files[0],t.isPhotoListPresent)},"data-log-name":"PhotoPickerFileInput",accept:"image/*"}),d.createElement(bt.a,{componentRef:t.buttonRef,className:"".concat(e.button," ").concat("photoPickerFirstFocusableSelector"),iconProps:{iconName:"Add"},onClick:function(){var e;null===(e=n.current)||void 0===e||e.click(),t.onUploadNewPhoto()}},t.uploadText))},Bt=n(850),Tt=n(1290),Mt=n(202),_t=n(59),zt=n(550),Wt=n(336),Ft=n(325);function Ht(t){var e=new DataView(function(t){for(var e=t.replace(/^data\:([^\;]+)\;base64,/i,""),n=atob(e),o=n.length,a=new ArrayBuffer(o),i=new Uint8Array(a),r=0;r<o;r++)i[r]=n.charCodeAt(r);return a}(t));if(65496!==e.getUint16(0,!1))return 1;for(var n,o=e.byteLength,a=2;a<o;){var i=e.getUint16(a,!1);if(a+=2,65505===i){if(1165519206!==e.getUint32(a+=2,!1))break;var r=18761===e.getUint16(a+=6,!1);a+=e.getUint32(a+4,r);var l=e.getUint16(a,r);a+=2;for(var s=0;s<l;s++)if(274===e.getUint16(a+12*s,r))return(n=e.getUint16(a+12*s+8,r))<1||n>8?1:n}else{if(65280!=(65280&i))break;a+=e.getUint16(a,!1)}}return 1}var Gt=n(2956),Yt=n(1424),Kt=n(160),Xt=Object(Kt.a)((function(t,e){return Object(It.db)({sliderContainer:{flexGrow:1,marginTop:2,marginBottom:24,selectors:{"&:disabled":{background:"transparent",cursor:"not-allowed"}}},sliderButton:{selectors:{"&:disabled":{background:"transparent",cursor:"not-allowed"}}},editControls:{paddingTop:10,display:"flex",flexDirection:"row",width:"100%",height:32},root:Object(It.eb)({selectors:{"&:disabled":{background:"transparent",cursor:"not-allowed"}}},null==e?void 0:e.root),slideBox:Object(It.eb)({padding:"0 10px"},null==e?void 0:e.slideBox),thumb:Object(It.eb)({border:"2px solid ".concat(t.palette.themePrimary)},null==e?void 0:e.thumb),activeThumb:Object(It.eb)({backgroundColor:t.palette.themePrimary},null==e?void 0:e.activeThumb),inactiveThumb:Object(It.eb)({backgroundColor:t.palette.themeLight},null==e?void 0:e.inactiveThumb),announcement:{position:"absolute",width:1,height:1,margin:-1,overflowX:"hidden",overflowY:"hidden"}})})),Zt=function(t){return"".concat(Math.round(t),"°")},Vt=function(t){return"".concat(Math.round(t))},qt=function(t){var e,n,o=Object(xt.a)(),a=Xt(o,t.styles),i=t.onImageRotate,r=t.setBaseAngleForStraightening,l=d.useCallback((function(e){var n=e-t.imageRotationAngle+t.baseAngleForStraightening;i(n)}),[i,t.baseAngleForStraightening,t.imageRotationAngle]),s=d.useCallback((function(){i(90),r(t.baseAngleForStraightening+90)}),[i,r,t.baseAngleForStraightening]),c=d.useCallback((function(){t.onImageRotate(-90),t.setBaseAngleForStraightening(t.baseAngleForStraightening-90)}),[t]),u=null!==(n=null===(e=t.imagePositionInformationString)||void 0===e?void 0:e.call(t,{p0:Zt(t.imageRotationAngle)}))&&void 0!==n?n:Zt(t.imageRotationAngle);return d.createElement("div",{className:a.editControls},d.createElement(St.a,{className:a.sliderButton,title:t.counterClockwiseString,ariaLabel:t.counterClockwiseString,onClick:c,onRenderIcon:Jt,disabled:t.isPhotoUploading}),d.createElement(vt.a,{content:u,styles:{root:a.sliderContainer}},d.createElement(Gt.a,{styles:{root:a.root,slideBox:a.slideBox,thumb:a.thumb,activeSection:a.activeThumb,inactiveSection:a.inactiveThumb},min:-45,max:45,step:1,value:t.imageRotationAngle-t.baseAngleForStraightening,showValue:!1,disabled:t.isPhotoUploading,originFromZero:!0,onChange:l,ariaValueText:Vt,"aria-label":t.rotateString})),d.createElement(St.a,{className:a.sliderButton,disabled:t.isPhotoUploading,title:t.clockwiseString,ariaLabel:t.clockwiseString,onClick:s,onRenderIcon:Qt}),d.createElement("div",{"aria-live":"assertive",role:"status",className:a.announcement},Zt(t.imageRotationAngle)))};function Jt(){return d.createElement("span",null,d.createElement(Yt.p,null))}function Qt(){return d.createElement("span",null,d.createElement(Yt.q,null))}var $t=function(t){return"".concat(t,"%")},te=function(t,e){return Math.round(100*(t*(e-1)+1))},ee=function(t){var e,n,o=d.useState(!1),a=o[0],i=o[1],r=d.useRef(0),l=t.zoom,s=d.useCallback((function(e,n,o){var a,i;!t.image||t.maximumScale<1||isNaN(e)?null==o||o.stopPropagation():l((a=e,i=t.maximumScale,Math.round((a/100-1)/(i-1)*100)/100-t.relativeScale),.5*t.canvasSize,.5*t.canvasSize)}),[t.image,t.maximumScale,t.relativeScale,l,t.canvasSize]),c=d.useCallback((function(e){l(e,t.canvasSize/2,t.canvasSize/2),i(!0),r.current&&clearTimeout(r.current),r.current=window.setTimeout((function(){return i(!1)}),3e3)}),[l,r,t.canvasSize]);d.useEffect((function(){return function(){return clearTimeout(r.current)}}),[r]);var u=Object(xt.a)(),p=Xt(u,t.styles),m=C(2*t.stepSize,.1,.2),g=te(0,t.maximumScale),h=te(1,t.maximumScale),f=te(t.relativeScale,t.maximumScale),b=te(C(t.stepSize,.05,.1),t.maximumScale)-te(0,t.maximumScale),v=t.maximumScale<=1?t.zoomAtMaxString:null!==(n=null===(e=t.imageScaleInformationString)||void 0===e?void 0:e.call(t,{p0:$t(f)}))&&void 0!==n?n:$t(f);return d.createElement("div",{className:p.editControls},d.createElement(St.a,{className:p.sliderButton,iconProps:{iconName:"CalculatorSubtract"},title:t.zoomOutString,ariaLabel:t.zoomOutString,onClick:function(){return c(-m)},disabled:t.isPhotoUploading||t.zoomOutDisabled}),d.createElement(vt.a,{content:v,styles:{root:p.sliderContainer}},d.createElement(Gt.a,{styles:{root:p.root,slideBox:p.slideBox,thumb:p.thumb,activeSection:p.activeThumb,inactiveSection:p.inactiveThumb},ariaValueText:$t,ariaLabel:t.zoomString,min:g,max:h,disabled:t.isPhotoUploading||t.maximumScale<=1,step:b,value:f,showValue:!1,onChange:s})),d.createElement(St.a,{className:p.sliderButton,iconProps:{iconName:"CalculatorAddition"},title:t.zoomInString,ariaLabel:t.zoomInString,onClick:function(){return c(m)},disabled:t.isPhotoUploading||t.zoomInDisabled}),a&&d.createElement("div",{"aria-live":"assertive",role:"status",className:p.announcement},$t(te(t.relativeScale,t.maximumScale))))},ne=n(2933),oe=n(2310),ae=n(1425),ie=Object(Pt.c)((function(t,e){var n=t.palette;return Object(It.db)({editPivot:{height:46},link:Object(It.eb)({lineHeight:10,width:46,height:46,padding:0,marginRight:0,color:n.neutralSecondary},null==e?void 0:e.link),linkSelected:Object(It.eb)({color:n.neutralDark,fontWeight:600},null==e?void 0:e.linkSelected),button:Object(It.eb)({flex:"0 1 100%",height:44},null==e?void 0:e.button),buttonText:Object(It.eb)({fontSize:10,marginTop:5},null==e?void 0:e.buttonText)})})),re=function(t){var e=Object(xt.a)(),n=ie(e,t.styles),o=t.setSelectedKey,a=d.useCallback((function(t){var e;(null===(e=null==t?void 0:t.props)||void 0===e?void 0:e.itemKey)&&o(t.props.itemKey)}),[o]),i=d.useCallback((function(e){if(!(null==e?void 0:e.itemKey))return null;var o=e.itemKey,a="Rotate"===o?[d.createElement(Yt.o,{key:o}),t.rotateString]:[d.createElement(ae.g,{key:o}),t.zoomString],i=a[0],r=a[1];return d.createElement("span",{className:n.button},i,d.createElement("div",{className:n.buttonText},r))}),[t.rotateString,t.zoomString,n.button,n.buttonText]);return d.createElement(ne.a,{styles:{root:n.editPivot,link:n.link,linkIsSelected:n.linkSelected},"aria-label":t.pivotString,selectedKey:t.selectedKey,onLinkClick:a,headersOnly:!0,"aria-disabled":t.isPhotoUploading},d.createElement(oe.a,{itemKey:"Zoom",onRenderItemLink:i}),d.createElement(oe.a,{itemKey:"Rotate",onRenderItemLink:i}))},le=function(){return(le=s.a||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},se=Object(Pt.c)((function(t,e,n,o){return Object(It.db)({editControlsPlaceholderSpace:{height:32},editCanvas:Object(It.eb)({backgroundColor:t.palette.neutralLight,cursor:e?"move":"inherit"},null==n?void 0:n.root),isDropActive:{outline:"1px solid purple"},invisible:le({clip:"rect(1px, 1px, 1px, 1px)"},{height:1,overflow:"hidden",position:"absolute",whiteSpace:"nowrap",width:1}),canvasContainer:{margin:o?"0 0 0 auto":"0 auto",display:"flex",alignItems:"center",flexDirection:"column",width:256,position:"relative"},textboy:Object(It.eb)({color:t.palette.white,position:"absolute",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",top:0,left:0,width:256,height:256},null==n?void 0:n.textboy),initials:Object(It.eb)({fontSize:128,lineHeight:128},null==n?void 0:n.initials)})})),ce=function(t){t.stopPropagation(),t.preventDefault()},ue=function(t){return"targetTouches"in t?[t.targetTouches[0].clientX,t.targetTouches[0].clientY]:[t.clientX,t.clientY]};var pe,de=Object(v.c)((function(t){return pt.getSelectors(t).getEditCanvasState()}),(function(t){return{onReset:function(){return t(Z())},onKeyboardEvent:function(e){return t(F({xpos:e.xpos,ypos:e.ypos}))},onZoomEvent:function(e){return t(G({absoluteScale:e.absoluteScale,relativeScale:e.relativeScale,zoomOutDisabled:e.zoomOutDisabled,zoomInDisabled:e.zoomInDisabled,xpos:e.xpos,ypos:e.ypos}))},onImageLoaded:function(e){return t(Y({naturalMin:e.naturalMin,naturalWidth:e.naturalWidth,naturalHeight:e.naturalHeight,stepSize:e.stepSize,maximumScale:e.maximumScale,orientation:e.orientation,imageRotationAngle:e.imageRotationAngle,image:e.image,zoomInDisabled:e.zoomInDisabled,initialRender:e.initialRender,xpos:e.xpos,ypos:e.ypos,absoluteScale:e.absoluteScale,relativeScale:e.relativeScale,imageUpdated:e.imageUpdated}))},onDragStart:function(e){return t(K({moving:e.moving,lastMouseX:e.lastMouseX,lastMouseY:e.lastMouseY}))},onDragProgress:function(e){return t(X({moving:e.moving,xpos:e.xpos,ypos:e.ypos,lastMouseX:e.lastMouseX,lastMouseY:e.lastMouseY}))},onEmptyImageRendered:function(){return t(V())},onRotateEvent:function(e){return t(H({imageRotationAngle:e.imageRotationAngle}))}}}))((function(t){var e,n=d.useRef(!1),o=d.useRef(null),a=d.useRef(null),i=Object(Tt.a)(t.personDisplayName,Object(Mt.a)()),r=!t.image||t.maximumScale<=1||t.progress>0,l=t.image,s=t.progress>0&&t.progress<1,c=!r||t.naturalHeight!==t.naturalWidth,u=Object(xt.a)(),p=se(u,c,t.styles.canvas,t.isPhotoListPresent),m=d.useState(!1),g=m[0],h=m[1],f=d.useState(0),b=f[0],v=f[1],S=d.useState(),y=S[0],P=S[1],x=d.useCallback((function(t){return v(t%360)}),[]),O=t.onRefocus,U=t.onZoomEvent,R=t.onError,w=t.onDragProgress,A=t.onReset,k=t.onDragStart,L=t.onCanvasUpdated,j=t.onEmptyImageRendered,N=t.onFileSelected,D=t.onImageLoaded,B=t.onKeyboardEvent,T=t.onRotateEvent,M=t.isUploadedPhotoTooSmall,_=d.useCallback((function(e,n){return"Fit"===t.imageScaling&&n<256?(256-n)/2:e>0?0:e+n<256?256-n:e}),[t.imageScaling]),z=d.useCallback((function(e,n,o,a){var i=e+(n-e)*a/t.absoluteScale,r=a*o/t.maximumScale;return _(i,r)}),[_,t.absoluteScale,t.maximumScale]),W=d.useCallback((function(e,n,o){if(!(!t.image||t.maximumScale<1||isNaN(e)||"Rotate"===y)){var a=Math.min(1,Math.max(0,t.relativeScale+e));if(a!==t.relativeScale){var i=Math.exp(a*Math.log(t.maximumScale)),r=i<=1,l=i>=t.maximumScale,s=z(n,t.xpos,t.naturalWidth,i),c=z(o,t.ypos,t.naturalHeight,i);U({absoluteScale:i,relativeScale:a,zoomOutDisabled:r,zoomInDisabled:l,xpos:s,ypos:c})}}}),[t.image,t.maximumScale,t.relativeScale,t.xpos,t.naturalWidth,t.ypos,t.naturalHeight,z,U,y]),F=d.useCallback((function(e){var n=(t.imageRotationAngle+e)%360;T({imageRotationAngle:n})}),[t.imageRotationAngle,T]),H=d.useCallback((function(e){var n,o,a,i,r,l,s,c;if(t.image&&!(t.maximumScale<1)){var u="",p=t.xpos.toFixed(1),d=t.ypos.toFixed(1);switch(e.key){case"+":return W(t.stepSize,128,128);case"-":return W(-1*t.stepSize,128,128);case"ArrowLeft":u=null===(o=(n=t.strings).leftArrowKeyAriaLabel)||void 0===o?void 0:o.call(n,{p0:p,p1:d});break;case"ArrowRight":u=null===(i=(a=t.strings).rightArrowKeyAriaLabel)||void 0===i?void 0:i.call(a,{p0:p,p1:d});break;case"ArrowUp":u=null===(l=(r=t.strings).upArrowKeyAriaLabel)||void 0===l?void 0:l.call(r,{p0:p,p1:d});break;case"ArrowDown":u=null===(c=(s=t.strings).downArrowKeyAriaLabel)||void 0===c?void 0:c.call(s,{p0:p,p1:d})}e.currentTarget.setAttribute("aria-label","".concat(u));var m=E((e.which===_t.a.left?1:e.which===_t.a.right&&-1)||0,(e.which===_t.a.up?1:e.which===_t.a.down&&-1)||0,t.orientation,t.imageRotationAngle),g=m.x,h=m.y,f=g*t.naturalWidth/100,b=h*t.naturalHeight/100,v=_(t.xpos+f,t.naturalWidth*t.absoluteScale/t.maximumScale),S=_(t.ypos+b,t.naturalHeight*t.absoluteScale/t.maximumScale);B({xpos:v,ypos:S})}}),[t.stepSize,t.orientation,t.image,t.naturalWidth,t.naturalHeight,t.xpos,t.ypos,t.absoluteScale,t.maximumScale,B,t.imageRotationAngle,W,_,t.strings]),G=d.useCallback((function(e){var a,i,r,l=1;"Fit"===t.imageScaling?(l=1.2,i=Math.max(e.naturalWidth,e.naturalHeight),r=i*l/256):(i=Math.min(e.naturalWidth,e.naturalHeight),r=i/256);var s=function(t){return-.5*(t/r-256)},c=Math.min(1,Math.max(.01,256/(2*Math.max(e.naturalWidth,e.naturalHeight))));x(0),!t.initialRender&&r<1&&(e.naturalHeight<48||e.naturalWidth<48?setTimeout((function(){return R("IMAGE_TOO_SMALL_ERROR")}),0):setTimeout((function(){return R("IMAGE_TOO_SMALL_WARNING")}),0)),M(e.naturalHeight<48||e.naturalWidth<48),n.current||D({naturalMin:i,naturalWidth:e.naturalWidth*l,naturalHeight:e.naturalHeight*l,stepSize:c,maximumScale:r,orientation:Ht(e.src),imageRotationAngle:0,image:e,zoomInDisabled:!1,initialRender:!1,xpos:s(e.naturalWidth*l),ypos:s(e.naturalHeight*l),absoluteScale:1,relativeScale:0,imageUpdated:!1}),!t.initialRender&&(null===(a=o.current)||void 0===a||a.focus())}),[t.initialRender,R,M,D,n,o,t.imageScaling,x]),Y=d.useCallback((function(e){if(e){var n=new Image;n.onload=function(){return G(n)},n.src=e,n.alt=t.fileName||""}else A(),""===e&&j()}),[A,G,j,t.fileName]),K=d.useCallback((function(e){if(t.image){ce(e);var n=e.deltaY>0?-1:1,o=E(e.nativeEvent.offsetX,e.nativeEvent.offsetY,t.orientation,t.imageRotationAngle),a=o.x,i=o.y;W(C(t.stepSize,.05,.1)*n,a,i)}}),[t.image,t.orientation,t.stepSize,W,t.imageRotationAngle]),X=d.useCallback((function(e){var n=ue(e),o=E(n[0],n[1],t.orientation,t.imageRotationAngle),a=o.x,i=o.y;t.image&&(ce(e),k({moving:!0,lastMouseX:a,lastMouseY:i}))}),[t.image,k,t.orientation,t.imageRotationAngle]),Z=d.useCallback((function(e){if(ce(e),t.image)if(["mousemove","touchmove"].includes(e.type)&&t.moving){var n=ue(e),o=E(n[0],n[1],t.orientation,t.imageRotationAngle),a=o.x,i=o.y,r=_(t.xpos+(a-t.lastMouseX),t.naturalWidth*t.absoluteScale/t.maximumScale),l=_(t.ypos+(i-t.lastMouseY),t.naturalHeight*t.absoluteScale/t.maximumScale);w({moving:!0,xpos:r,ypos:l,lastMouseX:a,lastMouseY:i})}else w({moving:!1,xpos:t.xpos,ypos:t.ypos,lastMouseX:t.lastMouseX,lastMouseY:t.lastMouseY})}),[t.orientation,t.image,t.moving,t.xpos,t.ypos,t.lastMouseX,t.lastMouseY,t.naturalWidth,t.naturalHeight,t.absoluteScale,t.maximumScale,_,w,t.imageRotationAngle]),V=d.useCallback((function(t){ce(t),h(!0)}),[h]),q=d.useCallback((function(t){ce(t),h(!1)}),[h]),J=d.useCallback((function(e){q(e),e.dataTransfer&&N(e.dataTransfer.files[0],t.isPhotoListPresent)}),[q,N,t.isPhotoListPresent]),Q=d.useCallback((function(){var e=o.current;if(e&&a.current){var n=e.getContext("2d");if(n){var i=window.getComputedStyle(e);n.fillStyle=i.backgroundColor||"#ffffff",n.fillRect(0,0,1,1);var r=n.getImageData(0,0,1,1).data,l="rgba(".concat(r[0],", ").concat(r[1],", ").concat(r[2],", 0.6)"),s="rgba(".concat(r[0],", ").concat(r[1],", ").concat(r[2],", 1)"),c=Object(zt.a)({text:t.personDisplayName});""===t.dataUrl?(n.fillStyle=c,a.current.style.display="flex"):(n.fillStyle=t.customBackgroundColor||"white",a.current.style.display="none"),n.fillRect(0,0,256,256),t.image&&I(n,256,t.imageRotationAngle,t.orientation,t.image,(function(e,n){return e.drawImage(n,t.xpos,t.ypos,t.naturalWidth*t.absoluteScale/t.maximumScale,t.naturalHeight*t.absoluteScale/t.maximumScale)})),null==L||L(e),"Circle"===t.imageCropShape&&(n.save(),n.beginPath(),n.rect(0,0,256,256),n.arc(128,128,125,0,2*Math.PI,!0),n.clip(),n.fillStyle=l,n.fillRect(0,0,256,256),n.restore(),n.save(),n.beginPath(),n.arc(128,128,126,0,2*Math.PI,!0),n.lineWidth=2,n.strokeStyle=s,n.stroke(),n.restore(),n.save(),n.beginPath(),n.lineWidth=4,n.fillStyle="rgba(0, 120, 215, 0.5)",n.strokeStyle="rgba(0, 120, 215, 0.5)",n.arc(128,128,125,-Math.PI/2,2*t.progress*Math.PI-Math.PI/2,!1),1===t.progress&&n.fill(),n.stroke(),n.restore())}else R("UNSUPPORTED_BROWSER")}}),[t.personDisplayName,t.dataUrl,t.image,t.imageRotationAngle,t.orientation,t.xpos,t.ypos,t.naturalWidth,t.naturalHeight,t.absoluteScale,t.maximumScale,t.progress,R,t.customBackgroundColor,L,t.imageCropShape,a]);d.useEffect((function(){return Q(),function(){n.current=!0}}),[]),d.useEffect((function(){Q()})),d.useEffect((function(){1===t.progress&&O()}),[t.progress,O]),d.useEffect((function(){t.dataUrl&&P(r?"Rotate":"Zoom")}),[t.dataUrl,r]),d.useEffect((function(){t.dataUrl?t.imageUpdated&&Y(t.dataUrl):t.image&&(A(),j())}),[t.dataUrl,t.imageUpdated,t.image,A,j,r,Y]);var $=d.useMemo((function(){var e,n;return t.image?1===t.progress?t.strings.success:t.fileName?null===(n=(e=t.strings).photoSelected)||void 0===n?void 0:n.call(e,{p0:t.fileName}):t.strings.dropZoneImageAriaLabel:t.strings.dropZoneEmptyAriaLabel}),[t.image,t.progress,t.fileName,t.strings]),tt=d.useRef(Object(Bt.a)());return d.createElement("div",{className:p.canvasContainer},d.createElement("div",{"aria-live":"polite"},d.createElement("canvas",{className:Object(Wt.a)(p.editCanvas,(e={},e[p.isDropActive]=g,e)),role:"img",tabIndex:l?0:-1,ref:o,width:256,height:256,onKeyDown:H,"aria-label":$,onDragEnter:V,onDrop:J,onDragLeave:q,onDragOver:ce,onMouseDown:X,onMouseMove:Z,onMouseUp:Z,onMouseLeave:Z,onWheel:K,onTouchStart:X,onTouchMove:Z,onTouchEnd:Z,"aria-describedby":tt.current}),t.image&&t.fileName&&d.createElement("img",{alt:t.fileName,id:tt.current,"aria-hidden":!0,hidden:!0}),d.createElement("div",{className:p.textboy,ref:a,onDragEnter:V,onDragLeave:q,onDragOver:ce,onDrop:J},d.createElement("div",{className:p.initials},i),d.createElement("div",null,t.strings.dropZone))),d.createElement("div",{role:"region","aria-live":"assertive","aria-atomic":!0},1===t.progress?d.createElement("div",{className:p.textboy},d.createElement("span",{className:p.invisible},t.strings.success),d.createElement(Ft.a,{className:p.initials,iconName:"CheckMark"})):null),l?d.createElement(d.Fragment,null,"Zoom"!==y&&t.enableImageRotation?d.createElement(qt,{styles:t.styles.slider,isPhotoUploading:s,clockwiseString:t.strings.clockwise,counterClockwiseString:t.strings.counterClockwise,rotateString:t.strings.rotate,baseAngleForStraightening:b,imagePositionInformationString:t.strings.imagePositionInformationString,setBaseAngleForStraightening:x,onImageRotate:F,imageRotationAngle:t.imageRotationAngle,panEnabled:c}):d.createElement(ee,{styles:t.styles.slider,zoomOutString:t.strings.zoomOut,zoomInString:t.strings.zoomIn,zoomString:t.strings.zoom,zoomAtMaxString:t.strings.zoomAtMax||"",imageScaleInformationString:t.strings.imageScaleInformationString,isPhotoUploading:s,canvasSize:256,image:t.image,maximumScale:t.maximumScale,stepSize:t.stepSize,zoomOutDisabled:t.zoomOutDisabled,relativeScale:t.relativeScale,zoomInDisabled:t.zoomInDisabled,panEnabled:c,zoom:W}),t.enableImageRotation&&d.createElement(re,{styles:t.styles.pivot,zoomAtMaxString:t.strings.zoomAtMax,isPhotoUploading:s,maximumScale:t.maximumScale,selectedKey:y,setSelectedKey:P,rotateString:t.strings.rotate,zoomString:t.strings.zoom,pivotString:t.strings.pivot})):d.createElement("div",{className:p.editControlsPlaceholderSpace,"aria-live":"polite"}))})),me=n(2037),ge=n(612),he=n(347),fe=n(63),be=n(459),ve=function(t){var e,n,o=Object(xt.a)(),a=(n=t.styles,Object(be.a)((function(t){return Object(It.db)({listItem:Object(It.eb)({height:56,width:56,marginBottom:10,border:"none",boxSizing:"border-box",display:"flex",padding:0,background:"transparent",cursor:"pointer",selectors:{"&:focus":{outline:"2px solid ".concat(t.palette.themePrimary)},"&:hover":{opacity:.9,border:"1px solid ".concat(t.palette.neutralLighter)}}},null==n?void 0:n.listItem),lastListItem:{marginBottom:0},listItemSelected:Object(It.eb)({outline:"2px solid ".concat(t.palette.themePrimary),opacity:.9},null==n?void 0:n.listItemSelected),listItemWithBackground:{background:t.palette.neutralLighter},photoListItemImage:{height:"100%",width:"100%"},emptyListIcon:Object(It.eb)({margin:"auto",fontSize:"24px",color:t.palette.neutralSecondaryAlt},null==n?void 0:n.emptyListIcon)})})))(o);return d.createElement("button",{className:Object(Wt.a)(a.listItem,(e={},e[a.listItemSelected]=t.index===t.selectedIndex,e[a.listItemWithBackground]=t.isEmptyPhoto,e[a.lastListItem]=t.isLastPhoto,e)),onClick:function(){var e;t.onClickHandler({selectedIndex:t.index,imageUrl:t.imageUrl||"",fileName:"".concat(t.photoListImageAriaLabel||""," ").concat(t.index+1).trim()}),t.isEmptyPhoto&&(null===(e=t.onPhotoRemoved)||void 0===e||e.call(t))},"aria-describedby":t.ariaDescribedBy},t.isEmptyPhoto?d.createElement(ge.a,{"aria-label":t.photoListEmptyImageAriaLabel,iconName:"Contact",className:a.emptyListIcon}):d.createElement(he.a,{src:t.imageUrl,className:a.photoListItemImage,alt:t.photoListImageAriaLabel,imageFit:fe.b.cover}))},Se=function(t){var e,n=(e=t.styles,Object(be.b)(Object(It.db)({root:Object(It.eb)({height:256,width:56,padding:"0px 25px 0px 12px",overflowY:"auto",margin:0,listStyle:"none"},null==e?void 0:e.root)}))()),o=t.imageUrls,a=t.showEmptyPhoto?o.length:o.length-1;return d.createElement("ul",{className:n.root,"aria-label":t.strings.photoListAriaLabel},o.map((function(e,n){return d.createElement(me.a,{posInSet:n+1,setSize:a+1,key:n,onRenderDescribedElement:function(o){return d.createElement("li",{key:n},d.createElement(ve,{key:n,styles:t.styles,imageUrl:e,index:n,selectedIndex:t.selectedIndex,isLastPhoto:n===a,isEmptyPhoto:!1,photoListImageAriaLabel:t.strings.photoListImageAriaLabel,onClickHandler:t.onPhotoListImageSelected,ariaDescribedBy:o}))}})})),!!t.showEmptyPhoto&&d.createElement(me.a,{posInSet:a+1,setSize:a+1,onRenderDescribedElement:function(e){return d.createElement("li",null,d.createElement(ve,{index:o.length,selectedIndex:t.selectedIndex,isLastPhoto:!0,isEmptyPhoto:!0,styles:t.styles,photoListEmptyImageAriaLabel:t.strings.photoListEmptyImageAriaLabel,onClickHandler:t.onPhotoListImageSelected,onPhotoRemoved:t.onPhotoRemoved,ariaDescribedBy:e}))}}))},ye=(pe=function(t,e){return(pe=a.a||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}pe(t,e),t.prototype=null===e?r()(e):(n.prototype=e.prototype,new n)}),Pe=function(){return(Pe=s.a||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},Ie=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ye(e,t),e.prototype.componentDidMount=function(){this.props.photoListLoadPhotos(this.props.photoListSelectedIndex||0,this.props.photoListImageUrls)},e.prototype.render=function(){return d.createElement(Se,Pe({},this.props))},e}(d.Component);var Ee=Object(v.c)((function(t){return pt.getSelectors(t).getPhotoListState()}),(function(t){return{photoListLoadPhotos:function(e,n){t($({selectedIndex:e,imageUrls:n}))},onPhotoListImageSelected:function(e){!function(t,e,n,o){if(!e)return t(D({isPhotoListPresent:!0})),void t(J({selectedIndex:n}));if(e.startsWith("data:image/"))return t(B({dataUrl:e,isPhotoListPresent:!0,fileName:o})),t(q()),void t(J({selectedIndex:n}));var a=new Image;a.crossOrigin="Anonymous",a.onload=function(){var e=document.createElement("canvas");e.width=a.naturalWidth,a.alt=o||"",e.height=a.naturalHeight;var i=e.getContext("2d");i&&(i.drawImage(a,0,0),t(B({dataUrl:S(e,!1),isPhotoListPresent:!0,fileName:o})),t(q()),t(J({selectedIndex:n})))},a.src=e}(t,e.imageUrl,e.selectedIndex,e.fileName)}}}))(Ie),Ce=function(){var t=function(e,n){return(t=a.a||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?r()(n):(o.prototype=n.prototype,new o)}}(),xe=function(){return(xe=s.a||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},Oe=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(null!=t&&"function"==typeof et.a){var a=0;for(o=et()(t);a<o.length;a++)e.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(t,o[a])&&(n[o[a]]=t[o[a]])}return n},Ue=function(t){function e(e){return 1/(1+Math.exp(-t*e))-.5}var n=.5/e(1);return function(t){return t<=0?0:t>1?1:n*e(2*t-1)+.5}}(5),Re=function(t){function e(e){var n=t.call(this,e)||this;return n.focusTrap=null,n.primaryButton=null,n.uploadFileButton=null,n.onCanvasUpdated=function(t){var e,o;n.props.isCanvasDirty&&n.props.onImageChanged?n.props.onImageChanged(n.props.latestImageStats):null===(o=(e=n.props).onCanvasUpdated)||void 0===o||o.call(e,t,n.props.isCanvasDirty)},n.handleOnRemoveButtonClicked=function(){n.props.loadedEmptyImage(h()(n.props.personImageUrl)),n.uploadFileButton&&n.uploadFileButton.focus()},n.handleOnSaveButtonClicked=function(){switch(n.props.status){case"SUCCESS":return n.props.onDone(),n.props.onDismiss();default:n.props.startUpload()}},n.handleUploadAnimation=function(){"IN_PROGRESS"===n.props.status&&n.props.onUploadProgress(b()())},n.handleOnCancelButtonClicked=function(){n.props.onCancel(),n.props.onDismiss()},n.handleOnCloseButtonClicked=function(){n.props.onClose(),n.props.onDismiss()},n.getFocusTrapRef=n.getFocusTrapRef.bind(n),n.getButtonRef=n.getButtonRef.bind(n),n.getUploadButtonRef=n.getUploadButtonRef.bind(n),n}return Ce(e,t),e.prototype.getFocusTrapRef=function(){var t=this,e=function(e){return t.focusTrap=e};return e.current=null,e},e.prototype.getButtonRef=function(){var t=this,e=function(e){return t.primaryButton=e};return e.current=null,e},e.prototype.getUploadButtonRef=function(){var t=this,e=function(e){return t.uploadFileButton=e};return e.current=null,e},e.prototype.render=function(){var t,e,n=this,o=this.getWarningText(this.props.warning);return d.createElement(jt,{styles:this.props.styles.picker,onDismiss:this.props.onDismiss,focusTrapRef:this.getFocusTrapRef(),hideTitleText:!!this.props.hideUploadHeader,isComponentInline:!!this.props.isComponentInline,titleText:this.props.strings.uploadHeader,imageEditorDescription:this.props.strings.imageEditorDescription,hideEndActions:this.props.hideButtons,closeIcon:d.createElement(Ct,{buttonType:"Icon",iconName:"Cancel",onClick:this.handleOnCloseButtonClicked,dataLogName:"PhotoPickerClose",title:this.props.strings.closeIconTitle,ariaLabel:this.props.strings.closeIconAriaLabel}),infoBar:o?d.createElement(wt,{styles:this.props.styles.infoBar,warning:this.props.warning,warningText:o,onDismiss:this.props.onDismissInfoBar,dismissButtonAriaLabel:this.props.strings.infoBarDismissButtonAriaLabel}):null,uploadPhoto:this.props.hideUploadPhotoButton&&this.props.renderCustomUploadButton?null:d.createElement(Dt,{styles:this.props.styles.uploadPhoto,buttonRef:this.getUploadButtonRef(),onFileSelected:this.props.onFileSelected,onUploadNewPhoto:this.props.onUploadNewPhoto,uploadText:this.props.strings.upload,isPhotoListPresent:h()(this.props.personImageUrl)}),editCanvas:d.createElement(de,{dataUrl:this.props.dataUrl,enableImageRotation:this.props.enableImageRotation,fileName:this.props.fileName,personDisplayName:this.props.personDisplayName,progress:this.props.progress,warning:o,strings:this.props.strings,onError:this.props.onError,isUploadedPhotoTooSmall:function(t){return n.props.onUploadedPhotoTooSmall(t)},styles:this.props.styles,onFileSelected:this.props.onFileSelected,onRefocus:function(){return n.onFocusChange()},onUpdate:this.props.onImageUpdated,imageCropShape:this.props.imageCropShape||"Circle",imageScaling:this.props.imageScaling||"Fill",onCanvasUpdated:this.onCanvasUpdated,isComponentInline:!!this.props.isComponentInline,customBackgroundColor:this.props.customBackgroundColor,isPhotoListPresent:h()(this.props.personImageUrl)}),photoList:h()(this.props.personImageUrl)?d.createElement(Ee,{styles:this.props.styles.list,photoListImageUrls:this.props.personImageUrl,photoListSelectedIndex:this.props.photoListSelectedIndex,showEmptyPhoto:!!this.props.showPhotoListEmptyPhoto,strings:this.props.strings,onPhotoRemoved:function(){var t;null===(t=n.uploadFileButton)||void 0===t||t.focus()}}):null,applyButton:d.createElement(Ct,{buttonType:"Primary",buttonLabel:this.getSaveButtonText(this.props.status),dataLogName:"PhotoPickerOkay",onClick:this.handleOnSaveButtonClicked,disabled:this.getIsPrimaryButtonDisabled(),buttonRef:this.getButtonRef()}),cancelButton:this.props.progress>0?null:d.createElement(Ct,{buttonType:"Default",buttonLabel:this.props.strings.cancel,dataLogName:"PhotoPickerCancel",onClick:this.handleOnCancelButtonClicked}),removeButton:this.props.isImageRemovable?d.createElement(Ct,{buttonType:"Action",buttonLabel:this.props.strings.remove,iconName:"Delete",dataLogName:"PhotoPickerDelete",disabled:this.getIsRemoveButtonDisabled(),onClick:this.handleOnRemoveButtonClicked}):null,customUploadButton:null===(e=(t=this.props).renderCustomUploadButton)||void 0===e?void 0:e.call(t,{onFileSelected:this.props.onFileSelected,onUploadNewPhoto:this.props.onUploadNewPhoto})})},e.prototype.componentDidMount=function(){var t=this;this.props.loadCurrentImage(),requestAnimationFrame((function(){return t.focusTrap&&t.focusTrap.focus()}))},e.prototype.componentWillUnmount=function(){this.props.onImageEditPaneDismissed()},e.prototype.componentDidUpdate=function(t){"IN_PROGRESS"===this.props.status&&requestAnimationFrame(this.handleUploadAnimation),"IN_PROGRESS"===t.status&&"SUCCESS"===this.props.status&&this.primaryButton&&this.primaryButton.focus()},e.prototype.onFocusChange=function(){"SUCCESS"===this.props.status?this.primaryButton&&this.primaryButton.focus():this.focusTrap&&this.focusTrap.focus()},e.prototype.getSaveButtonText=function(t){switch(t){case"IN_PROGRESS":return this.props.strings.inProgress;case"SUCCESS":return this.props.strings.close;case"READY":case"SOMETHING_WENT_WRONG":return this.props.strings.apply;default:return Object(nt.a)(t)}},e.prototype.getWarningText=function(t){switch(t){case"IMAGE_TOO_SMALL_WARNING":return this.props.strings.imageTooSmall;case"IMAGE_TOO_SMALL_ERROR":return this.props.strings.imageTooSmallError;case"NOT_AN_IMAGE":return this.props.strings.notAnImage;case"UNKNOWN":return this.props.strings.somethingWentWrong;case"UNSUPPORTED_BROWSER":return this.props.strings.unsupportedBrowser;default:return""}},e.prototype.getIsPrimaryButtonDisabled=function(){return!this.props.isCanvasDirty||"IN_PROGRESS"===this.props.status||this.props.isUploadedPhotoTooSmall},e.prototype.getIsRemoveButtonDisabled=function(){return!this.props.dataUrl||"IN_PROGRESS"===this.props.status},e}(d.Component);var we={absoluteScale:0,imageRotationAngle:0,xpos:0,ypos:0},Ae=function(t){return ht.reduce((function(e,n){var o;return xe(xe({},e),((o={})[n]=Number(t[n]),o))}),we)},ke=function(t,e){return ht.some((function(n){return e[n].toFixed(4)!==t[n].toFixed(4)}))},Le=function(t,e){switch(t){case"IN_PROGRESS":return.999999*Ue(e/2e3);case"SUCCESS":return 1;case"READY":case"SOMETHING_WENT_WRONG":return 0;default:Object(nt.a)(t)}};var je=Object(v.c)((function(t){var e=pt.getSelectors(t).getPhotoPickerState(),n=pt.getSelectors(t).getEditCanvasState(),o=n.originalCanvasState,a=Oe(n,["originalCanvasState"]),i=Ae(a),r=Ae(o);return{dataUrl:e.dataUrl,initialImage:e.currentImageDataUrl,warning:e.warning,status:e.status,isCanvasDirty:e.isUpdated||ke(r,i),isUploadedPhotoTooSmall:e.isUploadedPhotoTooSmall,progress:Le(e.status,e.uploadDuration),latestImageStats:i,fileName:e.fileName}}),(function(t){return{onUploadedPhotoTooSmall:function(e){return t(U({isUploadedPhotoTooSmall:e}))},onDismissInfoBar:function(){return t(W())},onError:function(e){return t(T({warning:e}))},onUploadNewPhoto:function(){return t(k())},onFileSelected:function(e,n){return function(t,e,n){var o=new FileReader,a=function(){return t(T({warning:"NOT_AN_IMAGE"}))};o.onerror=a,o.onloadend=function(){var i=document.createElement("img");i.onerror=a,i.onload=function(){i.alt=e.name,t(B({dataUrl:i.src,fileName:e.name})),t(q()),n&&t(Q({selectedIndex:0,newImageUrl:i.src}))},i.src=String(o.result)},o.readAsDataURL(e)}(t,e,n)},onCancel:function(){return t(R())},onClose:function(){return t(w())},onDone:function(){return t(A())},onImageEditPaneDismissed:function(){return t(L())},onImageUpdated:function(){return t(j())},onUploadProgress:function(e){return t(_({now:e}))}}}))(Re),Ne=function(){var t=function(e,n){return(t=a.a||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?r()(n):(o.prototype=n.prototype,new o)}}(),De=function(){return(De=s.a||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},Be=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.loadCurrentImage=function(){var t=new Image;t.crossOrigin="Anonymous",t.onload=function(){return e.imageLoaded(t)},t.onerror=function(){return e.imageLoadFailed()},t.src=h()(e.props.personImageUrl)?e.props.personImageUrl[e.props.photoListSelectedIndex||0]||"":e.props.personImageUrl},e.imageLoaded=function(t){var n=document.createElement("canvas");n.width=t.naturalWidth,n.height=t.naturalHeight;var o=n.getContext("2d");o?(o.drawImage(t,0,0),e.props.onLoadedCurrentImage(S(n,e.props.isComponentInline),!!e.props.isSuggestedPhoto,h()(e.props.personImageUrl))):e.props.onError("UNSUPPORTED_BROWSER")},e.imageLoadFailed=function(){e.props.onLoadedEmptyImage(h()(e.props.personImageUrl))},e.startUpload=function(){var t=e.getImageDataUrlFromCanvas();e.props.onStartUpload(b()(),t,e.props.selectedIndex,e.props.imageUrls,e.props.onUpload,e.props.getPhotoListDataOnUpload)},e.getImageDataUrlFromCanvas=function(t){if(!e.props.image)return"";t||(t=648);var n=document.createElement("canvas"),o=e.props.naturalMin/e.props.absoluteScale;n.width=o,n.height=o;var a=n.getContext("2d");if(!a)return e.props.onError("UNSUPPORTED_BROWSER"),"";a.fillStyle=e.props.customBackgroundColor||"white",a.fillRect(0,0,n.width,n.height),e.props.image&&I(a,n.width,e.props.imageRotationAngle,e.props.orientation,e.props.image,(function(t,o){return a.drawImage(o,e.props.xpos*n.width/256,e.props.ypos*n.height/256,e.props.naturalWidth,e.props.naturalHeight)}));for(var i=1;n.width*i/4>=t;)i/=2,a.drawImage(n,0,0,n.width*i,n.height*i);var r=document.createElement("canvas"),l=Math.min(e.props.naturalMin/e.props.absoluteScale,t);r.width=l,r.height=l;var s=r.getContext("2d");return s?(s.drawImage(n,0,0,n.width*i,n.width*i,0,0,l,l),S(r,e.props.isComponentInline)):(e.props.onError("UNSUPPORTED_BROWSER"),"")},e.stopEventDefaults=function(t){t.stopPropagation(),t.preventDefault()},e}return Ne(e,t),e.prototype.render=function(){return d.createElement(je,De({loadCurrentImage:this.loadCurrentImage,startUpload:this.startUpload,loadedEmptyImage:this.props.onLoadedEmptyImage,styles:this.props.styles||{}},this.props))},e}(d.Component);var Te=Object(v.c)((function(t){return De(De({},pt.getSelectors(t).getEditCanvasState()),pt.getSelectors(t).getPhotoListState())}),(function(t){return{onError:function(e){return t(T({warning:e}))},onLoadedCurrentImage:function(e,n,o){return t(N({dataUrl:e,isSuggestedPhoto:n,isPhotoListPresent:o}))},onLoadedEmptyImage:function(e){return t(D({isPhotoListPresent:e}))},onStartUpload:function(e,n,o,a,i,r){return function(t,e,n,o,a,i,r){t(M({now:e})),i(n,(function(){t(z({dataUrl:n})),null==r||r(o===a.length?-1:o,a)}),(function(){return t(T({warning:"UNKNOWN"}))}))}(t,e,n,o,a,i,r)}}}))(Be),Me=n(1349);function _e(){Object(Me.a)(void 0,{disableWarnings:!0})}var ze=function(){var t=function(e,n){return(t=a.a||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?r()(n):(o.prototype=n.prototype,new o)}}(),We=function(){return(We=s.a||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},Fe=null,He=!1,Ge=0,Ye=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ze(e,t),e.prototype.UNSAFE_componentWillMount=function(){if(Ge>=1)throw new Error("Can only mount one StandalonePhotoPicker at a time.");if(Ge+=1,He||(He=!0,_e()),null===Fe){var t=Object(m.createStore)(Object(c.a)([pt]));Fe=new u.a({reduxStore:t})}},e.prototype.componentWillUnmount=function(){Ge-=1},e.prototype.render=function(){return Fe?d.createElement(p.a,{context:Fe},d.createElement(Te,We({},this.props))):null},e}(d.Component)}}]);