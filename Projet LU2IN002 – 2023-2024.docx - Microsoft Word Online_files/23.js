(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[23],{337:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(331),i=n(97),r=n(7);function o(e){var t;try{t=decodeURI(e)}catch(n){t=e}return t===e?e=Object(a.e)(e,!0):(e=e.replace("#","%23"),r.t.isActivated("589c6b39-fbce-42b5-bff1-125e13e2367a","05/19/2021","encode url with %number in the name")||i.e.isFeatureEnabled({ECS:83959})||!e.indexOf("%25")||(e=Object(a.e)(e,!0))),e}},408:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(0),i=n(15),r=n(7).e.isActivated("0F8C524D-93DF-45F2-9CBB-64AED06517C5","08/11/2023","Normalize CorrelationId in QoS events");function o(e){var t,n,s=e||void 0;return Object(a.e)(Object(a.e)({error:e&&(e.message||e.name),resultCode:s&&(t=s,n=[],"object"==typeof t.extraData&&t.extraData&&void 0!==t.extraData.status&&n.push("[".concat(t.extraData.status,"]")),"string"==typeof t.code&&n.push("".concat(t.code)),n.join(" "))||e&&e.name||"Unknown"},s?Object(a.e)({},"boolean"==typeof s.isExpected?{resultType:s.isExpected?i.t.ExpectedFailure:i.t.Failure}:{resultType:i.t.Failure}):{resultType:i.t.Success}),{extraData:Object(a.e)({stack:e&&e.stack},s?Object(a.e)(Object(a.e)(Object(a.e)({},"object"==typeof s.innerError?{innerError:o(s.innerError)}:{}),"string"==typeof s.correlationId?r?{correlationId:s.correlationId}:{CorrelationId:s.correlationId}:{}),"object"==typeof s.extraData?Object(a.e)({},s.extraData):{}):{})})}},426:function(e,t,n){"use strict";n.d(t,"e",function(){return q});var a=n(0),i=n(131),r=n(371),o=n(65),s=n(336),c=n(15),d=n(220),l=n(55),u=n(139),f=n(125),p=n(470),m="Unknown",_="NoConnection",h=n(23),b=n(81),g=n(7),v=n(279),y="WWW-Authenticate",S="x-ms-diagnostics",D="X-SubStatusCode",I="X-SPO-ErrorCode",x="X-MSDAVEXT_Error",C="SPSQLQueryCount",O="x-virus-infected",w=function(){function e(e,t,n){this._request=e,this._url=t,this._webAbsoluteUrl=n&&n.webAbsoluteUrl,this._isCanaryRequest=n&&n.isCanaryRequest}return e.prototype.getSourceUrl=function(){return this._url},e.prototype.getAllResponseHeaders=function(){return this._request.getAllResponseHeaders()},e.prototype.getCorrelationId=function(){return this.getResponseHeader("SPRequestGuid")},e.prototype.getServiceWorkerDataSourceHeader=function(){return this.getResponseHeader("X-SERVICEWORKER-DATA-SOURCE")},e.prototype.getStatus=function(){var e=-1;try{e=this._request.status}catch(e){}return"number"==typeof e?e:-1},e.prototype.getAuthenticationRedirect=function(){return this.getResponseHeader("X-Forms_Based_Auth_Required")},e.prototype.getResponseType=function(){return this._request.responseType},e.prototype.getResponseText=function(){return this._request.responseType&&"text"!==this._request.responseType?this._request.response:this._request.responseText},e.prototype.getErrorResponseText=function(){return"blob"===this._request.responseType?{status:this._request.status,statusText:this._request.statusText,infected:!!this.getResponseHeader(O),authenticate:this.getResponseHeader(y)}:this.getResponseText()},e.prototype.parseError=function(){var e=this,t=new r.e;return this._request.responseType&&"text"!==this._request.responseType?"blob"===this._request.responseType?function(e){var t,n=new r.e,a=function(){if(t.result){var e=void 0;try{e=JSON.parse(t.result),n.complete(e)}catch(e){n.complete({message:"Unable to parse blob result."})}}},i=function(){n.complete({message:"Unable to read blob error response."})};try{(t=new FileReader).addEventListener("load",a),t.addEventListener("error",i),t.readAsText(e)}catch(e){i()}return n.getPromise().then(function(e){return t&&(t.removeEventListener("load",a),t.removeEventListener("error",i)),e})}(this._request.response).then(function(n){var a={data:n,status:e.getStatus(),statusText:e._request.statusText,infected:!!e.getResponseHeader(O),authenticate:e.getResponseHeader(y)};t.complete(a)}):t.complete(this._request.response):t.complete(this._request.responseText),t.getPromise()},e.prototype.getValue=function(t){var n;switch(t){case e.DataValueKeys.SourceURL:n=this.getSourceUrl();break;case e.DataValueKeys.CorrelationId:n=this.getCorrelationId();break;case e.DataValueKeys.Status:n=this.getStatus();break;case e.DataValueKeys.AuthenticationRedirect:n=this.getAuthenticationRedirect();break;case e.DataValueKeys.ResponseText:n=this.getResponseText();break;case e.DataValueKeys.ErrorResponseText:n=this.getErrorResponseText()}return n},e.prototype.getRedirectUrl=function(){return this._isCanaryRequest?403===this.getStatus()?this.shouldRedirectToErrorCustomPromptLocation()?this.getRedirectToErrorCustomPromptLocation():this.getRedirectLoginPageUrl():this.getAccessDeniedRedirectUrl():403===this.getStatus()||401===this.getStatus()?this.shouldRedirectToErrorCustomPromptLocation()?this.getRedirectToErrorCustomPromptLocation():this.getRedirectLoginPageUrl():void 0},e.prototype.getRedirectLoginPageUrl=function(){var e,t=this.getAuthenticationRedirect();if(t){var n=new h.t(t);n.setQueryParameter("ReturnUrl",b.e.encodeURIComponent(window.location.href)),e=n.toString()}else if(!g.e.isActivated("E01ED707-3C9F-4CD5-8ADF-8A5484D4A861","04/18/2023","Construct redirectUrl targetting Default.aspx")){var a=g.e.isActivated("46AD8143-4179-406B-83E3-582A1DD3F543","07/21/2023","Use location to determine redirectUrl, in case of cross site calls")?new u.e(this._url).authority:new u.e(window.location.href).authority;a&&(e="".concat(a,"/_forms/Default.aspx?ReturnUrl=").concat(encodeURIComponent(location.href)));var i=this.getResponseHeader("Reauthid");if(v.n.isFeatureEnabled({ODB:60017})&&i){var r=new URL(location.href);r.searchParams.append("reauthid",i),e=r.toString()}}return e},e.prototype.getAccessDeniedRedirectUrl=function(){var e;if(this._webAbsoluteUrl){var t=this._webAbsoluteUrl+"/_layouts/15/AccessDenied.aspx";if(t){var n=new h.t(t);n.setQueryParameter("Source",b.e.encodeURIComponent(window.location.href)),n.setQueryParameter("Type","list"),n.setQueryParameter("correlation",b.e.encodeURIComponent(this.getCorrelationId())),e=n.toString()}}return e},e.prototype.getRedirectToErrorCustomPromptLocation=function(){var e=this.getResponseHeader("X-SPO-ErrorCustomPromptLocation"),t=new h.t(e);return t.setQueryParameter("ReturnUrl",window.location.href),t.toString()},e.prototype.shouldRedirectToErrorCustomPromptLocation=function(){var e=this.getResponseHeader(I),t=this.getResponseHeader("sharepointerror");return"9.3"===e||"-2130575129"===t},e.prototype.getResponseHeadersDictionary=function(){var e={},t=this.getAllResponseHeaders();if(t){var n=t.trim().split(/[\r\n]+/);n&&n.length>0&&n.forEach(function(t){var n=t.split(": "),a=n.shift(),i=n.join(": ");e[a]=i})}return this.getResponseHeadersDictionary=function(){return e},e},e.prototype.getResponseHeader=function(e){var t=this.getResponseHeadersDictionary();return t[e.toLowerCase()]||t[e]||this._request.getResponseHeader(e)},e.prototype.getHeaderNumberValue=function(e){var t=this.getResponseHeader(e),n=Number(t);return isNaN(n)?void 0:n},e.DataValueKeys={SourceURL:"SourceUrl",CorrelationId:"CorrelationId",Status:"Status",AuthenticationRedirect:"AuthenticationRedirect",ResponseText:"ResponseText",ErrorResponseText:"ErrorResponseText",GroupThrottle:"GroupThrottle"},e}(),E=n(71),A=n(46),L=function(){function e(e){var t;void 0===e&&(e={}),this._scope=new E.e,this._events=this._scope.attach(new A.t(this));var n=e.webAbsoluteUrl||e.webUrl;this._webServerRelativeUrl=e.webServerRelativeUrl||n&&new h.t(n).getPath(),"/"===this._webServerRelativeUrl&&(this._webServerRelativeUrl=""),g.e.isActivated("5F6AAA43-30D4-4E2C-B9CF-76C77A7F48DE","10/04/2022","Always use token provider to fetch tokens")?n?(this._webAbsoluteUrl=n,this._alwaysGetDigest=!0):this._alwaysGetDigest=!1:this._alwaysGetDigest=null!==(t=e.alwaysGetDigest)&&void 0!==t&&t,this._needsRequestDigest=!1!==e.needsRequestDigest,this._needsRequestDigest&&this._tryLoadDigest(e.formDigest),this._requestCanaryForAuth=!1,this._engagement=e.engagement,this._operationName=e.operationName}return e._isValidFormDigest=function(e){return e&&e.serverTime&&Date.now()-new Date(e.serverTime).getTime()<1e3*(e.formDigestTimeoutSeconds-60)},e.prototype.dispose=function(){this._scope.dispose()},e.prototype.abort=function(){if(this._currentRequest){var e=this._currentRequest;e.isCancelled=!0,e.abort(),this._currentRequest=void 0}},e.prototype.isRequestActive=function(){return!!this._currentRequest},e.prototype.getServerDataFromUrl=function(e){var t=this,n=e.url,a=e.successCallback,i=e.failureCallback,r=e.uploadProgressCallback,o=e.additionalPostData,s=e.isRest,c=void 0===s||s,d=e.method,l=void 0===d?"POST":d,u=e.withCredentials,f=e.additionalHeaders,p=e.contentType,m=e.noRedirect,_=e.responseType,h=e.needsRequestDigest,b=void 0===h?this._needsRequestDigest:h,v=(new Date).toISOString(),y=new XMLHttpRequest;y.open(l,n,!0),"boolean"==typeof u&&(y.withCredentials=u),_&&(y.responseType=_);var S=!g.e.isActivated("2368CF71-4213-4E1D-A3BA-BFCC77F2AD83","25/08/2023","Use browser set Content-Type header for FormData requests")&&o instanceof FormData;p?y.setRequestHeader("Content-Type",p):S||(c?y.setRequestHeader("Content-Type","application/json;odata=verbose"):y.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));var D=!1;if(f)for(var I in f)I&&(y.setRequestHeader(I,f[I]),"accept"===I.toLowerCase()&&(D=!0));D||y.setRequestHeader("accept","application/json;odata=verbose"),this._currentRequest=y;var x=function(e){b&&e&&y.setRequestHeader("x-requestdigest",e),t._events.on(y,"readystatechange",function(){t._onReadyStateChange(y,n,a,i,m,v)}),r&&y.upload&&t._events.on(y.upload,"progress",function(e){r(e)}),y.send(o)};b?this._ensureRequestDigest(x,i):x()},e.prototype.ensureRequestDigest=function(e,t){this._ensureRequestDigest(e,t)},e.prototype._ensureRequestDigest=function(t,n){var a=e._formDigests[this._webServerRelativeUrl];!this._alwaysGetDigest&&e._isValidFormDigest(a)?t(a.formDigestValue):this._ensureRequestDigestWorker(t,n)},e.prototype._ensureRequestDigestWorker=function(t,n){var a=this,r=new Date,o=new e({needsRequestDigest:!1,webServerRelativeUrl:this._webServerRelativeUrl,webUrl:void 0});t||(o._requestCanaryForAuth=!0);var s=this._webAbsoluteUrl||this._webServerRelativeUrl;"string"==typeof s?(e._requestDigestPromise||(e._requestDigestPromise=new i.t(function(i,c){o.getServerDataFromUrl({url:h.t.concatenate(s,"/_api/contextinfo"),successCallback:function(t){var n=t.getResponseText(),o=JSON.parse(n).d.GetContextWebInformation;e._formDigests[a._webServerRelativeUrl]={serverTime:r.toISOString(),formDigestValue:o.FormDigestValue,formDigestTimeoutSeconds:o.FormDigestTimeoutSeconds-60,updateFormDigestPageLoaded:new Date},i(e._formDigests[a._webServerRelativeUrl].formDigestValue),e._requestDigestPromise=void 0},failureCallback:function(a,i){t?t(void 0):n&&n(a,i),c(void 0),e._requestDigestPromise=void 0},method:"POST",noRedirect:!!n})})),e._requestDigestPromise.then(function(e){return t&&t(e),e})):n&&n(void 0,new l.e({code:"MissingWebForDigestAuth",isExpected:!1}))},e.prototype._onReadyStateChange=function(t,n,a,i,r,o){var s;if(4===t.readyState)if(this._currentRequest=void 0,this._events.off(t),t.upload&&this._events.off(t.upload),(s=t)&&s.isCancelled)i(void 0,new l.e({code:"RequestAborted",isExpected:!0}));else if(function(e){try{if(4===e.readyState&&(void 0===e.status||0===e.status))return!1}catch(e){return!1}return!0}(t)){var c=new w(t,n,{webAbsoluteUrl:this._webAbsoluteUrl||this._webServerRelativeUrl,isCanaryRequest:this._requestCanaryForAuth}),d=c.getStatus(),u=!r&&c.shouldRedirectToErrorCustomPromptLocation();if(this._requestCanaryForAuth){if(this._requestCanaryForAuth=!1,403===d){var f=c.getRedirectLoginPageUrl();try{u?window.location.href=c.getRedirectToErrorCustomPromptLocation():i(c)}catch(e){}f&&!r&&(window.location.href=f)}else{f=c.getAccessDeniedRedirectUrl();try{i(c)}catch(e){}f&&!r&&(this._engagement&&this._engagement.logData({name:"AccessDeniedRedirect",isIntentional:!1,extraData:{originalOperation:this._operationName||""}}),window.location.href=f)}return}if(200===d||201===d||204===d)return void a(c);if(403===d)return e._requestDigestPromise=void 0,void(r?this._ensureRequestDigestWorker(void 0,function(e,t){return i(c,t)}):u?window.location.href=c.getRedirectToErrorCustomPromptLocation():this._ensureRequestDigestWorker(void 0));401===d&&u&&(window.location.href=c.getRedirectToErrorCustomPromptLocation()),i(c)}else i(void 0,new l.e({code:_,isExpected:!0}))},e.prototype._tryLoadDigest=function(t){if(e._isValidFormDigest(t))e._formDigests[this._webServerRelativeUrl]=t;else{var n=e._formDigests[this._webServerRelativeUrl];e._isValidFormDigest(t)&&(!e._isValidFormDigest(n)||n&&new Date(n.serverTime).getTime()<new Date(t.serverTime).getTime())&&(e._formDigests[this._webServerRelativeUrl]=t)}},e._formDigests={},e._requestDigestPromise=void 0,e}();function k(e){var t=e.options,n=t.url,r=t.authToken,o=t.telemetryHandler,s=t.useExactAuthToken,d=t.method,l=t.additionalHeaders,u=e.dataSyncClient,f=e.aadUserId,p=e.getData,m=function(){return p({url:n,telemetryHandler:o,authToken:r,useExactAuthToken:s})};return f?i.t.resolve(u).then(function(e){return e?function(e){var t=function(e,t){return function(n,i){var r=n.eventData,o=r.extraData,s={performanceEntry:o&&o.performanceEntry,httpStatus:o&&o.HttpStatus,correlationId:o&&o.CorrelationId,succeeded:r&&r.resultType===c.t.Success||!1,resultCode:r&&r.resultCode,endpoint:i},d=t&&t(n),l=e.onRequestComplete(s);return o.dataSyncQos=e.getQosInfo(),Object(a.e)(Object(a.e)({},d||{}),{eventData:Object(a.e)(Object(a.e)({},d?d.eventData:r),{extraData:Object(a.e)(Object(a.e)({},d?d.eventData.extraData:r.extraData),e.getQosInfo())}),canRetry:l&&(!d||d.canRetry)})}}(e,o);return e.getData({url:n,method:d,additionalHeaders:l},function(e,n){return p({url:e.url,authToken:e.authToken,telemetryHandler:function(n){return t(n,e)},useExactAuthToken:!0,additionalHeaders:n})},m)}(e):m()}):m()}var M=n(97),P=n(35),T=n(408),U=n(443);function F(e){var t=e.options,n=e.webAbsoluteUrl,r=e.apiEvent,o=e.tokenProvider,s=e.getData,c=e.qosName,d=t.url,f=new u.e(d),p="".concat(f.authority,"/{ length: ").concat(f.path.length,", segments: ").concat(f.segments.length," }"),m=function(e,t){if(!o.getAuthToken)return i.t.resolve({authToken:void 0});var n=new r({name:"".concat(c,".getAuthToken").concat(t?".retry":""),url:p});return i.t.resolve(o.getAuthToken(e)).then(function(e){return e&&"string"!=typeof e?(n.end({resultType:P.e.Success,resultCode:e.authToken?"tokenAuth":"cookieAuth",extraData:{AuthCorrelationId:e.correlationId,AuthExpiration:e.expiresOn}}),e):(n.end({resultType:P.e.Success,resultCode:e?"tokenAuth.string":"cookieAuth.string"}),{authToken:e})}).catch(function(e){return n.end(Object(T.e)(e)),i.t.reject(e)})},_=function(e,t){if(!o.getFormDigest)return i.t.resolve(void 0);var n=new r({name:"".concat(c,".getAuthToken").concat(t?".retry":""),url:p});return i.t.resolve(o.getFormDigest(e)).then(function(e){return n.end({resultType:P.e.Success,resultCode:e?"newDigest":"sameDigest"}),e}).catch(function(e){return n.end(Object(T.e)(e)),i.t.reject(e)})};if(!m&&!_)return s({url:d});if(!g.e.isActivated("1BFD6EB7-B8E4-42E1-93FF-12D3DB9BAE18","10/05/2023","Validate domain for auth token")&&n&&!Object(U.e)(d,encodeURI(n)))throw new l.e({code:"TargetUrlDoesNotBeginWithWebAbsoluteUrl"});var h={url:d,webAbsoluteUrl:n,claimsChallenge:t.claimsChallenge},b={url:d,webAbsoluteUrl:n,claimsChallenge:t.claimsChallenge};return m(h,!1).then(function(e){return e.authToken?e:_(b,!1).then(function(t){return e})}).then(function(e){return s({url:d,authToken:e.authToken,qosExtraData:{AuthCorrelationId:e.correlationId,AuthExpiration:e.expiresOn}}).catch(function(t){if(v.n.isFeatureEnabled({ODB:1435})){var n=void 0;return N(t)?n={claimsChallenge:{authToken:e.authToken,claims:R(t),error:t}}:(j(t)||B(t))&&(n={expiration:{authToken:e.authToken,error:t}}),n?m(Object(a.e)(Object(a.e)({},h),n),!0).then(function(n){if(!n.authToken){var r=void 0;return N(t)?r={claimsChallenge:{claims:R(t),error:t}}:(j(t)||B(t))&&(r={expiration:{error:t}}),_(Object(a.e)(Object(a.e)({},b),r),!0).then(function(e){return n})}return n.authToken===e.authToken?i.t.reject(t):n}).then(function(e){return s({url:d,authToken:e.authToken,qosExtraData:{AuthCorrelationId:e.correlationId,AuthExpiration:e.expiresOn}})}).catch(function(e){return i.t.reject(e)}):i.t.reject(t)}if(e.authToken&&(n=void 0,N(t)?n={claimsChallenge:{authToken:e.authToken,claims:R(t),error:t}}:j(t)&&(n={expiration:{authToken:e.authToken,error:t}}),n))return m(Object(a.e)(Object(a.e)({},h),n),!0).then(function(n){return n.authToken&&n.authToken!==e.authToken?s({url:d,authToken:n.authToken,qosExtraData:{AuthCorrelationId:n.correlationId,AuthExpiration:n.expiresOn}}):i.t.reject(t)});if(o.getFormDigest){var r=void 0;if(N(t)?r={claimsChallenge:{claims:R(t),error:t}}:(j(t)||!g.e.isActivated("D82A42B5-F515-45E0-AD3A-A6F5AB8B090B","05/17/2023","add handling of authentication error")&&B(t))&&(r={expiration:{error:t}}),r)return _(Object(a.e)(Object(a.e)({},b),r),!0).then(function(e){return s({url:d})})}return i.t.reject(t)})})}var H="Bearer";function R(e){var t=e.authenticate,n='claims="';if(t){var a=t.indexOf(n);if(a>-1){var i=t.indexOf('"',a+n.length);if(i>-1){var r=t.slice(a+n.length,i);return g.e.isActivated("93E9F77D-7B3B-4760-B58F-1154E9E530ED","06/02/2022","Decode claims from base64")?r:atob(r)}}}}function N(e){var t=e.authenticate;return!!(t&&t.slice(0,H.length)===H&&t.indexOf('error="insufficient_claims"')>-1)}function B(e){return!!e.authenticate}function j(e){var t=e.code;return"3000002,invalid_client"===t||"10013"===t||"917656"===t}var V=n(228),z=g.e.isActivated("937A3141-0674-4F3C-B6F6-AACCD3BFD1DD","08/11/2023","Prioritize page context auth token when present"),G="undefined"!=typeof window?window:void 0,K=G&&G.performance,W=g.t.isActivated("00babe87-7679-4e02-94f0-4c05915282ca","3/29/2023"),q=function(){function e(e,t){var n,a,i,r,c,d,l,u,f;this._pageContext=t?t.pageContext:e.pageContext,this._tokenProvider=null!==(n=null==t?void 0:t.tokenProvider)&&void 0!==n?n:null===(a=this._pageContext)||void 0===a?void 0:a.tokenProvider,this._dataSyncClient=null!==(i=null==t?void 0:t.dataSyncClient)&&void 0!==i?i:null===(r=this._pageContext)||void 0===r?void 0:r.dataSyncClient,this._qosName=e.qosName,this._apiEvent=null!==(c=null==t?void 0:t.apiEvent)&&void 0!==c?c:o.t,this._engagement=null!==(d=null==t?void 0:t.engagement)&&void 0!==d?d:s.e,this._normalizeErrors=!!e.normalizeErrors,this._getDataWithTokenProvider=null!==(l=null==t?void 0:t.getDataWithTokenProvider)&&void 0!==l?l:F,this._getDataWithSyncClient=null!==(u=null==t?void 0:t.getDataWithSyncClient)&&void 0!==u?u:k,this._offlineDetection=null==t?void 0:t.offlineDetection,this._noRedirect=null!==(f=null==t?void 0:t.noRedirect)&&void 0!==f?f:!!(null==t?void 0:t.tokenProvider)||void 0}return e.parseJSON=function(e){return e&&JSON.parse(e)||void 0},e.prototype.getData=function(t){var n=this,o=t.parseResponse,s=void 0===o?e.parseJSON:o,h=t.qosExtraData,b=t.additionalPostData,O=void 0===b?"":b,w=t.contentType,E=t.method,A=void 0===E?"POST":E,k=t.maxRetries,P=void 0===k?0:k,T=t.responseType,U=t.onUploadProgress,F=t.timeout,H=t.noTimeoutInLastRetry,R=void 0!==H&&H,N=t.webAbsoluteUrl,B=t.allowOAuth,j=void 0===B||B,q=t.customerPromise,Q=this._pageContext,Y=this._tokenProvider,J=this._getDataWithTokenProvider,X=this._getDataWithSyncClient,Z=[];this._qosName&&Z.push(this._qosName),t.qosName&&Z.push(t.qosName);var $=Z.join("."),ee=function(e){var o=e.url,b=e.telemetryHandler,E=e.authToken,k=e.useExactAuthToken,H=void 0!==k&&k,B=e.additionalHeaders,X=!0,Z=new u.e(o),ee="".concat(Z.authority,"/{ length: ").concat(Z.path.length,", segments: ").concat(Z.segments.length," }"),te=function(e){var E=e.authToken,k=e.qosExtraData,z=t.crossSiteCollectionCall,J=void 0!==z&&z,Z=t.noRedirect,te=void 0===Z?n._noRedirect:Z,ne=t.needsRequestDigest,ae=void 0===ne||ne,ie=Object(a.e)(Object(a.e)(Object(a.e)({},t.additionalHeaders),W?{}:B),g.e.isActivated("3404B5AF-0FCD-496E-AE1A-7249248BACFE","10/5/2021","Send CollectSPPerfMetrics header for all SP data requests")?{}:{CollectSPPerfMetrics:C}),re=!!g.e.isActivated("B11E1406-A736-464F-96CB-E2E64BF66881","05/02/2023","add allowOAuth flag to allow or skip OAuth completely (used with Acquire endpoint calls)")||j;if(re&&E){var oe=!1;g.t.isActivated("589c6b39-fbce-42b5-bff1-125e13e2367a","06/09/2021","check if auth token has auth header already, if yes, use exact auth token")||M.e.isFeatureEnabled({ECS:86137})||E.split(" ").length>1&&(oe=!0);var se=H||oe?E:"Bearer ".concat(E),ce=!1;for(var de in ie)de&&"authorization"===de.toLowerCase()&&(ce=!0);ce||(ie.Authorization=se),J=!0,ae=!1,te=!0}else re&&v.n.isFeatureEnabled({ODB:60959})&&Y&&(ie.Authorization="Bearer");var le,ue,fe=new L(Object(a.e)(Object(a.e)({},Q?Object(a.e)(Object(a.e)({webServerRelativeUrl:Q.webServerRelativeUrl},g.e.isActivated("5F6AAA43-30D4-4E2C-B9CF-76C77A7F48DE","10/04/2022","Always use token provider to fetch tokens")?{webAbsoluteUrl:J?Q.webAbsoluteUrl:N}:{webAbsoluteUrl:N||Q.webAbsoluteUrl,alwaysGetDigest:J}),{formDigest:{serverTime:Q.serverTime,updateFormDigestPageLoaded:Q.updateFormDigestPageLoaded,formDigestValue:Q.formDigestValue,formDigestTimeoutSeconds:Q.formDigestTimeoutSeconds}}):{}),{needsRequestDigest:ae,engagement:n._engagement,operationName:n._qosName})),pe=G&&G.location&&new u.e(G.location.href).authority,me=new u.e(o).authority,_e=d.e.getRUMOneLogger(),he=Date.now();return _e&&(Boolean(_e.readTempData("appDataFetchStart"))||_e.saveTempData("appDataFetchStart",he)),function(e){var t,n=e.onExecute,a=e.onCancel,o=e.timeout,s=e.canRetry,c=e.noTimeoutInLastRetry,d=0,l=Math.max(e.maxRetries,0),u=function(){var e=new i.t(n,function(){a(d>=l||!s())});return o&&(!c||d<l)?i.t.timeout(o,e):e};return t=d<l?function(e){var t,n=e.adjustRetries,a=e.async,i=e.beforeRetry,o=e.callback,s=e.canRetry,c=void 0===s?function(){return!0}:s,d=e.delay,l=e.resetAttemptsOnRestart,u=e.retries,f=e.shouldRestart,p=0,m=new r.e(function(){t.cancel()});function _(e){f&&f()?(l&&(p=0),b()):m.complete(e)}function h(e){n&&(u=n(e)),p<u&&c(e)?(p++,i&&i(),"number"==typeof d&&a?a.setTimeout(b,d):b()):m.error(e)}function b(){(t=o()).then(_,h)}return b(),m.getPromise()}({canRetry:s,retries:l,callback:u,beforeRetry:function(){d++}}):u(),t}({timeout:F,onExecute:function(e,i){var r,d=function(t,r){return function(d){var l=d.getResponseText();ue=d.getServiceWorkerDataSourceHeader();var u,m,_,g,v=Object(f.e)(o,r),y=Object(a.e)(Object(a.e)(Object(a.e)(Object(a.e)({},h||{}),{needsRequestDigest:ae,hasAuthToken:!!E,isCrossOrigin:!!pe&&pe!==me,CorrelationId:d.getCorrelationId()}),k||{}),{HttpStatus:d.getStatus(),serviceWorkerDataSource:ue||void 0,rawRequestDuration:v.duration,performanceEntry:JSON.stringify(v),serviceWorkerFetchInfo:d.getResponseHeader("X-ServiceWorkerFetchInfo")||void 0,SQLRT:d.getHeaderNumberValue(C),ServerDuration:d.getHeaderNumberValue("SPClientServiceRequestDuration")}),S=!1;try{!function(e,t){return"blob"===e&&t&&"object"==typeof t}(T,l)?m=s(l,d):_=l,S=!0}catch(e){u=e,g={resultType:c.t.Failure,resultCode:"InvalidJSON",error:"object"==typeof e?JSON.stringify(e):e,extraData:y}}if(g||(g={resultType:c.t.Success,extraData:y}),b&&(g=b({response:m,eventData:g,serverData:d}).eventData),t.end(g),S)try{e(_||m)}catch(e){}else i(n._normalizeErrors?new p.e({code:"-1,parse_response",innerError:u,errorData:{correlationId:d.getCorrelationId(),status:d.getStatus()}}):void 0);fe=void 0}},u=function(e,r){return function(s,d){var u=Object(f.e)(o,r),v=Object(a.e)(Object(a.e)({},h||{}),{needsRequestDigest:ae,hasAuthToken:!!E,isCrossOrigin:!!pe&&pe!==me,rawRequestDuration:u.duration,performanceEntry:JSON.stringify(u)}),C="undefined"!=typeof navigator&&!1===navigator.onLine;if(n._offlineDetection&&(C=n._offlineDetection.offline),!s){var w=m,A=!0,L=0;d&&d instanceof l.e&&(w=d.code,A=d.isExpected,L=-1),!C||w!==_&&w!==m||(w="Offline");var k={status:L,code:w},M={resultType:A?c.t.ExpectedFailure:c.t.Failure,resultCode:w,extraData:v};return b&&(M=b({eventData:M,errorData:k}).eventData),e.end(M),void i(n._normalizeErrors?new p.e({errorData:k,innerError:d}):k)}var P=function(r){var o=void 0,d=function(e){var t=!1,n={order:[],map:{}},a=e.getResponseHeader(S);if(a)try{var i=/(\d+)(?:;reason="([^"]+?)")?(?:;category="([^"]+?)")?/.exec(a),r=i[1],o=void 0===r?"-1":r,s=i[2],c=void 0===s?"":s,d=i[3],l=void 0===d?"unknown":d;switch(Number(o)){case 3e6:case 3000003:case 3000006:case 3001003:case 3001004:case 3001005:case 3002e3:case 3004009:case 3004010:case 3003e3:t=!0;break;default:t=!1}var u={source:S,code:"".concat(o,",").concat(l),message:c,isDisplayable:!0};n.order.push(u.source),n.map[u.source]=u}catch(e){}var f=e.getResponseHeader(x);if(f)try{var p=/(\d+);\s+(.+)/.exec(f),m=p[1],_=void 0===m?"-1":m,h=p[2];u={source:x,code:_,message:c=void 0===h?"":h,isDisplayable:!1},n.order.push(u.source),n.map[u.source]=u}catch(e){}if(!g.e.isActivated("653DFB77-4F5B-4F7E-BAAE-0AA791061E25","03/30/2023","Add extra error codes")){var b=e.getResponseHeader(I);if(b){var v=e.getResponseHeader("X-SPO-ErrorMessage");u={source:I,code:b,message:v,isDisplayable:!0},n.order.push(u.source),n.map[u.source]=u}}if(!g.e.isActivated("32B53DE1-9D7F-48EE-BE6A-6D02852E7030","03/30/2023","Add extra error codes")){var y=e.getResponseHeader(D);y&&(u={source:D,code:y},n.order.push(u.source),n.map[u.source]=u)}return{codes:n,isExpected:t}}(s),l=d.isExpected,u=d.codes;if("object"==typeof r&&"number"==typeof r.status)o=r;else if("string"==typeof r){var f=void 0;try{f=JSON.parse(r)}catch(e){}if(f)if(f.error_description)o={code:"-1,".concat(f.error||"Unknown"),message:f.error_description},"policy_enforced"===f.error&&(l=!0);else if("string"==typeof f.error)o={message:f.error};else if(f.error&&f.error.message&&f.error.message.value){var _={source:p.t.spServiceResponse,code:f.error.code,message:"".concat(f.error.message.value),isDisplayable:!0};u.order.push(_.source),u.map[_.source]=_,o=f.error}else o=f.error||f["odata.error"]||{responseData:f};else if(r&&!g.e.isActivated("9F364C4C-7016-42DE-8C8C-36891B606E25","11/11/2023","Read HTML error for 400 Unknown")&&400===s.getStatus()){var h;h=function(e){return/<html[^>]*>[\s\S]*?<body[^>]*>[\s\S]*?<\/body>[\s\S]*?<\/html>/i.test(e)}(r)?function(e){var t=e.match(/<body[^>]*>[\s\S]*<\/body>/i);return t?t[0]:""}(r).slice(0,1e3):r.slice(0,1e3),o={code:"-1,HTMLResult",message:h},v=Object(a.e)(Object(a.e)({},v),{rawUrl:t.url,rawPayload:O})}}var w=s.getStatus(),E=s.getCorrelationId(),A=s.getResponseHeader("SPGroupThrottle"),L=s.getResponseHeader(x);if(v=Object(a.e)(Object(a.e)({},v),{CorrelationId:E,HttpStatus:w,GroupThrottle:A,MSCorrelationVector:s.getResponseHeader("MS-CV")}),(401===w&&L||403===w||404===w||429===w||503===w||-1===w||0===w&&C)&&(X=!1,l=!0),400===w){var k=function(e){var t={order:[],map:{}};if(!g.e.isActivated("389A4BF0-3228-454F-8BCC-BD561B9B1DBE","10/26/2023","Add code for MSEdgeRef with static code")){var n,a="No X-Msedge-Ref details",i=e.getResponseHeader("X-Msedge-Ref");n=i?{source:D,code:"Non-Empty X-Msedge-Ref details",message:i}:{source:D,code:a,message:a},t.order.push(n.source),t.map[n.source]=n}return{codes:t,isExpected:!1}}(s);Array.prototype.push.apply(u.order,k.codes.order),k.codes.order.forEach(function(e){u.map[e]=k.codes.map[e]}),g.e.isActivated("9F364C4C-7016-42DE-8C8C-36891B606E25","11/11/2023","Read HTML error for 400 Unknown")||v.rawUrl||v.rawPayload||(v=Object(a.e)(Object(a.e)({},v),{rawUrl:t.url,rawPayload:O}))}(o=o||{}).codes=u,o.status=w,o.retryAfter=s.getHeaderNumberValue("Retry-After"),o.authenticate=s.getResponseHeader(y),!g.e.isActivated("892484e8-2020-4fce-b619-d246a23a8f41","12/08/2023","If context is failed, Mark expected failure")&&o.authenticate&&(l=!0),E&&(o.correlationId=E),A&&(o.groupThrottle=A);var M=o["@error.redirectUrl"],P=s.getRedirectUrl()||M;P&&(l=!0,o.redirectUrl=P);var T=JSON.stringify(o),U=u.map[p.t.spServiceResponse];U&&n._normalizeErrors&&!g.e.isActivated("B4426688-76EA-4718-8166-1A4F69314E42","04/18/2023","Simplify SPO message structure")&&(o.message=U.message);var F=u.order[0];F&&(_=u.map[F])&&(F===I&&_.message?(o.code="XSPOErrorMessage",o.message=_.message):_.code&&(o.code=_.code)),o.code||(o.code=m);var H="[".concat(w,"] ").concat(o.code),R={resultType:l?c.t.ExpectedFailure:c.t.Failure,error:T,resultCode:H,extraData:v};if(b){var N=b({eventData:R,errorData:o,serverData:s}),B=N.eventData,j=N.canRetry;B&&(R=B),!0!==j&&!1!==j||(X=j),R.resultType===c.t.ExpectedFailure&&(l=!0)}var V=n._normalizeErrors?new p.e({errorData:o,isExpected:l}):o;V.codes&&V.codes&&(R.extraData.errorCodes=JSON.stringify(V.codes.map)),e.end(R),i(V)},T=s.getResponseType();T&&"text"!==T?s.parseError().then(P):P(s.getResponseText())}};r=function(){var e;e=le=!g.e.isActivated("B27DA5D9-B6F0-4648-9E59-4700ABA3836F")&&q?new(function(e){function t(t){var n=e.call(this,t)||this;return t.pillar&&(n._customerPromise=new V.e({scenario:t.name,pillar:t.pillar,extraData:Object(a.e)(Object(a.e)({},null==t?void 0:t.extraData),{isFromQosEvent:!0})}),t.veto&&(n._computeVeto=t.veto)),n}return Object(a.a)(t,e),t.prototype.end=function(t){this._customerPromise&&this._customerPromise.end({resultType:null==t?void 0:t.resultType,errorCode:null==t?void 0:t.resultCode,veto:this._computeVeto?this._computeVeto(t):"None",extraData:Object(a.e)(Object(a.e)({},null==t?void 0:t.extraData),{isFromQosEvent:!0})}),e.prototype.end.call(this,t)},t}(n._apiEvent))({url:ee,name:$,pillar:(null==q?void 0:q.pillar)?q.pillar:void 0,veto:(null==q?void 0:q.veto)?q.veto:void 0}):new n._apiEvent({url:ee,name:$});var t=K&&K.now();fe.getServerDataFromUrl({url:o,successCallback:d(e,t),failureCallback:u(e,t),uploadProgressCallback:U,additionalPostData:O,method:A,additionalHeaders:ie,contentType:w,withCredentials:!E&&void 0,noRedirect:te,responseType:T,needsRequestDigest:ae})},r()},maxRetries:P,noTimeoutInLastRetry:R,canRetry:function(){return X},onCancel:function(e){fe&&(fe.abort(),e&&fe.dispose())}}).then(function(e){return fe&&fe.dispose(),e},function(e){return fe&&fe.dispose(),!le.endTime&&i.t.isCanceled(e)&&le.end({resultCode:"Canceled",resultType:c.t.ExpectedFailure}),i.t.reject(e)})};if(E)return i.t.resolve(E).then(function(e){return te({url:o,authToken:e})});if(!z&&(null==Q?void 0:Q.authToken))return i.t.resolve(Q.authToken).then(function(e){return te({url:o,authToken:e})});if(Y)return J({apiEvent:n._apiEvent,getData:te,options:{url:o,authToken:t.authToken,qosExtraData:t.qosExtraData,claimsChallenge:t.claimsChallenge},webAbsoluteUrl:!g.e.isActivated("5F6AAA43-30D4-4E2C-B9CF-76C77A7F48DE","10/04/2022","Always use token provider to fetch tokens")&&N||Q&&Q.webAbsoluteUrl,qosName:$,tokenProvider:Y});if(Q){if(Q.getAuthToken)return i.t.resolve(Q.getAuthToken()).then(function(e){return te({url:o,authToken:e})});if(z&&Q.authToken)return i.t.resolve(Q.authToken).then(function(e){return te({url:o,authToken:e})})}return te({url:o})},te={authToken:t.authToken,telemetryHandler:t.telemetryHandler,url:t.url,useExactAuthToken:t.useExactAuthToken,method:t.method,additionalHeaders:t.additionalHeaders};return this._dataSyncClient&&!t.skipSyncClient?X({options:te,aadUserId:null==Q?void 0:Q.aadUserId,dataSyncClient:this._dataSyncClient,getData:ee}):ee(te)},e}();t.t=q},432:function(e,t,n){"use strict";n.d(t,"e",function(){return f});var a=n(135),i=function(){function e(e){this._scope=new a.e,this._targetMap=new WeakMap,this._disposableMap=new WeakMap}return e.prototype.on=function(e,t,n){var a;if(r(e))a=e;else{var i=this._targetMap.get(e);i?a=i:(a=new EventTarget,this._targetMap.set(e,a))}a.addEventListener(t,n);var o=this._disposableMap.get(e);o||(o=new Map,this._disposableMap.set(e,o));var s=this._scope.attach({dispose:function(){a.removeEventListener(t,n)}});o.set(t,s)},e.prototype.off=function(e,t,n){var a;if(r(e))a=e;else{var i=this._targetMap.get(e);i&&(a=i)}var o=this._disposableMap.get(e);if(o){var s=o.get(t);s&&(s.dispose(),o.delete(t)),0===o.size&&this._disposableMap.delete(e)}a&&a.removeEventListener(t,n)},e.prototype.dispose=function(){this._scope.dispose()},e}();function r(e){return!!e.addEventListener}var o=function(){function e(e){this._scope=new a.e,this._timeoutMap=new Map}return e.prototype.setTimeout=function(e,t){var n=this,a=setTimeout(function(){n._timeoutMap.delete(a),e()},t),i=this._scope.attach({dispose:function(){clearTimeout(a)}});return this._timeoutMap.set(a,i),a},e.prototype.clearTimeout=function(e){var t=this._timeoutMap.get(e);t&&(this._timeoutMap.delete(e),t.dispose())},e.prototype.dispose=function(){this._scope.dispose()},e}(),s="handlerRejection",c="canceled",d=0,l=function(){function e(e,t){void 0===t&&(t={});var n=this,r=new Map,d={onCommand:e.onCommand,onNotification:e.onNotification},l=e.initResources,u=e.initTimeoutMs,f=void 0===u?1e4:u,p=e.ackTimeoutMs,m=void 0===p?1e3:p,_=e.resultTimeoutMs,h=void 0===_?1e4:_,b=t.asyncType,g=void 0===b?o:b,v=t.eventGroupType,y=void 0===v?i:v,S=this._scope=new a.e;S.attach(l);var D,I=this._async=S.attach(new g(this)),x=S.attach(new y(this));this._ackTimeoutMs=m,this._resultTimeoutMs=h,this._invokeCommandHandler=function(e){try{var t=d.onCommand&&d.onCommand(e);return t?Promise.resolve(t).catch(function(e){return{result:"error",error:{code:(e=e||{name:s,isExpected:!1,message:"Unknown error"}).code||e.name||s,message:e.message||"".concat(e)},isExpected:!!e.isExpected}}):Promise.resolve({result:"error",error:{code:"unsupportedCommand",message:e.command},isExpected:!0})}catch(e){return Promise.resolve({result:"error",isExpected:!1,error:{code:"handlerError",message:e&&"Name: ".concat(e.name,"; Message: ").concat(e.message||e)}})}},this._invokeNotificationHandler=function(e){try{d.onNotification&&d.onNotification(e)}catch(e){}};var C=this._port=new Promise(function(t,a){S.attach({dispose:function(){var e=new Error("Initialization canceled.");e.code=c,a(e)}}),D=I.setTimeout(function(){var e=new Error("Initialization timed out after ".concat(f,"ms"));e.code="setupTimeout",a(e)},f),e.init(function(e){I.clearTimeout(D),S.attach({dispose:function(){e.close()}}),x.on(e,"message",function(t){var a=t.data;if(a&&"object"==typeof a)return"acknowledge"===a.type?n._onAcknowledge(a):"command"===a.type?n._onCommand(e,a):"notification"===a.type?n._onNotification(a):"result"===a.type?n._onResult(a):void 0}),e.start(),t(e)},a)});this.ready=C.then(function(){},function(e){return n.dispose(),Promise.reject(e)}),this._signals=r}return e.prototype.dispose=function(){this._scope.dispose(),this._signals.forEach(function(e){e.resolve({result:"error",isExpected:!0,error:{code:c,message:"Messenger disposed"}})}),this._signals.clear()},e.prototype.sendCommand=function(e,t){var n=this;if(void 0===t&&(t={}),this._scope.isDisposed)return Promise.resolve({result:"error",isExpected:!1,error:{code:"disposed",message:"disposed"}});var a=++d,i=t.timeoutDelayMs,r=void 0===i?this._resultTimeoutMs:i,o=t.acknowledgeTimeoutMs,s=void 0===o?this._ackTimeoutMs:o,c=t.transfer;return this._port.then(function(t){var i=n._async,o=new Promise(function(e){n._signals.set(a,{acknowledgeTimeout:i.setTimeout(function(){n._onResult(u(a,"acknowledgeTimeout"))},s),resultTimeout:i.setTimeout(function(){n._onResult(u(a,"resultTimeout"))},r),resolve:e})});return t.postMessage({type:"command",id:a,data:e},c||[]),o})},e.prototype.sendNotification=function(e){this._scope.isDisposed||this._port.then(function(t){t.postMessage({type:"notification",data:e})})},e.prototype._onAcknowledge=function(e){var t=this._signals.get(e.id);t&&this._async.clearTimeout(t.acknowledgeTimeout)},e.prototype._onCommand=function(e,t){var n=t.id;e.postMessage({type:"acknowledge",id:n}),this._invokeCommandHandler(t.data).then(function(t){e.postMessage({type:"result",data:t,id:n})}).catch(function(e){})},e.prototype._onNotification=function(e){this._invokeNotificationHandler(e.data)},e.prototype._onResult=function(e){var t=e.id,n=this._async,a=this._signals,i=a.get(t);i&&(n.clearTimeout(i.acknowledgeTimeout),n.clearTimeout(i.resultTimeout),i.resolve(e.data)),a.delete(t)},e}();function u(e,t){return{id:e,data:{result:"error",error:{code:t,message:"Timed out"},isExpected:!1}}}function f(e,t){void 0===t&&(t={});var n=e.channelId,r=e.onReinitialize,o=e.origin,s=e.receiver,c=void 0===s?window:s,d=e.source,u=e.identifyParent,f=t.eventGroupType,p=void 0===f?i:f,m=t.messengerType,_=void 0===m?l:m,h=new a.e,b=h.attach(new p(null));return new _({onCommand:e.onCommand,onNotification:e.onNotification,init:function(e,t){var a;if(u&&d){var i=setInterval(function(){var e={type:"identify-parent",channelId:n};d.postMessage(e,o)},100);a=h.attach({dispose:function(){clearInterval(i)}})}var s=!1;b.on(c,"message",function(t){var i=t.data;if(t.origin===o&&(!d||t.source===d)&&i&&"object"==typeof i&&"initialize"===i.type&&i.channelId===n){if(a&&a.dispose(),r){if(s)return r(),void b.dispose();s=!0}else b.dispose();var c=i.replyTo;c.postMessage({type:"activate"}),e(c)}})},initResources:h,initTimeoutMs:e.initTimeoutMs,ackTimeoutMs:e.ackTimeoutMs,resultTimeoutMs:e.resultTimeoutMs})}},443:function(e,t,n){"use strict";function a(e,t){var n=e.toUpperCase(),a=t&&t.toUpperCase();return n.substring(0,a&&a.length||0)===a}n.d(t,"e",function(){return a})},470:function(e,t,n){"use strict";n.d(t,"t",function(){return o}),n.d(t,"e",function(){return c});var a=n(0),i=n(55),r=n(7),o={unknown:"Unknown",spServiceResponse:"SPServiceResponse"},s=!r.e.isActivated("05F6D32A-E2A4-45FA-B486-30818AF5FC7E","03/17/2023","Stop process response error in GetDataError. Do it in DataRequestor instead"),c=function(e){function t(n){var i=this,r=n.errorData,o=n.innerError instanceof t&&n.innerError.errorData,c=n.errorData||o||{status:0},d=c.message,l=void 0===d?void 0:d,u=c.correlationId,f=void 0===u?void 0:u,p=c.code,m=void 0===p?void 0:p,_=Object(a.r)(c,["message","correlationId","code"]),h="object"==typeof l?l?"string"!=typeof l.value||s?JSON.stringify(l):l.value:"".concat(l):l,b=r&&r.codes||{order:[],map:{}};if(o&&o.codes)for(var g=0,v=o.codes.order;g<v.length;g++){var y=v[g];b.map[y]||(b.order.push(y),b.map[y]=o.codes.map[y])}var S=Object(a.e)(Object(a.e)(Object(a.e)(Object(a.e)(Object(a.e)({},"string"==typeof f?{correlationId:f}:{}),"string"==typeof m?{code:m}:{}),"string"==typeof h?{message:h}:{}),n),{extraData:Object(a.e)(Object(a.e)({},n.extraData||{}),{hasAuthChallenge:!!c.authenticate,status:c.status,infected:c.infected,groupThrottle:c.groupThrottle,statusText:c.statusText})});(i=e.call(this,S)||this).name="GetDataError",i.codes=b,i.errorData=c;for(var D=0,I=Object.keys(_);D<I.length;D++)i[y=I[D]]=_[y];return i}return Object(a.a)(t,e),t}(i.e)},471:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"e",function(){return i}),n.d(t,"n",function(){return c}),n.d(t,"t",function(){return p});var a,i,r=n(64),o=n(118),s=n(443);!function(e){e[e.sameSite=0]="sameSite",e[e.crossSite=1]="crossSite",e[e.unknown=2]="unknown"}(a||(a={})),function(e){e[e.sameGeo=0]="sameGeo",e[e.crossGeo=1]="crossGeo",e[e.unknown=2]="unknown"}(i||(i={}));var c=function(){function e(e){var t=e.defaultFullWebUrl,n=e.defaultListUrl,a=e.multiGeoInfo,i=e.options,r=void 0===i?{}:i,o=r.path,s=void 0===o?void 0:o,c=r.listUrl,d=void 0===c?void 0:c,u=r.webUrl,f=void 0===u?void 0:u,p=r.mayInferListUrl,m=void 0!==p&&p;this._rawPath=s||void 0,this._rawListUrl=d||void 0,this._rawWebUrl=f||void 0,this.defaultFullWebUrl=l(t||void 0),this.defaultListUrl=l(n||void 0),this.multiGeoInfo=a,this.mayInferListUrl=m}return Object.defineProperty(e.prototype,"serverRelativeItemUrl",{get:function(){return d(this._getServerRelativeItemUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serverRelativeListUrl",{get:function(){return d(this._getServerRelativeListUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fullListUrl",{get:function(){return this._getFullListUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"normalizedListUrl",{get:function(){return d(this._getNormalizedListUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fullItemUrl",{get:function(){return this._getFullItemUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"normalizedItemUrl",{get:function(){return d(this._getNormalizedItemUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"listRelativeItemUrl",{get:function(){return this._getListRelativeItemUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"webRelativeItemUrl",{get:function(){return this._getWebRelativeItemUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fullWebUrl",{get:function(){return this._getFullWebUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"normalizedWebUrl",{get:function(){return d(this._getNormalizedWebUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serverRelativeWebUrl",{get:function(){return d(this._getServerRelativeWebUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCrossDomain",{get:function(){return this._getIsCrossDomain()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCrossList",{get:function(){return this._getIsCrossList()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"siteRelation",{get:function(){return this._getSiteRelation()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"geoRelation",{get:function(){return this._getGeoRelation()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._getPath()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"listUrl",{get:function(){return this._getListUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"webUrl",{get:function(){return this._getWebUrl()},enumerable:!1,configurable:!0}),e.prototype._getPath=function(){var e,t=this._rawPath;if(t)if("/"===t[0]||t.indexOf("://")>-1)e=l(t);else{var n=this._getListUrl()||this.defaultListUrl;n&&(e="".concat(n,"/").concat(t))}return this._getPath=function(){return e},e},e.prototype._getListUrl=function(){var e,t=this._rawListUrl;if(t)if("/"===t[0]||t.indexOf("://")>-1)e=l(t);else{var n=this._getWebUrl()||this.defaultFullWebUrl;n&&(e="".concat(n,"/").concat(t))}return this._getListUrl=function(){return e},e},e.prototype._getWebUrl=function(){var e,t=this._rawWebUrl;return t&&(e="/"===t[0]||t.indexOf("://")>-1?l(t):"".concat(this.defaultFullWebUrl,"/").concat(t)),this._getWebUrl=function(){return e},e},e.prototype._getCurrentAuthority=function(){var e=new r.e(this.defaultFullWebUrl).authority;return this._getCurrentAuthority=function(){return e},e},e.prototype._getNormalizedWebUrl=function(){var e,t=this._getFullWebUrl(),n=this.defaultFullWebUrl;if(void 0!==t&&!Object(o.t)(t,n)){var a=new r.e(t);e=Object(o.t)(a.authority,this._getCurrentAuthority())?a.path:t}return this._getNormalizedItemUrl=function(){return e},e},e.prototype._getNormalizedItemUrl=function(){var e,t=this._getFullItemUrl();if(void 0!==t){var n=new r.e(t);e=Object(o.t)(n.authority,this._getCurrentAuthority())?n.path:t}return this._getNormalizedItemUrl=function(){return e},e},e.prototype._getNormalizedListUrl=function(){var e,t=this._getFullListUrl(),n=this._getDefaultListUrl();return void 0===t||Object(o.t)(t,n)||(e=Object(o.t)(new r.e(t).authority,this._getCurrentAuthority())?this._getServerRelativeListUrl():t),this._getNormalizedListUrl=function(){return e},e},e.prototype._getServerUrl=function(){var e=this.path&&new r.e(this.path).authority||this.listUrl&&new r.e(this.listUrl).authority||this.webUrl&&new r.e(this.webUrl).authority||this.defaultListUrl&&new r.e(this.defaultListUrl).authority||new r.e(this.defaultFullWebUrl).authority;return this._getServerUrl=function(){return e},e},e.prototype._getServerRelativeListUrl=function(){var e;if(void 0!==this.listUrl)e=new r.e(this.listUrl).path;else{var t=this._getDefaultListUrl(),n=this.mayInferListUrl;if(void 0!==t||n){var a=this._getServerRelativePath(),i=new r.e(t).path;if(void 0===a&&(void 0===this.webUrl||i&&Object(s.e)(f(i),f(this._getServerRelativeWebUrl())))||i&&Object(s.e)(f(a),f(i)))e=i;else if(void 0!==a&&(""===this.defaultListUrl||n)){var o=this._getServerRelativeWebUrl();if(Object(s.e)(f(a),f(o))){var c=new r.e(a).segments[new r.e(o).segments.length];e="".concat(f(o)).concat(c)}}}}return this._getServerRelativeListUrl=function(){return e},e},e.prototype._getFullListUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeListUrl();return void 0!==n&&(e="".concat(t).concat(n)),e},e.prototype._getFullItemUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeItemUrl();return void 0!==n&&(e="".concat(t).concat(n)),this._getFullItemUrl=function(){return e},e},e.prototype._getServerRelativeWebUrl=function(){var e,t;if(void 0!==this.webUrl)e=new r.e(this.webUrl).path;else if(!this.defaultListUrl&&!this.listUrl||this.mayInferListUrl||void 0===(t=this._getServerRelativeListUrl()))this.defaultFullWebUrl&&(e=new r.e(this.defaultFullWebUrl).path);else{var n=new r.e(t);e="".concat(n.segments.slice(0,-1).join("/"))}return this._getServerRelativeWebUrl=function(){return e},e},e.prototype._getServerRelativePath=function(){var e;return void 0!==this.path&&(e=new r.e(this.path).path),this._getServerRelativePath=function(){return e},e},e.prototype._getServerRelativeItemUrl=function(){var e;return this.path||this._rawPath?e=this._getServerRelativePath():this.listUrl?e=this._getServerRelativeListUrl():this.webUrl?e=this._getServerRelativeWebUrl():this.defaultListUrl?e=this._getServerRelativeListUrl():this.defaultFullWebUrl&&(e=this._getServerRelativeWebUrl()),this._getServerRelativeItemUrl=function(){return e},e},e.prototype._getListRelativeItemUrl=function(){var e,t,n=this._getServerRelativePath(),a=this._getServerRelativeListUrl();return void 0!==this.path&&void 0!==a&&Object(s.e)(f(n),t=f(a))&&(e=n&&n.substring(t.length)),this._getListRelativeItemUrl=function(){return e},e},e.prototype._getWebRelativeItemUrl=function(){var e,t,n=this._getServerRelativePath(),a=this._getServerRelativeWebUrl();return void 0!==this.path&&void 0!==a&&Object(s.e)(f(n),t=f(a))&&(e=n&&n.substring(t.length)),this._getWebRelativeItemUrl=function(){return e},e},e.prototype._getDefaultListUrl=function(){var e;return void 0!==this.defaultListUrl&&(e=new r.e(this.defaultListUrl).authority?this.defaultListUrl:"".concat(this._getCurrentAuthority()).concat(this.defaultListUrl)),this._getDefaultListUrl=function(){return e},e},e.prototype._getIsCrossDomain=function(){var e=this._getCurrentAuthority(),t=!Object(o.t)(new r.e(this._getServerUrl()).authority,e);return this._getIsCrossDomain=function(){return t},t},e.prototype._getIsCrossList=function(){var e=this._getFullListUrl(),t=this._getDefaultListUrl(),n=!Object(o.t)(e,t);return this._getIsCrossList=function(){return n},n},e.prototype._getSiteRelation=function(){var e=a.unknown;if(this._getIsCrossDomain())e=a.crossSite;else if(void 0!==this.webUrl)e=Object(o.t)(u(this.defaultFullWebUrl),u(this._getFullWebUrl()))?a.sameSite:a.crossSite;else{var t=new r.e(this.defaultFullWebUrl).path,n=this._getServerRelativeListUrl()||this._getServerRelativePath();if(void 0!==n)if(Object(s.e)(f(n),f(t))){var i=new r.e(u(n)),c=new r.e(u(t));e=i.segments.length-1===c.segments.length||i.segments.length-2===c.segments.length&&"Lists"===i.segments[i.segments.length-2]?a.sameSite:a.unknown}else e=a.crossSite}return this._getSiteRelation=function(){return e},e},e.prototype._getFullWebUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeWebUrl();return void 0!==n&&(e="".concat(t).concat(n)),this._getFullWebUrl=function(){return e},e},e.prototype._getGeoRelation=function(){if(!this._getIsCrossDomain())return i.sameGeo;var e=new r.e(this._getServerUrl()).authority;if(!e)return i.unknown;var t=this._getCurrentGeo();if(!t)return i.unknown;var n=this._getGeoByAuthority()[e.toUpperCase()];return n?Object(o.t)(n,t)?i.sameGeo:i.crossGeo:i.unknown},e.prototype._getGeoByAuthority=function(){var e={},t={};function n(n,a,i){var o=new r.e(n).authority.toUpperCase();!i&&t[o]||(e[o]=a),i&&(t[o]=!0)}if(this.multiGeoInfo)for(var a=0,i=this.multiGeoInfo;a<i.length;a++){var o=i[a],s=o.InstanceId,c=o.IsDefaultDataLocation;if(n(o.MySiteHostUrl,s,c),n(o.PortalUrl,s,c),n(o.RootSiteUrl,s,c),n(o.TenantAdminUrl,s,c),o.AdditionalUrls)for(var d=0,l=o.AdditionalUrls;d<l.length;d++)n(l[d],s,c)}return this._getGeoByAuthority=function(){return e},e},e.prototype._getCurrentGeo=function(){var e=this._getCurrentAuthority();if(e){var t=this._getGeoByAuthority()[e.toUpperCase()];return this._getCurrentGeo=function(){return t},t}},e}();function d(e){return""===e?"/":e}function l(e){return"/"===e?"/":e}function u(e){return void 0===e&&(e=""),"/"===e[e.length-1]?e.substring(0,e.length-1):e}function f(e){return void 0===e&&(e=""),"/"===e[e.length-1]?e:"".concat(e,"/")}var p=function(){function e(e){var t=e.context,n=e.itemUrlPartsType,a=void 0===n?c:n;this.itemUrlPartsType=a,this.itemUrlContext=t}return e.prototype.getUrlParts=function(e){var t=this.itemUrlContext,n=t.webAbsoluteUrl,a=t.listUrl,i=t.multiGeoInfo;return new this.itemUrlPartsType({defaultFullWebUrl:n,defaultListUrl:a,multiGeoInfo:i,options:e})},e}()},520:function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o});var a=n(0),i=n(81),r=function(){function e(e){var t=e.webAbsoluteUrl,n=e.encodeWebAbsoluteUrl,a=void 0===n||n;this._webAbsoluteUrl=t,this._encodeWebAbsoluteUrl=a,this._segments=[],this._parameters=[],this._rawParameters=[],this._lastParameterId=0}return e.prototype.toString=function(){var e,t=[];this._parameters.length&&t.push(this._parameters.map(function(e){var t=e.name,n=e.serializedValue;return"".concat(t,"=").concat(n)}).join("&")),t.push.apply(t,this._rawParameters),e=t.length?"?".concat(t.join("&")):"";var n=this._webUrl||this._webAbsoluteUrl||"",i=n.indexOf("?"),r=i>-1?n.slice(0,i):n,o=Object(a.o)([this._encodeWebAbsoluteUrl?encodeURI(r):r,"_api"],this._segments,!0);return"".concat(o.join("/")).concat(e)},e.prototype.segment=function(e){return this._extend({segments:[e]})},e.prototype.segments=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._extend({segments:e})},e.prototype.methodWithAliases=function(e,t){for(var n=this,a=[],i=0,r=Object.keys(t);i<r.length;i++){var o=r[i],s=t[o],c=n._autoParameter(s);n=c.apiUrl,a.push("".concat(o,"=").concat(c.name))}return n.segment("".concat(e,"(").concat(a.join(","),")"))},e.prototype.method=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var a=this,i=[],r=0,o=t;r<o.length;r++){var s=o[r],c=a._autoParameter(s);a=c.apiUrl,i.push(c.name)}return a.segment("".concat(e,"(").concat(i.join(","),")"))},e.prototype.parameter=function(e,t){return this._parameter(e,t)},e.prototype.parameters=function(e){for(var t=this,n=0,a=Object.keys(e);n<a.length;n++){var i=a[n],r=e[i];t=t.parameter(i,r)}return t},e.prototype.oDataParameter=function(e,t){return this.parameter(e,{raw:t})},e.prototype.rawParameter=function(e){return this._extend({rawParameters:[e]})},e.prototype._autoParameter=function(e){var t=this._lastParameterId+1,n="@a".concat(t);return{name:n,apiUrl:this._extend({lastParameterId:t})._parameter(n,e)}},e.prototype._parameter=function(e,t){var n;return n=function(e){return!!e&&"object"==typeof e&&"json"in e}(t)?i.e.encodeRestUriStringToken(JSON.stringify(t.json)):function(e){return!!e&&"object"==typeof e&&"guid"in e}(t)?"guid'".concat(t.guid,"'"):function(e){return!!e&&"object"==typeof e&&"raw"in e}(t)?t.raw:"number"==typeof t||"boolean"==typeof t?"".concat(t):"'".concat(i.e.encodeRestUriStringToken(t),"'"),this._extend({parameters:[{name:e,serializedValue:n}]})},e.prototype.clone=function(){return new e({webAbsoluteUrl:this._webAbsoluteUrl,encodeWebAbsoluteUrl:this._encodeWebAbsoluteUrl})},e.prototype._extend=function(e){var t,n,a,i,r,o;void 0===e&&(e={});var s=this.clone();return s._webUrl=this._webUrl,s._lastParameterId=this._lastParameterId,(t=s._parameters).push.apply(t,this._parameters),(n=s._segments).push.apply(n,this._segments),(a=s._rawParameters).push.apply(a,this._rawParameters),"webUrl"in e&&(s._webUrl=e.webUrl),"lastParameterId"in e&&void 0!==e.lastParameterId&&(s._lastParameterId=e.lastParameterId),"parameters"in e&&void 0!==e.parameters&&(i=s._parameters).push.apply(i,e.parameters),"rawParameters"in e&&void 0!==e.rawParameters&&(r=s._rawParameters).push.apply(r,e.rawParameters),"segments"in e&&void 0!==e.segments&&(o=s._segments).push.apply(o,e.segments),s},e}(),o=function(){function e(e){this._apiUrlType=function(t){function n(){return t.call(this,{webAbsoluteUrl:e.webAbsoluteUrl,encodeWebAbsoluteUrl:e.encodeWebAbsoluteUrl})||this}return Object(a.a)(n,t),n}(r)}return e.prototype.build=function(){return new this._apiUrlType},e.prototype.contextInfoUrl=function(e){var t,n=e.indexOf("/_layouts/");if(n>-1)t=e.substring(0,n);else{var a=e.lastIndexOf("/"),i=e.lastIndexOf(".");t=i>a?"".concat(e.substring(0,i),"_").concat(e.substring(i+1)):e}return"".concat(t,"/_api/contextinfo")},e}()},539:function(e,t,n){"use strict";n.d(t,"e",function(){return u}),n.d(t,"t",function(){return f});var a={};n.r(a),n.d(a,"Default",function(){return s}),n.d(a,"Tenant",function(){return c}),n.d(a,"Hub",function(){return d}),n.d(a,"Site",function(){return l});var i,r=n(279),o=n(7),s=0,c=1,d=2,l=3;function u(e){return"/"===e.webServerRelativeUrl?"":e.webServerRelativeUrl}function f(e){return e&&e.webAbsoluteUrl===e.siteAbsoluteUrl}o.t.isActivated("F9624ACA-9230-4329-9616-969638C4D4CB","05/08/2022","Include Personal Site Id in generated Server Url for Freemium lists"),"undefined"!=typeof window&&r.n.isFeatureEnabled({ODB:1737}),function(e){e[e.FooterEnabled=2]="FooterEnabled",e[e.MegaMenuEnabled=128]="MegaMenuEnabled",e[e.FooterEmphasis0=256]="FooterEmphasis0",e[e.FooterEmphasis1=512]="FooterEmphasis1",e[e.FooterLayout0=1024]="FooterLayout0",e[e.FooterLayout1=2048]="FooterLayout1",e[e.HideTitleInHeader=33554432]="HideTitleInHeader",e[e.HorizontalQuickLaunch=1]="HorizontalQuickLaunch"}(i||(i={}))},558:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(0),i=n(471),r=n(520),o=function(e){function t(t,n){var a=e.call(this,{webAbsoluteUrl:n.pageContext.webAbsoluteUrl,encodeWebAbsoluteUrl:n.encodeWebAbsoluteUrl})||this;return a._pageContext=n.pageContext,a._shouldEncodeWebAbsoluteUrl=n.encodeWebAbsoluteUrl,a._itemUrlHelper=n.itemUrlHelper,a}return Object(a.a)(t,e),t.prototype.webByUrl=function(e){return this.webByItemUrl(this._itemUrlHelper.getUrlParts(e))},t.prototype.webByItemUrl=function(e){var t=e.siteRelation,n=e.isCrossDomain,a=e.fullItemUrl,r=this;return(n||t===i.a.crossSite)&&(r=r.method("SP.RemoteWeb",a)),r.segment("web")},t.prototype.listById=function(e,t){return this.webByItemUrl(e).segment("lists").method("GetById",t)},t.prototype.clone=function(){return new t({webAbsoluteUrl:this._pageContext.webAbsoluteUrl},{pageContext:this._pageContext,itemUrlHelper:this._itemUrlHelper,encodeWebAbsoluteUrl:this._shouldEncodeWebAbsoluteUrl})},t}(r.e),s=function(e){function t(t,n){var i=e.call(this,{webAbsoluteUrl:n&&n.pageContext?n.pageContext.webAbsoluteUrl:"",encodeWebAbsoluteUrl:n.encodeWebAbsoluteUrl})||this,r=n.itemUrlHelper,s=n.pageContext,c=n.encodeWebAbsoluteUrl,d=n.apiUrlType,l=void 0===d?function(e){function t(){return e.call(this,{},{itemUrlHelper:r,pageContext:s,encodeWebAbsoluteUrl:c})||this}return Object(a.a)(t,e),t}(o):d;return i._apiUrlType=l,i}return Object(a.a)(t,e),t.prototype.build=function(){return new this._apiUrlType},t}(r.t)},559:function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"t",function(){return u});var a=n(23),i=n(15),r={Small:1,Medium:2,Large:3},o="_oat_",s={},c={},d="TryGetAlternativeUrlFailure";function l(e){if(-1===e.indexOf(o))return!0;var t=c[e];if(t)return Date.now()/1e3<t;var n=new a.t(e),r=n.getQueryParameter(o);if(r){var s=r.split("_");if(2===s.length&&(t=Number(s[0])),!t)return new i.e({name:d}).end({resultType:i.t.Failure,resultCode:"OatParamUnexpectedFormat",extraData:{eatParam:r}}),c[e]=Date.now()/1e3+86400,!0;if(t-=30,c[e]=t,Date.now()/1e3>t)return!1}var l=n.getQueryParameter("P1");if(!l)return!0;var u=Number(l);return u-=30,c[e]=Math.min(u,c[e]),!(Date.now()/1e3>u)}function u(e,t,n){var o;switch(n=n||function(e){var t,n;function a(e){return l(window[e].userPhotoCdnBaseUrl)?window[e].userPhotoCdnBaseUrl:(delete window[e].userPhotoCdnBaseUrl,"")}try{var r=s&&s[e];if(r||((null===(t=window._spPageContextInfo)||void 0===t?void 0:t.userPhotoCdnBaseUrl)?r=a("_spPageContextInfo"):(null===(n=window._spHomePageContext)||void 0===n?void 0:n.userPhotoCdnBaseUrl)&&(r=a("_spHomePageContext"))),!r)return;return l(r)?r:void delete s[e]}catch(e){new i.e({name:d}).end({resultType:i.t.Failure,resultCode:"Unexpected",extraData:{error:e}})}}("UserPhotoAspx")||"/_layouts/15/userphoto.aspx",t){case r.Medium:o="M";break;case r.Large:o="L";break;default:o="S"}var c=new a.t(n);return c.setQueryParameter("size",o),c.setQueryParameter("accountname",e||""),c.toString()}},585:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(0),i=n(432),r=n(15),o=function(e){function t(t){var n=this,r=t.initTimeoutMs,o=void 0===r?4e4:r,s=Object(a.r)(t,["initTimeoutMs"]);return(n=e.call(this)||this)._customerPromiseLogger=s.customerPromiseLogger,n._messenger=Object(i.e)(Object(a.e)(Object(a.e)({},s),{initTimeoutMs:o,identifyParent:!0,onCommand:n._onCommand.bind(n),onNotification:n._onNotificiation.bind(n)})),n}return Object(a.a)(t,e),t.prototype.sendShareDestruct=function(){return this._send({command:"shareCommand",name:"share_destruct"})},t.prototype.sendShareRevisible=function(e){return e.command="shareCommand",this._send(e)},t.prototype.sendSharingContextInformation=function(e){var t={command:"shareCommand",name:"share_postContextInformation",data:e};return this._send(t)},t.prototype.sendNewToken=function(e,t,n){var a={command:"shareCommand",name:"share_newToken"};return e?a.token=e:t&&(a.error=t,a.errorDetails=n),this._send(a)},t.prototype.sendDocumentInformation=function(e){var t={command:"shareCommand",name:"share_documentInformation",data:{documentInformation:e}};return this._send(t)},t.prototype.sendSharingInfoBarInformation=function(e){var t={command:"shareCommand",name:"share_sharingInfoBarInformation",data:{sharingInfoBarInformation:e}};return this._send(t)},t.prototype._send=function(e){var t=this;return this._messenger.sendCommand(e).then(function(e){return!!e}).catch(function(n){var a;return null===(a=t._customerPromiseLogger)||void 0===a||a.end({resultType:r.t.Failure,errorCode:"SharingHostMessenger - send ".concat(e.name," failed"),extraData:{errorMessage:n.toString()}}),!1})},t}(function(){function e(){this._commandHandlers=[],this._notificationHandlers=[]}return Object.defineProperty(e.prototype,"ready",{get:function(){return this._messenger.ready},enumerable:!1,configurable:!0}),e.prototype.sendCommand=function(e,t){return this._messenger.sendCommand(e,t)},e.prototype.sendNotification=function(e){return this._messenger.sendNotification(e)},e.prototype.addCommandHandler=function(e){var t=this;return this._commandHandlers.push(e),{dispose:function(){var n=t._commandHandlers.indexOf(e);n>-1&&t._commandHandlers.splice(n,1)}}},e.prototype.addNotificationHandler=function(e){var t=this;return this._notificationHandlers.push(e),{dispose:function(){var n=t._notificationHandlers.indexOf(e);n>-1&&t._notificationHandlers.splice(n,1)}}},e.prototype.dispose=function(){this._messenger.dispose()},e.prototype._onCommand=function(e){for(var t=0,n=this._commandHandlers;t<n.length;t++){var a=(0,n[t])(e);if(a)return a}},e.prototype._onNotificiation=function(e){for(var t=0,n=this._notificationHandlers;t<n.length;t++)(0,n[t])(e)},e}())},606:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(0),i=n(471),r=n(106),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.a)(t,e),t}(i.n),s=function(e){function t(t,n){var a=n.itemUrlPartsType,i=void 0===a?o:a;return e.call(this,{context:n.pageContext,itemUrlPartsType:i})||this}return Object(a.a)(t,e),t.prototype.getUrlParts=function(t){return e.prototype.getUrlParts.call(this,t)},t.prototype.getItemUrlParts=function(e){var t=Object(r.e)(e);return this.getUrlParts({path:t.id,listUrl:t.listurl})},t}(i.t)},782:function(e,t,n){"use strict";n.r(t),n.d(t,"SharePrefetch",function(){return Oe});var a,i=n(0),r=n(594),o=n(254),s=n(148),c=n(131),d=n(371);!function(e){e[e.share=1]="share",e[e.copy=2]="copy",e[e.atMention=3]="atMention",e[e.linkSettings=4]="linkSettings",e[e.manageAccess=5]="manageAccess",e[e.notify=6]="notify",e[e.addPeople=7]="addPeople"}(a||(a={}));var l=a,u=n(118);function f(e,t){void 0===t&&(t=!1);var n=new Date(e),a=n.getTimezoneOffset()<0,i=n.getFullYear()+"",r=Object(u.i)(n.getMonth()+1+"",2),o=Object(u.i)(n.getDate()+"",2),s=Object(u.i)(n.getHours()+"",2),c=Object(u.i)(n.getMinutes()+"",2),d=Object(u.i)(n.getSeconds()+"",2),l=(a?"+":"-")+Object(u.i)(a?(Math.ceil(n.getTimezoneOffset()/60)+"").replace("-",""):Math.floor(n.getTimezoneOffset()/60)+"",2)+Object(u.i)((n.getTimezoneOffset()%60).toString().replace("-",""),2);return t?i+"-"+r+"-"+o+"T"+s+":"+c+":"+d+l:i+r+o+"T"+s+c+d+l}var p,m=n(606),_=n(558),h=n(426),b=function(){function e(e,t){var n=this._pageContext=t.pageContext,a=t.tokenProvider,r=t.noRedirect,o=t.dataRequestorType,s=void 0===o?function(e){function t(t){return e.call(this,t,{pageContext:n,tokenProvider:a,noRedirect:r})||this}return Object(i.a)(t,e),t}(h.t):o,c=e.dataSourceName,d=void 0===c?"DataSource":c;this.dataRequestor=new s({qosName:d})}return e.prototype.getDataSourceName=function(){return this.dataSourceName},e.prototype.needsRequestDigest=function(e){return!0},e.prototype.getData=function(e,t,n,a,i,r,o,s,c,d,l,u,f,p,m,_,h){void 0===i&&(i="POST");var b=e(),g=a&&a(),v=this.needsRequestDigest(b);return this.dataRequestor.getData({url:b,parseResponse:t,qosName:n,additionalPostData:g,method:i,additionalHeaders:r,contentType:o,maxRetries:s,noRedirect:c,crossSiteCollectionCall:d,telemetryHandler:l,qosExtraData:u,needsRequestDigest:v,authToken:f,webAbsoluteUrl:p,useExactAuthToken:m,skipSyncClient:_,customerPromise:h})},e}(),g=n(316);!function(e){e[e.unknown=0]="unknown",e[e.prefetch=1]="prefetch",e[e.hostapp=2]="hostapp",e[e.api=3]="api"}(p||(p={}));var v,y;!function(e){e[e.none=0]="none",e[e.view=1]="view",e[e.edit=2]="edit",e[e.owner=3]="owner",e[e.review=6]="review",e[e.restrictedview=7]="restrictedview",e[e.submit=8]="submit",e[e.manageList=9]="manageList"}(v||(v={})),function(e){e[e.unknown=1]="unknown",e[e.odb=2]="odb",e[e.sharePoint=3]="sharePoint",e[e.ngsc=4]="ngsc",e[e.word=5]="word",e[e.powerpoint=6]="powerpoint",e[e.excel=7]="excel",e[e.onenoteWeb=8]="onenoteWeb",e[e.wac=9]="wac",e[e.visio=10]="visio",e[e.officecom=11]="officecom",e[e.listPart=12]="listPart",e[e.outlookWeb=13]="outlookWeb",e[e.odIos=14]="odIos",e[e.odAndroid=15]="odAndroid",e[e.teams=16]="teams",e[e.sample=17]="sample",e[e.odc=18]="odc",e[e.wordAndroid=19]="wordAndroid",e[e.excelAndroid=20]="excelAndroid",e[e.powerpointAndroid=21]="powerpointAndroid",e[e.wordIos=22]="wordIos",e[e.excelIos=23]="excelIos",e[e.powerpointIos=24]="powerpointIos",e[e.onenote=25]="onenote",e[e.teamsIos=26]="teamsIos",e[e.teamsAndroid=27]="teamsAndroid",e[e.onenoteIos=28]="onenoteIos",e[e.visioIos=29]="visioIos",e[e.onenoteAndroid=30]="onenoteAndroid",e[e.visioAndroid=31]="visioAndroid",e[e.outlookWindows=32]="outlookWindows",e[e.outlookMac=33]="outlookMac",e[e.onenoteUWP=34]="onenoteUWP",e[e.officemobileIos=35]="officemobileIos",e[e.officemobileAndroid=36]="officemobileAndroid",e[e.odcWac=37]="odcWac",e[e.outlookGroupsWeb=38]="outlookGroupsWeb",e[e.fluid=39]="fluid",e[e.modernFileExplorer=40]="modernFileExplorer",e[e.listsHome=41]="listsHome",e[e.listsIos=42]="listsIos",e[e.edgeEnterpriseNtp=43]="edgeEnterpriseNtp",e[e.officeFeed=44]="officeFeed",e[e.searchUx=45]="searchUx",e[e.consumerList=46]="consumerList",e[e.shareDemo=47]="shareDemo",e[e.onePlayer=48]="onePlayer",e[e.windowsShare=49]="windowsShare",e[e.streamIos=50]="streamIos",e[e.streamAndroid=51]="streamAndroid",e[e.loopIos=52]="loopIos",e[e.outlookAndroid=53]="outlookAndroid",e[e.outlookiOS=54]="outlookiOS",e[e.whiteboard=55]="whiteboard",e[e.businesscentral=56]="businesscentral",e[e.mslens=57]="mslens",e[e.pbidesktop=58]="pbidesktop",e[e.oneup=59]="oneup",e[e.sharePointPages=60]="sharePointPages",e[e.streamOnline=61]="streamOnline"}(y||(y={}));var S,D,I=y;!function(e){e[e.uninitialized=0]="uninitialized",e[e.direct=1]="direct",e[e.organizationView=2]="organizationView",e[e.organizationEdit=3]="organizationEdit",e[e.anonymousView=4]="anonymousView",e[e.anonymousEdit=5]="anonymousEdit",e[e.flexible=6]="flexible",e[e.requestAccess=7]="requestAccess"}(S||(S={})),function(e){e[e.specificPeople=0]="specificPeople",e[e.organization=1]="organization",e[e.anyone=2]="anyone",e[e.existing=3]="existing",e[e.specificPeopleFlex=4]="specificPeopleFlex",e[e.customLabeledSpecificPeople=5]="customLabeledSpecificPeople"}(D||(D={}));var x,C=D,O=n(539),w=n(164),E=n(337),A=n(279),L=n(139),k=function(){function e(e){this._itemUrlHelper=e.itemUrlHelper,this._sharingContextInformation=e.sharingContextInformation}return e.prototype.getApiRoot=function(e,t,n,a){var i,r,o,s,c,d,l,u,f;if(void 0===a&&(a=!1),this._sharingContextInformation){var p=this._sharingContextInformation,m=p.isFolder,_=p.isListSharing,h=p.itemUrl,b=p.listId,g=p.listItemId,v=p.listUrl,y=p.resourceId,S=p.serverRelativeItemUrl,D=p.uniqueId,I=p.webAbsoluteUrl,x=(a&&null!==(r=null===(i=null==t?void 0:t.properties)||void 0===i?void 0:i.listId)&&void 0!==r?r:b)||"",C=(a&&null!==(s=null===(o=null==t?void 0:t.properties)||void 0===o?void 0:o.ID)&&void 0!==s?s:g)||"",O=(a&&null!==(d=null===(c=null==t?void 0:t.properties)||void 0===c?void 0:c.uniqueId)&&void 0!==d?d:D)||"";if(_)return e.build().webByUrl({webUrl:I}).method("Lists",b);if(D){if(b)return e.build().webByUrl({webUrl:I}).segment("lists").method("getbyid",x).method("GetItemByUniqueId",O);var k=a&&(null==t?void 0:t.type)===w.e.Folder||m?"GetFolderById":"GetFileById",M={guid:a&&null!==(u=null===(l=null==t?void 0:t.properties)||void 0===l?void 0:l.uniqueId)&&void 0!==u?u:D};return e.build().webByUrl({webUrl:I}).method(k,M).segment("ListItemAllFields")}return v?e.build().webByUrl({listUrl:v}).method("GetListItem",S):h?A.n.isFeatureEnabled({ODB:1236})?e.build().webByUrl({webUrl:I}).methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:new L.e(h).path}).segment("ListItemAllFields"):e.build().webByUrl({webUrl:I}).method("GetFileByUrl",E.e(h)).segment("ListItemAllFields"):b&&g?e.build().webByUrl({webUrl:I}).method("Lists",x).method("GetItemById",C):e.build().webByUrl({webUrl:I}).method("GetListItemByResourceId",y)}f=t.properties.path?this._itemUrlHelper.getUrlParts({path:t.properties.path}):this._itemUrlHelper.getItemUrlParts(t.key);var P=e.build().webByItemUrl(f).method("Lists",n);return t.isRootFolder||(P=t.properties.ID?P.method("GetItemById",t.properties.ID):P.method("GetItemByUniqueId",t.properties.uniqueId)),P},e.prototype.getFileUrl=function(e){return this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl},e.prototype.canUseSecurable=function(e){var t=e.properties;return!(!t||!(e.isRootFolder?e.list&&e.list.id:t.ID||t.uniqueId))},e.getUniqueSharingPrincipals=function(e){if(e){var t=new Set;return e.filter(function(e){return!t.has(e.loginName)&&(t.add(e.loginName),!0)})}},e}(),M=n(261),P=n(340),T=n(559);function U(e,t,n){var a=Object(T.t)(t,void 0,n);if(!e||!a||0===a.indexOf("http"))return a;try{return new L.e(e).authority+a}catch(e){return a}}!function(e){e.Small="S",e.Medium="M",e.Large="L"}(x||(x={}));var F,H,R,N,B,j,V,z=n(7),G=function(){function e(e){if(this._features=new Map,!e)throw new Error("Cannot create SPFeatureInfo object, incoming data is undefined.");for(var t in e)if(void 0!==t){var n=e[t];this._features.set(t,{version:n.Version,enabled:n.Enabled})}}return e.prototype._serialize=function(){var e={};return this._features.forEach(function(t,n){e[n]={Version:t.version,Enabled:t.enabled}}),e},e.prototype.get=function(e){if(!e||e&&0===e.length)throw new Error("Cannot get feature, featureName input is empty or undefined");return this._features.get(e)},e}();!function(){function e(){}e.hasItemPermission=function(t,n){return t&&t.permissions&&e.hasPermission(t.permissions,n)},e.hasPermission=function(e,t){return!!t&&!!e&&(t.Low&e.Low)>>>0===t.Low&&(t.High&e.High)>>>0===t.High},e.hasAny=function(t,n){return(n||[]).some(function(n){return e.hasPermission(t,n)})},e.hasIdentityPermission=function(t,n){return n&&t.webPermMasks&&e.hasPermission(t.webPermMasks,n)},e.viewListItems={High:0,Low:1},e.insertListItems={High:0,Low:2},e.editListItems={High:0,Low:4},e.deleteListItems={High:0,Low:8},e.approveItems={High:0,Low:16},e.openItems={High:0,Low:32},e.viewVersions={High:0,Low:64},e.deleteVersions={High:0,Low:128},e.cancelCheckout={High:0,Low:256},e.managePersonalViews={High:0,Low:512},e.manageLists={High:0,Low:2048},e.viewFormPages={High:0,Low:4096},e.reviewListItems={High:0,Low:16384},e.open={High:0,Low:65536},e.viewPages={High:0,Low:131072},e.layoutsPage={High:0,Low:135168},e.addAndCustomizePages={High:0,Low:262144},e.applyThemeAndBorder={High:0,Low:524288},e.viewUsageData={High:0,Low:2097152},e.createSSCSite={High:0,Low:4194304},e.manageSubwebs={High:0,Low:8388608},e.managePermissions={High:0,Low:33554432},e.browseDirectories={High:0,Low:67108864},e.browseUserInfo={High:0,Low:134217728},e.addDelPrivateWebParts={High:0,Low:268435456},e.updatePersonalWebParts={High:0,Low:536870912},e.manageWeb={High:0,Low:1073741824},e.useClientIntegration={High:16,Low:0},e.manageAlerts={High:64,Low:0},e.createAlerts={High:128,Low:0},e.editMyUserInfo={High:256,Low:0},e.viewItemsRequiresOpen={High:65536,Low:0},e.enumeratePermissions={High:1073741824,Low:0},e.useRemoteAPIs={High:32,Low:0},e.fullMaskWithoutACP={High:2147483647,Low:4294705151},e.fullMask={High:2147483647,Low:4294967295}}(),function(e){e[e.HEADER=0]="HEADER",e[e.NAV=1]="NAV",e[e.FOOTER=2]="FOOTER",e[e.SEARCHBOX=3]="SEARCHBOX"}(F||(F={})),function(e){e[e.LEFT=0]="LEFT",e[e.HORIZONTAL=1]="HORIZONTAL"}(H||(H={})),function(e){e[e.FULLBLEED=0]="FULLBLEED",e[e.WITHLEFTNAV=1]="WITHLEFTNAV"}(R||(R={})),function(e){e[e.none=0]="none",e[e.standard=1]="standard",e[e.compact=2]="compact",e[e.minimal=3]="minimal",e[e.extended=4]="extended"}(N||(N={})),function(e){e[e.left=0]="left",e[e.middle=1]="middle",e[e.right=2]="right"}(B||(B={})),function(e){e[e.SIMPLE=0]="SIMPLE",e[e.EXTENDED=1]="EXTENDED",e[e.STACKED=2]="STACKED"}(j||(j={})),function(e){e[e.Strong=0]="Strong",e[e.Neutral=1]="Neutral",e[e.Soft=2]="Soft",e[e.None=3]="None"}(V||(V={}));var K=n(78),W=n(195),q=n(97),Q=n(106),Y=z.t.isActivated("7853DF32-37BE-47FC-9ED5-B341B51F0667","07/07/2023","KS for COB simplified ShareDialog")||q.e.isFeatureEnabled({ECS:1131341}),J=q.e.isFeatureEnabled({ODB:61327,ODC:"COBNewShareDialog"});function X(e,t){var n=!!e.filter(function(e){var t=new Date(e.expiration);return e.isActive&&e.sharingLinkKind!==S.direct&&(!e.expiration||t.getTime()>Date.now())&&!0!==e.isUnhealthy}).length;if(!n&&t.length)for(var a=0,i=t;a<i.length;a++)if(i[a].role!==v.owner){n=!0;break}return n}function Z(){var e=window.location.search.substring(1),t=Object(Q.e)(e),n=t.itemMigrated&&"true"===t.itemMigrated.toLowerCase();return!Y&&(J||!!n)}var $=!z.t.isActivated("48d0bf6b-2e41-42a8-a3a3-e8d2ef405dbb","7/14/2022","better error handling"),ee=z.t.isActivated("3e85cd31-2807-44c1-96bf-35f08619ec11","1/31/2023","Fix for not appending navId to SPL link"),te=z.t.isActivated("46a06a91-966f-47f1-af68-09d8b3864e12","07/03/2023","Override navId with navIdSendLinkOverride")||q.e.isFeatureEnabled({ECS:1107386}),ne=z.t.isActivated("62a4337e-d21e-407b-b2ef-2163777d20b8","12/19/2022","Link unfurl using displayName KS")||q.e.isFeatureEnabled({ECS:1059927}),ae=z.t.isActivated("9c1ecbd5-cae0-484e-ba86-18863f653357","09/18/2023","KS for using AgeGroup returned from GSI")||q.e.isFeatureEnabled({ECS:1132016}),ie=function(e){function t(t,n){void 0===n&&(n={pageContext:t.pageContext});var a=e.call(this,{dataSourceName:"SharingDataSource"},n)||this;a._getParentListId=t.getParentListId,a._itemUrlHelper=t.itemUrlHelper||new m.e({},{pageContext:t.pageContext}),a._apiUrlHelper=t.apiUrlHelper||new _.e({},{pageContext:t.pageContext,itemUrlHelper:a._itemUrlHelper}),a._sharingContextInformation=t.sharingContextInformation||void 0,a._sharingDataSourceHelper=new k({itemUrlHelper:a._itemUrlHelper,sharingContextInformation:a._sharingContextInformation,isItemUrlEncoded:t.isItemUrlEncoded});var i=Object(O.e)(a._pageContext);return a._shareUrl=i+"/_api/SP.Web.ShareObject",a}return Object(i.a)(t,e),t.parsePeople=function(e){return e.map(function(e){var n={role:t.parseSharingRole(e.CurrentRole),statusCode:Number(!e.Status),errorMessage:e.Message||null};return{name:e.DisplayName,email:e.Email,userId:e.UserId,sharingInfo:n}})},t.parseSharingRole=function(e){switch(e){case 0:return g.e.None;default:return g.e.View;case 2:return g.e.Edit;case 6:return g.e.Review}},t.prototype.getSharingInformation=function(e,t,n,a,i,r){var o,s=this,c=(a=a||this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e))).segment("GetSharingInformation"),d="pickerSettings";return t&&(d+=",permissionsInformation"),n&&(d+=",sharingLinkTemplates"),i&&(d+=",addressBarLinkSettings"),o=c.oDataParameter("$Expand",d).toString(),this.getData(function(){return o},function(t){var n=JSON.parse(t),a=s._parseGetSharingInformationResponse(n,e);return a.getSharingInformationSources=p.api,a},"GetSharingInformation",null,"POST",this._sharingContextInformation&&this._sharingContextInformation.listId&&de(this._sharingContextInformation.listId.slice(1,-1))?{"X-SP-REQUESTRESOURCES":"WEBPROPERTIES, list=".concat(this._sharingContextInformation.listId.slice(1,-1))}:null,null,null,!0,void 0,void 0,this._getExtraData(),r)},t.prototype.getShareLinkApi=function(e,t,n){return t.method("Lists",this._getParentListId(e)).method("GetItemById",n).segment("ShareLink")},t.prototype.emailWithoutPermissioning=function(e,n,a,i){var r=this,o=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,n,this._getParentListId(n)).segment("ForwardObjectLink").toString();return this.getData(function(){return o},function(e){var a=JSON.parse(e).d,i=[];a.UniquelyPermissionedUsers&&a.UniquelyPermissionedUsers.results&&(i=a.UniquelyPermissionedUsers.results);var r=[];a.InvitedUsers&&a.InvitedUsers.results&&(r=a.InvitedUsers.results);var o={};if(o.statusCode=a.StatusCode,o.errorMessage=a.ErrorMessage,o.people=t.parsePeople(i),o.invitedUsers=t.parsePeople(r),o.itemId=n&&n.id,r.length>0&&(o.invitationLink=r[0].InvitationLink),o.invalidEmails=[],a.UsersWithInvalidEmails&&a.UsersWithInvalidEmails.results)for(var s=0,c=a.UsersWithInvalidEmails.results;s<c.length;s++){var d=c[s];o.invalidEmails.push(d.User)}return o},"ForwardObjectLink",function(){for(var t=[],n=0,o=e;n<o.length;n++){var s=o[n];t.push(s.rawPersonData)}var c={peoplePickerInput:JSON.stringify(t),emailBody:a,emailSubject:i,linkParameters:{}};return r._sharingContextInformation&&r._sharingContextInformation.optInSendNavIdInShareLink&&!ee&&(r._sharingContextInformation.navIdSendLinkOverride&&!te?c.linkParameters.nav=r._sharingContextInformation.navIdSendLinkOverride:r._sharingContextInformation.navId&&(c.linkParameters.nav=r._sharingContextInformation.navId)),JSON.stringify(c)})},t.prototype.checkPermissions=function(e,t){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("CheckPermissions").toString();return this.getData(function(){return n},function(e){var t=JSON.parse(e);return t.d?t.d.CheckPermissions.results:null},"CheckPermissions",function(){var t={recipients:e};return JSON.stringify(t)})},t.prototype.share=function(e,n){var a=this,i=!!this._sharingContextInformation||this._sharingDataSourceHelper.canUseSecurable(n.items[0]);if(9===n.linkType||6===n.linkType||5===n.linkType)return this._shareLink(e,n);var r,o={};if(i){var s=n.items[0],c=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,s,this._getParentListId(s));r=c.segment("ShareObject").toString()}else r=this._shareUrl;return this._sharingContextInformation&&this._sharingContextInformation.listId&&de(this._sharingContextInformation.listId.slice(1,-1))&&(o["X-SP-REQUESTRESOURCES"]="WEBPROPERTIES, list=".concat(this._sharingContextInformation.listId.slice(1,-1))),this.getData(function(){return r},function(e){var a=JSON.parse(e).d,i=[];Object(W.e)()&&window.sessionStorage.setItem("Share_Response",JSON.stringify(a)),a.UniquelyPermissionedUsers&&a.UniquelyPermissionedUsers.results&&(i=a.UniquelyPermissionedUsers.results);var r=[];a.InvitedUsers&&a.InvitedUsers.results&&(r=a.InvitedUsers.results);var o={};if(o.statusCode=a.StatusCode,o.errorMessage=a.ErrorMessage,o.people=t.parsePeople(i),o.invitedUsers=t.parsePeople(r),o.itemId=n.items[0]&&n.items[0].id,r.length>0&&(o.invitationLink=r[0].InvitationLink),o.invalidEmails=[],a.UsersWithInvalidEmails&&a.UsersWithInvalidEmails.results)for(var s=0,c=a.UsersWithInvalidEmails.results;s<c.length;s++){var d=c[s];o.invalidEmails.push(d.User)}return o},"Share",function(){for(var t=[],r=0;r<e.length;r++){var o=e[r];t.push(o.rawPersonData)}n.roleValue===g.e.Edit.toString()?n.roleValue="role:1073741827":n.roleValue===g.e.View.toString()&&(n.roleValue="role:1073741826");var s={peoplePickerInput:JSON.stringify(t),roleValue:n.roleValue,sendEmail:n.sendEmail,emailBody:n.message,emailSubject:n.subject,includeAnonymousLinkInEmail:!n.requireSignIn,propagateAcl:n.propagateSharing,useSimplifiedRoles:!0};return i||(s.url=a._sharingDataSourceHelper.getFileUrl(n.items[0])),Object(W.e)()&&window.sessionStorage.setItem("Share_Payload",JSON.stringify(s)),JSON.stringify(s)},"POST",o,void 0,void 0,!0).catch(function(t){var a="";try{a=JSON.stringify(t)}catch(e){}return{error:5,debugErrorMessage:a,people:e,statusCode:t.statusCode,errorMessage:t.errorMessage,invitedUsers:[],itemId:n.items[0]&&n.items[0].id||""}})},t.prototype.updatePermissions2=function(e,t,n){var a=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t),Z()).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return a},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole}:null},"UpdatePermissions2",function(){var t;switch(n){case v.none:case v.view:case v.manageList:case v.restrictedview:case v.review:case v.edit:case v.owner:t=n;break;default:t=v.view}var a={userRoleAssignments:[{UserId:e.loginName,Role:t}],validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:!1,customMessage:null,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(a)})},t.prototype.updatePermissionsMultiple=function(e,t,n,a,i){var r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole,success:t.UpdateDocumentSharingInfo.results.map(function(e){return e.Status}).reduce(function(e,t){return e&&t},!0)}:null},"UpdatePermissionsMultiple",function(){var t;switch(n){case v.none:t=0;break;case v.view:t=1;break;case v.review:t=6;break;case v.edit:t=2;break;default:t=1}var r={userRoleAssignments:e.map(function(e){return{UserId:e.userId,Role:t}}),validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:a,customMessage:i,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(r)})},t.prototype.parseRawSharingInformation=function(e,t){return this._parseGetSharingInformationResponse(e,t)},t.prototype.unshareLink=function(e){var t=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.item,this._getParentListId(e.item),Z()).segment("UnshareLink").toString();return this.getData(function(){return t},function(e){return!!JSON.parse(e).d},"UnshareLink",function(){var t={linkKind:e.kind,shareId:e.shareId};return JSON.stringify(t)})},t.prototype.shareLink=function(e){var t=this,n=e.settings,a=e.items[0],i=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.items[0],this._getParentListId(a),Z()).segment("ShareLink").toString(),r={};return this._sharingContextInformation&&(this._sharingContextInformation.listId&&de(this._sharingContextInformation.listId.slice(1,-1))&&(r["X-SP-REQUESTRESOURCES"]="WEBPROPERTIES, list=".concat(this._sharingContextInformation.listId.slice(1,-1))),this._sharingContextInformation&&this._sharingContextInformation.enableFallbackShareLink&&(r.Prefer="DirectUrlWithShareToken")),this.getData(function(){return i},function(e){var t=JSON.parse(e);return t.d?(Object(W.e)()&&window.sessionStorage.setItem("ShareLink_Response",JSON.stringify(t.d)),function(e){if(e.d)return re(e.d.ShareLink.sharingLinkInfo)}(t)):t.error?{error:5,errorMessage:t.error.message}:void 0},"ShareLink",function(){var a=null;n.expiration&&(a=f(n.expiration.toString()));var i=null;if(e.recipients&&e.recipients.length>0){i=[];for(var r=0,o=e.recipients;r<o.length;r++){var s=o[r];s.rawPersonData&&i.push(s.rawPersonData)}}var c=null;if(n.inviteesToRemove&&n.inviteesToRemove.length>0){c=[];for(var d=0,l=n.inviteesToRemove;d<l.length;d++){var u=l[d];c.push({id:u.id,loginName:u.loginName,name:u.primaryText,isExternal:u.isExternal,principalType:u.type,email:u.email})}}var p={request:{createLink:!!n.createLink,settings:{allowAnonymousAccess:n.allowAnonymousAccess,trackLinkUsers:n.trackLinkUsers,linkKind:n.sharingLinkKind,expiration:a,role:n.role,restrictShareMembership:n.restrictShareMembership,updatePassword:n.updatePassword,password:n.password,shareId:n.shareId,description:n.description,scope:n.scope,nav:""}}};if(t._sharingContextInformation&&t._sharingContextInformation.optInSendNavIdInShareLink&&!ee&&(t._sharingContextInformation.navIdSendLinkOverride&&!te?p.request.settings.nav=t._sharingContextInformation.navIdSendLinkOverride:t._sharingContextInformation.navId&&(p.request.settings.nav=t._sharingContextInformation.navId)),c&&(p.request.settings.inviteesToRemove={results:c}),i&&i.length>0){p.request.peoplePickerInput=JSON.stringify(i);var m=e.emailData,_=e.emailSubject;void 0!==m&&void 0===_&&(p.request.emailData={body:e.emailData,subject:""}),void 0===m&&void 0!==_&&(p.request.emailData={body:"",subject:e.emailSubject}),void 0!==m&&void 0!==_&&(p.request.emailData={body:e.emailData,subject:e.emailSubject})}var h=e.settings.shareId;h&&(p.request.settings.shareId=h,p.request.emailData={body:""});var b=JSON.stringify(p);return Object(W.e)()&&window.sessionStorage.setItem("ShareLink_Payload",b),b},"POST",0!==Object.keys(r).length?r:null,null,null,!0,void 0,void 0,this._getExtraData()).catch(function(e){if($)return{error:e};var t="";try{t=JSON.stringify(e)}catch(e){}return{error:5,debugErrorMessage:t}})},t.prototype.setAddressBarLinkCapability=function(e,t){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e)).segment("SetAddressBarLinkCapability").toString();return this.getData(function(){return n},function(e){return!!JSON.parse(e).d},"SetAddressBarLinkCapability",function(){var e={enable:t};return JSON.stringify(e)})},t.prototype.shareLinkExpress=function(e,t,n){var a=this._apiUrlHelper.build().webByUrl({webUrl:this._pageContext.webAbsoluteUrl}).method("Lists",e).method("GetItemById",t).segment("ShareLinkExpress").toString();return this.getData(function(){return a},function(e){var t,n,a,i=JSON.parse(e);return i.error||!(null===(n=null===(t=i.d)||void 0===t?void 0:t.ShareLinkExpress)||void 0===n?void 0:n.sharingLinkInfo)?{error:5,errorMessage:(null===(a=null==i?void 0:i.error)||void 0===a?void 0:a.message)||"No sharing link info returned"}:i.d?re(i.d.ShareLinkExpress.sharingLinkInfo):void 0},"ShareLinkExpress",function(){var e={expressOption:n};return JSON.stringify(e)},"POST",null,null,null,!0,void 0,void 0,this._getExtraData()).catch(function(e){if($)return{error:e};var t="";try{t=JSON.stringify(e)}catch(e){}return{error:5,debugErrorMessage:t}})},t.prototype.getClientId=function(){var e=Number(this._pageContext.webTemplate);if(function(e){if(e.featureInfo){var t=new G(e.featureInfo);if(t){var n=t.get("SitePagePublishing");return!!n&&n.enabled}return!1}return Number(e.webTemplate)===P.e.sitePagePublishing}(this._pageContext))return I.sharePoint;switch(e){case P.e.teamSite:case P.e.group:case P.e.subgroup:case P.e.sitePagePublishing:return I.sharePoint;case P.e.mySite:return I.odb;default:return I.sharePoint}},t.prototype._shareLink=function(e,t){var n=this,a=t.items[0],i=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,a,this._getParentListId(a)).segment("ShareLink").toString();return this.getData(function(){return i},function(n){return{statusCode:0,errorMessage:"",people:e,itemId:t.items[0].id}},"ShareLink",function(){for(var a=[],i=0,r=e;i<r.length;i++){var o=r[i];a.push(o.rawPersonData)}var s=null;t.expiration&&(s=f(t.expiration));var c={request:{peoplePickerInput:JSON.stringify(a),emailData:{body:t.message,subject:t.subject},linkKind:n._getSharingLinkKind(t.linkType,t.roleValue),createLink:!0,expiration:s}};return JSON.stringify(c)})},t.prototype._getSharingLinkKind=function(e,t){var n=S.direct;return 6===e?n=S.anonymousEdit:5===e?n=S.anonymousView:9===e&&(n=t===g.e.Edit.toString()?S.organizationEdit:S.organizationView),n},t.prototype._parseGetSharingInformationResponse=function(e,t){if(e.error)return{error:5,ageGroup:void 0,anonymousLinkExpirationRestrictionDays:void 0,anyoneLinkTrackUsers:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkScope:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharedObjectType:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,userRole:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0,itemUrl:void 0,siteId:void 0,substrateFileId:void 0,tenantId:void 0,isConsumerFiles:void 0,outlookEndpointHostUrl:void 0,webUrl:void 0,userPhotoCdnBaseUrl:void 0,permissionsInformation:void 0,sensitivityLabelInformation:void 0,displayName:void 0};var n=e.d,a=n.userPhotoCdnBaseUrl,r=n.permissionsInformation,o=!!r,s=!!n.sharingLinkTemplates,c=o,d=!!n.addressBarLinkSettings,l=o?this._parseSharingLinks(r.links.results,n.directUrl,a,Z()):[],u=s?this._parseSharingLinkTemplates(n.sharingLinkTemplates.templates.results,a):[],f=d?n.addressBarLinkSettings:null,p=[];if(o){var m=r.siteAdmins.results,_=r.principals.results,h=this._parseSharingPrincipals(m,void 0,a);h.forEach(function(e){return e.isSiteAdmin=!0});var b=this._parseSharingPrincipals(_,void 0,a);p=h.concat(b)}var g=this._getDefaultSharingLink(n.defaultLinkKind,n.defaultShareLinkScope,l,n.sharingAbilities),v=this._sharingContextInformation?this._sharingContextInformation.itemName:void 0;ne||v||!n||(v=n.displayName);var y={name:v,childCount:this._sharingContextInformation?this._sharingContextInformation.itemCount:void 0,hasDlpPolicy:this._sharingContextInformation?this._sharingContextInformation.hasDlpPolicy:void 0,extension:this._sharingContextInformation&&this._sharingContextInformation.itemExtension?this._sharingContextInformation.itemExtension:n.fileExtension,appmap:this._sharingContextInformation?this._sharingContextInformation.itemAppmap:void 0,itemType:this._sharingContextInformation?this._sharingContextInformation.itemType:void 0};if(t){var D=t.properties,I=D.ItemChildCount?parseInt(D.ItemChildCount,10):0,x=D.FolderChildCount?parseInt(D.FolderChildCount,10):0,O=t.type===w.e.OneNote?0:I+x,E=this._isPolicyTipFlagSet(t.policyTip,M.t.blockSharing),A=t.name;ne||A||!n.displayName||(A=n.displayName),y={name:A,childCount:O,hasDlpPolicy:E,extension:t.extension,appmap:t.appMap,itemType:t.type}}var L=n.canRequestAccessForGrantAccess||n.canAddInternalPrincipal||l.length>1,k=0===n.anonymousLinkExpirationRestrictionDays?-1:n.anonymousLinkExpirationRestrictionDays,P=Object(i.e)({anonymousLinkExpirationRestrictionDays:k,anyoneLinkTrackUsers:n.anyoneLinkTrackUsers,canAddExternalPrincipal:n.canAddExternalPrincipal,canAddInternalPrincipal:n.canAddInternalPrincipal,defaultShareLinkToExistingAccess:n.defaultShareLinkToExistingAccess,canManagePermissions:L,defaultSharingLink:g,fileExtension:n.fileExtension,sharedObjectType:n.sharedObjectType,hasInheritedLinks:!!c&&n.permissionsInformation.hasInheritedLinks,isShared:X(l,p),item:y,sharingLinks:l,sharingPrincipals:p,peoplePickerSettings:n.pickerSettings,userDisplayName:this._pageContext.userDisplayName,blockPeoplePickerAndSharing:n.blockPeoplePickerAndSharing,requiresAccessApproval:!n.canAddInternalPrincipal&&n.canRequestAccessForGrantAccess,canRequestAccessForGrantAccess:n.canRequestAccessForGrantAccess,userRole:n.currentRole,defaultShareLinkPermission:n.defaultShareLinkPermission,sharingAbilities:n.sharingAbilities,defaultLinkKind:n.defaultLinkKind,defaultShareLinkScope:n.defaultShareLinkScope,directLink:{allowsAnonymousAccess:!1,audience:C.existing,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:S.direct,sharingScope:3,url:n.directUrl,updatePassword:!1,password:"",passwordLastModifiedBy:null},hasPermissionsInformation:!!n.permissionsInformation,sharingLinkTemplates:u,addressBarLinkSettings:f,webTemplateId:n.webTemplateId,itemUniqueId:n.itemUniqueId,itemUrl:n.itemUrl,siteId:n.siteId,substrateFileId:n.substrateFileId,tenantId:n.tenantId,isConsumerFiles:!!n.isConsumerFiles&&n.isConsumerFiles,customizedExternalSharingServiceUrl:n.customizedExternalSharingServiceUrl||"",siteIBSegmentIDs:n.siteIBSegmentIDs?n.siteIBSegmentIDs.results:null,siteIBMode:n.siteIBMode,enforceIBSegmentFiltering:!!n.enforceIBSegmentFiltering,enforceSPOSearch:!!n.enforceSPOSearch,outlookEndpointHostUrl:n.outlookEndpointHostUrl?n.outlookEndpointHostUrl:null,webUrl:n.webUrl?n.webUrl:null,isStubFile:!!n.isStubFile&&n.isStubFile,userPhotoCdnBaseUrl:n.userPhotoCdnBaseUrl,permissionsInformation:n.permissionsInformation,sensitivityLabelInformation:n.sensitivityLabelInformation,displayName:n.displayName,isPremium:n.isPremium},!ae&&n.ageGroup?{ageGroup:n.ageGroup}:{});if(Object(W.e)()){var T=window.sessionStorage.getItem("Get_Sharing_Information");if(T&&Object.keys(T).length>0){var U=JSON.parse(T);return Object(i.e)(Object(i.e)({},P),U)}}return P},t.prototype._parseSharingLinks=function(e,t,n,a){var r=this;void 0===a&&(a=!1),a||(e=e.filter(function(e){return!e.isInherited}));var o=e.map(function(e){var t,o=e.linkDetails;return t=void 0!==o.Scope&&-1!==o.Scope?se(o.LinkKind,o.Scope):oe(o.LinkKind,o.AllowsAnonymousAccess,o.RestrictedShareMembership),Object(i.e)({allowsAnonymousAccess:o.AllowsAnonymousAccess,hasPassword:o.RequiresPassword,blockDownload:o.BlocksDownload,description:o.Description,audience:t,expiration:o.Expiration?new Date(o.Expiration):null,isActive:o.IsActive,isEdit:ce(o.LinkKind)||o.IsEditLink,isReview:o.IsReviewLink,isManageList:o.IsManageListLink,principals:r._parseSharingPrincipals(e.linkMembers.results,o.LinkKind,n),invitees:r._parseLinkInvitees(o,n),shareId:o.ShareId,sharingLinkKind:o.LinkKind,sharingScope:o.Scope,url:o.Url,updatePassword:o.UpdatePassword,password:o.Password,passwordLastModifiedBy:r._parseSharingPrincipal(o.PasswordLastModifiedBy,n),isCreateOnlyLink:o.IsCreateOnlyLink,isAddressBarLink:o.IsAddressBarLink,isUnhealthy:o.IsUnhealthy,status:o.SharingLinkStatus,created:o.Created,trackLinkUsers:o.TrackLinkUsers},a?{inheritedLinkInfo:e.inheritedFrom}:{})});return(o=o.sort(function(e,t){return r._getLinkRanking(t)-r._getLinkRanking(e)})).push({allowsAnonymousAccess:!1,audience:C.specificPeople,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:S.direct,sharingScope:2,url:t,updatePassword:!1,password:"",passwordLastModifiedBy:null}),o},t.prototype._getLinkRanking=function(e){var t=0;switch(e.audience){case C.anyone:t+=30;break;case C.organization:t+=20;break;case C.specificPeopleFlex:t+=10}return e.isEdit?t+=3:e.isReview?t+=2:e.isEdit||e.isReview||e.blockDownload||(t+=1),t},t.prototype._getSharingLinkTemplateRanking=function(e){var t=0;if(e&&e.linkDetails&&e.linkDetails.shareId){switch(e.scope){case 0:t+=30;break;case 1:t+=20;break;case 2:t+=10}switch(e.role){case v.edit:t+=3;break;case v.review:t+=2;break;case v.view:t+=1}}return t},t.prototype._parseSharingLinkTemplates=function(e,t){var n=this;return e.map(function(e){var a,i,r=e.linkDetails;null!==r&&(i=void 0!==r.Scope&&-1!==r.Scope?se(r.LinkKind,r.Scope):oe(r.LinkKind,r.AllowsAnonymousAccess,r.RestrictedShareMembership),a={allowsAnonymousAccess:r.AllowsAnonymousAccess,hasPassword:r.RequiresPassword,blockDownload:r.BlocksDownload,audience:i,expiration:r.Expiration?new Date(r.Expiration):null,description:r.Description,isActive:r.IsActive,isEdit:ce(r.LinkKind)||r.IsEditLink,isReview:r.IsReviewLink,principals:void 0,invitees:n._parseLinkInvitees(r,t),shareId:r.ShareId,sharingLinkKind:r.LinkKind,sharingScope:r.Scope,url:r.Url,updatePassword:r.UpdatePassword,password:r.Password,passwordLastModifiedBy:n._parseSharingPrincipal(r.PasswordLastModifiedBy,t)});return{linkDetails:a,passwordProtected:e.passwordProtected,role:e.role,scope:e.scope,shareKind:e.shareKind}}).sort(function(e,t){return n._getSharingLinkTemplateRanking(t)-n._getSharingLinkTemplateRanking(e)})},t.prototype._parseLinkInvitees=function(e,t){var n=this,a=e.Invitations;if(!a)return[];for(var i=[],r=0,o=a.results;r<o.length;r++){var s=o[r];s&&s.invitee&&i.push(s.invitee)}return i.map(function(e){return{id:e.id,email:e.email,primaryText:e.name,isExternal:e.isExternal,loginName:e.loginName,role:null,secondaryText:e.jobTitle,type:e.principalType,imageUrl:U(n._pageContext.webAbsoluteUrl,e.email,t)}})},t.prototype._parseSharingPrincipals=function(e,t,n){var a=this,i=e.map(function(e){var i=e.principal;i||(i=e);var r={id:i.id,isExternal:i.isExternal,loginName:i.loginName,primaryText:i.name,role:e.role,secondaryText:i.jobTitle,type:i.principalType,imageUrl:U(a._pageContext.webAbsoluteUrl,i.email,n),email:i.email};return t&&(r.sharingLinkKind=t),r});return k.getUniqueSharingPrincipals(i)},t.prototype._getExtraData=function(){var e;return this._sharingContextInformation&&(e={clientId:this._sharingContextInformation.clientId,mode:l[this._sharingContextInformation.mode]}),e},t.prototype._parseSharingPrincipal=function(e,t){if(e){var n=e.principal;return n||(n=e),{id:n.id,isExternal:n.isExternal,loginName:n.loginName,primaryText:n.name,role:e.role,secondaryText:n.jobTitle,type:n.principalType,imageUrl:U(this._pageContext.webAbsoluteUrl,n.email,t),email:n.email}}return null},t.prototype._getDefaultSharingLink=function(e,t,n,a){a.peopleSharingLinkAbilities&&(a.peopleSharingLinkAbilities.canManageEditLink.enabled||a.peopleSharingLinkAbilities.canManageReadLink.enabled)&&e===S.direct&&(e=S.flexible);var i=e,r=t;a.anyoneLinkAbilities?(i!==S.anonymousEdit||a.anyoneLinkAbilities.canManageEditLink.enabled||(i=S.anonymousView),i!==S.anonymousView||a.anyoneLinkAbilities.canManageReadLink.enabled||(i=S.organizationEdit),0!==r||a.anyoneLinkAbilities.canManageReadLink.enabled||a.anyoneLinkAbilities.canManageReadLink.enabled||(r=1)):(i!==S.anonymousEdit||a.anonymousLinkAbilities.canManageEditLink.enabled||(i=S.anonymousView),i!==S.anonymousView||a.anonymousLinkAbilities.canManageReadLink.enabled||(i=S.organizationEdit),0!==r||a.anonymousLinkAbilities.canManageReadLink.enabled||a.anonymousLinkAbilities.canManageReadLink.enabled||(r=1)),a.organizationLinkAbilities&&(i!==S.organizationEdit||a.organizationLinkAbilities.canManageEditLink.enabled||(i=S.organizationView),i!==S.organizationView||a.organizationLinkAbilities.canManageReadLink.enabled||(i=S.direct),1!==r||a.organizationLinkAbilities.canManageReadLink.enabled||a.organizationLinkAbilities.canManageEditLink.enabled||(r=2)),a.peopleSharingLinkAbilities&&(2!==r||a.peopleSharingLinkAbilities.canManageReadLink.enabled||a.peopleSharingLinkAbilities.canManageEditLink.enabled||(r=3));var o=void 0;return e===S.anonymousEdit||e===S.anonymousView?o=C.anyone:e===S.organizationEdit||e===S.organizationView?o=C.organization:e===S.direct?o=C.specificPeople:e===S.flexible&&(o=C.specificPeopleFlex),{allowsAnonymousAccess:void 0,audience:o,expiration:void 0,description:void 0,isActive:!0,isEdit:void 0,principals:void 0,shareId:void 0,sharingLinkKind:i,sharingScope:r,url:void 0,invitees:void 0,updatePassword:!1,password:"",passwordLastModifiedBy:void 0}},t.prototype._isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t},t}(b);function re(e){var t;t=void 0!==e.Scope&&-1!==e.Scope?se(e.LinkKind,e.Scope):oe(e.LinkKind,e.AllowsAnonymousAccess,e.RestrictedShareMembership);var n=e.Expiration?new Date(e.Expiration):void 0;return{link:{allowsAnonymousAccess:e.AllowsAnonymousAccess,audience:t,expiration:n,description:e.Description,isActive:e.IsActive,isEdit:ce(e.LinkKind)||e.IsEditLink,principals:null,invitees:null,hasPassword:e.RequiresPassword,shareId:e.ShareId,sharingLinkKind:e.LinkKind,sharingScope:e.Scope,url:e.Url,updatePassword:e.UpdatePassword,password:e.Password,passwordLastModifiedBy:e.PasswordLastModifiedBy,shareTokenString:e.ShareTokenString,isAddressBarLink:e.IsAddressBarLink,isUnhealthy:e.IsUnhealthy,status:e.SharingLinkStatus,created:e.Created}}}function oe(e,t,n){return e===S.anonymousEdit||e===S.anonymousView?C.anyone:e===S.organizationEdit||e===S.organizationView?C.organization:e===S.direct?C.specificPeople:e===S.flexible?t?C.anyone:!1===n?C.organization:C.specificPeopleFlex:void 0}function se(e,t){return e===S.anonymousEdit||e===S.anonymousView?C.anyone:e===S.organizationEdit||e===S.organizationView?C.organization:e===S.direct?C.specificPeople:e===S.flexible?0==t?C.anyone:1===t?C.organization:C.specificPeopleFlex:void 0}function ce(e){return e===S.anonymousEdit||e===S.organizationEdit||e!==S.anonymousView&&e!==S.organizationView&&null}function de(e){return"{"===e[0]&&(e=e.substring(1,e.length-1)),/^(\{){0,1}[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}(\}){0,1}$/gi.test(e)&&"00000000-0000-0000-0000-000000000000"!=e}var le=function(){function e(e){this._dataSource=e.sharingDataSource||new ie({getParentListId:e.getParentListId,pageContext:e.pageContext}),this._itemProvider=e.itemProvider}return e.prototype.getSharingInformation=function(e,t,n,a,i){return this._dataSource.getSharingInformation(e,t,n,a,i)},e.prototype.shareLink=function(e){var t=this;return this._dataSource.shareLink(e).then(function(n){return t._invalidateItem(e.items[0]),n})},e.prototype.unshareLink=function(e){var t=this;return this._dataSource.unshareLink(e).then(function(n){return t._invalidateItem(e.item),n})},e.prototype.updatePermissions2=function(e,t,n){var a=this;return this._dataSource.updatePermissions2(e,t,n).then(function(e){return a._invalidateItem(t),e})},e.prototype.updatePermissionsMultiple=function(e,t,n,a,i){var r=this;return this._dataSource.updatePermissionsMultiple(e,t,n,a,i).then(function(e){return r._invalidateItem(t),e})},e.prototype.getClientId=function(){return this._dataSource.getClientId()},e.prototype.parseRawSharingInformation=function(e){return this._dataSource.parseRawSharingInformation(e)},e.prototype.emailWithoutPermissioning=function(e,t,n,a){return this._dataSource.emailWithoutPermissioning(e,t,n,a).then(function(e){return e})},e.prototype.checkPermissions=function(e,t){return this._dataSource.checkPermissions(e,t)},e.prototype.share=function(e,t,n){return this._dataSource.share(e,t).then(function(e){return e})},e.prototype.setAddressBarLinkCapability=function(e,t){return this._dataSource.setAddressBarLinkCapability(e,t)},e.prototype._invalidateItem=function(e){this._itemProvider&&e&&e.parent&&e.parent.key&&this._itemProvider.invalidateItem(e.parent.key)},e}(),ue=n(144),fe=n(238),pe=n(61),me=z.t.isActivated("0f076102-5fa0-402d-8cbe-240c5abb8fb8")?"eeddb977348d43ebaaae45e759ea6e96-42528e91-0556-4879-9b8d-af7b3b8417e4-6984":"eeddb977348d43ebaaae45e759ea6e96-e15eaf40-ba64-4d72-bc1b-c3951c77cdfb-6929",_e=function(e){function t(t){return e.call(this,t)||this}return Object(i.a)(t,e),t}(Object(fe.e)()(function(e){function t(t){var n=t.context,a=void 0===n?{}:n,r=t.accountType,o=void 0===r?"Unknown":r,s=t.clientName,c=void 0===s?"Unknown":s,d=t.cloudType,l=void 0===d?"Unknown":d,u=t.correlationId,f=t.environment,p=void 0===f?t.ariaEnvironment||"prod":f,m=t.isAuthenticated,_=void 0===m?"NA":m,h=t.language,b=void 0===h?a.Market:h,g=t.scenario,v=void 0===g?"Unknown":g,y=t.siteSubscriptionId,S=void 0===y?"Unknown":y,D=t.userId,I=void 0===D?"Unknown":D,x=t.version,C=void 0===x?"Unknown":x,O=t.tenantToken,w=void 0===O?me:O,E=(t.context,Object(i.r)(t,["accountType","clientName","cloudType","correlationId","environment","isAuthenticated","language","scenario","siteSubscriptionId","userId","version","tenantToken","context"]));return e.call(this,Object(i.e)({tenantToken:w,context:Object(i.e)({AccountType:o,ClientName:c,CloudType:l,CorrelationId:u,Environment:p,IsAuthenticated:_,IsSharedControl:!0,Market:b,Scenario:v,Session:pe.generate(),SiteSubscriptionId:S,UserId:I,Version:C,Workload:"SharedControls"},a)},E))||this}return Object(i.a)(t,e),t}(function(e){function t(t){var a=this,r=t.context,o=void 0===r?{}:r,s=t.ariaLoader,c=void 0===s?function(){return Object(i.t)(a,void 0,void 0,function(){return Object(i.i)(this,function(e){return[2,n.ee(1,747,7)]})})}:s,d=(t.context,Object(i.r)(t,["ariaLoader","context"]));return a=e.call(this,Object(i.e)({ariaLoader:c,context:Object(i.e)({},o)},d))||this}return Object(i.a)(t,e),t}(ue.e)))),he=n(253),be=function(e){function t(t){return e.call(this,t)||this}return Object(i.a)(t,e),t}(Object(he.e)()(_e)),ge=n(72),ve=n(65),ye=n(109),Se=n(15),De=n(228),Ie=n(585),xe=A.n.isFeatureEnabled({ODC:"ODCSharePrefetchInline"}),Ce=A.n.isFeatureEnabled({ODB:61327,ODC:"COBNewShareDialog"}),Oe=function(){function e(e){var t,n=this;this._iframe=document.createElement("iframe"),this._form=document.createElement("form"),this._formInput=document.createElement("input"),this._sharingHostMessenger=null,this._channelId=K.e.generate(),this._onReceiveWindowMessage=function(e){try{var t=(null==e?void 0:e.data)&&JSON.parse(e.data);if(!n._elementWindow.document.body.contains(n._props.element))return n._messagesReceived.sharePrefetch_selfDispose=!0,void n.dispose();t.name&&(n._messagesReceived[t.name||""]=!0,n._processEvent(t))}catch(e){}},this._signal=new d.e,this._context=e.context,this._iframeWidth=0,this._iframeHeight=0,this._timeoutId=-1,this._isShareReady=!1,this._iframeUrl="",this._iframeBaseUrl="",this._messagesReceived={},this._props=e,this._elementWindow=this._props.elementWindow||window,this._sessionId=K.e.generate(),this._manager=Object(ge.t)(),this._hostOrigin="",this._clientOrigin="",this._sessionQos=new(Se.e.withManager(this._manager).withContext(function(e){return Object(i.e)(Object(i.e)({},e),{"AppInfo.Session":n._sessionId})}))({name:"SharingSession.".concat(l[e.context.mode||l.share])}),this._shareCustomerPromiseLogger=new De.e({scenario:"sharePrefetch.load",perfGoalInMs:3e4});var a,o=void 0===this._props.context.hostMethod?r.e.microservice:this._props.context.hostMethod,s=this._props.isConsumer;if(this._launchNewSharedialog=o===r.e.sharepoint&&(!s||Ce),this._launchNewSharedialogInCOB=this._launchNewSharedialog&&Ce,this._isInlineConsumer=!!s&&o===r.e.consumerOnedrive,this._useODCSharePrefetchInline=xe&&this._isInlineConsumer,!(null===(t=this._context)||void 0===t?void 0:t.authToken))throw new Error("An access token is required for SharePrefetch optimization");var c="";if(this._context.invitationId&&(c="&invitationId=".concat(this._context.invitationId)),this._launchNewSharedialog){var u=this._props.sharepointHostUrl?"".concat(this._props.sharepointHostUrl,"&sessionid=").concat(this._sessionId).concat(this._launchNewSharedialogInCOB?"&itemMigrated=true":""):void 0;this._iframeUrl=u||"".concat(this._context.webAbsoluteUrl,"/_layouts/15/sharedialog.aspx?sessionid=").concat(this._sessionId).concat(c,"&crossdomain=true").concat(this._launchNewSharedialogInCOB?"&itemMigrated=true":"")}else if(o===r.e.sharepoint&&this._props.sharepointHostUrl)this._iframeBaseUrl=this._iframeUrl=this._props.sharepointHostUrl;else if(this._useODCSharePrefetchInline&&this._isInlineConsumer)this._iframeBaseUrl=window.location.protocol+"//"+window.location.hostname,a=document.cookie.replace(/ /g,"").split(";").filter(function(e){return 0===e.indexOf("srr=")}).map(function(e){return e.split("=")[1]})[0];else switch((a=document.cookie.replace(/ /g,"").split(";").filter(function(e){return 0===e.indexOf("srr=")}).map(function(e){return e.split("=")[1]})[0])?"test":e.environment){case"pathfinder":this._iframeBaseUrl="https://od.apps.mil";break;case"trailblazer":this._iframeBaseUrl="https://admin.onedrive.us";break;case"ag08":this._iframeBaseUrl="https://odweba.svc.ms.eaglex.ic.gov";break;case"ag09":this._iframeBaseUrl="https://odweba.svc.ms.microsoft.scloud";break;case"test":this._iframeBaseUrl="https://www.onedrive-tst.com",this._iframeUrl=e.testEnvironmentUrl||"";break;default:this._iframeBaseUrl="https://www.odwebp.svc.ms"}var f={clientName:this._context.clientId,userAuthToken:this._context.authToken,Session:this._sessionId};if(s&&(this._context.userId?f.userId=this._context.userId:f.accountType="ConsumerAnonymous"),new be(f).attach(this._manager),this._iframeUrl||o!==r.e.microservice)!this._iframeUrl&&this._useODCSharePrefetchInline&&this._isInlineConsumer&&(p=s?"&consumer=true":"",this._iframeUrl="".concat(this._iframeBaseUrl,"/share?smkt=").concat(e.locale).concat(p,"&sessionid=").concat(this._sessionId).concat(c).concat(a?"&nextdevhost=".concat(encodeURIComponent(a),"&nextserverhost=").concat(encodeURIComponent(a)):""));else{var p=s?"&consumer=true":"";this._iframeUrl="".concat(this._iframeBaseUrl,"/share?smkt=").concat(e.locale).concat(p,"&sessionid=").concat(this._sessionId).concat(c).concat(a?"&devhost=".concat(encodeURIComponent(a)):"")}this._iframeStartTime=new Date,this._initializeIframe(),e.element.appendChild(this._iframe);var m=this._isInlineConsumer&&this._useODCSharePrefetchInline;if(!s||this._launchNewSharedialogInCOB||m){if(this._launchNewSharedialog){this._initializeForm();var _=this._iframe.contentWindow;_&&(_.document.body.appendChild(this._form),this._form.submit())}}else this._initializeForm(),e.element.appendChild(this._form);this._sharingHostMessenger||this._launchNewSharedialogInCOB||(this._sharingHostMessenger=this._createSharingHostMessenger())}return e.prototype.initializeUI=function(){return Object(i.t)(this,void 0,void 0,function(){var e,t,n,a,r,o,s,d,u,f=this;return Object(i.i)(this,function(p){return e=this._context&&this._context.correlationId,t=this._props.isConsumer,n=this._context.mode===l.copy&&"teams"===this._context.clientId&&!this._context.shareId,a=n?this._getDefaultLink():Promise.resolve(void 0),r=t&&!this._launchNewSharedialogInCOB||this._props.disablePrefetchSharingInformation?Promise.resolve(void 0):this._getSharingInformation(),o=!t||this._launchNewSharedialogInCOB||this._useODCSharePrefetchInline&&this._isInlineConsumer,s=o?this._signal.getPromise():Promise.resolve(void 0),this._isShareReady=!1,Promise.all([this._toTuple(a),this._toTuple(r),this._toTuple(s)]).then(function(n){var a=n[0],r=n[1];n[2];try{var o=!1;if(!t||f._launchNewSharedialogInCOB){var s=f._props.options.onError;if(f._isError(a)&&(o=!0,s&&s({name:"SharePrefetchError",message:"",error:a.error,resultCode:c.t.isCanceled(a.error)?"Canceled":Object(ye.a)(a.error)})),f._isError(r)){o=!0;var d=r.error,l={code:d.code,status:d.status};s&&s({name:"SharePrefetchError",message:"",error:d,resultCode:c.t.isCanceled(r.error)?"Canceled":"[".concat(l.status.toString(),"] ").concat(l.code||"Unknown")})}}var u=f._iframe.contentWindow;if(!u||t&&!f._launchNewSharedialogInCOB)t?f._useODCSharePrefetchInline&&f._isInlineConsumer&&u?(m=Object(i.e)(Object(i.e)({},f._context),{rawInvite:a.value,sharingInformation:r.value,hasTokenProvider:!1}),u.postMessage(m,f._iframeUrl)):(f._formInput.value=JSON.stringify(f._context),f._form.submit()):o||f._sessionQos.end({resultType:Se.t.ExpectedFailure,resultCode:"abandoned",extraData:{error:"contentWindow not defined to postMessage context",iframeInBody:f._elementWindow.document.body.contains(f._iframe),messagesReceived:Object.keys(f._messagesReceived).join(","),mode:f._context.mode,correlationId:e}});else{var p=f._props.options.spRestTokenProvider,m=Object(i.e)(Object(i.e)({},f._context),{rawInvite:a.value,sharingInformation:r.value,hasTokenProvider:!!p&&!!p.getAuthToken});f._sharingHostMessenger?f._sharingHostMessenger.sendSharingContextInformation(m):u.postMessage(m,f._iframeUrl)}}catch(t){f._sessionQos.end({resultType:Se.t.Failure,extraData:{unhandledError:t.toString(),correlationId:e}})}}),this._props.disableIframeDomainCheck||(d=!this._props.iframeCheckTimeout||this._props.iframeCheckTimeout<=0?8e3:this._props.iframeCheckTimeout,setTimeout(function(){if(!f._scriptsLoadedTime){var t=new Image;t.onerror=function(){var t="ShareDomainNotReachable"+(window.navigator&&window.navigator.onLine?"Online":"Offline"),n=f._props.options&&f._props.options.onError;n&&n({name:"SharePrefetchError",message:t,error:new Error(t),debugErrorMessage:"Unable to reach ".concat(f._iframeBaseUrl," domain. Refer to https://docs.microsoft.com/en-us/office365/enterprise/urls-and-ip-address-ranges"),resultCode:t}),f._sessionQos.end({resultType:Se.t.ExpectedFailure,resultCode:t,extraData:{mode:f._context.mode,iframeBaseUrl:f._iframeBaseUrl,correlationId:e}}),clearTimeout(f._timeoutId)},t.src="".concat(f._iframeBaseUrl,"/favicon.ico?").concat(Math.random())}},d)),u=this._props.timeout||45e3,this._timeoutId=setTimeout(function(){return Object(i.t)(f,void 0,void 0,function(){var n,o,s,c,d,l,f,p,m,_,h;return Object(i.i)(this,function(i){switch(i.label){case 0:o=!1,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,r];case 2:return s=i.sent(),o=!!s,[3,4];case 3:return c=i.sent(),n=c,[3,4];case 4:l=!1,i.label=5;case 5:return i.trys.push([5,7,,8]),[4,a];case 6:return f=i.sent(),l=!(!f||!f),[3,8];case 7:return p=i.sent(),d=p,[3,8];case 8:return m=this._elementWindow.document.body.contains(this._props.element),_={isTimeout:!0,iframeInBody:this._elementWindow.document.body.contains(this._iframe),rootElementInBody:m,messagesReceived:Object.keys(this._messagesReceived).join(","),getSharingHasData:o,getSharingError:n,inviteHasData:l,inviteError:d,isConsumer:t,timeout:u,mode:this._context.mode,isOnline:window.navigator&&window.navigator.onLine,scriptsLoadedTime:this._scriptsLoadedTime?this._scriptsLoadedTime.getTime()-this._iframeStartTime.getTime():-1,iframeLoadedTime:this._iframeLoadedTime,correlationId:e},this._showShareUX(),(h=this._props.options&&this._props.options.onTimeout)&&h(_),this._sessionQos.end({resultType:m?Se.t.Failure:Se.t.ExpectedFailure,resultCode:"timeout",extraData:_}),[2]}})})},u),[2]})})},e.prototype.dispose=function(){var e=this._context&&this._context.correlationId;clearTimeout(this._timeoutId),this._messagesReceived.sharePrefetch_dispose=!0,this._elementWindow.removeEventListener("message",this._onReceiveWindowMessage),this._props.element.removeChild(this._iframe),this._sessionQos.end({resultType:Se.t.ExpectedFailure,resultCode:"disposed",extraData:{isDisposed:!0,iframeInBody:this._elementWindow.document.body.contains(this._iframe),messagesReceived:Object.keys(this._messagesReceived).join(","),mode:this._context.mode,correlationId:e,isOnline:window.navigator&&window.navigator.onLine,iframeLoadedTime:this._iframeLoadedTime}})},e.prototype._getDefaultLink=function(){return Object(i.t)(this,void 0,void 0,function(){var e,t,n,a=this;return Object(i.i)(this,function(i){switch(i.label){case 0:return e=new s.t({},{urlDataSource:{getApiBaseUrl:function(){return"".concat(a._context.webAbsoluteUrl,"/_api/v2.0")}},sessionManagementProvider:this._props.options.graphTokenProvider||{getToken:function(){return c.t.resolve({accessToken:a._context.authToken})}},apiEvent:ve.e.withManager(this._manager)}),t=new o.e({},{dataRequestor:e}),n=[],this._context.defaultRecipients&&this._context.defaultRecipients.length>0&&(n=this._context.defaultRecipients.map(function(e){return{email:e}})),[4,this._context.uniqueId?t.getDefaultLinkByUniqueId(this._context.uniqueId||"",n,!this._props.disableUseMultiPart):t.getDefaultLink(this._context.itemUrl||"",n,!this._props.disableUseMultiPart)];case 1:return[2,{value:i.sent()}]}})})},e.prototype._getSharingInformation=function(){var e={authToken:this._context.authToken,webAbsoluteUrl:this._context.webAbsoluteUrl,webTemplate:this._context.isODB?"21":"1",env:"prod"},t=this._props.options.spRestTokenProvider,n=this._manager,a=new ie({pageContext:e,getParentListId:this._getParentListId,sharingContextInformation:this._context},{pageContext:e,dataRequestorType:function(a){function r(i){return a.call(this,i,{pageContext:e,apiEvent:ve.e.withManager(n),tokenProvider:t})||this}return Object(i.a)(r,a),r}(h.e),tokenProvider:t}),r=new le({pageContext:e,getParentListId:this._getParentListId,itemProvider:{invalidateItem:function(){}},sharingDataSource:a}),o=this._launchNewSharedialog||this._context.mode===l.copy||this._context.mode===l.linkSettings;return r.getSharingInformation({key:"",name:this._context.itemName,properties:{}},o,!0,void 0,this._context.mode===l.manageAccess)},e.prototype._initializeIframe=function(){var e=this;this._elementWindow.addEventListener("message",this._onReceiveWindowMessage),this._iframe.name="shareFrame",this._iframe.id="shareFrame",this._iframe.onload=function(){e._iframeLoadedTime=(new Date).getTime()-e._iframeStartTime.getTime()},this._iframeUrl&&!this._launchNewSharedialogInCOB&&(this._hostOrigin=new L.e(window.location.href).authority,this._iframeUrl+="&channelId=".concat(this._channelId,"&origin=").concat(this._hostOrigin)),this._launchNewSharedialog||(this._iframe.src=this._iframeUrl),this._iframe.style.width="0px",this._iframe.style.height="0px",this._iframe.style.visibility="hidden",this._iframe.allow="clipboard-read self ".concat(new L.e(this._iframeUrl).authority,"; clipboard-write self ").concat(new L.e(this._iframeUrl).authority)},e.prototype._initializeForm=function(){var e;this._form.target="shareFrame",this._form.method="POST",this._form.action=this._iframeUrl,this._form.style.display="none",this._formInput.type="text";var t=null===(e=this._context)||void 0===e?void 0:e.authToken;this._launchNewSharedialog?(this._formInput.value=t,this._formInput.name="access_token"):this._formInput.name="context",this._form.appendChild(this._formInput);var n=document.createElement("input");n.type="submit",this._form.appendChild(n)},e.prototype._showShareUX=function(){var e,t;this._isShareReady=!0;var n=this._props.styles;n&&n.border?this._iframe.style.border=n.border:this._iframe.style.border="0",n&&(n.margin&&(this._iframe.style.margin=n.margin),n.minWidth&&(this._iframe.style.minWidth=n.minWidth),n.minHeight&&(this._iframe.style.minHeight=n.minHeight)),this._iframe.style.visibility="visible",this._iframe.style.height=this._context.fullScreenIframe?"100vh":"".concat(this._iframeHeight||400,"px");var a=!1===(null===(t=null===(e=this._props.context)||void 0===e?void 0:e.hostOptions)||void 0===t?void 0:t.enableWiderDialog)?320:480;this._iframe.style.width=this._context.fullScreenIframe?"100%":"".concat(a||this._iframeWidth||this._iframe.style.minWidth,"px"),clearTimeout(this._timeoutId)},e.prototype._getParentListId=function(e){return""},e.prototype._toTuple=function(e){return Object(i.t)(this,void 0,void 0,function(){var t;return Object(i.i)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t={},[4,e];case 1:return[2,(t.value=n.sent(),t)];case 2:return[2,{error:n.sent()}];case 3:return[2]}})})},e.prototype._isError=function(e){return!!e.error},e.prototype._createSharingHostMessenger=function(){var e=this;if(this._clientOrigin=new L.e(this._iframeUrl).authority,this._clientOrigin&&this._iframe.contentWindow){var t=new Ie.e({origin:this._clientOrigin,channelId:this._channelId,source:this._iframe.contentWindow,customerPromiseLogger:this._shareCustomerPromiseLogger});return t.addCommandHandler(function(t){return e._processEvent(t),{result:"success"}}),t}return null},e.prototype._processEvent=function(e){var t,n,a,r,o=this;switch(e.name){case"share_scriptsLoaded":this._scriptsLoadedTime=new Date,this._signal.complete();var s=this._props.options&&this._props.options.onScriptsLoaded;s&&s();break;case"share_resize":if(!this._context.fullScreenIframe&&"width"in e&&"height"in e){var c=this._props.options&&this._props.options.onResize;c&&e.width&&e.height&&c(e.width,e.height),this._iframeWidth=e.width||320,this._iframeHeight=e.height||400,this._isShareReady&&(this._iframe.style.height="".concat(this._iframeHeight,"px"),this._iframe.style.width="".concat(this._iframeWidth,"px"))}break;case"share_started":var d=this._props.options&&this._props.options.onStarted;d&&d();break;case"share_ready":this._showShareUX();var l={scriptsLoadedTime:this._scriptsLoadedTime?this._scriptsLoadedTime.getTime()-this._iframeStartTime.getTime():-1,iframeLoadedTime:this._iframeLoadedTime,mode:this._context.mode,recipientsCount:this._context.defaultRecipients&&this._context.defaultRecipients.length||0,shareId:this._context.shareId,correlationId:null===(t=this._context)||void 0===t?void 0:t.correlationId};this._sessionQos.end({resultType:Se.t.Success,extraData:l}),this._shareCustomerPromiseLogger.end({resultType:Se.t.Success});var u=this._props.options&&this._props.options.onReady;u&&u();break;case"share_error":this._showShareUX();var f=this._props.options&&this._props.options.onError;if("error"in e){var p=e.resultCode||Object(ye.a)(new Error(e.error))||"unavilable";this._sessionQos.end({resultType:Se.t.Failure,resultCode:p,extraData:{correlationId:null===(n=this._context)||void 0===n?void 0:n.correlationId}}),this._shareCustomerPromiseLogger.end({resultType:Se.t.Failure,errorCode:p,extraData:{clientId:this._context.clientId,mode:null===(a=this._context)||void 0===a?void 0:a.mode,correlationId:null===(r=this._context)||void 0===r?void 0:r.correlationId}}),f&&f({name:"SharePrefetchError",message:e.errorMessage||"",error:Error(e.error),debugErrorMessage:e.debugErrorMessage||"",errorMessage:e.errorMessage||"",resultCode:p})}break;case"share_completed":var m=this._props.options&&this._props.options.onCompleted;m&&m({scope:"scope"in e&&e.scope||""});break;case"share_dismiss":var _=this._props.options&&this._props.options.onDismiss;_&&_();break;case"share_manageAccessClicked":var h=this._props.options&&this._props.options.openManageAccess;h&&h();break;case"share_linkSettingsCompleted":var b=this._props.options&&this._props.options.onLinkSettingsComplete;e&&b&&b(e);break;case"share_grantAccessCompleted":var g=this._props.options&&this._props.options.onGrantAccessComplete;"successful"in e&&e.successful&&g&&g();break;case"share_getToken":var v=new Se.e({name:"SharingSession.GetToken"}),y=this._iframe.contentWindow;if(!y){v.end({resultType:Se.t.Failure,error:"no_window"});break}this._props.options.spRestTokenProvider&&this._props.options.spRestTokenProvider.getAuthToken&&e&&"url"in e?this._props.options.spRestTokenProvider.getAuthToken(Object(i.e)(Object(i.e)({},e),{disallowCookies:!0})).then(function(e){e?(o._sharingHostMessenger?o._sharingHostMessenger.sendNewToken(e,void 0):y.postMessage(JSON.stringify({name:"share_newToken",token:e}),o._iframeUrl),v.end({resultType:Se.t.Success})):(o._sharingHostMessenger?o._sharingHostMessenger.sendNewToken(void 0,"no_token"):y.postMessage(JSON.stringify({name:"share_newToken",error:"no_token"}),o._iframeUrl),v.end({resultType:Se.t.Failure,error:"no_token"}))}).catch(function(e){o._sharingHostMessenger?o._sharingHostMessenger.sendNewToken(void 0,"token_exception",e.toString()):y.postMessage(JSON.stringify({name:"share_newToken",error:"token_exception",errorDetails:e}),o._iframeUrl),v.end({resultType:Se.t.Failure,error:String(e)})}):(this._sharingHostMessenger?this._sharingHostMessenger.sendNewToken(void 0,"no_handler"):y.postMessage(JSON.stringify({name:"share_newToken",error:"no_handler"}),this._iframeUrl),v.end({resultType:Se.t.Failure,error:"no_handler"}))}},e}()}}]);